/*! For license information please see script.bundle.js.LICENSE.txt */
(()=>{var t={7228:t=>{t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i},t.exports.default=t.exports,t.exports.__esModule=!0},2858:t=>{t.exports=function(t){if(Array.isArray(t))return t},t.exports.default=t.exports,t.exports.__esModule=!0},4575:t=>{t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},t.exports.default=t.exports,t.exports.__esModule=!0},3913:t=>{function e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}t.exports=function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t},t.exports.default=t.exports,t.exports.__esModule=!0},3884:t=>{t.exports=function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],i=!0,s=!1,r=void 0;try{for(var o,a=t[Symbol.iterator]();!(i=(o=a.next()).done)&&(n.push(o.value),!e||n.length!==e);i=!0);}catch(t){s=!0,r=t}finally{try{i||null==a.return||a.return()}finally{if(s)throw r}}return n}},t.exports.default=t.exports,t.exports.__esModule=!0},521:t=>{t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},t.exports.default=t.exports,t.exports.__esModule=!0},3038:(t,e,n)=>{var i=n(2858),s=n(3884),r=n(379),o=n(521);t.exports=function(t,e){return i(t)||s(t,e)||r(t,e)||o()},t.exports.default=t.exports,t.exports.__esModule=!0},379:(t,e,n)=>{var i=n(7228);t.exports=function(t,e){if(t){if("string"==typeof t)return i(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,e):void 0}},t.exports.default=t.exports,t.exports.__esModule=!0},7757:(t,e,n)=>{t.exports=n(5666)},5382:function(t,e,n){!function(t,e,n,i){"use strict";function s(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var r=s(e),o=s(n),a=s(i),c=function(t,e,n){return{endTime:e,insertTime:n,type:"exponentialRampToValue",value:t}},u=function(t,e,n){return{endTime:e,insertTime:n,type:"linearRampToValue",value:t}},l=function(t,e){return{startTime:e,type:"setValue",value:t}},h=function(t,e,n){return{duration:n,startTime:e,type:"setValueCurve",values:t}},p=function(t,e,n){var i=n.startTime,s=n.target,r=n.timeConstant;return s+(e-s)*Math.exp((i-t)/r)},d=function(t){return"exponentialRampToValue"===t.type},f=function(t){return"linearRampToValue"===t.type},m=function(t){return d(t)||f(t)},v=function(t){return"setValue"===t.type},g=function(t){return"setValueCurve"===t.type},y=function t(e,n,i,s){var r=e[n];return void 0===r?s:m(r)||v(r)?r.value:g(r)?r.values[r.values.length-1]:p(i,t(e,n-1,r.startTime,s),r)},_=function(t,e,n,i,s){return void 0===n?[i.insertTime,s]:m(n)?[n.endTime,n.value]:v(n)?[n.startTime,n.value]:g(n)?[n.startTime+n.duration,n.values[n.values.length-1]]:[n.startTime,y(t,e-1,n.startTime,s)]},b=function(t){return"cancelAndHold"===t.type},x=function(t){return"cancelScheduledValues"===t.type},w=function(t){return b(t)||x(t)?t.cancelTime:d(t)||f(t)?t.endTime:t.startTime},T=function(t,e,n,i){var s=i.endTime,r=i.value;return n===r?r:0<n&&0<r||n<0&&r<0?n*Math.pow(r/n,(t-e)/(s-e)):0},S=function(t,e,n,i){return n+(t-e)/(i.endTime-e)*(i.value-n)},k=function(t,e){var n=e.duration,i=e.startTime,s=e.values;return function(t,e){var n=Math.floor(e),i=Math.ceil(e);return n===i?t[n]:(1-(e-n))*t[n]+(1-(i-e))*t[i]}(s,(t-i)/n*(s.length-1))},O=function(t){return"setTarget"===t.type},E=function(){function t(e){o.default(this,t),this._automationEvents=[],this._currenTime=0,this._defaultValue=e}return a.default(t,[{key:Symbol.iterator,value:function(){return this._automationEvents[Symbol.iterator]()}},{key:"add",value:function(t){var e=w(t);if(b(t)||x(t)){var n=this._automationEvents.findIndex((function(n){return x(t)&&g(n)?n.startTime+n.duration>=e:w(n)>=e})),i=this._automationEvents[n];if(-1!==n&&(this._automationEvents=this._automationEvents.slice(0,n)),b(t)){var s=this._automationEvents[this._automationEvents.length-1];if(void 0!==i&&m(i)){if(O(s))throw new Error("The internal list is malformed.");var r=g(s)?s.startTime+s.duration:w(s),o=g(s)?s.values[s.values.length-1]:s.value,a=d(i)?T(e,r,o,i):S(e,r,o,i),p=d(i)?c(a,e,this._currenTime):u(a,e,this._currenTime);this._automationEvents.push(p)}void 0!==s&&O(s)&&this._automationEvents.push(l(this.getValue(e),e)),void 0!==s&&g(s)&&s.startTime+s.duration>e&&(this._automationEvents[this._automationEvents.length-1]=h(new Float32Array([6,7]),s.startTime,e-s.startTime))}}else{var v=this._automationEvents.findIndex((function(t){return w(t)>e})),y=-1===v?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[v-1];if(void 0!==y&&g(y)&&w(y)+y.duration>e)return!1;var _=d(t)?c(t.value,t.endTime,this._currenTime):f(t)?u(t.value,e,this._currenTime):t;if(-1===v)this._automationEvents.push(_);else{if(g(t)&&e+t.duration>w(this._automationEvents[v]))return!1;this._automationEvents.splice(v,0,_)}}return!0}},{key:"flush",value:function(t){var e=this._automationEvents.findIndex((function(e){return w(e)>t}));if(e>1){var n=this._automationEvents.slice(e-1),i=n[0];O(i)&&n.unshift(l(y(this._automationEvents,e-2,i.startTime,this._defaultValue),i.startTime)),this._automationEvents=n}}},{key:"getValue",value:function(t){if(0===this._automationEvents.length)return this._defaultValue;var e=this._automationEvents.findIndex((function(e){return w(e)>t})),n=this._automationEvents[e],i=(-1===e?this._automationEvents.length:e)-1,s=this._automationEvents[i];if(void 0!==s&&O(s)&&(void 0===n||!m(n)||n.insertTime>t))return p(t,y(this._automationEvents,i-1,s.startTime,this._defaultValue),s);if(void 0!==s&&v(s)&&(void 0===n||!m(n)))return s.value;if(void 0!==s&&g(s)&&(void 0===n||!m(n)||s.startTime+s.duration>t))return t<s.startTime+s.duration?k(t,s):s.values[s.values.length-1];if(void 0!==s&&m(s)&&(void 0===n||!m(n)))return s.value;if(void 0!==n&&d(n)){var o=_(this._automationEvents,i,s,n,this._defaultValue),a=r.default(o,2),c=a[0],u=a[1];return T(t,c,u,n)}if(void 0!==n&&f(n)){var l=_(this._automationEvents,i,s,n,this._defaultValue),h=r.default(l,2),b=h[0],x=h[1];return S(t,b,x,n)}return this._defaultValue}}]),t}();t.AutomationEventList=E,t.createCancelAndHoldAutomationEvent=function(t){return{cancelTime:t,type:"cancelAndHold"}},t.createCancelScheduledValuesAutomationEvent=function(t){return{cancelTime:t,type:"cancelScheduledValues"}},t.createExponentialRampToValueAutomationEvent=function(t,e){return{endTime:e,type:"exponentialRampToValue",value:t}},t.createLinearRampToValueAutomationEvent=function(t,e){return{endTime:e,type:"linearRampToValue",value:t}},t.createSetTargetAutomationEvent=function(t,e,n){return{startTime:e,target:t,timeConstant:n,type:"setTarget"}},t.createSetValueAutomationEvent=l,t.createSetValueCurveAutomationEvent=h,Object.defineProperty(t,"__esModule",{value:!0})}(e,n(3038),n(4575),n(3913))},8496:t=>{t.exports=function(){var t={};Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,t.default=function(t){return!(!t||!t.Window)&&t instanceof t.Window};var e={};Object.defineProperty(e,"__esModule",{value:!0}),e.init=s,e.getWindow=function(e){return(0,t.default)(e)?e:(e.ownerDocument||e).defaultView||i.window},e.window=e.realWindow=void 0;var n=void 0;e.realWindow=n;var i=void 0;function s(t){e.realWindow=n=t;var s=t.document.createTextNode("");s.ownerDocument!==t.document&&"function"==typeof t.wrap&&t.wrap(s)===s&&(t=t.wrap(t)),e.window=i=t}e.window=i,"undefined"!=typeof window&&window&&s(window);var r={};function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var a=function(t){return!!t&&"object"===o(t)},c=function(t){return"function"==typeof t},u={window:function(n){return n===e.window||(0,t.default)(n)},docFrag:function(t){return a(t)&&11===t.nodeType},object:a,func:c,number:function(t){return"number"==typeof t},bool:function(t){return"boolean"==typeof t},string:function(t){return"string"==typeof t},element:function(t){if(!t||"object"!==o(t))return!1;var n=e.getWindow(t)||e.window;return/object|function/.test(o(n.Element))?t instanceof n.Element:1===t.nodeType&&"string"==typeof t.nodeName},plainObject:function(t){return a(t)&&!!t.constructor&&/function Object\b/.test(t.constructor.toString())},array:function(t){return a(t)&&void 0!==t.length&&c(t.splice)}};r.default=u;var l={};function h(t){var e=t.interaction;if("drag"===e.prepared.name){var n=e.prepared.axis;"x"===n?(e.coords.cur.page.y=e.coords.start.page.y,e.coords.cur.client.y=e.coords.start.client.y,e.coords.velocity.client.y=0,e.coords.velocity.page.y=0):"y"===n&&(e.coords.cur.page.x=e.coords.start.page.x,e.coords.cur.client.x=e.coords.start.client.x,e.coords.velocity.client.x=0,e.coords.velocity.page.x=0)}}function p(t){var e=t.iEvent,n=t.interaction;if("drag"===n.prepared.name){var i=n.prepared.axis;if("x"===i||"y"===i){var s="x"===i?"y":"x";e.page[s]=n.coords.start.page[s],e.client[s]=n.coords.start.client[s],e.delta[s]=0}}}Object.defineProperty(l,"__esModule",{value:!0}),l.default=void 0;var d={id:"actions/drag",install:function(t){var e=t.actions,n=t.Interactable,i=t.defaults;n.prototype.draggable=d.draggable,e.map.drag=d,e.methodDict.drag="draggable",i.actions.drag=d.defaults},listeners:{"interactions:before-action-move":h,"interactions:action-resume":h,"interactions:action-move":p,"auto-start:check":function(t){var e=t.interaction,n=t.interactable,i=t.buttons,s=n.options.drag;if(s&&s.enabled&&(!e.pointerIsDown||!/mouse|pointer/.test(e.pointerType)||0!=(i&n.options.drag.mouseButtons)))return t.action={name:"drag",axis:"start"===s.lockAxis?s.startAxis:s.lockAxis},!1}},draggable:function(t){return r.default.object(t)?(this.options.drag.enabled=!1!==t.enabled,this.setPerAction("drag",t),this.setOnEvents("drag",t),/^(xy|x|y|start)$/.test(t.lockAxis)&&(this.options.drag.lockAxis=t.lockAxis),/^(xy|x|y)$/.test(t.startAxis)&&(this.options.drag.startAxis=t.startAxis),this):r.default.bool(t)?(this.options.drag.enabled=t,this):this.options.drag},beforeMove:h,move:p,defaults:{startAxis:"xy",lockAxis:"xy"},getCursor:function(){return"move"}},f=d;l.default=f;var m={};Object.defineProperty(m,"__esModule",{value:!0}),m.default=void 0;var v={init:function(t){var e=t;v.document=e.document,v.DocumentFragment=e.DocumentFragment||g,v.SVGElement=e.SVGElement||g,v.SVGSVGElement=e.SVGSVGElement||g,v.SVGElementInstance=e.SVGElementInstance||g,v.Element=e.Element||g,v.HTMLElement=e.HTMLElement||v.Element,v.Event=e.Event,v.Touch=e.Touch||g,v.PointerEvent=e.PointerEvent||e.MSPointerEvent},document:null,DocumentFragment:null,SVGElement:null,SVGSVGElement:null,SVGElementInstance:null,Element:null,HTMLElement:null,Event:null,Touch:null,PointerEvent:null};function g(){}var y=v;m.default=y;var _={};Object.defineProperty(_,"__esModule",{value:!0}),_.default=void 0;var b={init:function(t){var e=m.default.Element,n=t.navigator||{};b.supportsTouch="ontouchstart"in t||r.default.func(t.DocumentTouch)&&m.default.document instanceof t.DocumentTouch,b.supportsPointerEvent=!1!==n.pointerEnabled&&!!m.default.PointerEvent,b.isIOS=/iP(hone|od|ad)/.test(n.platform),b.isIOS7=/iP(hone|od|ad)/.test(n.platform)&&/OS 7[^\d]/.test(n.appVersion),b.isIe9=/MSIE 9/.test(n.userAgent),b.isOperaMobile="Opera"===n.appName&&b.supportsTouch&&/Presto/.test(n.userAgent),b.prefixedMatchesSelector="matches"in e.prototype?"matches":"webkitMatchesSelector"in e.prototype?"webkitMatchesSelector":"mozMatchesSelector"in e.prototype?"mozMatchesSelector":"oMatchesSelector"in e.prototype?"oMatchesSelector":"msMatchesSelector",b.pEventTypes=b.supportsPointerEvent?m.default.PointerEvent===t.MSPointerEvent?{up:"MSPointerUp",down:"MSPointerDown",over:"mouseover",out:"mouseout",move:"MSPointerMove",cancel:"MSPointerCancel"}:{up:"pointerup",down:"pointerdown",over:"pointerover",out:"pointerout",move:"pointermove",cancel:"pointercancel"}:null,b.wheelEvent=m.default.document&&"onmousewheel"in m.default.document?"mousewheel":"wheel"},supportsTouch:null,supportsPointerEvent:null,isIOS7:null,isIOS:null,isIe9:null,isOperaMobile:null,prefixedMatchesSelector:null,pEventTypes:null,wheelEvent:null},x=b;_.default=x;var w={};function T(t){var e=t.parentNode;if(r.default.docFrag(e)){for(;(e=e.host)&&r.default.docFrag(e););return e}return e}function S(t,n){return e.window!==e.realWindow&&(n=n.replace(/\/deep\//g," ")),t[_.default.prefixedMatchesSelector](n)}Object.defineProperty(w,"__esModule",{value:!0}),w.nodeContains=function(t,e){if(t.contains)return t.contains(e);for(;e;){if(e===t)return!0;e=e.parentNode}return!1},w.closest=function(t,e){for(;r.default.element(t);){if(S(t,e))return t;t=T(t)}return null},w.parentNode=T,w.matchesSelector=S,w.indexOfDeepestElement=function(t){for(var n,i=[],s=0;s<t.length;s++){var r=t[s],o=t[n];if(r&&s!==n)if(o){var a=k(r),c=k(o);if(a!==r.ownerDocument)if(c!==r.ownerDocument)if(a!==c){i=i.length?i:O(o);var u=void 0;if(o instanceof m.default.HTMLElement&&r instanceof m.default.SVGElement&&!(r instanceof m.default.SVGSVGElement)){if(r===c)continue;u=r.ownerSVGElement}else u=r;for(var l=O(u,o.ownerDocument),h=0;l[h]&&l[h]===i[h];)h++;var p=[l[h-1],l[h],i[h]];if(p[0])for(var d=p[0].lastChild;d;){if(d===p[1]){n=s,i=l;break}if(d===p[2])break;d=d.previousSibling}}else f=r,v=o,(parseInt(e.getWindow(f).getComputedStyle(f).zIndex,10)||0)>=(parseInt(e.getWindow(v).getComputedStyle(v).zIndex,10)||0)&&(n=s);else n=s}else n=s}var f,v;return n},w.matchesUpTo=function(t,e,n){for(;r.default.element(t);){if(S(t,e))return!0;if((t=T(t))===n)return S(t,e)}return!1},w.getActualElement=function(t){return t.correspondingUseElement||t},w.getScrollXY=E,w.getElementClientRect=C,w.getElementRect=function(t){var n=C(t);if(!_.default.isIOS7&&n){var i=E(e.getWindow(t));n.left+=i.x,n.right+=i.x,n.top+=i.y,n.bottom+=i.y}return n},w.getPath=function(t){for(var e=[];t;)e.push(t),t=T(t);return e},w.trySelector=function(t){return!!r.default.string(t)&&(m.default.document.querySelector(t),!0)};var k=function(t){return t.parentNode||t.host};function O(t,e){for(var n,i=[],s=t;(n=k(s))&&s!==e&&n!==s.ownerDocument;)i.unshift(s),s=n;return i}function E(t){return{x:(t=t||e.window).scrollX||t.document.documentElement.scrollLeft,y:t.scrollY||t.document.documentElement.scrollTop}}function C(t){var e=t instanceof m.default.SVGElement?t.getBoundingClientRect():t.getClientRects()[0];return e&&{left:e.left,right:e.right,top:e.top,bottom:e.bottom,width:e.width||e.right-e.left,height:e.height||e.bottom-e.top}}var A={};Object.defineProperty(A,"__esModule",{value:!0}),A.default=function(t,e){for(var n in e)t[n]=e[n];return t};var D={};function M(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function I(t,e,n){return"parent"===t?(0,w.parentNode)(n):"self"===t?e.getRect(n):(0,w.closest)(n,t)}Object.defineProperty(D,"__esModule",{value:!0}),D.getStringOptionResult=I,D.resolveRectLike=function(t,e,n,i){var s,o=t;return r.default.string(o)?o=I(o,e,n):r.default.func(o)&&(o=o.apply(void 0,function(t){if(Array.isArray(t))return M(t)}(s=i)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(s)||function(t,e){if(t){if("string"==typeof t)return M(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?M(t,e):void 0}}(s)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())),r.default.element(o)&&(o=(0,w.getElementRect)(o)),o},D.rectToXY=function(t){return t&&{x:"x"in t?t.x:t.left,y:"y"in t?t.y:t.top}},D.xywhToTlbr=function(t){return!t||"left"in t&&"top"in t||((t=(0,A.default)({},t)).left=t.x||0,t.top=t.y||0,t.right=t.right||t.left+t.width,t.bottom=t.bottom||t.top+t.height),t},D.tlbrToXywh=function(t){return!t||"x"in t&&"y"in t||((t=(0,A.default)({},t)).x=t.left||0,t.y=t.top||0,t.width=t.width||(t.right||0)-t.x,t.height=t.height||(t.bottom||0)-t.y),t},D.addEdges=function(t,e,n){t.left&&(e.left+=n.x),t.right&&(e.right+=n.x),t.top&&(e.top+=n.y),t.bottom&&(e.bottom+=n.y),e.width=e.right-e.left,e.height=e.bottom-e.top};var P={};Object.defineProperty(P,"__esModule",{value:!0}),P.default=function(t,e,n){var i=t.options[n],s=i&&i.origin||t.options.origin,r=(0,D.resolveRectLike)(s,t,e,[t&&e]);return(0,D.rectToXY)(r)||{x:0,y:0}};var R={};function j(t){return t.trim().split(/ +/)}Object.defineProperty(R,"__esModule",{value:!0}),R.default=function t(e,n,i){if(i=i||{},r.default.string(e)&&-1!==e.search(" ")&&(e=j(e)),r.default.array(e))return e.reduce((function(e,s){return(0,A.default)(e,t(s,n,i))}),i);if(r.default.object(e)&&(n=e,e=""),r.default.func(n))i[e]=i[e]||[],i[e].push(n);else if(r.default.array(n))for(var s=0;s<n.length;s++){var o;o=n[s],t(e,o,i)}else if(r.default.object(n))for(var a in n){var c=j(a).map((function(t){return"".concat(e).concat(t)}));t(c,n[a],i)}return i};var q={};Object.defineProperty(q,"__esModule",{value:!0}),q.default=void 0,q.default=function(t,e){return Math.sqrt(t*t+e*e)};var N={};function V(t,e){for(var n in e){var i=V.prefixedPropREs,s=!1;for(var r in i)if(0===n.indexOf(r)&&i[r].test(n)){s=!0;break}s||"function"==typeof e[n]||(t[n]=e[n])}return t}Object.defineProperty(N,"__esModule",{value:!0}),N.default=void 0,V.prefixedPropREs={webkit:/(Movement[XY]|Radius[XY]|RotationAngle|Force)$/,moz:/(Pressure)$/};var F=V;N.default=F;var L={};function z(t){return t instanceof m.default.Event||t instanceof m.default.Touch}function B(t,e,n){return t=t||"page",(n=n||{}).x=e[t+"X"],n.y=e[t+"Y"],n}function W(t,e){return e=e||{x:0,y:0},_.default.isOperaMobile&&z(t)?(B("screen",t,e),e.x+=window.scrollX,e.y+=window.scrollY):B("page",t,e),e}function Z(t,e){return e=e||{},_.default.isOperaMobile&&z(t)?B("screen",t,e):B("client",t,e),e}function U(t){var e=[];return r.default.array(t)?(e[0]=t[0],e[1]=t[1]):"touchend"===t.type?1===t.touches.length?(e[0]=t.touches[0],e[1]=t.changedTouches[0]):0===t.touches.length&&(e[0]=t.changedTouches[0],e[1]=t.changedTouches[1]):(e[0]=t.touches[0],e[1]=t.touches[1]),e}function Y(t){for(var e={pageX:0,pageY:0,clientX:0,clientY:0,screenX:0,screenY:0},n=0;n<t.length;n++){var i=t[n];for(var s in e)e[s]+=i[s]}for(var r in e)e[r]/=t.length;return e}Object.defineProperty(L,"__esModule",{value:!0}),L.copyCoords=function(t,e){t.page=t.page||{},t.page.x=e.page.x,t.page.y=e.page.y,t.client=t.client||{},t.client.x=e.client.x,t.client.y=e.client.y,t.timeStamp=e.timeStamp},L.setCoordDeltas=function(t,e,n){t.page.x=n.page.x-e.page.x,t.page.y=n.page.y-e.page.y,t.client.x=n.client.x-e.client.x,t.client.y=n.client.y-e.client.y,t.timeStamp=n.timeStamp-e.timeStamp},L.setCoordVelocity=function(t,e){var n=Math.max(e.timeStamp/1e3,.001);t.page.x=e.page.x/n,t.page.y=e.page.y/n,t.client.x=e.client.x/n,t.client.y=e.client.y/n,t.timeStamp=n},L.setZeroCoords=function(t){t.page.x=0,t.page.y=0,t.client.x=0,t.client.y=0},L.isNativePointer=z,L.getXY=B,L.getPageXY=W,L.getClientXY=Z,L.getPointerId=function(t){return r.default.number(t.pointerId)?t.pointerId:t.identifier},L.setCoords=function(t,e,n){var i=e.length>1?Y(e):e[0];W(i,t.page),Z(i,t.client),t.timeStamp=n},L.getTouchPair=U,L.pointerAverage=Y,L.touchBBox=function(t){if(!t.length)return null;var e=U(t),n=Math.min(e[0].pageX,e[1].pageX),i=Math.min(e[0].pageY,e[1].pageY),s=Math.max(e[0].pageX,e[1].pageX),r=Math.max(e[0].pageY,e[1].pageY);return{x:n,y:i,left:n,top:i,right:s,bottom:r,width:s-n,height:r-i}},L.touchDistance=function(t,e){var n=e+"X",i=e+"Y",s=U(t),r=s[0][n]-s[1][n],o=s[0][i]-s[1][i];return(0,q.default)(r,o)},L.touchAngle=function(t,e){var n=e+"X",i=e+"Y",s=U(t),r=s[1][n]-s[0][n],o=s[1][i]-s[0][i];return 180*Math.atan2(o,r)/Math.PI},L.getPointerType=function(t){return r.default.string(t.pointerType)?t.pointerType:r.default.number(t.pointerType)?[void 0,void 0,"touch","pen","mouse"][t.pointerType]:/touch/.test(t.type||"")||t instanceof m.default.Touch?"touch":"mouse"},L.getEventTargets=function(t){var e=r.default.func(t.composedPath)?t.composedPath():t.path;return[w.getActualElement(e?e[0]:t.target),w.getActualElement(t.currentTarget)]},L.newCoords=function(){return{page:{x:0,y:0},client:{x:0,y:0},timeStamp:0}},L.coordsToEvent=function(t){return{coords:t,get page(){return this.coords.page},get client(){return this.coords.client},get timeStamp(){return this.coords.timeStamp},get pageX(){return this.coords.page.x},get pageY(){return this.coords.page.y},get clientX(){return this.coords.client.x},get clientY(){return this.coords.client.y},get pointerId(){return this.coords.pointerId},get target(){return this.coords.target},get type(){return this.coords.type},get pointerType(){return this.coords.pointerType},get buttons(){return this.coords.buttons},preventDefault:function(){}}},Object.defineProperty(L,"pointerExtend",{enumerable:!0,get:function(){return N.default}});var G={};function X(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(G,"__esModule",{value:!0}),G.BaseEvent=void 0;var Q=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),X(this,"type",void 0),X(this,"target",void 0),X(this,"currentTarget",void 0),X(this,"interactable",void 0),X(this,"_interaction",void 0),X(this,"timeStamp",void 0),X(this,"immediatePropagationStopped",!1),X(this,"propagationStopped",!1),this._interaction=e}var e;return(e=[{key:"preventDefault",value:function(){}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}},{key:"stopImmediatePropagation",value:function(){this.immediatePropagationStopped=this.propagationStopped=!0}}])&&function(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}(t.prototype,e),t}();G.BaseEvent=Q,Object.defineProperty(Q.prototype,"interaction",{get:function(){return this._interaction._proxy},set:function(){}});var H={};Object.defineProperty(H,"__esModule",{value:!0}),H.find=H.findIndex=H.from=H.merge=H.remove=H.contains=void 0,H.contains=function(t,e){return-1!==t.indexOf(e)},H.remove=function(t,e){return t.splice(t.indexOf(e),1)};var $=function(t,e){for(var n=0;n<e.length;n++){var i=e[n];t.push(i)}return t};H.merge=$,H.from=function(t){return $([],t)};var K=function(t,e){for(var n=0;n<t.length;n++)if(e(t[n],n,t))return n;return-1};H.findIndex=K,H.find=function(t,e){return t[K(t,e)]};var J={};function tt(t){return(tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function et(t,e){return(et=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function nt(t,e){return!e||"object"!==tt(e)&&"function"!=typeof e?it(t):e}function it(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function st(t){return(st=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function rt(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(J,"__esModule",{value:!0}),J.DropEvent=void 0;var ot=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&et(t,e)}(r,t);var e,n,i,s=(n=r,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=st(n);if(i){var s=st(this).constructor;t=Reflect.construct(e,arguments,s)}else t=e.apply(this,arguments);return nt(this,t)});function r(t,e,n){var i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),rt(it(i=s.call(this,e._interaction)),"target",void 0),rt(it(i),"dropzone",void 0),rt(it(i),"dragEvent",void 0),rt(it(i),"relatedTarget",void 0),rt(it(i),"draggable",void 0),rt(it(i),"timeStamp",void 0),rt(it(i),"propagationStopped",!1),rt(it(i),"immediatePropagationStopped",!1);var o="dragleave"===n?t.prev:t.cur,a=o.element,c=o.dropzone;return i.type=n,i.target=a,i.currentTarget=a,i.dropzone=c,i.dragEvent=e,i.relatedTarget=e.target,i.draggable=e.interactable,i.timeStamp=e.timeStamp,i}return(e=[{key:"reject",value:function(){var t=this,e=this._interaction.dropState;if("dropactivate"===this.type||this.dropzone&&e.cur.dropzone===this.dropzone&&e.cur.element===this.target)if(e.prev.dropzone=this.dropzone,e.prev.element=this.target,e.rejected=!0,e.events.enter=null,this.stopImmediatePropagation(),"dropactivate"===this.type){var n=e.activeDrops,i=H.findIndex(n,(function(e){var n=e.dropzone,i=e.element;return n===t.dropzone&&i===t.target}));e.activeDrops.splice(i,1);var s=new r(e,this.dragEvent,"dropdeactivate");s.dropzone=this.dropzone,s.target=this.target,this.dropzone.fire(s)}else this.dropzone.fire(new r(e,this.dragEvent,"dragleave"))}},{key:"preventDefault",value:function(){}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}},{key:"stopImmediatePropagation",value:function(){this.immediatePropagationStopped=this.propagationStopped=!0}}])&&function(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}(r.prototype,e),r}(G.BaseEvent);J.DropEvent=ot;var at={};function ct(t,e){for(var n=0;n<t.slice().length;n++){var i=t.slice()[n],s=i.dropzone,r=i.element;e.dropzone=s,e.target=r,s.fire(e),e.propagationStopped=e.immediatePropagationStopped=!1}}function ut(t,e){for(var n=function(t,e){for(var n=t.interactables,i=[],s=0;s<n.list.length;s++){var o=n.list[s];if(o.options.drop.enabled){var a=o.options.drop.accept;if(!(r.default.element(a)&&a!==e||r.default.string(a)&&!w.matchesSelector(e,a)||r.default.func(a)&&!a({dropzone:o,draggableElement:e})))for(var c=r.default.string(o.target)?o._context.querySelectorAll(o.target):r.default.array(o.target)?o.target:[o.target],u=0;u<c.length;u++){var l=c[u];l!==e&&i.push({dropzone:o,element:l,rect:o.getRect(l)})}}}return i}(t,e),i=0;i<n.length;i++){var s=n[i];s.rect=s.dropzone.getRect(s.element)}return n}function lt(t,e,n){for(var i=t.dropState,s=t.interactable,r=t.element,o=[],a=0;a<i.activeDrops.length;a++){var c=i.activeDrops[a],u=c.dropzone,l=c.element,h=c.rect;o.push(u.dropCheck(e,n,s,r,l,h)?l:null)}var p=w.indexOfDeepestElement(o);return i.activeDrops[p]||null}function ht(t,e,n){var i=t.dropState,s={enter:null,leave:null,activate:null,deactivate:null,move:null,drop:null};return"dragstart"===n.type&&(s.activate=new J.DropEvent(i,n,"dropactivate"),s.activate.target=null,s.activate.dropzone=null),"dragend"===n.type&&(s.deactivate=new J.DropEvent(i,n,"dropdeactivate"),s.deactivate.target=null,s.deactivate.dropzone=null),i.rejected||(i.cur.element!==i.prev.element&&(i.prev.dropzone&&(s.leave=new J.DropEvent(i,n,"dragleave"),n.dragLeave=s.leave.target=i.prev.element,n.prevDropzone=s.leave.dropzone=i.prev.dropzone),i.cur.dropzone&&(s.enter=new J.DropEvent(i,n,"dragenter"),n.dragEnter=i.cur.element,n.dropzone=i.cur.dropzone)),"dragend"===n.type&&i.cur.dropzone&&(s.drop=new J.DropEvent(i,n,"drop"),n.dropzone=i.cur.dropzone,n.relatedTarget=i.cur.element),"dragmove"===n.type&&i.cur.dropzone&&(s.move=new J.DropEvent(i,n,"dropmove"),s.move.dragmove=n,n.dropzone=i.cur.dropzone)),s}function pt(t,e){var n=t.dropState,i=n.activeDrops,s=n.cur,r=n.prev;e.leave&&r.dropzone.fire(e.leave),e.enter&&s.dropzone.fire(e.enter),e.move&&s.dropzone.fire(e.move),e.drop&&s.dropzone.fire(e.drop),e.deactivate&&ct(i,e.deactivate),n.prev.dropzone=s.dropzone,n.prev.element=s.element}function dt(t,e){var n=t.interaction,i=t.iEvent,s=t.event;if("dragmove"===i.type||"dragend"===i.type){var r=n.dropState;e.dynamicDrop&&(r.activeDrops=ut(e,n.element));var o=i,a=lt(n,o,s);r.rejected=r.rejected&&!!a&&a.dropzone===r.cur.dropzone&&a.element===r.cur.element,r.cur.dropzone=a&&a.dropzone,r.cur.element=a&&a.element,r.events=ht(n,0,o)}}Object.defineProperty(at,"__esModule",{value:!0}),at.default=void 0;var ft={id:"actions/drop",install:function(t){var e=t.actions,n=t.interactStatic,i=t.Interactable,s=t.defaults;t.usePlugin(l.default),i.prototype.dropzone=function(t){return function(t,e){if(r.default.object(e)){if(t.options.drop.enabled=!1!==e.enabled,e.listeners){var n=(0,R.default)(e.listeners),i=Object.keys(n).reduce((function(t,e){return t[/^(enter|leave)/.test(e)?"drag".concat(e):/^(activate|deactivate|move)/.test(e)?"drop".concat(e):e]=n[e],t}),{});t.off(t.options.drop.listeners),t.on(i),t.options.drop.listeners=i}return r.default.func(e.ondrop)&&t.on("drop",e.ondrop),r.default.func(e.ondropactivate)&&t.on("dropactivate",e.ondropactivate),r.default.func(e.ondropdeactivate)&&t.on("dropdeactivate",e.ondropdeactivate),r.default.func(e.ondragenter)&&t.on("dragenter",e.ondragenter),r.default.func(e.ondragleave)&&t.on("dragleave",e.ondragleave),r.default.func(e.ondropmove)&&t.on("dropmove",e.ondropmove),/^(pointer|center)$/.test(e.overlap)?t.options.drop.overlap=e.overlap:r.default.number(e.overlap)&&(t.options.drop.overlap=Math.max(Math.min(1,e.overlap),0)),"accept"in e&&(t.options.drop.accept=e.accept),"checker"in e&&(t.options.drop.checker=e.checker),t}return r.default.bool(e)?(t.options.drop.enabled=e,t):t.options.drop}(this,t)},i.prototype.dropCheck=function(t,e,n,i,s,o){return function(t,e,n,i,s,o,a){var c=!1;if(!(a=a||t.getRect(o)))return!!t.options.drop.checker&&t.options.drop.checker(e,n,c,t,o,i,s);var u=t.options.drop.overlap;if("pointer"===u){var l=(0,P.default)(i,s,"drag"),h=L.getPageXY(e);h.x+=l.x,h.y+=l.y;var p=h.x>a.left&&h.x<a.right,d=h.y>a.top&&h.y<a.bottom;c=p&&d}var f=i.getRect(s);if(f&&"center"===u){var m=f.left+f.width/2,v=f.top+f.height/2;c=m>=a.left&&m<=a.right&&v>=a.top&&v<=a.bottom}return f&&r.default.number(u)&&(c=Math.max(0,Math.min(a.right,f.right)-Math.max(a.left,f.left))*Math.max(0,Math.min(a.bottom,f.bottom)-Math.max(a.top,f.top))/(f.width*f.height)>=u),t.options.drop.checker&&(c=t.options.drop.checker(e,n,c,t,o,i,s)),c}(this,t,e,n,i,s,o)},n.dynamicDrop=function(e){return r.default.bool(e)?(t.dynamicDrop=e,n):t.dynamicDrop},(0,A.default)(e.phaselessTypes,{dragenter:!0,dragleave:!0,dropactivate:!0,dropdeactivate:!0,dropmove:!0,drop:!0}),e.methodDict.drop="dropzone",t.dynamicDrop=!1,s.actions.drop=ft.defaults},listeners:{"interactions:before-action-start":function(t){var e=t.interaction;"drag"===e.prepared.name&&(e.dropState={cur:{dropzone:null,element:null},prev:{dropzone:null,element:null},rejected:null,events:null,activeDrops:[]})},"interactions:after-action-start":function(t,e){var n=t.interaction,i=(t.event,t.iEvent);if("drag"===n.prepared.name){var s=n.dropState;s.activeDrops=null,s.events=null,s.activeDrops=ut(e,n.element),s.events=ht(n,0,i),s.events.activate&&(ct(s.activeDrops,s.events.activate),e.fire("actions/drop:start",{interaction:n,dragEvent:i}))}},"interactions:action-move":dt,"interactions:after-action-move":function(t,e){var n=t.interaction,i=t.iEvent;"drag"===n.prepared.name&&(pt(n,n.dropState.events),e.fire("actions/drop:move",{interaction:n,dragEvent:i}),n.dropState.events={})},"interactions:action-end":function(t,e){if("drag"===t.interaction.prepared.name){var n=t.interaction,i=t.iEvent;dt(t,e),pt(n,n.dropState.events),e.fire("actions/drop:end",{interaction:n,dragEvent:i})}},"interactions:stop":function(t){var e=t.interaction;if("drag"===e.prepared.name){var n=e.dropState;n&&(n.activeDrops=null,n.events=null,n.cur.dropzone=null,n.cur.element=null,n.prev.dropzone=null,n.prev.element=null,n.rejected=!1)}}},getActiveDrops:ut,getDrop:lt,getDropEvents:ht,fireDropEvents:pt,defaults:{enabled:!1,accept:null,overlap:"pointer"}},mt=ft;at.default=mt;var vt={};function gt(t){var e=t.interaction,n=t.iEvent,i=t.phase;if("gesture"===e.prepared.name){var s=e.pointers.map((function(t){return t.pointer})),o="start"===i,a="end"===i,c=e.interactable.options.deltaSource;if(n.touches=[s[0],s[1]],o)n.distance=L.touchDistance(s,c),n.box=L.touchBBox(s),n.scale=1,n.ds=0,n.angle=L.touchAngle(s,c),n.da=0,e.gesture.startDistance=n.distance,e.gesture.startAngle=n.angle;else if(a){var u=e.prevEvent;n.distance=u.distance,n.box=u.box,n.scale=u.scale,n.ds=0,n.angle=u.angle,n.da=0}else n.distance=L.touchDistance(s,c),n.box=L.touchBBox(s),n.scale=n.distance/e.gesture.startDistance,n.angle=L.touchAngle(s,c),n.ds=n.scale-e.gesture.scale,n.da=n.angle-e.gesture.angle;e.gesture.distance=n.distance,e.gesture.angle=n.angle,r.default.number(n.scale)&&n.scale!==1/0&&!isNaN(n.scale)&&(e.gesture.scale=n.scale)}}Object.defineProperty(vt,"__esModule",{value:!0}),vt.default=void 0;var yt={id:"actions/gesture",before:["actions/drag","actions/resize"],install:function(t){var e=t.actions,n=t.Interactable,i=t.defaults;n.prototype.gesturable=function(t){return r.default.object(t)?(this.options.gesture.enabled=!1!==t.enabled,this.setPerAction("gesture",t),this.setOnEvents("gesture",t),this):r.default.bool(t)?(this.options.gesture.enabled=t,this):this.options.gesture},e.map.gesture=yt,e.methodDict.gesture="gesturable",i.actions.gesture=yt.defaults},listeners:{"interactions:action-start":gt,"interactions:action-move":gt,"interactions:action-end":gt,"interactions:new":function(t){t.interaction.gesture={angle:0,distance:0,scale:1,startAngle:0,startDistance:0}},"auto-start:check":function(t){if(!(t.interaction.pointers.length<2)){var e=t.interactable.options.gesture;if(e&&e.enabled)return t.action={name:"gesture"},!1}}},defaults:{},getCursor:function(){return""}},_t=yt;vt.default=_t;var bt={};function xt(t,e,n,i,s,o,a){if(!e)return!1;if(!0===e){var c=r.default.number(o.width)?o.width:o.right-o.left,u=r.default.number(o.height)?o.height:o.bottom-o.top;if(a=Math.min(a,Math.abs(("left"===t||"right"===t?c:u)/2)),c<0&&("left"===t?t="right":"right"===t&&(t="left")),u<0&&("top"===t?t="bottom":"bottom"===t&&(t="top")),"left"===t)return n.x<(c>=0?o.left:o.right)+a;if("top"===t)return n.y<(u>=0?o.top:o.bottom)+a;if("right"===t)return n.x>(c>=0?o.right:o.left)-a;if("bottom"===t)return n.y>(u>=0?o.bottom:o.top)-a}return!!r.default.element(i)&&(r.default.element(e)?e===i:w.matchesUpTo(i,e,s))}function wt(t){var e=t.iEvent,n=t.interaction;if("resize"===n.prepared.name&&n.resizeAxes){var i=e;n.interactable.options.resize.square?("y"===n.resizeAxes?i.delta.x=i.delta.y:i.delta.y=i.delta.x,i.axes="xy"):(i.axes=n.resizeAxes,"x"===n.resizeAxes?i.delta.y=0:"y"===n.resizeAxes&&(i.delta.x=0))}}Object.defineProperty(bt,"__esModule",{value:!0}),bt.default=void 0;var Tt={id:"actions/resize",before:["actions/drag"],install:function(t){var e=t.actions,n=t.browser,i=t.Interactable,s=t.defaults;Tt.cursors=function(t){return t.isIe9?{x:"e-resize",y:"s-resize",xy:"se-resize",top:"n-resize",left:"w-resize",bottom:"s-resize",right:"e-resize",topleft:"se-resize",bottomright:"se-resize",topright:"ne-resize",bottomleft:"ne-resize"}:{x:"ew-resize",y:"ns-resize",xy:"nwse-resize",top:"ns-resize",left:"ew-resize",bottom:"ns-resize",right:"ew-resize",topleft:"nwse-resize",bottomright:"nwse-resize",topright:"nesw-resize",bottomleft:"nesw-resize"}}(n),Tt.defaultMargin=n.supportsTouch||n.supportsPointerEvent?20:10,i.prototype.resizable=function(e){return function(t,e,n){return r.default.object(e)?(t.options.resize.enabled=!1!==e.enabled,t.setPerAction("resize",e),t.setOnEvents("resize",e),r.default.string(e.axis)&&/^x$|^y$|^xy$/.test(e.axis)?t.options.resize.axis=e.axis:null===e.axis&&(t.options.resize.axis=n.defaults.actions.resize.axis),r.default.bool(e.preserveAspectRatio)?t.options.resize.preserveAspectRatio=e.preserveAspectRatio:r.default.bool(e.square)&&(t.options.resize.square=e.square),t):r.default.bool(e)?(t.options.resize.enabled=e,t):t.options.resize}(this,e,t)},e.map.resize=Tt,e.methodDict.resize="resizable",s.actions.resize=Tt.defaults},listeners:{"interactions:new":function(t){t.interaction.resizeAxes="xy"},"interactions:action-start":function(t){!function(t){var e=t.iEvent,n=t.interaction;if("resize"===n.prepared.name&&n.prepared.edges){var i=e,s=n.rect;n._rects={start:(0,A.default)({},s),corrected:(0,A.default)({},s),previous:(0,A.default)({},s),delta:{left:0,right:0,width:0,top:0,bottom:0,height:0}},i.edges=n.prepared.edges,i.rect=n._rects.corrected,i.deltaRect=n._rects.delta}}(t),wt(t)},"interactions:action-move":function(t){!function(t){var e=t.iEvent,n=t.interaction;if("resize"===n.prepared.name&&n.prepared.edges){var i=e,s=n.interactable.options.resize.invert,r="reposition"===s||"negate"===s,o=n.rect,a=n._rects,c=a.start,u=a.corrected,l=a.delta,h=a.previous;if((0,A.default)(h,u),r){if((0,A.default)(u,o),"reposition"===s){if(u.top>u.bottom){var p=u.top;u.top=u.bottom,u.bottom=p}if(u.left>u.right){var d=u.left;u.left=u.right,u.right=d}}}else u.top=Math.min(o.top,c.bottom),u.bottom=Math.max(o.bottom,c.top),u.left=Math.min(o.left,c.right),u.right=Math.max(o.right,c.left);for(var f in u.width=u.right-u.left,u.height=u.bottom-u.top,u)l[f]=u[f]-h[f];i.edges=n.prepared.edges,i.rect=u,i.deltaRect=l}}(t),wt(t)},"interactions:action-end":function(t){var e=t.iEvent,n=t.interaction;if("resize"===n.prepared.name&&n.prepared.edges){var i=e;i.edges=n.prepared.edges,i.rect=n._rects.corrected,i.deltaRect=n._rects.delta}},"auto-start:check":function(t){var e=t.interaction,n=t.interactable,i=t.element,s=t.rect,o=t.buttons;if(s){var a=(0,A.default)({},e.coords.cur.page),c=n.options.resize;if(c&&c.enabled&&(!e.pointerIsDown||!/mouse|pointer/.test(e.pointerType)||0!=(o&c.mouseButtons))){if(r.default.object(c.edges)){var u={left:!1,right:!1,top:!1,bottom:!1};for(var l in u)u[l]=xt(l,c.edges[l],a,e._latestPointer.eventTarget,i,s,c.margin||Tt.defaultMargin);u.left=u.left&&!u.right,u.top=u.top&&!u.bottom,(u.left||u.right||u.top||u.bottom)&&(t.action={name:"resize",edges:u})}else{var h="y"!==c.axis&&a.x>s.right-Tt.defaultMargin,p="x"!==c.axis&&a.y>s.bottom-Tt.defaultMargin;(h||p)&&(t.action={name:"resize",axes:(h?"x":"")+(p?"y":"")})}return!t.action&&void 0}}}},defaults:{square:!1,preserveAspectRatio:!1,axis:"xy",margin:NaN,edges:null,invert:"none"},cursors:null,getCursor:function(t){var e=t.edges,n=t.axis,i=t.name,s=Tt.cursors,r=null;if(n)r=s[i+n];else if(e){for(var o="",a=["top","bottom","left","right"],c=0;c<a.length;c++){var u=a[c];e[u]&&(o+=u)}r=s[o]}return r},defaultMargin:null},St=Tt;bt.default=St;var kt={};Object.defineProperty(kt,"__esModule",{value:!0}),kt.default=void 0;var Ot={id:"actions",install:function(t){t.usePlugin(vt.default),t.usePlugin(bt.default),t.usePlugin(l.default),t.usePlugin(at.default)}};kt.default=Ot;var Et={};Object.defineProperty(Et,"__esModule",{value:!0}),Et.default=void 0;var Ct,At,Dt=0,Mt={request:function(t){return Ct(t)},cancel:function(t){return At(t)},init:function(t){if(Ct=t.requestAnimationFrame,At=t.cancelAnimationFrame,!Ct)for(var e=["ms","moz","webkit","o"],n=0;n<e.length;n++){var i=e[n];Ct=t["".concat(i,"RequestAnimationFrame")],At=t["".concat(i,"CancelAnimationFrame")]||t["".concat(i,"CancelRequestAnimationFrame")]}Ct=Ct&&Ct.bind(t),At=At&&At.bind(t),Ct||(Ct=function(e){var n=Date.now(),i=Math.max(0,16-(n-Dt)),s=t.setTimeout((function(){e(n+i)}),i);return Dt=n+i,s},At=function(t){return clearTimeout(t)})}};Et.default=Mt;var It={};Object.defineProperty(It,"__esModule",{value:!0}),It.getContainer=Rt,It.getScroll=jt,It.getScrollSize=function(t){return r.default.window(t)&&(t=window.document.body),{x:t.scrollWidth,y:t.scrollHeight}},It.getScrollSizeDelta=function(t,e){var n=t.interaction,i=t.element,s=n&&n.interactable.options[n.prepared.name].autoScroll;if(!s||!s.enabled)return e(),{x:0,y:0};var r=Rt(s.container,n.interactable,i),o=jt(r);e();var a=jt(r);return{x:a.x-o.x,y:a.y-o.y}},It.default=void 0;var Pt={defaults:{enabled:!1,margin:60,container:null,speed:300},now:Date.now,interaction:null,i:0,x:0,y:0,isScrolling:!1,prevTime:0,margin:0,speed:0,start:function(t){Pt.isScrolling=!0,Et.default.cancel(Pt.i),t.autoScroll=Pt,Pt.interaction=t,Pt.prevTime=Pt.now(),Pt.i=Et.default.request(Pt.scroll)},stop:function(){Pt.isScrolling=!1,Pt.interaction&&(Pt.interaction.autoScroll=null),Et.default.cancel(Pt.i)},scroll:function(){var t=Pt.interaction,e=t.interactable,n=t.element,i=t.prepared.name,s=e.options[i].autoScroll,o=Rt(s.container,e,n),a=Pt.now(),c=(a-Pt.prevTime)/1e3,u=s.speed*c;if(u>=1){var l={x:Pt.x*u,y:Pt.y*u};if(l.x||l.y){var h=jt(o);r.default.window(o)?o.scrollBy(l.x,l.y):o&&(o.scrollLeft+=l.x,o.scrollTop+=l.y);var p=jt(o),d={x:p.x-h.x,y:p.y-h.y};(d.x||d.y)&&e.fire({type:"autoscroll",target:n,interactable:e,delta:d,interaction:t,container:o})}Pt.prevTime=a}Pt.isScrolling&&(Et.default.cancel(Pt.i),Pt.i=Et.default.request(Pt.scroll))},check:function(t,e){var n;return null==(n=t.options[e].autoScroll)?void 0:n.enabled},onInteractionMove:function(t){var e=t.interaction,n=t.pointer;if(e.interacting()&&Pt.check(e.interactable,e.prepared.name))if(e.simulation)Pt.x=Pt.y=0;else{var i,s,o,a,c=e.interactable,u=e.element,l=e.prepared.name,h=c.options[l].autoScroll,p=Rt(h.container,c,u);if(r.default.window(p))a=n.clientX<Pt.margin,i=n.clientY<Pt.margin,s=n.clientX>p.innerWidth-Pt.margin,o=n.clientY>p.innerHeight-Pt.margin;else{var d=w.getElementClientRect(p);a=n.clientX<d.left+Pt.margin,i=n.clientY<d.top+Pt.margin,s=n.clientX>d.right-Pt.margin,o=n.clientY>d.bottom-Pt.margin}Pt.x=s?1:a?-1:0,Pt.y=o?1:i?-1:0,Pt.isScrolling||(Pt.margin=h.margin,Pt.speed=h.speed,Pt.start(e))}}};function Rt(t,n,i){return(r.default.string(t)?(0,D.getStringOptionResult)(t,n,i):t)||(0,e.getWindow)(i)}function jt(t){return r.default.window(t)&&(t=window.document.body),{x:t.scrollLeft,y:t.scrollTop}}var qt={id:"auto-scroll",install:function(t){var e=t.defaults,n=t.actions;t.autoScroll=Pt,Pt.now=function(){return t.now()},n.phaselessTypes.autoscroll=!0,e.perAction.autoScroll=Pt.defaults},listeners:{"interactions:new":function(t){t.interaction.autoScroll=null},"interactions:destroy":function(t){t.interaction.autoScroll=null,Pt.stop(),Pt.interaction&&(Pt.interaction=null)},"interactions:stop":Pt.stop,"interactions:action-move":function(t){return Pt.onInteractionMove(t)}}};It.default=qt;var Nt={};Object.defineProperty(Nt,"__esModule",{value:!0}),Nt.warnOnce=function(t,n){var i=!1;return function(){return i||(e.window.console.warn(n),i=!0),t.apply(this,arguments)}},Nt.copyAction=function(t,e){return t.name=e.name,t.axis=e.axis,t.edges=e.edges,t},Nt.sign=void 0,Nt.sign=function(t){return t>=0?1:-1};var Vt={};function Ft(t){return r.default.bool(t)?(this.options.styleCursor=t,this):null===t?(delete this.options.styleCursor,this):this.options.styleCursor}function Lt(t){return r.default.func(t)?(this.options.actionChecker=t,this):null===t?(delete this.options.actionChecker,this):this.options.actionChecker}Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.default=void 0;var zt={id:"auto-start/interactableMethods",install:function(t){var e=t.Interactable;e.prototype.getAction=function(e,n,i,s){var r=function(t,e,n,i,s){var r=t.getRect(i),o={action:null,interactable:t,interaction:n,element:i,rect:r,buttons:e.buttons||{0:1,1:4,3:8,4:16}[e.button]};return s.fire("auto-start:check",o),o.action}(this,n,i,s,t);return this.options.actionChecker?this.options.actionChecker(e,n,r,this,s,i):r},e.prototype.ignoreFrom=(0,Nt.warnOnce)((function(t){return this._backCompatOption("ignoreFrom",t)}),"Interactable.ignoreFrom() has been deprecated. Use Interactble.draggable({ignoreFrom: newValue})."),e.prototype.allowFrom=(0,Nt.warnOnce)((function(t){return this._backCompatOption("allowFrom",t)}),"Interactable.allowFrom() has been deprecated. Use Interactble.draggable({allowFrom: newValue})."),e.prototype.actionChecker=Lt,e.prototype.styleCursor=Ft}};Vt.default=zt;var Bt={};function Wt(t,e,n,i,s){return e.testIgnoreAllow(e.options[t.name],n,i)&&e.options[t.name].enabled&&Gt(e,n,t,s)?t:null}function Zt(t,e,n,i,s,r,o){for(var a=0,c=i.length;a<c;a++){var u=i[a],l=s[a],h=u.getAction(e,n,t,l);if(h){var p=Wt(h,u,l,r,o);if(p)return{action:p,interactable:u,element:l}}}return{action:null,interactable:null,element:null}}function Ut(t,e,n,i,s){var o=[],a=[],c=i;function u(t){o.push(t),a.push(c)}for(;r.default.element(c);){o=[],a=[],s.interactables.forEachMatch(c,u);var l=Zt(t,e,n,o,a,i,s);if(l.action&&!l.interactable.options[l.action.name].manualStart)return l;c=w.parentNode(c)}return{action:null,interactable:null,element:null}}function Yt(t,e,n){var i=e.action,s=e.interactable,r=e.element;i=i||{name:null},t.interactable=s,t.element=r,(0,Nt.copyAction)(t.prepared,i),t.rect=s&&i.name?s.getRect(r):null,Ht(t,n),n.fire("autoStart:prepared",{interaction:t})}function Gt(t,e,n,i){var s=t.options,r=s[n.name].max,o=s[n.name].maxPerElement,a=i.autoStart.maxInteractions,c=0,u=0,l=0;if(!(r&&o&&a))return!1;for(var h=0;h<i.interactions.list.length;h++){var p=i.interactions.list[h],d=p.prepared.name;if(p.interacting()){if(++c>=a)return!1;if(p.interactable===t){if((u+=d===n.name?1:0)>=r)return!1;if(p.element===e&&(l++,d===n.name&&l>=o))return!1}}}return a>0}function Xt(t,e){return r.default.number(t)?(e.autoStart.maxInteractions=t,this):e.autoStart.maxInteractions}function Qt(t,e,n){var i=n.autoStart.cursorElement;i&&i!==t&&(i.style.cursor=""),t.ownerDocument.documentElement.style.cursor=e,t.style.cursor=e,n.autoStart.cursorElement=e?t:null}function Ht(t,e){var n=t.interactable,i=t.element,s=t.prepared;if("mouse"===t.pointerType&&n&&n.options.styleCursor){var o="";if(s.name){var a=n.options[s.name].cursorChecker;o=r.default.func(a)?a(s,n,i,t._interacting):e.actions.map[s.name].getCursor(s)}Qt(t.element,o||"",e)}else e.autoStart.cursorElement&&Qt(e.autoStart.cursorElement,"",e)}Object.defineProperty(Bt,"__esModule",{value:!0}),Bt.default=void 0;var $t={id:"auto-start/base",before:["actions"],install:function(t){var e=t.interactStatic,n=t.defaults;t.usePlugin(Vt.default),n.base.actionChecker=null,n.base.styleCursor=!0,(0,A.default)(n.perAction,{manualStart:!1,max:1/0,maxPerElement:1,allowFrom:null,ignoreFrom:null,mouseButtons:1}),e.maxInteractions=function(e){return Xt(e,t)},t.autoStart={maxInteractions:1/0,withinInteractionLimit:Gt,cursorElement:null}},listeners:{"interactions:down":function(t,e){var n=t.interaction,i=t.pointer,s=t.event,r=t.eventTarget;n.interacting()||Yt(n,Ut(n,i,s,r,e),e)},"interactions:move":function(t,e){!function(t,e){var n=t.interaction,i=t.pointer,s=t.event,r=t.eventTarget;"mouse"!==n.pointerType||n.pointerIsDown||n.interacting()||Yt(n,Ut(n,i,s,r,e),e)}(t,e),function(t,e){var n=t.interaction;if(n.pointerIsDown&&!n.interacting()&&n.pointerWasMoved&&n.prepared.name){e.fire("autoStart:before-start",t);var i=n.interactable,s=n.prepared.name;s&&i&&(i.options[s].manualStart||!Gt(i,n.element,n.prepared,e)?n.stop():(n.start(n.prepared,i,n.element),Ht(n,e)))}}(t,e)},"interactions:stop":function(t,e){var n=t.interaction,i=n.interactable;i&&i.options.styleCursor&&Qt(n.element,"",e)}},maxInteractions:Xt,withinInteractionLimit:Gt,validateAction:Wt};Bt.default=$t;var Kt={};Object.defineProperty(Kt,"__esModule",{value:!0}),Kt.default=void 0;var Jt={id:"auto-start/dragAxis",listeners:{"autoStart:before-start":function(t,e){var n=t.interaction,i=t.eventTarget,s=t.dx,o=t.dy;if("drag"===n.prepared.name){var a=Math.abs(s),c=Math.abs(o),u=n.interactable.options.drag,l=u.startAxis,h=a>c?"x":a<c?"y":"xy";if(n.prepared.axis="start"===u.lockAxis?h[0]:u.lockAxis,"xy"!==h&&"xy"!==l&&l!==h){n.prepared.name=null;for(var p=i,d=function(t){if(t!==n.interactable){var s=n.interactable.options.drag;if(!s.manualStart&&t.testIgnoreAllow(s,p,i)){var r=t.getAction(n.downPointer,n.downEvent,n,p);if(r&&"drag"===r.name&&function(t,e){if(!e)return!1;var n=e.options.drag.startAxis;return"xy"===t||"xy"===n||n===t}(h,t)&&Bt.default.validateAction(r,t,p,i,e))return t}}};r.default.element(p);){var f=e.interactables.forEachMatch(p,d);if(f){n.prepared.name="drag",n.interactable=f,n.element=p;break}p=(0,w.parentNode)(p)}}}}}};Kt.default=Jt;var te={};function ee(t){var e=t.prepared&&t.prepared.name;if(!e)return null;var n=t.interactable.options;return n[e].hold||n[e].delay}Object.defineProperty(te,"__esModule",{value:!0}),te.default=void 0;var ne={id:"auto-start/hold",install:function(t){var e=t.defaults;t.usePlugin(Bt.default),e.perAction.hold=0,e.perAction.delay=0},listeners:{"interactions:new":function(t){t.interaction.autoStartHoldTimer=null},"autoStart:prepared":function(t){var e=t.interaction,n=ee(e);n>0&&(e.autoStartHoldTimer=setTimeout((function(){e.start(e.prepared,e.interactable,e.element)}),n))},"interactions:move":function(t){var e=t.interaction,n=t.duplicate;e.autoStartHoldTimer&&e.pointerWasMoved&&!n&&(clearTimeout(e.autoStartHoldTimer),e.autoStartHoldTimer=null)},"autoStart:before-start":function(t){var e=t.interaction;ee(e)>0&&(e.prepared.name=null)}},getHoldDuration:ee};te.default=ne;var ie={};Object.defineProperty(ie,"__esModule",{value:!0}),ie.default=void 0;var se={id:"auto-start",install:function(t){t.usePlugin(Bt.default),t.usePlugin(te.default),t.usePlugin(Kt.default)}};ie.default=se;var re={};function oe(t){return/^(always|never|auto)$/.test(t)?(this.options.preventDefault=t,this):r.default.bool(t)?(this.options.preventDefault=t?"always":"never",this):this.options.preventDefault}function ae(t){var e=t.interaction,n=t.event;e.interactable&&e.interactable.checkAndPreventDefault(n)}function ce(t){var n=t.Interactable;n.prototype.preventDefault=oe,n.prototype.checkAndPreventDefault=function(n){return function(t,n,i){var s=t.options.preventDefault;if("never"!==s)if("always"!==s){if(n.events.supportsPassive&&/^touch(start|move)$/.test(i.type)){var o=(0,e.getWindow)(i.target).document,a=n.getDocOptions(o);if(!a||!a.events||!1!==a.events.passive)return}/^(mouse|pointer|touch)*(down|start)/i.test(i.type)||r.default.element(i.target)&&(0,w.matchesSelector)(i.target,"input,select,textarea,[contenteditable=true],[contenteditable=true] *")||i.preventDefault()}else i.preventDefault()}(this,t,n)},t.interactions.docEvents.push({type:"dragstart",listener:function(e){for(var n=0;n<t.interactions.list.length;n++){var i=t.interactions.list[n];if(i.element&&(i.element===e.target||(0,w.nodeContains)(i.element,e.target)))return void i.interactable.checkAndPreventDefault(e)}}})}Object.defineProperty(re,"__esModule",{value:!0}),re.install=ce,re.default=void 0;var ue={id:"core/interactablePreventDefault",install:ce,listeners:["down","move","up","cancel"].reduce((function(t,e){return t["interactions:".concat(e)]=ae,t}),{})};re.default=ue;var le={};Object.defineProperty(le,"__esModule",{value:!0}),le.default=void 0,le.default={};var he,pe={};Object.defineProperty(pe,"__esModule",{value:!0}),pe.default=void 0,function(t){t.touchAction="touchAction",t.boxSizing="boxSizing",t.noListeners="noListeners"}(he||(he={})),he.touchAction,he.boxSizing,he.noListeners;pe.default={id:"dev-tools",install:function(){}};var de={};Object.defineProperty(de,"__esModule",{value:!0}),de.default=function t(e){var n={};for(var i in e){var s=e[i];r.default.plainObject(s)?n[i]=t(s):r.default.array(s)?n[i]=H.from(s):n[i]=s}return n};var fe={};function me(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],i=!0,s=!1,r=void 0;try{for(var o,a=t[Symbol.iterator]();!(i=(o=a.next()).done)&&(n.push(o.value),!e||n.length!==e);i=!0);}catch(t){s=!0,r=t}finally{try{i||null==a.return||a.return()}finally{if(s)throw r}}return n}}(t,e)||function(t,e){if(t){if("string"==typeof t)return ve(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ve(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ve(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function ge(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(fe,"__esModule",{value:!0}),fe.getRectOffset=be,fe.default=void 0;var ye=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),ge(this,"states",[]),ge(this,"startOffset",{left:0,right:0,top:0,bottom:0}),ge(this,"startDelta",void 0),ge(this,"result",void 0),ge(this,"endResult",void 0),ge(this,"edges",void 0),ge(this,"interaction",void 0),this.interaction=e,this.result=_e()}var e;return(e=[{key:"start",value:function(t,e){var n=t.phase,i=this.interaction,s=function(t){var e=t.interactable.options[t.prepared.name],n=e.modifiers;return n&&n.length?n:["snap","snapSize","snapEdges","restrict","restrictEdges","restrictSize"].map((function(t){var n=e[t];return n&&n.enabled&&{options:n,methods:n._methods}})).filter((function(t){return!!t}))}(i);this.prepareStates(s),this.edges=(0,A.default)({},i.edges),this.startOffset=be(i.rect,e),this.startDelta={x:0,y:0};var r=this.fillArg({phase:n,pageCoords:e,preEnd:!1});return this.result=_e(),this.startAll(r),this.result=this.setAll(r)}},{key:"fillArg",value:function(t){var e=this.interaction;return t.interaction=e,t.interactable=e.interactable,t.element=e.element,t.rect=t.rect||e.rect,t.edges=this.edges,t.startOffset=this.startOffset,t}},{key:"startAll",value:function(t){for(var e=0;e<this.states.length;e++){var n=this.states[e];n.methods.start&&(t.state=n,n.methods.start(t))}}},{key:"setAll",value:function(t){var e=t.phase,n=t.preEnd,i=t.skipModifiers,s=t.rect;t.coords=(0,A.default)({},t.pageCoords),t.rect=(0,A.default)({},s);for(var r=i?this.states.slice(i):this.states,o=_e(t.coords,t.rect),a=0;a<r.length;a++){var c,u=r[a],l=u.options,h=(0,A.default)({},t.coords),p=null;null!=(c=u.methods)&&c.set&&this.shouldDo(l,n,e)&&(t.state=u,p=u.methods.set(t),D.addEdges(this.interaction.edges,t.rect,{x:t.coords.x-h.x,y:t.coords.y-h.y})),o.eventProps.push(p)}o.delta.x=t.coords.x-t.pageCoords.x,o.delta.y=t.coords.y-t.pageCoords.y,o.rectDelta.left=t.rect.left-s.left,o.rectDelta.right=t.rect.right-s.right,o.rectDelta.top=t.rect.top-s.top,o.rectDelta.bottom=t.rect.bottom-s.bottom;var d=this.result.coords,f=this.result.rect;if(d&&f){var m=o.rect.left!==f.left||o.rect.right!==f.right||o.rect.top!==f.top||o.rect.bottom!==f.bottom;o.changed=m||d.x!==o.coords.x||d.y!==o.coords.y}return o}},{key:"applyToInteraction",value:function(t){var e=this.interaction,n=t.phase,i=e.coords.cur,s=e.coords.start,r=this.result,o=this.startDelta,a=r.delta;"start"===n&&(0,A.default)(this.startDelta,r.delta);for(var c=0;c<[[s,o],[i,a]].length;c++){var u=me([[s,o],[i,a]][c],2),l=u[0],h=u[1];l.page.x+=h.x,l.page.y+=h.y,l.client.x+=h.x,l.client.y+=h.y}var p=this.result.rectDelta,d=t.rect||e.rect;d.left+=p.left,d.right+=p.right,d.top+=p.top,d.bottom+=p.bottom,d.width=d.right-d.left,d.height=d.bottom-d.top}},{key:"setAndApply",value:function(t){var e=this.interaction,n=t.phase,i=t.preEnd,s=t.skipModifiers,r=this.setAll(this.fillArg({preEnd:i,phase:n,pageCoords:t.modifiedCoords||e.coords.cur.page}));if(this.result=r,!r.changed&&(!s||s<this.states.length)&&e.interacting())return!1;if(t.modifiedCoords){var o=e.coords.cur.page,a={x:t.modifiedCoords.x-o.x,y:t.modifiedCoords.y-o.y};r.coords.x+=a.x,r.coords.y+=a.y,r.delta.x+=a.x,r.delta.y+=a.y}this.applyToInteraction(t)}},{key:"beforeEnd",value:function(t){var e=t.interaction,n=t.event,i=this.states;if(i&&i.length){for(var s=!1,r=0;r<i.length;r++){var o=i[r];t.state=o;var a=o.options,c=o.methods,u=c.beforeEnd&&c.beforeEnd(t);if(u)return this.endResult=u,!1;s=s||!s&&this.shouldDo(a,!0,t.phase,!0)}s&&e.move({event:n,preEnd:!0})}}},{key:"stop",value:function(t){var e=t.interaction;if(this.states&&this.states.length){var n=(0,A.default)({states:this.states,interactable:e.interactable,element:e.element,rect:null},t);this.fillArg(n);for(var i=0;i<this.states.length;i++){var s=this.states[i];n.state=s,s.methods.stop&&s.methods.stop(n)}this.states=null,this.endResult=null}}},{key:"prepareStates",value:function(t){this.states=[];for(var e=0;e<t.length;e++){var n=t[e],i=n.options,s=n.methods,r=n.name;this.states.push({options:i,methods:s,index:e,name:r})}return this.states}},{key:"restoreInteractionCoords",value:function(t){var e=t.interaction,n=e.coords,i=e.rect,s=e.modification;if(s.result){for(var r=s.startDelta,o=s.result,a=o.delta,c=o.rectDelta,u=[[n.start,r],[n.cur,a]],l=0;l<u.length;l++){var h=me(u[l],2),p=h[0],d=h[1];p.page.x-=d.x,p.page.y-=d.y,p.client.x-=d.x,p.client.y-=d.y}i.left-=c.left,i.right-=c.right,i.top-=c.top,i.bottom-=c.bottom}}},{key:"shouldDo",value:function(t,e,n,i){return!(!t||!1===t.enabled||i&&!t.endOnly||t.endOnly&&!e||"start"===n&&!t.setStart)}},{key:"copyFrom",value:function(t){this.startOffset=t.startOffset,this.startDelta=t.startDelta,this.edges=t.edges,this.states=t.states.map((function(t){return(0,de.default)(t)})),this.result=_e((0,A.default)({},t.result.coords),(0,A.default)({},t.result.rect))}},{key:"destroy",value:function(){for(var t in this)this[t]=null}}])&&function(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}(t.prototype,e),t}();function _e(t,e){return{rect:e,coords:t,delta:{x:0,y:0},rectDelta:{left:0,right:0,top:0,bottom:0},eventProps:[],changed:!0}}function be(t,e){return t?{left:e.x-t.left,top:e.y-t.top,right:t.right-e.x,bottom:t.bottom-e.y}:{left:0,top:0,right:0,bottom:0}}fe.default=ye;var xe={};function we(t){var e=t.iEvent,n=t.interaction.modification.result;n&&(e.modifiers=n.eventProps)}Object.defineProperty(xe,"__esModule",{value:!0}),xe.makeModifier=function(t,e){var n=t.defaults,i={start:t.start,set:t.set,beforeEnd:t.beforeEnd,stop:t.stop},s=function(t){var s=t||{};for(var r in s.enabled=!1!==s.enabled,n)r in s||(s[r]=n[r]);var o={options:s,methods:i,name:e,enable:function(){return s.enabled=!0,o},disable:function(){return s.enabled=!1,o}};return o};return e&&"string"==typeof e&&(s._defaults=n,s._methods=i),s},xe.addEventModifiers=we,xe.default=void 0;var Te={id:"modifiers/base",before:["actions"],install:function(t){t.defaults.perAction.modifiers=[]},listeners:{"interactions:new":function(t){var e=t.interaction;e.modification=new fe.default(e)},"interactions:before-action-start":function(t){var e=t.interaction.modification;e.start(t,t.interaction.coords.start.page),t.interaction.edges=e.edges,e.applyToInteraction(t)},"interactions:before-action-move":function(t){return t.interaction.modification.setAndApply(t)},"interactions:before-action-end":function(t){return t.interaction.modification.beforeEnd(t)},"interactions:action-start":we,"interactions:action-move":we,"interactions:action-end":we,"interactions:after-action-start":function(t){return t.interaction.modification.restoreInteractionCoords(t)},"interactions:after-action-move":function(t){return t.interaction.modification.restoreInteractionCoords(t)},"interactions:stop":function(t){return t.interaction.modification.stop(t)}}};xe.default=Te;var Se={};Object.defineProperty(Se,"__esModule",{value:!0}),Se.defaults=void 0,Se.defaults={base:{preventDefault:"auto",deltaSource:"page"},perAction:{enabled:!1,origin:{x:0,y:0}},actions:{}};var ke={};function Oe(t){return(Oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Ee(t,e){return(Ee=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Ce(t,e){return!e||"object"!==Oe(e)&&"function"!=typeof e?Ae(t):e}function Ae(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function De(t){return(De=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Me(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(ke,"__esModule",{value:!0}),ke.InteractEvent=void 0;var Ie=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Ee(t,e)}(r,t);var e,n,i,s=(n=r,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=De(n);if(i){var s=De(this).constructor;t=Reflect.construct(e,arguments,s)}else t=e.apply(this,arguments);return Ce(this,t)});function r(t,e,n,i,o,a,c){var u;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),Me(Ae(u=s.call(this,t)),"target",void 0),Me(Ae(u),"currentTarget",void 0),Me(Ae(u),"relatedTarget",null),Me(Ae(u),"screenX",void 0),Me(Ae(u),"screenY",void 0),Me(Ae(u),"button",void 0),Me(Ae(u),"buttons",void 0),Me(Ae(u),"ctrlKey",void 0),Me(Ae(u),"shiftKey",void 0),Me(Ae(u),"altKey",void 0),Me(Ae(u),"metaKey",void 0),Me(Ae(u),"page",void 0),Me(Ae(u),"client",void 0),Me(Ae(u),"delta",void 0),Me(Ae(u),"rect",void 0),Me(Ae(u),"x0",void 0),Me(Ae(u),"y0",void 0),Me(Ae(u),"t0",void 0),Me(Ae(u),"dt",void 0),Me(Ae(u),"duration",void 0),Me(Ae(u),"clientX0",void 0),Me(Ae(u),"clientY0",void 0),Me(Ae(u),"velocity",void 0),Me(Ae(u),"speed",void 0),Me(Ae(u),"swipe",void 0),Me(Ae(u),"timeStamp",void 0),Me(Ae(u),"axes",void 0),Me(Ae(u),"preEnd",void 0),o=o||t.element;var l=t.interactable,h=(l&&l.options||Se.defaults).deltaSource,p=(0,P.default)(l,o,n),d="start"===i,f="end"===i,m=d?Ae(u):t.prevEvent,v=d?t.coords.start:f?{page:m.page,client:m.client,timeStamp:t.coords.cur.timeStamp}:t.coords.cur;return u.page=(0,A.default)({},v.page),u.client=(0,A.default)({},v.client),u.rect=(0,A.default)({},t.rect),u.timeStamp=v.timeStamp,f||(u.page.x-=p.x,u.page.y-=p.y,u.client.x-=p.x,u.client.y-=p.y),u.ctrlKey=e.ctrlKey,u.altKey=e.altKey,u.shiftKey=e.shiftKey,u.metaKey=e.metaKey,u.button=e.button,u.buttons=e.buttons,u.target=o,u.currentTarget=o,u.preEnd=a,u.type=c||n+(i||""),u.interactable=l,u.t0=d?t.pointers[t.pointers.length-1].downTime:m.t0,u.x0=t.coords.start.page.x-p.x,u.y0=t.coords.start.page.y-p.y,u.clientX0=t.coords.start.client.x-p.x,u.clientY0=t.coords.start.client.y-p.y,u.delta=d||f?{x:0,y:0}:{x:u[h].x-m[h].x,y:u[h].y-m[h].y},u.dt=t.coords.delta.timeStamp,u.duration=u.timeStamp-u.t0,u.velocity=(0,A.default)({},t.coords.velocity[h]),u.speed=(0,q.default)(u.velocity.x,u.velocity.y),u.swipe=f||"inertiastart"===i?u.getSwipe():null,u}return(e=[{key:"getSwipe",value:function(){var t=this._interaction;if(t.prevEvent.speed<600||this.timeStamp-t.prevEvent.timeStamp>150)return null;var e=180*Math.atan2(t.prevEvent.velocityY,t.prevEvent.velocityX)/Math.PI;e<0&&(e+=360);var n=112.5<=e&&e<247.5,i=202.5<=e&&e<337.5;return{up:i,down:!i&&22.5<=e&&e<157.5,left:n,right:!n&&(292.5<=e||e<67.5),angle:e,speed:t.prevEvent.speed,velocity:{x:t.prevEvent.velocityX,y:t.prevEvent.velocityY}}}},{key:"preventDefault",value:function(){}},{key:"stopImmediatePropagation",value:function(){this.immediatePropagationStopped=this.propagationStopped=!0}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}}])&&function(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}(r.prototype,e),r}(G.BaseEvent);ke.InteractEvent=Ie,Object.defineProperties(Ie.prototype,{pageX:{get:function(){return this.page.x},set:function(t){this.page.x=t}},pageY:{get:function(){return this.page.y},set:function(t){this.page.y=t}},clientX:{get:function(){return this.client.x},set:function(t){this.client.x=t}},clientY:{get:function(){return this.client.y},set:function(t){this.client.y=t}},dx:{get:function(){return this.delta.x},set:function(t){this.delta.x=t}},dy:{get:function(){return this.delta.y},set:function(t){this.delta.y=t}},velocityX:{get:function(){return this.velocity.x},set:function(t){this.velocity.x=t}},velocityY:{get:function(){return this.velocity.y},set:function(t){this.velocity.y=t}}});var Pe={};function Re(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(Pe,"__esModule",{value:!0}),Pe.PointerInfo=void 0,Pe.PointerInfo=function t(e,n,i,s,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Re(this,"id",void 0),Re(this,"pointer",void 0),Re(this,"event",void 0),Re(this,"downTime",void 0),Re(this,"downTarget",void 0),this.id=e,this.pointer=n,this.event=i,this.downTime=s,this.downTarget=r};var je,qe,Ne={};function Ve(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(Ne,"__esModule",{value:!0}),Object.defineProperty(Ne,"PointerInfo",{enumerable:!0,get:function(){return Pe.PointerInfo}}),Ne.default=Ne.Interaction=Ne._ProxyMethods=Ne._ProxyValues=void 0,Ne._ProxyValues=je,function(t){t.interactable="",t.element="",t.prepared="",t.pointerIsDown="",t.pointerWasMoved="",t._proxy=""}(je||(Ne._ProxyValues=je={})),Ne._ProxyMethods=qe,function(t){t.start="",t.move="",t.end="",t.stop="",t.interacting=""}(qe||(Ne._ProxyMethods=qe={}));var Fe=0,Le=function(){function t(e){var n=this,i=e.pointerType,s=e.scopeFire;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Ve(this,"interactable",null),Ve(this,"element",null),Ve(this,"rect",void 0),Ve(this,"_rects",void 0),Ve(this,"edges",void 0),Ve(this,"_scopeFire",void 0),Ve(this,"prepared",{name:null,axis:null,edges:null}),Ve(this,"pointerType",void 0),Ve(this,"pointers",[]),Ve(this,"downEvent",null),Ve(this,"downPointer",{}),Ve(this,"_latestPointer",{pointer:null,event:null,eventTarget:null}),Ve(this,"prevEvent",null),Ve(this,"pointerIsDown",!1),Ve(this,"pointerWasMoved",!1),Ve(this,"_interacting",!1),Ve(this,"_ending",!1),Ve(this,"_stopped",!0),Ve(this,"_proxy",null),Ve(this,"simulation",null),Ve(this,"doMove",(0,Nt.warnOnce)((function(t){this.move(t)}),"The interaction.doMove() method has been renamed to interaction.move()")),Ve(this,"coords",{start:L.newCoords(),prev:L.newCoords(),cur:L.newCoords(),delta:L.newCoords(),velocity:L.newCoords()}),Ve(this,"_id",Fe++),this._scopeFire=s,this.pointerType=i;var r=this;this._proxy={};var o=function(t){Object.defineProperty(n._proxy,t,{get:function(){return r[t]}})};for(var a in je)o(a);var c=function(t){Object.defineProperty(n._proxy,t,{value:function(){return r[t].apply(r,arguments)}})};for(var u in qe)c(u);this._scopeFire("interactions:new",{interaction:this})}var e;return(e=[{key:"pointerMoveTolerance",get:function(){return 1}},{key:"pointerDown",value:function(t,e,n){var i=this.updatePointer(t,e,n,!0),s=this.pointers[i];this._scopeFire("interactions:down",{pointer:t,event:e,eventTarget:n,pointerIndex:i,pointerInfo:s,type:"down",interaction:this})}},{key:"start",value:function(t,e,n){return!(this.interacting()||!this.pointerIsDown||this.pointers.length<("gesture"===t.name?2:1)||!e.options[t.name].enabled)&&((0,Nt.copyAction)(this.prepared,t),this.interactable=e,this.element=n,this.rect=e.getRect(n),this.edges=this.prepared.edges?(0,A.default)({},this.prepared.edges):{left:!0,right:!0,top:!0,bottom:!0},this._stopped=!1,this._interacting=this._doPhase({interaction:this,event:this.downEvent,phase:"start"})&&!this._stopped,this._interacting)}},{key:"pointerMove",value:function(t,e,n){this.simulation||this.modification&&this.modification.endResult||this.updatePointer(t,e,n,!1);var i,s,r=this.coords.cur.page.x===this.coords.prev.page.x&&this.coords.cur.page.y===this.coords.prev.page.y&&this.coords.cur.client.x===this.coords.prev.client.x&&this.coords.cur.client.y===this.coords.prev.client.y;this.pointerIsDown&&!this.pointerWasMoved&&(i=this.coords.cur.client.x-this.coords.start.client.x,s=this.coords.cur.client.y-this.coords.start.client.y,this.pointerWasMoved=(0,q.default)(i,s)>this.pointerMoveTolerance);var o=this.getPointerIndex(t),a={pointer:t,pointerIndex:o,pointerInfo:this.pointers[o],event:e,type:"move",eventTarget:n,dx:i,dy:s,duplicate:r,interaction:this};r||L.setCoordVelocity(this.coords.velocity,this.coords.delta),this._scopeFire("interactions:move",a),r||this.simulation||(this.interacting()&&(a.type=null,this.move(a)),this.pointerWasMoved&&L.copyCoords(this.coords.prev,this.coords.cur))}},{key:"move",value:function(t){t&&t.event||L.setZeroCoords(this.coords.delta),(t=(0,A.default)({pointer:this._latestPointer.pointer,event:this._latestPointer.event,eventTarget:this._latestPointer.eventTarget,interaction:this},t||{})).phase="move",this._doPhase(t)}},{key:"pointerUp",value:function(t,e,n,i){var s=this.getPointerIndex(t);-1===s&&(s=this.updatePointer(t,e,n,!1));var r=/cancel$/i.test(e.type)?"cancel":"up";this._scopeFire("interactions:".concat(r),{pointer:t,pointerIndex:s,pointerInfo:this.pointers[s],event:e,eventTarget:n,type:r,curEventTarget:i,interaction:this}),this.simulation||this.end(e),this.removePointer(t,e)}},{key:"documentBlur",value:function(t){this.end(t),this._scopeFire("interactions:blur",{event:t,type:"blur",interaction:this})}},{key:"end",value:function(t){var e;this._ending=!0,t=t||this._latestPointer.event,this.interacting()&&(e=this._doPhase({event:t,interaction:this,phase:"end"})),this._ending=!1,!0===e&&this.stop()}},{key:"currentAction",value:function(){return this._interacting?this.prepared.name:null}},{key:"interacting",value:function(){return this._interacting}},{key:"stop",value:function(){this._scopeFire("interactions:stop",{interaction:this}),this.interactable=this.element=null,this._interacting=!1,this._stopped=!0,this.prepared.name=this.prevEvent=null}},{key:"getPointerIndex",value:function(t){var e=L.getPointerId(t);return"mouse"===this.pointerType||"pen"===this.pointerType?this.pointers.length-1:H.findIndex(this.pointers,(function(t){return t.id===e}))}},{key:"getPointerInfo",value:function(t){return this.pointers[this.getPointerIndex(t)]}},{key:"updatePointer",value:function(t,e,n,i){var s=L.getPointerId(t),r=this.getPointerIndex(t),o=this.pointers[r];return i=!1!==i&&(i||/(down|start)$/i.test(e.type)),o?o.pointer=t:(o=new Pe.PointerInfo(s,t,e,null,null),r=this.pointers.length,this.pointers.push(o)),L.setCoords(this.coords.cur,this.pointers.map((function(t){return t.pointer})),this._now()),L.setCoordDeltas(this.coords.delta,this.coords.prev,this.coords.cur),i&&(this.pointerIsDown=!0,o.downTime=this.coords.cur.timeStamp,o.downTarget=n,L.pointerExtend(this.downPointer,t),this.interacting()||(L.copyCoords(this.coords.start,this.coords.cur),L.copyCoords(this.coords.prev,this.coords.cur),this.downEvent=e,this.pointerWasMoved=!1)),this._updateLatestPointer(t,e,n),this._scopeFire("interactions:update-pointer",{pointer:t,event:e,eventTarget:n,down:i,pointerInfo:o,pointerIndex:r,interaction:this}),r}},{key:"removePointer",value:function(t,e){var n=this.getPointerIndex(t);if(-1!==n){var i=this.pointers[n];this._scopeFire("interactions:remove-pointer",{pointer:t,event:e,eventTarget:null,pointerIndex:n,pointerInfo:i,interaction:this}),this.pointers.splice(n,1),this.pointerIsDown=!1}}},{key:"_updateLatestPointer",value:function(t,e,n){this._latestPointer.pointer=t,this._latestPointer.event=e,this._latestPointer.eventTarget=n}},{key:"destroy",value:function(){this._latestPointer.pointer=null,this._latestPointer.event=null,this._latestPointer.eventTarget=null}},{key:"_createPreparedEvent",value:function(t,e,n,i){return new ke.InteractEvent(this,t,this.prepared.name,e,this.element,n,i)}},{key:"_fireEvent",value:function(t){this.interactable.fire(t),(!this.prevEvent||t.timeStamp>=this.prevEvent.timeStamp)&&(this.prevEvent=t)}},{key:"_doPhase",value:function(t){var e=t.event,n=t.phase,i=t.preEnd,s=t.type,r=this.rect;if(r&&"move"===n&&(D.addEdges(this.edges,r,this.coords.delta[this.interactable.options.deltaSource]),r.width=r.right-r.left,r.height=r.bottom-r.top),!1===this._scopeFire("interactions:before-action-".concat(n),t))return!1;var o=t.iEvent=this._createPreparedEvent(e,n,i,s);return this._scopeFire("interactions:action-".concat(n),t),"start"===n&&(this.prevEvent=o),this._fireEvent(o),this._scopeFire("interactions:after-action-".concat(n),t),!0}},{key:"_now",value:function(){return Date.now()}}])&&function(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}(t.prototype,e),t}();Ne.Interaction=Le;var ze=Le;Ne.default=ze;var Be={};function We(t){t.pointerIsDown&&(Ge(t.coords.cur,t.offset.total),t.offset.pending.x=0,t.offset.pending.y=0)}function Ze(t){Ue(t.interaction)}function Ue(t){if(!function(t){return!(!t.offset.pending.x&&!t.offset.pending.y)}(t))return!1;var e=t.offset.pending;return Ge(t.coords.cur,e),Ge(t.coords.delta,e),D.addEdges(t.edges,t.rect,e),e.x=0,e.y=0,!0}function Ye(t){var e=t.x,n=t.y;this.offset.pending.x+=e,this.offset.pending.y+=n,this.offset.total.x+=e,this.offset.total.y+=n}function Ge(t,e){var n=t.page,i=t.client,s=e.x,r=e.y;n.x+=s,n.y+=r,i.x+=s,i.y+=r}Object.defineProperty(Be,"__esModule",{value:!0}),Be.addTotal=We,Be.applyPending=Ue,Be.default=void 0,Ne._ProxyMethods.offsetBy="";var Xe={id:"offset",before:["modifiers","pointer-events","actions","inertia"],install:function(t){t.Interaction.prototype.offsetBy=Ye},listeners:{"interactions:new":function(t){t.interaction.offset={total:{x:0,y:0},pending:{x:0,y:0}}},"interactions:update-pointer":function(t){return We(t.interaction)},"interactions:before-action-start":Ze,"interactions:before-action-move":Ze,"interactions:before-action-end":function(t){var e=t.interaction;if(Ue(e))return e.move({offset:!0}),e.end(),!1},"interactions:stop":function(t){var e=t.interaction;e.offset.total.x=0,e.offset.total.y=0,e.offset.pending.x=0,e.offset.pending.y=0}}};Be.default=Xe;var Qe={};function He(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(Qe,"__esModule",{value:!0}),Qe.default=Qe.InertiaState=void 0;var $e=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),He(this,"active",!1),He(this,"isModified",!1),He(this,"smoothEnd",!1),He(this,"allowResume",!1),He(this,"modification",void 0),He(this,"modifierCount",0),He(this,"modifierArg",void 0),He(this,"startCoords",void 0),He(this,"t0",0),He(this,"v0",0),He(this,"te",0),He(this,"targetOffset",void 0),He(this,"modifiedOffset",void 0),He(this,"currentOffset",void 0),He(this,"lambda_v0",0),He(this,"one_ve_v0",0),He(this,"timeout",void 0),He(this,"interaction",void 0),this.interaction=e}var e;return(e=[{key:"start",value:function(t){var e=this.interaction,n=Ke(e);if(!n||!n.enabled)return!1;var i=e.coords.velocity.client,s=(0,q.default)(i.x,i.y),r=this.modification||(this.modification=new fe.default(e));if(r.copyFrom(e.modification),this.t0=e._now(),this.allowResume=n.allowResume,this.v0=s,this.currentOffset={x:0,y:0},this.startCoords=e.coords.cur.page,this.modifierArg=r.fillArg({pageCoords:this.startCoords,preEnd:!0,phase:"inertiastart"}),this.t0-e.coords.cur.timeStamp<50&&s>n.minSpeed&&s>n.endSpeed)this.startInertia();else{if(r.result=r.setAll(this.modifierArg),!r.result.changed)return!1;this.startSmoothEnd()}return e.modification.result.rect=null,e.offsetBy(this.targetOffset),e._doPhase({interaction:e,event:t,phase:"inertiastart"}),e.offsetBy({x:-this.targetOffset.x,y:-this.targetOffset.y}),e.modification.result.rect=null,this.active=!0,e.simulation=this,!0}},{key:"startInertia",value:function(){var t=this,e=this.interaction.coords.velocity.client,n=Ke(this.interaction),i=n.resistance,s=-Math.log(n.endSpeed/this.v0)/i;this.targetOffset={x:(e.x-s)/i,y:(e.y-s)/i},this.te=s,this.lambda_v0=i/this.v0,this.one_ve_v0=1-n.endSpeed/this.v0;var r=this.modification,o=this.modifierArg;o.pageCoords={x:this.startCoords.x+this.targetOffset.x,y:this.startCoords.y+this.targetOffset.y},r.result=r.setAll(o),r.result.changed&&(this.isModified=!0,this.modifiedOffset={x:this.targetOffset.x+r.result.delta.x,y:this.targetOffset.y+r.result.delta.y}),this.onNextFrame((function(){return t.inertiaTick()}))}},{key:"startSmoothEnd",value:function(){var t=this;this.smoothEnd=!0,this.isModified=!0,this.targetOffset={x:this.modification.result.delta.x,y:this.modification.result.delta.y},this.onNextFrame((function(){return t.smoothEndTick()}))}},{key:"onNextFrame",value:function(t){var e=this;this.timeout=Et.default.request((function(){e.active&&t()}))}},{key:"inertiaTick",value:function(){var t,e,n,i,s,r=this,o=this.interaction,a=Ke(o).resistance,c=(o._now()-this.t0)/1e3;if(c<this.te){var u,l=1-(Math.exp(-a*c)-this.lambda_v0)/this.one_ve_v0;this.isModified?(t=this.targetOffset.x,e=this.targetOffset.y,n=this.modifiedOffset.x,i=this.modifiedOffset.y,u={x:Je(s=l,0,t,n),y:Je(s,0,e,i)}):u={x:this.targetOffset.x*l,y:this.targetOffset.y*l};var h={x:u.x-this.currentOffset.x,y:u.y-this.currentOffset.y};this.currentOffset.x+=h.x,this.currentOffset.y+=h.y,o.offsetBy(h),o.move(),this.onNextFrame((function(){return r.inertiaTick()}))}else o.offsetBy({x:this.modifiedOffset.x-this.currentOffset.x,y:this.modifiedOffset.y-this.currentOffset.y}),this.end()}},{key:"smoothEndTick",value:function(){var t=this,e=this.interaction,n=e._now()-this.t0,i=Ke(e).smoothEndDuration;if(n<i){var s={x:tn(n,0,this.targetOffset.x,i),y:tn(n,0,this.targetOffset.y,i)},r={x:s.x-this.currentOffset.x,y:s.y-this.currentOffset.y};this.currentOffset.x+=r.x,this.currentOffset.y+=r.y,e.offsetBy(r),e.move({skipModifiers:this.modifierCount}),this.onNextFrame((function(){return t.smoothEndTick()}))}else e.offsetBy({x:this.targetOffset.x-this.currentOffset.x,y:this.targetOffset.y-this.currentOffset.y}),this.end()}},{key:"resume",value:function(t){var e=t.pointer,n=t.event,i=t.eventTarget,s=this.interaction;s.offsetBy({x:-this.currentOffset.x,y:-this.currentOffset.y}),s.updatePointer(e,n,i,!0),s._doPhase({interaction:s,event:n,phase:"resume"}),(0,L.copyCoords)(s.coords.prev,s.coords.cur),this.stop()}},{key:"end",value:function(){this.interaction.move(),this.interaction.end(),this.stop()}},{key:"stop",value:function(){this.active=this.smoothEnd=!1,this.interaction.simulation=null,Et.default.cancel(this.timeout)}}])&&function(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}(t.prototype,e),t}();function Ke(t){var e=t.interactable,n=t.prepared;return e&&e.options&&n.name&&e.options[n.name].inertia}function Je(t,e,n,i){var s=1-t;return s*s*e+2*s*t*n+t*t*i}function tn(t,e,n,i){return-n*(t/=i)*(t-2)+e}Qe.InertiaState=$e;var en={id:"inertia",before:["modifiers","actions"],install:function(t){var e=t.defaults;t.usePlugin(Be.default),t.usePlugin(xe.default),t.actions.phases.inertiastart=!0,t.actions.phases.resume=!0,e.perAction.inertia={enabled:!1,resistance:10,minSpeed:100,endSpeed:10,allowResume:!0,smoothEndDuration:300}},listeners:{"interactions:new":function(t){var e=t.interaction;e.inertia=new $e(e)},"interactions:before-action-end":function(t){var e=t.interaction,n=t.event;return(!e._interacting||e.simulation||!e.inertia.start(n))&&null},"interactions:down":function(t){var e=t.interaction,n=t.eventTarget,i=e.inertia;if(i.active)for(var s=n;r.default.element(s);){if(s===e.element){i.resume(t);break}s=w.parentNode(s)}},"interactions:stop":function(t){var e=t.interaction.inertia;e.active&&e.stop()},"interactions:before-action-resume":function(t){var e=t.interaction.modification;e.stop(t),e.start(t,t.interaction.coords.cur.page),e.applyToInteraction(t)},"interactions:before-action-inertiastart":function(t){return t.interaction.modification.setAndApply(t)},"interactions:action-resume":xe.addEventModifiers,"interactions:action-inertiastart":xe.addEventModifiers,"interactions:after-action-inertiastart":function(t){return t.interaction.modification.restoreInteractionCoords(t)},"interactions:after-action-resume":function(t){return t.interaction.modification.restoreInteractionCoords(t)}}};Qe.default=en;var nn={};function sn(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rn(t,e){for(var n=0;n<e.length;n++){var i=e[n];if(t.immediatePropagationStopped)break;i(t)}}Object.defineProperty(nn,"__esModule",{value:!0}),nn.Eventable=void 0;var on=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),sn(this,"options",void 0),sn(this,"types",{}),sn(this,"propagationStopped",!1),sn(this,"immediatePropagationStopped",!1),sn(this,"global",void 0),this.options=(0,A.default)({},e||{})}var e;return(e=[{key:"fire",value:function(t){var e,n=this.global;(e=this.types[t.type])&&rn(t,e),!t.propagationStopped&&n&&(e=n[t.type])&&rn(t,e)}},{key:"on",value:function(t,e){var n=(0,R.default)(t,e);for(t in n)this.types[t]=H.merge(this.types[t]||[],n[t])}},{key:"off",value:function(t,e){var n=(0,R.default)(t,e);for(t in n){var i=this.types[t];if(i&&i.length)for(var s=0;s<n[t].length;s++){var r=n[t][s],o=i.indexOf(r);-1!==o&&i.splice(o,1)}}}},{key:"getRect",value:function(t){return null}}])&&function(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}(t.prototype,e),t}();nn.Eventable=on;var an={};Object.defineProperty(an,"__esModule",{value:!0}),an.default=function(t,e){if(e.phaselessTypes[t])return!0;for(var n in e.map)if(0===t.indexOf(n)&&t.substr(n.length)in e.phases)return!0;return!1};var cn={};Object.defineProperty(cn,"__esModule",{value:!0}),cn.createInteractStatic=function(t){var e=function e(n,i){var s=t.interactables.get(n,i);return s||((s=t.interactables.new(n,i)).events.global=e.globalEvents),s};return e.getPointerAverage=L.pointerAverage,e.getTouchBBox=L.touchBBox,e.getTouchDistance=L.touchDistance,e.getTouchAngle=L.touchAngle,e.getElementRect=w.getElementRect,e.getElementClientRect=w.getElementClientRect,e.matchesSelector=w.matchesSelector,e.closest=w.closest,e.globalEvents={},e.version="1.10.11",e.scope=t,e.use=function(t,e){return this.scope.usePlugin(t,e),this},e.isSet=function(t,e){return!!this.scope.interactables.get(t,e&&e.context)},e.on=(0,Nt.warnOnce)((function(t,e,n){if(r.default.string(t)&&-1!==t.search(" ")&&(t=t.trim().split(/ +/)),r.default.array(t)){for(var i=0;i<t.length;i++){var s=t[i];this.on(s,e,n)}return this}if(r.default.object(t)){for(var o in t)this.on(o,t[o],e);return this}return(0,an.default)(t,this.scope.actions)?this.globalEvents[t]?this.globalEvents[t].push(e):this.globalEvents[t]=[e]:this.scope.events.add(this.scope.document,t,e,{options:n}),this}),"The interact.on() method is being deprecated"),e.off=(0,Nt.warnOnce)((function(t,e,n){if(r.default.string(t)&&-1!==t.search(" ")&&(t=t.trim().split(/ +/)),r.default.array(t)){for(var i=0;i<t.length;i++){var s=t[i];this.off(s,e,n)}return this}if(r.default.object(t)){for(var o in t)this.off(o,t[o],e);return this}var a;return(0,an.default)(t,this.scope.actions)?t in this.globalEvents&&-1!==(a=this.globalEvents[t].indexOf(e))&&this.globalEvents[t].splice(a,1):this.scope.events.remove(this.scope.document,t,e,n),this}),"The interact.off() method is being deprecated"),e.debug=function(){return this.scope},e.supportsTouch=function(){return _.default.supportsTouch},e.supportsPointerEvent=function(){return _.default.supportsPointerEvent},e.stop=function(){for(var t=0;t<this.scope.interactions.list.length;t++)this.scope.interactions.list[t].stop();return this},e.pointerMoveTolerance=function(t){return r.default.number(t)?(this.scope.interactions.pointerMoveTolerance=t,this):this.scope.interactions.pointerMoveTolerance},e.addDocument=function(t,e){this.scope.addDocument(t,e)},e.removeDocument=function(t){this.scope.removeDocument(t)},e};var un={};function ln(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(un,"__esModule",{value:!0}),un.Interactable=void 0;var hn=function(){function t(n,i,s,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),ln(this,"options",void 0),ln(this,"_actions",void 0),ln(this,"target",void 0),ln(this,"events",new nn.Eventable),ln(this,"_context",void 0),ln(this,"_win",void 0),ln(this,"_doc",void 0),ln(this,"_scopeEvents",void 0),ln(this,"_rectChecker",void 0),this._actions=i.actions,this.target=n,this._context=i.context||s,this._win=(0,e.getWindow)((0,w.trySelector)(n)?this._context:n),this._doc=this._win.document,this._scopeEvents=r,this.set(i)}var n;return(n=[{key:"_defaults",get:function(){return{base:{},perAction:{},actions:{}}}},{key:"setOnEvents",value:function(t,e){return r.default.func(e.onstart)&&this.on("".concat(t,"start"),e.onstart),r.default.func(e.onmove)&&this.on("".concat(t,"move"),e.onmove),r.default.func(e.onend)&&this.on("".concat(t,"end"),e.onend),r.default.func(e.oninertiastart)&&this.on("".concat(t,"inertiastart"),e.oninertiastart),this}},{key:"updatePerActionListeners",value:function(t,e,n){(r.default.array(e)||r.default.object(e))&&this.off(t,e),(r.default.array(n)||r.default.object(n))&&this.on(t,n)}},{key:"setPerAction",value:function(t,e){var n=this._defaults;for(var i in e){var s=i,o=this.options[t],a=e[s];"listeners"===s&&this.updatePerActionListeners(t,o.listeners,a),r.default.array(a)?o[s]=H.from(a):r.default.plainObject(a)?(o[s]=(0,A.default)(o[s]||{},(0,de.default)(a)),r.default.object(n.perAction[s])&&"enabled"in n.perAction[s]&&(o[s].enabled=!1!==a.enabled)):r.default.bool(a)&&r.default.object(n.perAction[s])?o[s].enabled=a:o[s]=a}}},{key:"getRect",value:function(t){return t=t||(r.default.element(this.target)?this.target:null),r.default.string(this.target)&&(t=t||this._context.querySelector(this.target)),(0,w.getElementRect)(t)}},{key:"rectChecker",value:function(t){var e=this;return r.default.func(t)?(this._rectChecker=t,this.getRect=function(t){var n=(0,A.default)({},e._rectChecker(t));return"width"in n||(n.width=n.right-n.left,n.height=n.bottom-n.top),n},this):null===t?(delete this.getRect,delete this._rectChecker,this):this.getRect}},{key:"_backCompatOption",value:function(t,e){if((0,w.trySelector)(e)||r.default.object(e)){for(var n in this.options[t]=e,this._actions.map)this.options[n][t]=e;return this}return this.options[t]}},{key:"origin",value:function(t){return this._backCompatOption("origin",t)}},{key:"deltaSource",value:function(t){return"page"===t||"client"===t?(this.options.deltaSource=t,this):this.options.deltaSource}},{key:"context",value:function(){return this._context}},{key:"inContext",value:function(t){return this._context===t.ownerDocument||(0,w.nodeContains)(this._context,t)}},{key:"testIgnoreAllow",value:function(t,e,n){return!this.testIgnore(t.ignoreFrom,e,n)&&this.testAllow(t.allowFrom,e,n)}},{key:"testAllow",value:function(t,e,n){return!t||!!r.default.element(n)&&(r.default.string(t)?(0,w.matchesUpTo)(n,t,e):!!r.default.element(t)&&(0,w.nodeContains)(t,n))}},{key:"testIgnore",value:function(t,e,n){return!(!t||!r.default.element(n))&&(r.default.string(t)?(0,w.matchesUpTo)(n,t,e):!!r.default.element(t)&&(0,w.nodeContains)(t,n))}},{key:"fire",value:function(t){return this.events.fire(t),this}},{key:"_onOff",value:function(t,e,n,i){r.default.object(e)&&!r.default.array(e)&&(i=n,n=null);var s="on"===t?"add":"remove",o=(0,R.default)(e,n);for(var a in o){"wheel"===a&&(a=_.default.wheelEvent);for(var c=0;c<o[a].length;c++){var u=o[a][c];(0,an.default)(a,this._actions)?this.events[t](a,u):r.default.string(this.target)?this._scopeEvents["".concat(s,"Delegate")](this.target,this._context,a,u,i):this._scopeEvents[s](this.target,a,u,i)}}return this}},{key:"on",value:function(t,e,n){return this._onOff("on",t,e,n)}},{key:"off",value:function(t,e,n){return this._onOff("off",t,e,n)}},{key:"set",value:function(t){var e=this._defaults;for(var n in r.default.object(t)||(t={}),this.options=(0,de.default)(e.base),this._actions.methodDict){var i=n,s=this._actions.methodDict[i];this.options[i]={},this.setPerAction(i,(0,A.default)((0,A.default)({},e.perAction),e.actions[i])),this[s](t[i])}for(var o in t)r.default.func(this[o])&&this[o](t[o]);return this}},{key:"unset",value:function(){if(r.default.string(this.target))for(var t in this._scopeEvents.delegatedEvents)for(var e=this._scopeEvents.delegatedEvents[t],n=e.length-1;n>=0;n--){var i=e[n],s=i.selector,o=i.context,a=i.listeners;s===this.target&&o===this._context&&e.splice(n,1);for(var c=a.length-1;c>=0;c--)this._scopeEvents.removeDelegate(this.target,this._context,t,a[c][0],a[c][1])}else this._scopeEvents.remove(this.target,"all")}}])&&function(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}(t.prototype,n),t}();un.Interactable=hn;var pn={};function dn(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(pn,"__esModule",{value:!0}),pn.InteractableSet=void 0;var fn=function(){function t(e){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),dn(this,"list",[]),dn(this,"selectorMap",{}),dn(this,"scope",void 0),this.scope=e,e.addListeners({"interactable:unset":function(t){var e=t.interactable,i=e.target,s=e._context,o=r.default.string(i)?n.selectorMap[i]:i[n.scope.id],a=H.findIndex(o,(function(t){return t.context===s}));o[a]&&(o[a].context=null,o[a].interactable=null),o.splice(a,1)}})}var e;return(e=[{key:"new",value:function(t,e){e=(0,A.default)(e||{},{actions:this.scope.actions});var n=new this.scope.Interactable(t,e,this.scope.document,this.scope.events),i={context:n._context,interactable:n};return this.scope.addDocument(n._doc),this.list.push(n),r.default.string(t)?(this.selectorMap[t]||(this.selectorMap[t]=[]),this.selectorMap[t].push(i)):(n.target[this.scope.id]||Object.defineProperty(t,this.scope.id,{value:[],configurable:!0}),t[this.scope.id].push(i)),this.scope.fire("interactable:new",{target:t,options:e,interactable:n,win:this.scope._win}),n}},{key:"get",value:function(t,e){var n=e&&e.context||this.scope.document,i=r.default.string(t),s=i?this.selectorMap[t]:t[this.scope.id];if(!s)return null;var o=H.find(s,(function(e){return e.context===n&&(i||e.interactable.inContext(t))}));return o&&o.interactable}},{key:"forEachMatch",value:function(t,e){for(var n=0;n<this.list.length;n++){var i=this.list[n],s=void 0;if((r.default.string(i.target)?r.default.element(t)&&w.matchesSelector(t,i.target):t===i.target)&&i.inContext(t)&&(s=e(i)),void 0!==s)return s}}}])&&function(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}(t.prototype,e),t}();pn.InteractableSet=fn;var mn={};function vn(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function gn(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],i=!0,s=!1,r=void 0;try{for(var o,a=t[Symbol.iterator]();!(i=(o=a.next()).done)&&(n.push(o.value),!e||n.length!==e);i=!0);}catch(t){s=!0,r=t}finally{try{i||null==a.return||a.return()}finally{if(s)throw r}}return n}}(t,e)||function(t,e){if(t){if("string"==typeof t)return yn(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?yn(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yn(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}Object.defineProperty(mn,"__esModule",{value:!0}),mn.default=void 0;var _n=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),vn(this,"currentTarget",void 0),vn(this,"originalEvent",void 0),vn(this,"type",void 0),this.originalEvent=e,(0,N.default)(this,e)}var e;return(e=[{key:"preventOriginalDefault",value:function(){this.originalEvent.preventDefault()}},{key:"stopPropagation",value:function(){this.originalEvent.stopPropagation()}},{key:"stopImmediatePropagation",value:function(){this.originalEvent.stopImmediatePropagation()}}])&&function(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}(t.prototype,e),t}();function bn(t){if(!r.default.object(t))return{capture:!!t,passive:!1};var e=(0,A.default)({},t);return e.capture=!!t.capture,e.passive=!!t.passive,e}var xn={id:"events",install:function(t){var e,n=[],i={},s=[],o={add:a,remove:c,addDelegate:function(t,e,n,r,o){var c=bn(o);if(!i[n]){i[n]=[];for(var h=0;h<s.length;h++){var p=s[h];a(p,n,u),a(p,n,l,!0)}}var d=i[n],f=H.find(d,(function(n){return n.selector===t&&n.context===e}));f||(f={selector:t,context:e,listeners:[]},d.push(f)),f.listeners.push([r,c])},removeDelegate:function(t,e,n,s,r){var o,a=bn(r),h=i[n],p=!1;if(h)for(o=h.length-1;o>=0;o--){var d=h[o];if(d.selector===t&&d.context===e){for(var f=d.listeners,m=f.length-1;m>=0;m--){var v=gn(f[m],2),g=v[0],y=v[1],_=y.capture,b=y.passive;if(g===s&&_===a.capture&&b===a.passive){f.splice(m,1),f.length||(h.splice(o,1),c(e,n,u),c(e,n,l,!0)),p=!0;break}}if(p)break}}},delegateListener:u,delegateUseCapture:l,delegatedEvents:i,documents:s,targets:n,supportsOptions:!1,supportsPassive:!1};function a(t,e,i,s){var r=bn(s),a=H.find(n,(function(e){return e.eventTarget===t}));a||(a={eventTarget:t,events:{}},n.push(a)),a.events[e]||(a.events[e]=[]),t.addEventListener&&!H.contains(a.events[e],i)&&(t.addEventListener(e,i,o.supportsOptions?r:r.capture),a.events[e].push(i))}function c(t,e,i,s){var r=bn(s),a=H.findIndex(n,(function(e){return e.eventTarget===t})),u=n[a];if(u&&u.events)if("all"!==e){var l=!1,h=u.events[e];if(h){if("all"===i){for(var p=h.length-1;p>=0;p--)c(t,e,h[p],r);return}for(var d=0;d<h.length;d++)if(h[d]===i){t.removeEventListener(e,i,o.supportsOptions?r:r.capture),h.splice(d,1),0===h.length&&(delete u.events[e],l=!0);break}}l&&!Object.keys(u.events).length&&n.splice(a,1)}else for(e in u.events)u.events.hasOwnProperty(e)&&c(t,e,"all")}function u(t,e){for(var n=bn(e),s=new _n(t),o=i[t.type],a=gn(L.getEventTargets(t),1)[0],c=a;r.default.element(c);){for(var u=0;u<o.length;u++){var l=o[u],h=l.selector,p=l.context;if(w.matchesSelector(c,h)&&w.nodeContains(p,a)&&w.nodeContains(p,c)){var d=l.listeners;s.currentTarget=c;for(var f=0;f<d.length;f++){var m=gn(d[f],2),v=m[0],g=m[1],y=g.capture,_=g.passive;y===n.capture&&_===n.passive&&v(s)}}}c=w.parentNode(c)}}function l(t){return u(t,!0)}return null==(e=t.document)||e.createElement("div").addEventListener("test",null,{get capture(){return o.supportsOptions=!0},get passive(){return o.supportsPassive=!0}}),t.events=o,o}};mn.default=xn;var wn={};Object.defineProperty(wn,"__esModule",{value:!0}),wn.default=void 0;var Tn={methodOrder:["simulationResume","mouseOrPen","hasPointer","idle"],search:function(t){for(var e=0;e<Tn.methodOrder.length;e++){var n;n=Tn.methodOrder[e];var i=Tn[n](t);if(i)return i}return null},simulationResume:function(t){var e=t.pointerType,n=t.eventType,i=t.eventTarget,s=t.scope;if(!/down|start/i.test(n))return null;for(var r=0;r<s.interactions.list.length;r++){var o=s.interactions.list[r],a=i;if(o.simulation&&o.simulation.allowResume&&o.pointerType===e)for(;a;){if(a===o.element)return o;a=w.parentNode(a)}}return null},mouseOrPen:function(t){var e,n=t.pointerId,i=t.pointerType,s=t.eventType,r=t.scope;if("mouse"!==i&&"pen"!==i)return null;for(var o=0;o<r.interactions.list.length;o++){var a=r.interactions.list[o];if(a.pointerType===i){if(a.simulation&&!Sn(a,n))continue;if(a.interacting())return a;e||(e=a)}}if(e)return e;for(var c=0;c<r.interactions.list.length;c++){var u=r.interactions.list[c];if(!(u.pointerType!==i||/down/i.test(s)&&u.simulation))return u}return null},hasPointer:function(t){for(var e=t.pointerId,n=t.scope,i=0;i<n.interactions.list.length;i++){var s=n.interactions.list[i];if(Sn(s,e))return s}return null},idle:function(t){for(var e=t.pointerType,n=t.scope,i=0;i<n.interactions.list.length;i++){var s=n.interactions.list[i];if(1===s.pointers.length){var r=s.interactable;if(r&&(!r.options.gesture||!r.options.gesture.enabled))continue}else if(s.pointers.length>=2)continue;if(!s.interacting()&&e===s.pointerType)return s}return null}};function Sn(t,e){return t.pointers.some((function(t){return t.id===e}))}var kn=Tn;wn.default=kn;var On={};function En(t){return(En="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function Cn(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],i=!0,s=!1,r=void 0;try{for(var o,a=t[Symbol.iterator]();!(i=(o=a.next()).done)&&(n.push(o.value),!e||n.length!==e);i=!0);}catch(t){s=!0,r=t}finally{try{i||null==a.return||a.return()}finally{if(s)throw r}}return n}}(t,e)||function(t,e){if(t){if("string"==typeof t)return An(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?An(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function An(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function Dn(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Mn(t,e){return(Mn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function In(t,e){return!e||"object"!==En(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Pn(t){return(Pn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}Object.defineProperty(On,"__esModule",{value:!0}),On.default=void 0;var Rn=["pointerDown","pointerMove","pointerUp","updatePointer","removePointer","windowBlur"];function jn(t,e){return function(n){var i=e.interactions.list,s=L.getPointerType(n),r=Cn(L.getEventTargets(n),2),o=r[0],a=r[1],c=[];if(/^touch/.test(n.type)){e.prevTouchTime=e.now();for(var u=0;u<n.changedTouches.length;u++){var l=n.changedTouches[u],h={pointer:l,pointerId:L.getPointerId(l),pointerType:s,eventType:n.type,eventTarget:o,curEventTarget:a,scope:e},p=qn(h);c.push([h.pointer,h.eventTarget,h.curEventTarget,p])}}else{var d=!1;if(!_.default.supportsPointerEvent&&/mouse/.test(n.type)){for(var f=0;f<i.length&&!d;f++)d="mouse"!==i[f].pointerType&&i[f].pointerIsDown;d=d||e.now()-e.prevTouchTime<500||0===n.timeStamp}if(!d){var m={pointer:n,pointerId:L.getPointerId(n),pointerType:s,eventType:n.type,curEventTarget:a,eventTarget:o,scope:e},v=qn(m);c.push([m.pointer,m.eventTarget,m.curEventTarget,v])}}for(var g=0;g<c.length;g++){var y=Cn(c[g],4),b=y[0],x=y[1],w=y[2];y[3][t](b,n,x,w)}}}function qn(t){var e=t.pointerType,n=t.scope,i={interaction:wn.default.search(t),searchDetails:t};return n.fire("interactions:find",i),i.interaction||n.interactions.new({pointerType:e})}function Nn(t,e){var n=t.doc,i=t.scope,s=t.options,r=i.interactions.docEvents,o=i.events,a=o[e];for(var c in i.browser.isIOS&&!s.events&&(s.events={passive:!1}),o.delegatedEvents)a(n,c,o.delegateListener),a(n,c,o.delegateUseCapture,!0);for(var u=s&&s.events,l=0;l<r.length;l++){var h=r[l];a(n,h.type,h.listener,u)}}var Vn={id:"core/interactions",install:function(t){for(var e={},n=0;n<Rn.length;n++){var i=Rn[n];e[i]=jn(i,t)}var s,r=_.default.pEventTypes;function o(){for(var e=0;e<t.interactions.list.length;e++){var n=t.interactions.list[e];if(n.pointerIsDown&&"touch"===n.pointerType&&!n._interacting)for(var i=function(){var e=n.pointers[s];t.documents.some((function(t){var n=t.doc;return(0,w.nodeContains)(n,e.downTarget)}))||n.removePointer(e.pointer,e.event)},s=0;s<n.pointers.length;s++)i()}}(s=m.default.PointerEvent?[{type:r.down,listener:o},{type:r.down,listener:e.pointerDown},{type:r.move,listener:e.pointerMove},{type:r.up,listener:e.pointerUp},{type:r.cancel,listener:e.pointerUp}]:[{type:"mousedown",listener:e.pointerDown},{type:"mousemove",listener:e.pointerMove},{type:"mouseup",listener:e.pointerUp},{type:"touchstart",listener:o},{type:"touchstart",listener:e.pointerDown},{type:"touchmove",listener:e.pointerMove},{type:"touchend",listener:e.pointerUp},{type:"touchcancel",listener:e.pointerUp}]).push({type:"blur",listener:function(e){for(var n=0;n<t.interactions.list.length;n++)t.interactions.list[n].documentBlur(e)}}),t.prevTouchTime=0,t.Interaction=function(e){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Mn(t,e)}(o,e);var n,i,s,r=(i=o,s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=Pn(i);if(s){var n=Pn(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return In(this,t)});function o(){return Dn(this,o),r.apply(this,arguments)}return(n=[{key:"pointerMoveTolerance",get:function(){return t.interactions.pointerMoveTolerance},set:function(e){t.interactions.pointerMoveTolerance=e}},{key:"_now",value:function(){return t.now()}}])&&function(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}(o.prototype,n),o}(Ne.default),t.interactions={list:[],new:function(e){e.scopeFire=function(e,n){return t.fire(e,n)};var n=new t.Interaction(e);return t.interactions.list.push(n),n},listeners:e,docEvents:s,pointerMoveTolerance:1},t.usePlugin(re.default)},listeners:{"scope:add-document":function(t){return Nn(t,"add")},"scope:remove-document":function(t){return Nn(t,"remove")},"interactable:unset":function(t,e){for(var n=t.interactable,i=e.interactions.list.length-1;i>=0;i--){var s=e.interactions.list[i];s.interactable===n&&(s.stop(),e.fire("interactions:destroy",{interaction:s}),s.destroy(),e.interactions.list.length>2&&e.interactions.list.splice(i,1))}}},onDocSignal:Nn,doOnInteractions:jn,methodNames:Rn};On.default=Vn;var Fn={};function Ln(t){return(Ln="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function zn(t,e,n){return(zn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Zn(t)););return t}(t,e);if(i){var s=Object.getOwnPropertyDescriptor(i,e);return s.get?s.get.call(n):s.value}})(t,e,n||t)}function Bn(t,e){return(Bn=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function Wn(t,e){return!e||"object"!==Ln(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function Zn(t){return(Zn=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function Un(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Yn(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function Gn(t,e,n){return e&&Yn(t.prototype,e),n&&Yn(t,n),t}function Xn(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(Fn,"__esModule",{value:!0}),Fn.initScope=Hn,Fn.Scope=void 0;var Qn=function(){function t(){var e=this;Un(this,t),Xn(this,"id","__interact_scope_".concat(Math.floor(100*Math.random()))),Xn(this,"isInitialized",!1),Xn(this,"listenerMaps",[]),Xn(this,"browser",_.default),Xn(this,"defaults",(0,de.default)(Se.defaults)),Xn(this,"Eventable",nn.Eventable),Xn(this,"actions",{map:{},phases:{start:!0,move:!0,end:!0},methodDict:{},phaselessTypes:{}}),Xn(this,"interactStatic",(0,cn.createInteractStatic)(this)),Xn(this,"InteractEvent",ke.InteractEvent),Xn(this,"Interactable",void 0),Xn(this,"interactables",new pn.InteractableSet(this)),Xn(this,"_win",void 0),Xn(this,"document",void 0),Xn(this,"window",void 0),Xn(this,"documents",[]),Xn(this,"_plugins",{list:[],map:{}}),Xn(this,"onWindowUnload",(function(t){return e.removeDocument(t.target)}));var n=this;this.Interactable=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&Bn(t,e)}(r,t);var e,i,s=(e=r,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,n=Zn(e);if(i){var s=Zn(this).constructor;t=Reflect.construct(n,arguments,s)}else t=n.apply(this,arguments);return Wn(this,t)});function r(){return Un(this,r),s.apply(this,arguments)}return Gn(r,[{key:"_defaults",get:function(){return n.defaults}},{key:"set",value:function(t){return zn(Zn(r.prototype),"set",this).call(this,t),n.fire("interactable:set",{options:t,interactable:this}),this}},{key:"unset",value:function(){zn(Zn(r.prototype),"unset",this).call(this),n.interactables.list.splice(n.interactables.list.indexOf(this),1),n.fire("interactable:unset",{interactable:this})}}]),r}(un.Interactable)}return Gn(t,[{key:"addListeners",value:function(t,e){this.listenerMaps.push({id:e,map:t})}},{key:"fire",value:function(t,e){for(var n=0;n<this.listenerMaps.length;n++){var i=this.listenerMaps[n].map[t];if(i&&!1===i(e,this,t))return!1}}},{key:"init",value:function(t){return this.isInitialized?this:Hn(this,t)}},{key:"pluginIsInstalled",value:function(t){return this._plugins.map[t.id]||-1!==this._plugins.list.indexOf(t)}},{key:"usePlugin",value:function(t,e){if(!this.isInitialized)return this;if(this.pluginIsInstalled(t))return this;if(t.id&&(this._plugins.map[t.id]=t),this._plugins.list.push(t),t.install&&t.install(this,e),t.listeners&&t.before){for(var n=0,i=this.listenerMaps.length,s=t.before.reduce((function(t,e){return t[e]=!0,t[$n(e)]=!0,t}),{});n<i;n++){var r=this.listenerMaps[n].id;if(s[r]||s[$n(r)])break}this.listenerMaps.splice(n,0,{id:t.id,map:t.listeners})}else t.listeners&&this.listenerMaps.push({id:t.id,map:t.listeners});return this}},{key:"addDocument",value:function(t,n){if(-1!==this.getDocIndex(t))return!1;var i=e.getWindow(t);n=n?(0,A.default)({},n):{},this.documents.push({doc:t,options:n}),this.events.documents.push(t),t!==this.document&&this.events.add(i,"unload",this.onWindowUnload),this.fire("scope:add-document",{doc:t,window:i,scope:this,options:n})}},{key:"removeDocument",value:function(t){var n=this.getDocIndex(t),i=e.getWindow(t),s=this.documents[n].options;this.events.remove(i,"unload",this.onWindowUnload),this.documents.splice(n,1),this.events.documents.splice(n,1),this.fire("scope:remove-document",{doc:t,window:i,scope:this,options:s})}},{key:"getDocIndex",value:function(t){for(var e=0;e<this.documents.length;e++)if(this.documents[e].doc===t)return e;return-1}},{key:"getDocOptions",value:function(t){var e=this.getDocIndex(t);return-1===e?null:this.documents[e].options}},{key:"now",value:function(){return(this.window.Date||Date).now()}}]),t}();function Hn(t,n){return t.isInitialized=!0,r.default.window(n)&&e.init(n),m.default.init(n),_.default.init(n),Et.default.init(n),t.window=n,t.document=n.document,t.usePlugin(On.default),t.usePlugin(mn.default),t}function $n(t){return t&&t.replace(/\/.*$/,"")}Fn.Scope=Qn;var Kn={};Object.defineProperty(Kn,"__esModule",{value:!0}),Kn.default=void 0;var Jn=new Fn.Scope,ti=Jn.interactStatic;Kn.default=ti;var ei="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0;Jn.init(ei);var ni={};Object.defineProperty(ni,"__esModule",{value:!0}),ni.default=void 0,ni.default=function(){};var ii={};Object.defineProperty(ii,"__esModule",{value:!0}),ii.default=void 0,ii.default=function(){};var si={};function ri(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],i=!0,s=!1,r=void 0;try{for(var o,a=t[Symbol.iterator]();!(i=(o=a.next()).done)&&(n.push(o.value),!e||n.length!==e);i=!0);}catch(t){s=!0,r=t}finally{try{i||null==a.return||a.return()}finally{if(s)throw r}}return n}}(t,e)||function(t,e){if(t){if("string"==typeof t)return oi(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?oi(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function oi(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}Object.defineProperty(si,"__esModule",{value:!0}),si.default=void 0,si.default=function(t){var e=[["x","y"],["left","top"],["right","bottom"],["width","height"]].filter((function(e){var n=ri(e,2),i=n[0],s=n[1];return i in t||s in t})),n=function(n,i){for(var s=t.range,r=t.limits,o=void 0===r?{left:-1/0,right:1/0,top:-1/0,bottom:1/0}:r,a=t.offset,c=void 0===a?{x:0,y:0}:a,u={range:s,grid:t,x:null,y:null},l=0;l<e.length;l++){var h=ri(e[l],2),p=h[0],d=h[1],f=Math.round((n-c.x)/t[p]),m=Math.round((i-c.y)/t[d]);u[p]=Math.max(o.left,Math.min(o.right,f*t[p]+c.x)),u[d]=Math.max(o.top,Math.min(o.bottom,m*t[d]+c.y))}return u};return n.grid=t,n.coordFields=e,n};var ai={};Object.defineProperty(ai,"__esModule",{value:!0}),Object.defineProperty(ai,"edgeTarget",{enumerable:!0,get:function(){return ni.default}}),Object.defineProperty(ai,"elements",{enumerable:!0,get:function(){return ii.default}}),Object.defineProperty(ai,"grid",{enumerable:!0,get:function(){return si.default}});var ci={};Object.defineProperty(ci,"__esModule",{value:!0}),ci.default=void 0;var ui={id:"snappers",install:function(t){var e=t.interactStatic;e.snappers=(0,A.default)(e.snappers||{},ai),e.createSnapGrid=e.snappers.grid}};ci.default=ui;var li={};function hi(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function pi(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?hi(Object(n),!0).forEach((function(e){di(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):hi(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function di(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(li,"__esModule",{value:!0}),li.aspectRatio=li.default=void 0;var fi={start:function(t){var e=t.state,n=t.rect,i=t.edges,s=t.pageCoords,r=e.options.ratio,o=e.options,a=o.equalDelta,c=o.modifiers;"preserve"===r&&(r=n.width/n.height),e.startCoords=(0,A.default)({},s),e.startRect=(0,A.default)({},n),e.ratio=r,e.equalDelta=a;var u=e.linkedEdges={top:i.top||i.left&&!i.bottom,left:i.left||i.top&&!i.right,bottom:i.bottom||i.right&&!i.top,right:i.right||i.bottom&&!i.left};if(e.xIsPrimaryAxis=!(!i.left&&!i.right),e.equalDelta)e.edgeSign=(u.left?1:-1)*(u.top?1:-1);else{var l=e.xIsPrimaryAxis?u.top:u.left;e.edgeSign=l?-1:1}if((0,A.default)(t.edges,u),c&&c.length){var h=new fe.default(t.interaction);h.copyFrom(t.interaction.modification),h.prepareStates(c),e.subModification=h,h.startAll(pi({},t))}},set:function(t){var e=t.state,n=t.rect,i=t.coords,s=(0,A.default)({},i),r=e.equalDelta?mi:vi;if(r(e,e.xIsPrimaryAxis,i,n),!e.subModification)return null;var o=(0,A.default)({},n);(0,D.addEdges)(e.linkedEdges,o,{x:i.x-s.x,y:i.y-s.y});var a=e.subModification.setAll(pi(pi({},t),{},{rect:o,edges:e.linkedEdges,pageCoords:i,prevCoords:i,prevRect:o})),c=a.delta;return a.changed&&(r(e,Math.abs(c.x)>Math.abs(c.y),a.coords,a.rect),(0,A.default)(i,a.coords)),a.eventProps},defaults:{ratio:"preserve",equalDelta:!1,modifiers:[],enabled:!1}};function mi(t,e,n){var i=t.startCoords,s=t.edgeSign;e?n.y=i.y+(n.x-i.x)*s:n.x=i.x+(n.y-i.y)*s}function vi(t,e,n,i){var s=t.startRect,r=t.startCoords,o=t.ratio,a=t.edgeSign;if(e){var c=i.width/o;n.y=r.y+(c-s.height)*a}else{var u=i.height*o;n.x=r.x+(u-s.width)*a}}li.aspectRatio=fi;var gi=(0,xe.makeModifier)(fi,"aspectRatio");li.default=gi;var yi={};Object.defineProperty(yi,"__esModule",{value:!0}),yi.default=void 0;var _i=function(){};_i._defaults={};var bi=_i;yi.default=bi;var xi={};Object.defineProperty(xi,"__esModule",{value:!0}),Object.defineProperty(xi,"default",{enumerable:!0,get:function(){return yi.default}});var wi={};function Ti(t,e,n){return r.default.func(t)?D.resolveRectLike(t,e.interactable,e.element,[n.x,n.y,e]):D.resolveRectLike(t,e.interactable,e.element)}Object.defineProperty(wi,"__esModule",{value:!0}),wi.getRestrictionRect=Ti,wi.restrict=wi.default=void 0;var Si={start:function(t){var e=t.rect,n=t.startOffset,i=t.state,s=t.interaction,r=t.pageCoords,o=i.options,a=o.elementRect,c=(0,A.default)({left:0,top:0,right:0,bottom:0},o.offset||{});if(e&&a){var u=Ti(o.restriction,s,r);if(u){var l=u.right-u.left-e.width,h=u.bottom-u.top-e.height;l<0&&(c.left+=l,c.right+=l),h<0&&(c.top+=h,c.bottom+=h)}c.left+=n.left-e.width*a.left,c.top+=n.top-e.height*a.top,c.right+=n.right-e.width*(1-a.right),c.bottom+=n.bottom-e.height*(1-a.bottom)}i.offset=c},set:function(t){var e=t.coords,n=t.interaction,i=t.state,s=i.options,r=i.offset,o=Ti(s.restriction,n,e);if(o){var a=D.xywhToTlbr(o);e.x=Math.max(Math.min(a.right-r.right,e.x),a.left+r.left),e.y=Math.max(Math.min(a.bottom-r.bottom,e.y),a.top+r.top)}},defaults:{restriction:null,elementRect:null,offset:null,endOnly:!1,enabled:!1}};wi.restrict=Si;var ki=(0,xe.makeModifier)(Si,"restrict");wi.default=ki;var Oi={};Object.defineProperty(Oi,"__esModule",{value:!0}),Oi.restrictEdges=Oi.default=void 0;var Ei={top:1/0,left:1/0,bottom:-1/0,right:-1/0},Ci={top:-1/0,left:-1/0,bottom:1/0,right:1/0};function Ai(t,e){for(var n=["top","left","bottom","right"],i=0;i<n.length;i++){var s=n[i];s in t||(t[s]=e[s])}return t}var Di={noInner:Ei,noOuter:Ci,start:function(t){var e,n=t.interaction,i=t.startOffset,s=t.state,r=s.options;if(r){var o=(0,wi.getRestrictionRect)(r.offset,n,n.coords.start.page);e=D.rectToXY(o)}e=e||{x:0,y:0},s.offset={top:e.y+i.top,left:e.x+i.left,bottom:e.y-i.bottom,right:e.x-i.right}},set:function(t){var e=t.coords,n=t.edges,i=t.interaction,s=t.state,r=s.offset,o=s.options;if(n){var a=(0,A.default)({},e),c=(0,wi.getRestrictionRect)(o.inner,i,a)||{},u=(0,wi.getRestrictionRect)(o.outer,i,a)||{};Ai(c,Ei),Ai(u,Ci),n.top?e.y=Math.min(Math.max(u.top+r.top,a.y),c.top+r.top):n.bottom&&(e.y=Math.max(Math.min(u.bottom+r.bottom,a.y),c.bottom+r.bottom)),n.left?e.x=Math.min(Math.max(u.left+r.left,a.x),c.left+r.left):n.right&&(e.x=Math.max(Math.min(u.right+r.right,a.x),c.right+r.right))}},defaults:{inner:null,outer:null,offset:null,endOnly:!1,enabled:!1}};Oi.restrictEdges=Di;var Mi=(0,xe.makeModifier)(Di,"restrictEdges");Oi.default=Mi;var Ii={};Object.defineProperty(Ii,"__esModule",{value:!0}),Ii.restrictRect=Ii.default=void 0;var Pi=(0,A.default)({get elementRect(){return{top:0,left:0,bottom:1,right:1}},set elementRect(t){}},wi.restrict.defaults),Ri={start:wi.restrict.start,set:wi.restrict.set,defaults:Pi};Ii.restrictRect=Ri;var ji=(0,xe.makeModifier)(Ri,"restrictRect");Ii.default=ji;var qi={};Object.defineProperty(qi,"__esModule",{value:!0}),qi.restrictSize=qi.default=void 0;var Ni={width:-1/0,height:-1/0},Vi={width:1/0,height:1/0},Fi={start:function(t){return Oi.restrictEdges.start(t)},set:function(t){var e=t.interaction,n=t.state,i=t.rect,s=t.edges,r=n.options;if(s){var o=D.tlbrToXywh((0,wi.getRestrictionRect)(r.min,e,t.coords))||Ni,a=D.tlbrToXywh((0,wi.getRestrictionRect)(r.max,e,t.coords))||Vi;n.options={endOnly:r.endOnly,inner:(0,A.default)({},Oi.restrictEdges.noInner),outer:(0,A.default)({},Oi.restrictEdges.noOuter)},s.top?(n.options.inner.top=i.bottom-o.height,n.options.outer.top=i.bottom-a.height):s.bottom&&(n.options.inner.bottom=i.top+o.height,n.options.outer.bottom=i.top+a.height),s.left?(n.options.inner.left=i.right-o.width,n.options.outer.left=i.right-a.width):s.right&&(n.options.inner.right=i.left+o.width,n.options.outer.right=i.left+a.width),Oi.restrictEdges.set(t),n.options=r}},defaults:{min:null,max:null,endOnly:!1,enabled:!1}};qi.restrictSize=Fi;var Li=(0,xe.makeModifier)(Fi,"restrictSize");qi.default=Li;var zi={};Object.defineProperty(zi,"__esModule",{value:!0}),Object.defineProperty(zi,"default",{enumerable:!0,get:function(){return yi.default}});var Bi={};Object.defineProperty(Bi,"__esModule",{value:!0}),Bi.snap=Bi.default=void 0;var Wi={start:function(t){var e,n=t.interaction,i=t.interactable,s=t.element,r=t.rect,o=t.state,a=t.startOffset,c=o.options,u=c.offsetWithOrigin?function(t){var e=t.interaction.element;return(0,D.rectToXY)((0,D.resolveRectLike)(t.state.options.origin,null,null,[e]))||(0,P.default)(t.interactable,e,t.interaction.prepared.name)}(t):{x:0,y:0};if("startCoords"===c.offset)e={x:n.coords.start.page.x,y:n.coords.start.page.y};else{var l=(0,D.resolveRectLike)(c.offset,i,s,[n]);(e=(0,D.rectToXY)(l)||{x:0,y:0}).x+=u.x,e.y+=u.y}var h=c.relativePoints;o.offsets=r&&h&&h.length?h.map((function(t,n){return{index:n,relativePoint:t,x:a.left-r.width*t.x+e.x,y:a.top-r.height*t.y+e.y}})):[{index:0,relativePoint:null,x:e.x,y:e.y}]},set:function(t){var e=t.interaction,n=t.coords,i=t.state,s=i.options,o=i.offsets,a=(0,P.default)(e.interactable,e.element,e.prepared.name),c=(0,A.default)({},n),u=[];s.offsetWithOrigin||(c.x-=a.x,c.y-=a.y);for(var l=0;l<o.length;l++)for(var h=o[l],p=c.x-h.x,d=c.y-h.y,f=0,m=s.targets.length;f<m;f++){var v,g=s.targets[f];(v=r.default.func(g)?g(p,d,e._proxy,h,f):g)&&u.push({x:(r.default.number(v.x)?v.x:p)+h.x,y:(r.default.number(v.y)?v.y:d)+h.y,range:r.default.number(v.range)?v.range:s.range,source:g,index:f,offset:h})}for(var y={target:null,inRange:!1,distance:0,range:0,delta:{x:0,y:0}},_=0;_<u.length;_++){var b=u[_],x=b.range,w=b.x-c.x,T=b.y-c.y,S=(0,q.default)(w,T),k=S<=x;x===1/0&&y.inRange&&y.range!==1/0&&(k=!1),y.target&&!(k?y.inRange&&x!==1/0?S/x<y.distance/y.range:x===1/0&&y.range!==1/0||S<y.distance:!y.inRange&&S<y.distance)||(y.target=b,y.distance=S,y.range=x,y.inRange=k,y.delta.x=w,y.delta.y=T)}return y.inRange&&(n.x=y.target.x,n.y=y.target.y),i.closest=y,y},defaults:{range:1/0,targets:null,offset:null,offsetWithOrigin:!0,origin:null,relativePoints:null,endOnly:!1,enabled:!1}};Bi.snap=Wi;var Zi=(0,xe.makeModifier)(Wi,"snap");Bi.default=Zi;var Ui={};function Yi(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}Object.defineProperty(Ui,"__esModule",{value:!0}),Ui.snapSize=Ui.default=void 0;var Gi={start:function(t){var e=t.state,n=t.edges,i=e.options;if(!n)return null;t.state={options:{targets:null,relativePoints:[{x:n.left?0:1,y:n.top?0:1}],offset:i.offset||"self",origin:{x:0,y:0},range:i.range}},e.targetFields=e.targetFields||[["width","height"],["x","y"]],Bi.snap.start(t),e.offsets=t.state.offsets,t.state=e},set:function(t){var e,n=t.interaction,i=t.state,s=t.coords,o=i.options,a=i.offsets,c={x:s.x-a[0].x,y:s.y-a[0].y};i.options=(0,A.default)({},o),i.options.targets=[];for(var u=0;u<(o.targets||[]).length;u++){var l=(o.targets||[])[u],h=void 0;if(h=r.default.func(l)?l(c.x,c.y,n):l){for(var p=0;p<i.targetFields.length;p++){var d=(2,function(t){if(Array.isArray(t))return t}(e=i.targetFields[p])||function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],i=!0,s=!1,r=void 0;try{for(var o,a=t[Symbol.iterator]();!(i=(o=a.next()).done)&&(n.push(o.value),2!==n.length);i=!0);}catch(t){s=!0,r=t}finally{try{i||null==a.return||a.return()}finally{if(s)throw r}}return n}}(e)||function(t,e){if(t){if("string"==typeof t)return Yi(t,2);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Yi(t,2):void 0}}(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),f=d[0],m=d[1];if(f in h||m in h){h.x=h[f],h.y=h[m];break}}i.options.targets.push(h)}}var v=Bi.snap.set(t);return i.options=o,v},defaults:{range:1/0,targets:null,offset:null,endOnly:!1,enabled:!1}};Ui.snapSize=Gi;var Xi=(0,xe.makeModifier)(Gi,"snapSize");Ui.default=Xi;var Qi={};Object.defineProperty(Qi,"__esModule",{value:!0}),Qi.snapEdges=Qi.default=void 0;var Hi={start:function(t){var e=t.edges;return e?(t.state.targetFields=t.state.targetFields||[[e.left?"left":"right",e.top?"top":"bottom"]],Ui.snapSize.start(t)):null},set:Ui.snapSize.set,defaults:(0,A.default)((0,de.default)(Ui.snapSize.defaults),{targets:null,range:null,offset:{x:0,y:0}})};Qi.snapEdges=Hi;var $i=(0,xe.makeModifier)(Hi,"snapEdges");Qi.default=$i;var Ki={};Object.defineProperty(Ki,"__esModule",{value:!0}),Object.defineProperty(Ki,"default",{enumerable:!0,get:function(){return yi.default}});var Ji={};Object.defineProperty(Ji,"__esModule",{value:!0}),Object.defineProperty(Ji,"default",{enumerable:!0,get:function(){return yi.default}});var ts={};Object.defineProperty(ts,"__esModule",{value:!0}),ts.default=void 0;var es={aspectRatio:li.default,restrictEdges:Oi.default,restrict:wi.default,restrictRect:Ii.default,restrictSize:qi.default,snapEdges:Qi.default,snap:Bi.default,snapSize:Ui.default,spring:Ki.default,avoid:xi.default,transform:Ji.default,rubberband:zi.default};ts.default=es;var ns={};Object.defineProperty(ns,"__esModule",{value:!0}),ns.default=void 0;var is={id:"modifiers",install:function(t){var e=t.interactStatic;for(var n in t.usePlugin(xe.default),t.usePlugin(ci.default),e.modifiers=ts.default,ts.default){var i=ts.default[n],s=i._defaults,r=i._methods;s._methods=r,t.defaults.perAction[n]=s}}};ns.default=is;var ss={};function rs(t){return(rs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function os(t,e){return(os=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function as(t,e){return!e||"object"!==rs(e)&&"function"!=typeof e?cs(t):e}function cs(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function us(t){return(us=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function ls(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}Object.defineProperty(ss,"__esModule",{value:!0}),ss.PointerEvent=ss.default=void 0;var hs=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&os(t,e)}(r,t);var e,n,i,s=(n=r,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=us(n);if(i){var s=us(this).constructor;t=Reflect.construct(e,arguments,s)}else t=e.apply(this,arguments);return as(this,t)});function r(t,e,n,i,o,a){var c;if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),ls(cs(c=s.call(this,o)),"type",void 0),ls(cs(c),"originalEvent",void 0),ls(cs(c),"pointerId",void 0),ls(cs(c),"pointerType",void 0),ls(cs(c),"double",void 0),ls(cs(c),"pageX",void 0),ls(cs(c),"pageY",void 0),ls(cs(c),"clientX",void 0),ls(cs(c),"clientY",void 0),ls(cs(c),"dt",void 0),ls(cs(c),"eventable",void 0),L.pointerExtend(cs(c),n),n!==e&&L.pointerExtend(cs(c),e),c.timeStamp=a,c.originalEvent=n,c.type=t,c.pointerId=L.getPointerId(e),c.pointerType=L.getPointerType(e),c.target=i,c.currentTarget=null,"tap"===t){var u=o.getPointerIndex(e);c.dt=c.timeStamp-o.pointers[u].downTime;var l=c.timeStamp-o.tapTime;c.double=!!(o.prevTap&&"doubletap"!==o.prevTap.type&&o.prevTap.target===c.target&&l<500)}else"doubletap"===t&&(c.dt=e.timeStamp-o.tapTime);return c}return(e=[{key:"_subtractOrigin",value:function(t){var e=t.x,n=t.y;return this.pageX-=e,this.pageY-=n,this.clientX-=e,this.clientY-=n,this}},{key:"_addOrigin",value:function(t){var e=t.x,n=t.y;return this.pageX+=e,this.pageY+=n,this.clientX+=e,this.clientY+=n,this}},{key:"preventDefault",value:function(){this.originalEvent.preventDefault()}}])&&function(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}(r.prototype,e),r}(G.BaseEvent);ss.PointerEvent=ss.default=hs;var ps={};Object.defineProperty(ps,"__esModule",{value:!0}),ps.default=void 0;var ds={id:"pointer-events/base",before:["inertia","modifiers","auto-start","actions"],install:function(t){t.pointerEvents=ds,t.defaults.actions.pointerEvents=ds.defaults,(0,A.default)(t.actions.phaselessTypes,ds.types)},listeners:{"interactions:new":function(t){var e=t.interaction;e.prevTap=null,e.tapTime=0},"interactions:update-pointer":function(t){var e=t.down,n=t.pointerInfo;!e&&n.hold||(n.hold={duration:1/0,timeout:null})},"interactions:move":function(t,e){var n=t.interaction,i=t.pointer,s=t.event,r=t.eventTarget;t.duplicate||n.pointerIsDown&&!n.pointerWasMoved||(n.pointerIsDown&&vs(t),fs({interaction:n,pointer:i,event:s,eventTarget:r,type:"move"},e))},"interactions:down":function(t,e){!function(t,e){for(var n=t.interaction,i=t.pointer,s=t.event,r=t.eventTarget,o=t.pointerIndex,a=n.pointers[o].hold,c=w.getPath(r),u={interaction:n,pointer:i,event:s,eventTarget:r,type:"hold",targets:[],path:c,node:null},l=0;l<c.length;l++){var h=c[l];u.node=h,e.fire("pointerEvents:collect-targets",u)}if(u.targets.length){for(var p=1/0,d=0;d<u.targets.length;d++){var f=u.targets[d].eventable.options.holdDuration;f<p&&(p=f)}a.duration=p,a.timeout=setTimeout((function(){fs({interaction:n,eventTarget:r,pointer:i,event:s,type:"hold"},e)}),p)}}(t,e),fs(t,e)},"interactions:up":function(t,e){vs(t),fs(t,e),function(t,e){var n=t.interaction,i=t.pointer,s=t.event,r=t.eventTarget;n.pointerWasMoved||fs({interaction:n,eventTarget:r,pointer:i,event:s,type:"tap"},e)}(t,e)},"interactions:cancel":function(t,e){vs(t),fs(t,e)}},PointerEvent:ss.PointerEvent,fire:fs,collectEventTargets:ms,defaults:{holdDuration:600,ignoreFrom:null,allowFrom:null,origin:{x:0,y:0}},types:{down:!0,move:!0,up:!0,cancel:!0,tap:!0,doubletap:!0,hold:!0}};function fs(t,e){var n=t.interaction,i=t.pointer,s=t.event,r=t.eventTarget,o=t.type,a=t.targets,c=void 0===a?ms(t,e):a,u=new ss.PointerEvent(o,i,s,r,n,e.now());e.fire("pointerEvents:new",{pointerEvent:u});for(var l={interaction:n,pointer:i,event:s,eventTarget:r,targets:c,type:o,pointerEvent:u},h=0;h<c.length;h++){var p=c[h];for(var d in p.props||{})u[d]=p.props[d];var f=(0,P.default)(p.eventable,p.node);if(u._subtractOrigin(f),u.eventable=p.eventable,u.currentTarget=p.node,p.eventable.fire(u),u._addOrigin(f),u.immediatePropagationStopped||u.propagationStopped&&h+1<c.length&&c[h+1].node!==u.currentTarget)break}if(e.fire("pointerEvents:fired",l),"tap"===o){var m=u.double?fs({interaction:n,pointer:i,event:s,eventTarget:r,type:"doubletap"},e):u;n.prevTap=m,n.tapTime=m.timeStamp}return u}function ms(t,e){var n=t.interaction,i=t.pointer,s=t.event,r=t.eventTarget,o=t.type,a=n.getPointerIndex(i),c=n.pointers[a];if("tap"===o&&(n.pointerWasMoved||!c||c.downTarget!==r))return[];for(var u=w.getPath(r),l={interaction:n,pointer:i,event:s,eventTarget:r,type:o,path:u,targets:[],node:null},h=0;h<u.length;h++){var p=u[h];l.node=p,e.fire("pointerEvents:collect-targets",l)}return"hold"===o&&(l.targets=l.targets.filter((function(t){var e;return t.eventable.options.holdDuration===(null==(e=n.pointers[a])?void 0:e.hold.duration)}))),l.targets}function vs(t){var e=t.interaction,n=t.pointerIndex,i=e.pointers[n].hold;i&&i.timeout&&(clearTimeout(i.timeout),i.timeout=null)}var gs=ds;ps.default=gs;var ys={};function _s(t){var e=t.interaction;e.holdIntervalHandle&&(clearInterval(e.holdIntervalHandle),e.holdIntervalHandle=null)}Object.defineProperty(ys,"__esModule",{value:!0}),ys.default=void 0;var bs={id:"pointer-events/holdRepeat",install:function(t){t.usePlugin(ps.default);var e=t.pointerEvents;e.defaults.holdRepeatInterval=0,e.types.holdrepeat=t.actions.phaselessTypes.holdrepeat=!0},listeners:["move","up","cancel","endall"].reduce((function(t,e){return t["pointerEvents:".concat(e)]=_s,t}),{"pointerEvents:new":function(t){var e=t.pointerEvent;"hold"===e.type&&(e.count=(e.count||0)+1)},"pointerEvents:fired":function(t,e){var n=t.interaction,i=t.pointerEvent,s=t.eventTarget,r=t.targets;if("hold"===i.type&&r.length){var o=r[0].eventable.options.holdRepeatInterval;o<=0||(n.holdIntervalHandle=setTimeout((function(){e.pointerEvents.fire({interaction:n,eventTarget:s,type:"hold",pointer:i,event:i},e)}),o))}}})};ys.default=bs;var xs={};function ws(t){return(0,A.default)(this.events.options,t),this}Object.defineProperty(xs,"__esModule",{value:!0}),xs.default=void 0;var Ts={id:"pointer-events/interactableTargets",install:function(t){var e=t.Interactable;e.prototype.pointerEvents=ws;var n=e.prototype._backCompatOption;e.prototype._backCompatOption=function(t,e){var i=n.call(this,t,e);return i===this&&(this.events.options[t]=e),i}},listeners:{"pointerEvents:collect-targets":function(t,e){var n=t.targets,i=t.node,s=t.type,r=t.eventTarget;e.interactables.forEachMatch(i,(function(t){var e=t.events,o=e.options;e.types[s]&&e.types[s].length&&t.testIgnoreAllow(o,i,r)&&n.push({node:i,eventable:e,props:{interactable:t}})}))},"interactable:new":function(t){var e=t.interactable;e.events.getRect=function(t){return e.getRect(t)}},"interactable:set":function(t,e){var n=t.interactable,i=t.options;(0,A.default)(n.events.options,e.pointerEvents.defaults),(0,A.default)(n.events.options,i.pointerEvents||{})}}};xs.default=Ts;var Ss={};Object.defineProperty(Ss,"__esModule",{value:!0}),Ss.default=void 0;var ks={id:"pointer-events",install:function(t){t.usePlugin(ps),t.usePlugin(ys.default),t.usePlugin(xs.default)}};Ss.default=ks;var Os={};function Es(t){var e=t.Interactable;t.actions.phases.reflow=!0,e.prototype.reflow=function(e){return function(t,e,n){for(var i=r.default.string(t.target)?H.from(t._context.querySelectorAll(t.target)):[t.target],s=n.window.Promise,o=s?[]:null,a=function(){var r=i[c],a=t.getRect(r);if(!a)return"break";var u=H.find(n.interactions.list,(function(n){return n.interacting()&&n.interactable===t&&n.element===r&&n.prepared.name===e.name})),l=void 0;if(u)u.move(),o&&(l=u._reflowPromise||new s((function(t){u._reflowResolve=t})));else{var h=(0,D.tlbrToXywh)(a),p={page:{x:h.x,y:h.y},client:{x:h.x,y:h.y},timeStamp:n.now()},d=L.coordsToEvent(p);l=function(t,e,n,i,s){var r=t.interactions.new({pointerType:"reflow"}),o={interaction:r,event:s,pointer:s,eventTarget:n,phase:"reflow"};r.interactable=e,r.element=n,r.prevEvent=s,r.updatePointer(s,s,n,!0),L.setZeroCoords(r.coords.delta),(0,Nt.copyAction)(r.prepared,i),r._doPhase(o);var a=t.window.Promise,c=a?new a((function(t){r._reflowResolve=t})):void 0;return r._reflowPromise=c,r.start(i,e,n),r._interacting?(r.move(o),r.end(s)):(r.stop(),r._reflowResolve()),r.removePointer(s,s),c}(n,t,r,e,d)}o&&o.push(l)},c=0;c<i.length&&"break"!==a();c++);return o&&s.all(o).then((function(){return t}))}(this,e,t)}}Object.defineProperty(Os,"__esModule",{value:!0}),Os.install=Es,Os.default=void 0;var Cs={id:"reflow",install:Es,listeners:{"interactions:stop":function(t,e){var n=t.interaction;"reflow"===n.pointerType&&(n._reflowResolve&&n._reflowResolve(),H.remove(e.interactions.list,n))}}};Os.default=Cs;var As={exports:{}};function Ds(t){return(Ds="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(As.exports,"__esModule",{value:!0}),As.exports.default=void 0,Kn.default.use(re.default),Kn.default.use(Be.default),Kn.default.use(Ss.default),Kn.default.use(Qe.default),Kn.default.use(ns.default),Kn.default.use(ie.default),Kn.default.use(kt.default),Kn.default.use(It.default),Kn.default.use(Os.default);var Ms=Kn.default;if(As.exports.default=Ms,"object"===Ds(As)&&As)try{As.exports=Kn.default}catch(t){}Kn.default.default=Kn.default,As=As.exports;var Is={exports:{}};function Ps(t){return(Ps="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(Is.exports,"__esModule",{value:!0}),Is.exports.default=void 0;var Rs=As.default;if(Is.exports.default=Rs,"object"===Ps(Is)&&Is)try{Is.exports=As.default}catch(t){}return As.default.default=As.default,Is.exports}()},5666:t=>{var e=function(t){"use strict";var e,n=Object.prototype,i=n.hasOwnProperty,s="function"==typeof Symbol?Symbol:{},r=s.iterator||"@@iterator",o=s.asyncIterator||"@@asyncIterator",a=s.toStringTag||"@@toStringTag";function c(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,n){return t[e]=n}}function u(t,e,n,i){var s=e&&e.prototype instanceof v?e:v,r=Object.create(s.prototype),o=new C(i||[]);return r._invoke=function(t,e,n){var i=h;return function(s,r){if(i===d)throw new Error("Generator is already running");if(i===f){if("throw"===s)throw r;return D()}for(n.method=s,n.arg=r;;){var o=n.delegate;if(o){var a=k(o,n);if(a){if(a===m)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===h)throw i=f,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=d;var c=l(t,e,n);if("normal"===c.type){if(i=n.done?f:p,c.arg===m)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(i=f,n.method="throw",n.arg=c.arg)}}}(t,n,o),r}function l(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=u;var h="suspendedStart",p="suspendedYield",d="executing",f="completed",m={};function v(){}function g(){}function y(){}var _={};_[r]=function(){return this};var b=Object.getPrototypeOf,x=b&&b(b(A([])));x&&x!==n&&i.call(x,r)&&(_=x);var w=y.prototype=v.prototype=Object.create(_);function T(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function n(s,r,o,a){var c=l(t[s],t,r);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==typeof h&&i.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,o,a)}),(function(t){n("throw",t,o,a)})):e.resolve(h).then((function(t){u.value=t,o(u)}),(function(t){return n("throw",t,o,a)}))}a(c.arg)}var s;this._invoke=function(t,i){function r(){return new e((function(e,s){n(t,i,e,s)}))}return s=s?s.then(r,r):r()}}function k(t,n){var i=t.iterator[n.method];if(i===e){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=e,k(t,n),"throw"===n.method))return m;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var s=l(i,t.iterator,n.arg);if("throw"===s.type)return n.method="throw",n.arg=s.arg,n.delegate=null,m;var r=s.arg;return r?r.done?(n[t.resultName]=r.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,m):r:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function E(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function A(t){if(t){var n=t[r];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var s=-1,o=function n(){for(;++s<t.length;)if(i.call(t,s))return n.value=t[s],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}return{next:D}}function D(){return{value:e,done:!0}}return g.prototype=w.constructor=y,y.constructor=g,g.displayName=c(y,a,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,c(t,a,"GeneratorFunction")),t.prototype=Object.create(w),t},t.awrap=function(t){return{__await:t}},T(S.prototype),S.prototype[o]=function(){return this},t.AsyncIterator=S,t.async=function(e,n,i,s,r){void 0===r&&(r=Promise);var o=new S(u(e,n,i,s),r);return t.isGeneratorFunction(n)?o:o.next().then((function(t){return t.done?t.value:o.next()}))},T(w),c(w,a,"Generator"),w[r]=function(){return this},w.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var i=e.pop();if(i in t)return n.value=i,n.done=!1,n}return n.done=!0,n}},t.values=A,C.prototype={constructor:C,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(E),!t)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function s(i,s){return a.type="throw",a.arg=t,n.next=i,s&&(n.method="next",n.arg=e),!!s}for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r],a=o.completion;if("root"===o.tryLoc)return s("end");if(o.tryLoc<=this.prev){var c=i.call(o,"catchLoc"),u=i.call(o,"finallyLoc");if(c&&u){if(this.prev<o.catchLoc)return s(o.catchLoc,!0);if(this.prev<o.finallyLoc)return s(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return s(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return s(o.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var s=this.tryEntries[n];if(s.tryLoc<=this.prev&&i.call(s,"finallyLoc")&&this.prev<s.finallyLoc){var r=s;break}}r&&("break"===t||"continue"===t)&&r.tryLoc<=e&&e<=r.finallyLoc&&(r=null);var o=r?r.completion:{};return o.type=t,o.arg=e,r?(this.method="next",this.next=r.finallyLoc,m):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),E(n),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var i=n.completion;if("throw"===i.type){var s=i.arg;E(n)}return s}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,i){return this.delegate={iterator:A(t),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=e),m}},t}(t.exports);try{regeneratorRuntime=e}catch(t){Function("r","regeneratorRuntime = r")(e)}},4143:(t,e,n)=>{"use strict";n.r(e),n.d(e,{ArgumentOutOfRangeError:()=>D.W,AsyncSubject:()=>l.c,BehaviorSubject:()=>c.X,ConnectableObservable:()=>s.c,EMPTY:()=>Q.E,EmptyError:()=>M.K,GroupedObservable:()=>r.T,NEVER:()=>ht,Notification:()=>k.P,NotificationKind:()=>k.W,ObjectUnsubscribedError:()=>I.N,Observable:()=>i.y,ReplaySubject:()=>u.t,Scheduler:()=>w.b,Subject:()=>a.xQ,Subscriber:()=>S.L,Subscription:()=>T.w,TimeoutError:()=>R.W,UnsubscriptionError:()=>P.B,VirtualAction:()=>x,VirtualTimeScheduler:()=>b,animationFrame:()=>_,animationFrameScheduler:()=>y,asap:()=>h.e,asapScheduler:()=>h.E,async:()=>p.P,asyncScheduler:()=>p.z,bindCallback:()=>F,bindNodeCallback:()=>B,combineLatest:()=>Y.aj,concat:()=>G.z,config:()=>At.v,defer:()=>X.P,empty:()=>Q.c,forkJoin:()=>K,from:()=>$.D,fromEvent:()=>et,fromEventPattern:()=>it,generate:()=>st,identity:()=>C.y,iif:()=>ot,interval:()=>ct,isObservable:()=>A,merge:()=>lt.T,never:()=>pt,noop:()=>E.Z,observable:()=>o.L,of:()=>dt.of,onErrorResumeNext:()=>ft,pairs:()=>mt,partition:()=>bt,pipe:()=>O.z,queue:()=>d.c,queueScheduler:()=>d.N,race:()=>xt.S3,range:()=>wt,scheduled:()=>Ct.x,throwError:()=>St._,timer:()=>kt.H,using:()=>Ot,zip:()=>Et.$R});var i=n(2772),s=n(3140),r=n(1120),o=n(5050),a=n(211),c=n(9233),u=n(2630),l=n(364),h=n(6650),p=n(964),d=n(2546),f=n(655),m=n(6114),v=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.scheduler=e,i.work=n,i}return f.ZT(e,t),e.prototype.requestAsyncId=function(e,n,i){return void 0===i&&(i=0),null!==i&&i>0?t.prototype.requestAsyncId.call(this,e,n,i):(e.actions.push(this),e.scheduled||(e.scheduled=requestAnimationFrame((function(){return e.flush(null)}))))},e.prototype.recycleAsyncId=function(e,n,i){if(void 0===i&&(i=0),null!==i&&i>0||null===i&&this.delay>0)return t.prototype.recycleAsyncId.call(this,e,n,i);0===e.actions.length&&(cancelAnimationFrame(n),e.scheduled=void 0)},e}(m.o),g=n(8399),y=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return f.ZT(e,t),e.prototype.flush=function(t){this.active=!0,this.scheduled=void 0;var e,n=this.actions,i=-1,s=n.length;t=t||n.shift();do{if(e=t.execute(t.state,t.delay))break}while(++i<s&&(t=n.shift()));if(this.active=!1,e){for(;++i<s&&(t=n.shift());)t.unsubscribe();throw e}},e}(g.v))(v),_=y,b=function(t){function e(e,n){void 0===e&&(e=x),void 0===n&&(n=Number.POSITIVE_INFINITY);var i=t.call(this,e,(function(){return i.frame}))||this;return i.maxFrames=n,i.frame=0,i.index=-1,i}return f.ZT(e,t),e.prototype.flush=function(){for(var t,e,n=this.actions,i=this.maxFrames;(e=n[0])&&e.delay<=i&&(n.shift(),this.frame=e.delay,!(t=e.execute(e.state,e.delay))););if(t){for(;e=n.shift();)e.unsubscribe();throw t}},e.frameTimeFactor=10,e}(g.v),x=function(t){function e(e,n,i){void 0===i&&(i=e.index+=1);var s=t.call(this,e,n)||this;return s.scheduler=e,s.work=n,s.index=i,s.active=!0,s.index=e.index=i,s}return f.ZT(e,t),e.prototype.schedule=function(n,i){if(void 0===i&&(i=0),!this.id)return t.prototype.schedule.call(this,n,i);this.active=!1;var s=new e(this.scheduler,this.work);return this.add(s),s.schedule(n,i)},e.prototype.requestAsyncId=function(t,n,i){void 0===i&&(i=0),this.delay=t.frame+i;var s=t.actions;return s.push(this),s.sort(e.sortActions),!0},e.prototype.recycleAsyncId=function(t,e,n){void 0===n&&(n=0)},e.prototype._execute=function(e,n){if(!0===this.active)return t.prototype._execute.call(this,e,n)},e.sortActions=function(t,e){return t.delay===e.delay?t.index===e.index?0:t.index>e.index?1:-1:t.delay>e.delay?1:-1},e}(m.o),w=n(8725),T=n(8760),S=n(979),k=n(2632),O=n(2561),E=n(3306),C=n(3608);function A(t){return!!t&&(t instanceof i.y||"function"==typeof t.lift&&"function"==typeof t.subscribe)}var D=n(6565),M=n(6929),I=n(1016),P=n(8782),R=n(1462),j=n(5709),q=n(3642),N=n(9026),V=n(7507);function F(t,e,n){if(e){if(!(0,V.K)(e))return function(){for(var i=[],s=0;s<arguments.length;s++)i[s]=arguments[s];return F(t,n).apply(void 0,i).pipe((0,j.U)((function(t){return(0,N.k)(t)?e.apply(void 0,t):e(t)})))};n=e}return function(){for(var e=[],s=0;s<arguments.length;s++)e[s]=arguments[s];var r,o=this,a={context:o,subject:r,callbackFunc:t,scheduler:n};return new i.y((function(i){if(n){var s={args:e,subscriber:i,params:a};return n.schedule(L,0,s)}if(!r){r=new l.c;try{t.apply(o,e.concat([function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];r.next(t.length<=1?t[0]:t),r.complete()}]))}catch(t){(0,q._)(r)?r.error(t):console.warn(t)}}return r.subscribe(i)}))}}function L(t){var e=this,n=t.args,i=t.subscriber,s=t.params,r=s.callbackFunc,o=s.context,a=s.scheduler,c=s.subject;if(!c){c=s.subject=new l.c;try{r.apply(o,n.concat([function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i=t.length<=1?t[0]:t;e.add(a.schedule(z,0,{value:i,subject:c}))}]))}catch(t){c.error(t)}}this.add(c.subscribe(i))}function z(t){var e=t.value,n=t.subject;n.next(e),n.complete()}function B(t,e,n){if(e){if(!(0,V.K)(e))return function(){for(var i=[],s=0;s<arguments.length;s++)i[s]=arguments[s];return B(t,n).apply(void 0,i).pipe((0,j.U)((function(t){return(0,N.k)(t)?e.apply(void 0,t):e(t)})))};n=e}return function(){for(var e=[],s=0;s<arguments.length;s++)e[s]=arguments[s];var r={subject:void 0,args:e,callbackFunc:t,scheduler:n,context:this};return new i.y((function(i){var s=r.context,o=r.subject;if(n)return n.schedule(W,0,{params:r,subscriber:i,context:s});if(!o){o=r.subject=new l.c;try{t.apply(s,e.concat([function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t.shift();n?o.error(n):(o.next(t.length<=1?t[0]:t),o.complete())}]))}catch(t){(0,q._)(o)?o.error(t):console.warn(t)}}return o.subscribe(i)}))}}function W(t){var e=this,n=t.params,i=t.subscriber,s=t.context,r=n.callbackFunc,o=n.args,a=n.scheduler,c=n.subject;if(!c){c=n.subject=new l.c;try{r.apply(s,o.concat([function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var i=t.shift();if(i)e.add(a.schedule(U,0,{err:i,subject:c}));else{var s=t.length<=1?t[0]:t;e.add(a.schedule(Z,0,{value:s,subject:c}))}}]))}catch(t){this.add(a.schedule(U,0,{err:t,subject:c}))}}this.add(c.subscribe(i))}function Z(t){var e=t.value,n=t.subject;n.next(e),n.complete()}function U(t){var e=t.err;t.subject.error(e)}var Y=n(5142),G=n(9795),X=n(1410),Q=n(5631),H=n(2009),$=n(5760);function K(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(1===t.length){var n=t[0];if((0,N.k)(n))return J(n,null);if((0,H.K)(n)&&Object.getPrototypeOf(n)===Object.prototype){var i=Object.keys(n);return J(i.map((function(t){return n[t]})),i)}}if("function"==typeof t[t.length-1]){var s=t.pop();return J(t=1===t.length&&(0,N.k)(t[0])?t[0]:t,null).pipe((0,j.U)((function(t){return s.apply(void 0,t)})))}return J(t,null)}function J(t,e){return new i.y((function(n){var i=t.length;if(0!==i)for(var s=new Array(i),r=0,o=0,a=function(a){var c=(0,$.D)(t[a]),u=!1;n.add(c.subscribe({next:function(t){u||(u=!0,o++),s[a]=t},error:function(t){return n.error(t)},complete:function(){++r!==i&&u||(o===i&&n.next(e?e.reduce((function(t,e,n){return t[e]=s[n],t}),{}):s),n.complete())}}))},c=0;c<i;c++)a(c);else n.complete()}))}var tt=n(4156);function et(t,e,n,s){return(0,tt.m)(n)&&(s=n,n=void 0),s?et(t,e,n).pipe((0,j.U)((function(t){return(0,N.k)(t)?s.apply(void 0,t):s(t)}))):new i.y((function(i){nt(t,e,(function(t){arguments.length>1?i.next(Array.prototype.slice.call(arguments)):i.next(t)}),i,n)}))}function nt(t,e,n,i,s){var r;if(function(t){return t&&"function"==typeof t.addEventListener&&"function"==typeof t.removeEventListener}(t)){var o=t;t.addEventListener(e,n,s),r=function(){return o.removeEventListener(e,n,s)}}else if(function(t){return t&&"function"==typeof t.on&&"function"==typeof t.off}(t)){var a=t;t.on(e,n),r=function(){return a.off(e,n)}}else if(function(t){return t&&"function"==typeof t.addListener&&"function"==typeof t.removeListener}(t)){var c=t;t.addListener(e,n),r=function(){return c.removeListener(e,n)}}else{if(!t||!t.length)throw new TypeError("Invalid event target");for(var u=0,l=t.length;u<l;u++)nt(t[u],e,n,i,s)}i.add(r)}function it(t,e,n){return n?it(t,e).pipe((0,j.U)((function(t){return(0,N.k)(t)?n.apply(void 0,t):n(t)}))):new i.y((function(n){var i,s=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return n.next(1===t.length?t[0]:t)};try{i=t(s)}catch(t){return void n.error(t)}if((0,tt.m)(e))return function(){return e(s,i)}}))}function st(t,e,n,s,r){var o,a;if(1==arguments.length){var c=t;a=c.initialState,e=c.condition,n=c.iterate,o=c.resultSelector||C.y,r=c.scheduler}else void 0===s||(0,V.K)(s)?(a=t,o=C.y,r=s):(a=t,o=s);return new i.y((function(t){var i=a;if(r)return r.schedule(rt,0,{subscriber:t,iterate:n,condition:e,resultSelector:o,state:i});for(;;){if(e){var s=void 0;try{s=e(i)}catch(e){return void t.error(e)}if(!s){t.complete();break}}var c=void 0;try{c=o(i)}catch(e){return void t.error(e)}if(t.next(c),t.closed)break;try{i=n(i)}catch(e){return void t.error(e)}}}))}function rt(t){var e=t.subscriber,n=t.condition;if(!e.closed){if(t.needIterate)try{t.state=t.iterate(t.state)}catch(t){return void e.error(t)}else t.needIterate=!0;if(n){var i=void 0;try{i=n(t.state)}catch(t){return void e.error(t)}if(!i)return void e.complete();if(e.closed)return}var s;try{s=t.resultSelector(t.state)}catch(t){return void e.error(t)}if(!e.closed&&(e.next(s),!e.closed))return this.schedule(t)}}function ot(t,e,n){return void 0===e&&(e=Q.E),void 0===n&&(n=Q.E),(0,X.P)((function(){return t()?e:n}))}var at=n(5812);function ct(t,e){return void 0===t&&(t=0),void 0===e&&(e=p.P),(!(0,at.k)(t)||t<0)&&(t=0),e&&"function"==typeof e.schedule||(e=p.P),new i.y((function(n){return n.add(e.schedule(ut,t,{subscriber:n,counter:0,period:t})),n}))}function ut(t){var e=t.subscriber,n=t.counter,i=t.period;e.next(n),this.schedule({subscriber:e,counter:n+1,period:i},i)}var lt=n(4370),ht=new i.y(E.Z);function pt(){return ht}var dt=n(8170);function ft(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(0===t.length)return Q.E;var n=t[0],s=t.slice(1);return 1===t.length&&(0,N.k)(n)?ft.apply(void 0,n):new i.y((function(t){var e=function(){return t.add(ft.apply(void 0,s).subscribe(t))};return(0,$.D)(n).subscribe({next:function(e){t.next(e)},error:e,complete:e})}))}function mt(t,e){return e?new i.y((function(n){var i=Object.keys(t),s=new T.w;return s.add(e.schedule(vt,0,{keys:i,index:0,subscriber:n,subscription:s,obj:t})),s})):new i.y((function(e){for(var n=Object.keys(t),i=0;i<n.length&&!e.closed;i++){var s=n[i];t.hasOwnProperty(s)&&e.next([s,t[s]])}e.complete()}))}function vt(t){var e=t.keys,n=t.index,i=t.subscriber,s=t.subscription,r=t.obj;if(!i.closed)if(n<e.length){var o=e[n];i.next([o,r[o]]),s.add(this.schedule({keys:e,index:n+1,subscriber:i,subscription:s,obj:r}))}else i.complete()}var gt=n(8463),yt=n(7843),_t=n(6008);function bt(t,e,n){return[(0,_t.h)(e,n)(new i.y((0,yt.s)(t))),(0,_t.h)((0,gt.f)(e,n))(new i.y((0,yt.s)(t)))]}var xt=n(8821);function wt(t,e,n){return void 0===t&&(t=0),new i.y((function(i){void 0===e&&(e=t,t=0);var s=0,r=t;if(n)return n.schedule(Tt,0,{index:s,count:e,start:t,subscriber:i});for(;;){if(s++>=e){i.complete();break}if(i.next(r++),i.closed)break}}))}function Tt(t){var e=t.start,n=t.index,i=t.count,s=t.subscriber;n>=i?s.complete():(s.next(e),s.closed||(t.index=n+1,t.start=e+1,this.schedule(t)))}var St=n(4944),kt=n(9604);function Ot(t,e){return new i.y((function(n){var i,s;try{i=t()}catch(t){return void n.error(t)}try{s=e(i)}catch(t){return void n.error(t)}var r=(s?(0,$.D)(s):Q.E).subscribe(n);return function(){r.unsubscribe(),i&&i.unsubscribe()}}))}var Et=n(5080),Ct=n(8107),At=n(150)},364:(t,e,n)=>{"use strict";n.d(e,{c:()=>o});var i=n(655),s=n(211),r=n(8760),o=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.value=null,e.hasNext=!1,e.hasCompleted=!1,e}return i.ZT(e,t),e.prototype._subscribe=function(e){return this.hasError?(e.error(this.thrownError),r.w.EMPTY):this.hasCompleted&&this.hasNext?(e.next(this.value),e.complete(),r.w.EMPTY):t.prototype._subscribe.call(this,e)},e.prototype.next=function(t){this.hasCompleted||(this.value=t,this.hasNext=!0)},e.prototype.error=function(e){this.hasCompleted||t.prototype.error.call(this,e)},e.prototype.complete=function(){this.hasCompleted=!0,this.hasNext&&t.prototype.next.call(this,this.value),t.prototype.complete.call(this)},e}(s.xQ)},9233:(t,e,n)=>{"use strict";n.d(e,{X:()=>o});var i=n(655),s=n(211),r=n(1016),o=function(t){function e(e){var n=t.call(this)||this;return n._value=e,n}return i.ZT(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),e.prototype._subscribe=function(e){var n=t.prototype._subscribe.call(this,e);return n&&!n.closed&&e.next(this._value),n},e.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new r.N;return this._value},e.prototype.next=function(e){t.prototype.next.call(this,this._value=e)},e}(s.xQ)},2632:(t,e,n)=>{"use strict";n.d(e,{W:()=>i,P:()=>a});var i,s=n(5631),r=n(8170),o=n(4944);i||(i={});var a=function(){function t(t,e,n){this.kind=t,this.value=e,this.error=n,this.hasValue="N"===t}return t.prototype.observe=function(t){switch(this.kind){case"N":return t.next&&t.next(this.value);case"E":return t.error&&t.error(this.error);case"C":return t.complete&&t.complete()}},t.prototype.do=function(t,e,n){switch(this.kind){case"N":return t&&t(this.value);case"E":return e&&e(this.error);case"C":return n&&n()}},t.prototype.accept=function(t,e,n){return t&&"function"==typeof t.next?this.observe(t):this.do(t,e,n)},t.prototype.toObservable=function(){switch(this.kind){case"N":return(0,r.of)(this.value);case"E":return(0,o._)(this.error);case"C":return(0,s.c)()}throw new Error("unexpected notification kind value")},t.createNext=function(e){return void 0!==e?new t("N",e):t.undefinedValueNotification},t.createError=function(e){return new t("E",void 0,e)},t.createComplete=function(){return t.completeNotification},t.completeNotification=new t("C"),t.undefinedValueNotification=new t("N",void 0),t}()},2772:(t,e,n)=>{"use strict";n.d(e,{y:()=>l});var i=n(3642),s=n(979),r=n(3142),o=n(2174),a=n(5050),c=n(2561),u=n(150),l=function(){function t(t){this._isScalar=!1,t&&(this._subscribe=t)}return t.prototype.lift=function(e){var n=new t;return n.source=this,n.operator=e,n},t.prototype.subscribe=function(t,e,n){var i=this.operator,a=function(t,e,n){if(t){if(t instanceof s.L)return t;if(t[r.b])return t[r.b]()}return t||e||n?new s.L(t,e,n):new s.L(o.c)}(t,e,n);if(i?a.add(i.call(a,this.source)):a.add(this.source||u.v.useDeprecatedSynchronousErrorHandling&&!a.syncErrorThrowable?this._subscribe(a):this._trySubscribe(a)),u.v.useDeprecatedSynchronousErrorHandling&&a.syncErrorThrowable&&(a.syncErrorThrowable=!1,a.syncErrorThrown))throw a.syncErrorValue;return a},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){u.v.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),(0,i._)(t)?t.error(e):console.warn(e)}},t.prototype.forEach=function(t,e){var n=this;return new(e=h(e))((function(e,i){var s;s=n.subscribe((function(e){try{t(e)}catch(t){i(t),s&&s.unsubscribe()}}),i,e)}))},t.prototype._subscribe=function(t){var e=this.source;return e&&e.subscribe(t)},t.prototype[a.L]=function(){return this},t.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 0===t.length?this:(0,c.U)(t)(this)},t.prototype.toPromise=function(t){var e=this;return new(t=h(t))((function(t,n){var i;e.subscribe((function(t){return i=t}),(function(t){return n(t)}),(function(){return t(i)}))}))},t.create=function(e){return new t(e)},t}();function h(t){if(t||(t=u.v.Promise||Promise),!t)throw new Error("no Promise impl found");return t}},2174:(t,e,n)=>{"use strict";n.d(e,{c:()=>r});var i=n(150),s=n(1644),r={closed:!0,next:function(t){},error:function(t){if(i.v.useDeprecatedSynchronousErrorHandling)throw t;(0,s.z)(t)},complete:function(){}}},2039:(t,e,n)=>{"use strict";n.d(e,{L:()=>s});var i=n(655),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i.ZT(e,t),e.prototype.notifyNext=function(t,e,n,i,s){this.destination.next(e)},e.prototype.notifyError=function(t,e){this.destination.error(t)},e.prototype.notifyComplete=function(t){this.destination.complete()},e}(n(979).L)},2630:(t,e,n)=>{"use strict";n.d(e,{t:()=>l});var i=n(655),s=n(211),r=n(2546),o=n(8760),a=n(9276),c=n(1016),u=n(8253),l=function(t){function e(e,n,i){void 0===e&&(e=Number.POSITIVE_INFINITY),void 0===n&&(n=Number.POSITIVE_INFINITY);var s=t.call(this)||this;return s.scheduler=i,s._events=[],s._infiniteTimeWindow=!1,s._bufferSize=e<1?1:e,s._windowTime=n<1?1:n,n===Number.POSITIVE_INFINITY?(s._infiniteTimeWindow=!0,s.next=s.nextInfiniteTimeWindow):s.next=s.nextTimeWindow,s}return i.ZT(e,t),e.prototype.nextInfiniteTimeWindow=function(e){if(!this.isStopped){var n=this._events;n.push(e),n.length>this._bufferSize&&n.shift()}t.prototype.next.call(this,e)},e.prototype.nextTimeWindow=function(e){this.isStopped||(this._events.push(new h(this._getNow(),e)),this._trimBufferThenGetEvents()),t.prototype.next.call(this,e)},e.prototype._subscribe=function(t){var e,n=this._infiniteTimeWindow,i=n?this._events:this._trimBufferThenGetEvents(),s=this.scheduler,r=i.length;if(this.closed)throw new c.N;if(this.isStopped||this.hasError?e=o.w.EMPTY:(this.observers.push(t),e=new u.W(this,t)),s&&t.add(t=new a.ht(t,s)),n)for(var l=0;l<r&&!t.closed;l++)t.next(i[l]);else for(l=0;l<r&&!t.closed;l++)t.next(i[l].value);return this.hasError?t.error(this.thrownError):this.isStopped&&t.complete(),e},e.prototype._getNow=function(){return(this.scheduler||r.c).now()},e.prototype._trimBufferThenGetEvents=function(){for(var t=this._getNow(),e=this._bufferSize,n=this._windowTime,i=this._events,s=i.length,r=0;r<s&&!(t-i[r].time<n);)r++;return s>e&&(r=Math.max(r,s-e)),r>0&&i.splice(0,r),i},e}(s.xQ),h=function(){return function(t,e){this.time=t,this.value=e}}()},8725:(t,e,n)=>{"use strict";n.d(e,{b:()=>i});var i=function(){function t(e,n){void 0===n&&(n=t.now),this.SchedulerAction=e,this.now=n}return t.prototype.schedule=function(t,e,n){return void 0===e&&(e=0),new this.SchedulerAction(this,t).schedule(n,e)},t.now=function(){return Date.now()},t}()},211:(t,e,n)=>{"use strict";n.d(e,{Yc:()=>l,xQ:()=>h});var i=n(655),s=n(2772),r=n(979),o=n(8760),a=n(1016),c=n(8253),u=n(3142),l=function(t){function e(e){var n=t.call(this,e)||this;return n.destination=e,n}return i.ZT(e,t),e}(r.L),h=function(t){function e(){var e=t.call(this)||this;return e.observers=[],e.closed=!1,e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return i.ZT(e,t),e.prototype[u.b]=function(){return new l(this)},e.prototype.lift=function(t){var e=new p(this,this);return e.operator=t,e},e.prototype.next=function(t){if(this.closed)throw new a.N;if(!this.isStopped)for(var e=this.observers,n=e.length,i=e.slice(),s=0;s<n;s++)i[s].next(t)},e.prototype.error=function(t){if(this.closed)throw new a.N;this.hasError=!0,this.thrownError=t,this.isStopped=!0;for(var e=this.observers,n=e.length,i=e.slice(),s=0;s<n;s++)i[s].error(t);this.observers.length=0},e.prototype.complete=function(){if(this.closed)throw new a.N;this.isStopped=!0;for(var t=this.observers,e=t.length,n=t.slice(),i=0;i<e;i++)n[i].complete();this.observers.length=0},e.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},e.prototype._trySubscribe=function(e){if(this.closed)throw new a.N;return t.prototype._trySubscribe.call(this,e)},e.prototype._subscribe=function(t){if(this.closed)throw new a.N;return this.hasError?(t.error(this.thrownError),o.w.EMPTY):this.isStopped?(t.complete(),o.w.EMPTY):(this.observers.push(t),new c.W(this,t))},e.prototype.asObservable=function(){var t=new s.y;return t.source=this,t},e.create=function(t,e){return new p(t,e)},e}(s.y),p=function(t){function e(e,n){var i=t.call(this)||this;return i.destination=e,i.source=n,i}return i.ZT(e,t),e.prototype.next=function(t){var e=this.destination;e&&e.next&&e.next(t)},e.prototype.error=function(t){var e=this.destination;e&&e.error&&this.destination.error(t)},e.prototype.complete=function(){var t=this.destination;t&&t.complete&&this.destination.complete()},e.prototype._subscribe=function(t){return this.source?this.source.subscribe(t):o.w.EMPTY},e}(h)},8253:(t,e,n)=>{"use strict";n.d(e,{W:()=>s});var i=n(655),s=function(t){function e(e,n){var i=t.call(this)||this;return i.subject=e,i.subscriber=n,i.closed=!1,i}return i.ZT(e,t),e.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var t=this.subject,e=t.observers;if(this.subject=null,e&&0!==e.length&&!t.isStopped&&!t.closed){var n=e.indexOf(this.subscriber);-1!==n&&e.splice(n,1)}}},e}(n(8760).w)},979:(t,e,n)=>{"use strict";n.d(e,{L:()=>l});var i=n(655),s=n(4156),r=n(2174),o=n(8760),a=n(3142),c=n(150),u=n(1644),l=function(t){function e(n,i,s){var o=t.call(this)||this;switch(o.syncErrorValue=null,o.syncErrorThrown=!1,o.syncErrorThrowable=!1,o.isStopped=!1,arguments.length){case 0:o.destination=r.c;break;case 1:if(!n){o.destination=r.c;break}if("object"==typeof n){n instanceof e?(o.syncErrorThrowable=n.syncErrorThrowable,o.destination=n,n.add(o)):(o.syncErrorThrowable=!0,o.destination=new h(o,n));break}default:o.syncErrorThrowable=!0,o.destination=new h(o,n,i,s)}return o}return i.ZT(e,t),e.prototype[a.b]=function(){return this},e.create=function(t,n,i){var s=new e(t,n,i);return s.syncErrorThrowable=!1,s},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this))},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){this.destination.error(t),this.unsubscribe()},e.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},e.prototype._unsubscribeAndRecycle=function(){var t=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=t,this},e}(o.w),h=function(t){function e(e,n,i,o){var a,c=t.call(this)||this;c._parentSubscriber=e;var u=c;return(0,s.m)(n)?a=n:n&&(a=n.next,i=n.error,o=n.complete,n!==r.c&&(u=Object.create(n),(0,s.m)(u.unsubscribe)&&c.add(u.unsubscribe.bind(u)),u.unsubscribe=c.unsubscribe.bind(c))),c._context=u,c._next=a,c._error=i,c._complete=o,c}return i.ZT(e,t),e.prototype.next=function(t){if(!this.isStopped&&this._next){var e=this._parentSubscriber;c.v.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}},e.prototype.error=function(t){if(!this.isStopped){var e=this._parentSubscriber,n=c.v.useDeprecatedSynchronousErrorHandling;if(this._error)n&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)n?(e.syncErrorValue=t,e.syncErrorThrown=!0):(0,u.z)(t),this.unsubscribe();else{if(this.unsubscribe(),n)throw t;(0,u.z)(t)}}},e.prototype.complete=function(){var t=this;if(!this.isStopped){var e=this._parentSubscriber;if(this._complete){var n=function(){return t._complete.call(t._context)};c.v.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}},e.prototype.__tryOrUnsub=function(t,e){try{t.call(this._context,e)}catch(t){if(this.unsubscribe(),c.v.useDeprecatedSynchronousErrorHandling)throw t;(0,u.z)(t)}},e.prototype.__tryOrSetError=function(t,e,n){if(!c.v.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,n)}catch(e){return c.v.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=e,t.syncErrorThrown=!0,!0):((0,u.z)(e),!0)}return!1},e.prototype._unsubscribe=function(){var t=this._parentSubscriber;this._context=null,this._parentSubscriber=null,t.unsubscribe()},e}(l)},8760:(t,e,n)=>{"use strict";n.d(e,{w:()=>a});var i=n(9026),s=n(2009),r=n(4156),o=n(8782),a=function(){function t(t){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._ctorUnsubscribe=!0,this._unsubscribe=t)}var e;return t.prototype.unsubscribe=function(){var e;if(!this.closed){var n=this,a=n._parentOrParents,u=n._ctorUnsubscribe,l=n._unsubscribe,h=n._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,a instanceof t)a.remove(this);else if(null!==a)for(var p=0;p<a.length;++p)a[p].remove(this);if((0,r.m)(l)){u&&(this._unsubscribe=void 0);try{l.call(this)}catch(t){e=t instanceof o.B?c(t.errors):[t]}}if((0,i.k)(h)){p=-1;for(var d=h.length;++p<d;){var f=h[p];if((0,s.K)(f))try{f.unsubscribe()}catch(t){e=e||[],t instanceof o.B?e=e.concat(c(t.errors)):e.push(t)}}}if(e)throw new o.B(e)}},t.prototype.add=function(e){var n=e;if(!e)return t.EMPTY;switch(typeof e){case"function":n=new t(e);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof t)){var i=n;(n=new t)._subscriptions=[i]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}var s=n._parentOrParents;if(null===s)n._parentOrParents=this;else if(s instanceof t){if(s===this)return n;n._parentOrParents=[s,this]}else{if(-1!==s.indexOf(this))return n;s.push(this)}var r=this._subscriptions;return null===r?this._subscriptions=[n]:r.push(n),n},t.prototype.remove=function(t){var e=this._subscriptions;if(e){var n=e.indexOf(t);-1!==n&&e.splice(n,1)}},t.EMPTY=((e=new t).closed=!0,e),t}();function c(t){return t.reduce((function(t,e){return t.concat(e instanceof o.B?e.errors:e)}),[])}},150:(t,e,n)=>{"use strict";n.d(e,{v:()=>s});var i=!1,s={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){t&&(new Error).stack,i=t},get useDeprecatedSynchronousErrorHandling(){return i}}},7604:(t,e,n)=>{"use strict";n.d(e,{IY:()=>a,Ds:()=>c,ft:()=>u});var i=n(655),s=n(979),r=n(2772),o=n(7843),a=function(t){function e(e){var n=t.call(this)||this;return n.parent=e,n}return i.ZT(e,t),e.prototype._next=function(t){this.parent.notifyNext(t)},e.prototype._error=function(t){this.parent.notifyError(t),this.unsubscribe()},e.prototype._complete=function(){this.parent.notifyComplete(),this.unsubscribe()},e}(s.L),c=(s.L,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i.ZT(e,t),e.prototype.notifyNext=function(t){this.destination.next(t)},e.prototype.notifyError=function(t){this.destination.error(t)},e.prototype.notifyComplete=function(){this.destination.complete()},e}(s.L));function u(t,e){if(!e.closed){if(t instanceof r.y)return t.subscribe(e);var n;try{n=(0,o.s)(t)(e)}catch(t){e.error(t)}return n}}s.L},3140:(t,e,n)=>{"use strict";n.d(e,{c:()=>u,N:()=>l});var i=n(655),s=n(211),r=n(2772),o=n(979),a=n(8760),c=n(3018),u=function(t){function e(e,n){var i=t.call(this)||this;return i.source=e,i.subjectFactory=n,i._refCount=0,i._isComplete=!1,i}return i.ZT(e,t),e.prototype._subscribe=function(t){return this.getSubject().subscribe(t)},e.prototype.getSubject=function(){var t=this._subject;return t&&!t.isStopped||(this._subject=this.subjectFactory()),this._subject},e.prototype.connect=function(){var t=this._connection;return t||(this._isComplete=!1,(t=this._connection=new a.w).add(this.source.subscribe(new h(this.getSubject(),this))),t.closed&&(this._connection=null,t=a.w.EMPTY)),t},e.prototype.refCount=function(){return(0,c.x)()(this)},e}(r.y),l=function(){var t=u.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:t._subscribe},_isComplete:{value:t._isComplete,writable:!0},getSubject:{value:t.getSubject},connect:{value:t.connect},refCount:{value:t.refCount}}}(),h=function(t){function e(e,n){var i=t.call(this,e)||this;return i.connectable=n,i}return i.ZT(e,t),e.prototype._error=function(e){this._unsubscribe(),t.prototype._error.call(this,e)},e.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),t.prototype._complete.call(this)},e.prototype._unsubscribe=function(){var t=this.connectable;if(t){this.connectable=null;var e=t._connection;t._refCount=0,t._subject=null,t._connection=null,e&&e.unsubscribe()}},e}(s.Yc);o.L},5142:(t,e,n)=>{"use strict";n.d(e,{aj:()=>l,Ms:()=>h});var i=n(655),s=n(7507),r=n(9026),o=n(2039),a=n(2080),c=n(3375),u={};function l(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=void 0,i=void 0;return(0,s.K)(t[t.length-1])&&(i=t.pop()),"function"==typeof t[t.length-1]&&(n=t.pop()),1===t.length&&(0,r.k)(t[0])&&(t=t[0]),(0,c.n)(t,i).lift(new h(n))}var h=function(){function t(t){this.resultSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new p(t,this.resultSelector))},t}(),p=function(t){function e(e,n){var i=t.call(this,e)||this;return i.resultSelector=n,i.active=0,i.values=[],i.observables=[],i}return i.ZT(e,t),e.prototype._next=function(t){this.values.push(u),this.observables.push(t)},e.prototype._complete=function(){var t=this.observables,e=t.length;if(0===e)this.destination.complete();else{this.active=e,this.toRespond=e;for(var n=0;n<e;n++){var i=t[n];this.add((0,a.D)(this,i,void 0,n))}}},e.prototype.notifyComplete=function(t){0==(this.active-=1)&&this.destination.complete()},e.prototype.notifyNext=function(t,e,n){var i=this.values,s=i[n],r=this.toRespond?s===u?--this.toRespond:this.toRespond:0;i[n]=e,0===r&&(this.resultSelector?this._tryResultSelector(i):this.destination.next(i.slice()))},e.prototype._tryResultSelector=function(t){var e;try{e=this.resultSelector.apply(this,t)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}(o.L)},9795:(t,e,n)=>{"use strict";n.d(e,{z:()=>r});var i=n(8170),s=n(2257);function r(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return(0,s.u)()(i.of.apply(void 0,t))}},1410:(t,e,n)=>{"use strict";n.d(e,{P:()=>o});var i=n(2772),s=n(5760),r=n(5631);function o(t){return new i.y((function(e){var n;try{n=t()}catch(t){return void e.error(t)}return(n?(0,s.D)(n):(0,r.c)()).subscribe(e)}))}},5631:(t,e,n)=>{"use strict";n.d(e,{E:()=>s,c:()=>r});var i=n(2772),s=new i.y((function(t){return t.complete()}));function r(t){return t?function(t){return new i.y((function(e){return t.schedule((function(){return e.complete()}))}))}(t):s}},5760:(t,e,n)=>{"use strict";n.d(e,{D:()=>o});var i=n(2772),s=n(7843),r=n(8107);function o(t,e){return e?(0,r.x)(t,e):t instanceof i.y?t:new i.y((0,s.s)(t))}},3375:(t,e,n)=>{"use strict";n.d(e,{n:()=>o});var i=n(2772),s=n(6900),r=n(3109);function o(t,e){return e?(0,r.r)(t,e):new i.y((0,s.V)(t))}},4370:(t,e,n)=>{"use strict";n.d(e,{T:()=>a});var i=n(2772),s=n(7507),r=n(2556),o=n(3375);function a(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=Number.POSITIVE_INFINITY,a=null,c=t[t.length-1];return(0,s.K)(c)?(a=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(n=t.pop())):"number"==typeof c&&(n=t.pop()),null===a&&1===t.length&&t[0]instanceof i.y?t[0]:(0,r.J)(n)((0,o.n)(t,a))}},8170:(t,e,n)=>{"use strict";n.d(e,{of:()=>o});var i=n(7507),s=n(3375),r=n(3109);function o(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t[t.length-1];return(0,i.K)(n)?(t.pop(),(0,r.r)(t,n)):(0,s.n)(t)}},8821:(t,e,n)=>{"use strict";n.d(e,{S3:()=>c});var i=n(655),s=n(9026),r=n(3375),o=n(2039),a=n(2080);function c(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(1===t.length){if(!(0,s.k)(t[0]))return t[0];t=t[0]}return(0,r.n)(t,void 0).lift(new u)}var u=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new l(t))},t}(),l=function(t){function e(e){var n=t.call(this,e)||this;return n.hasFirst=!1,n.observables=[],n.subscriptions=[],n}return i.ZT(e,t),e.prototype._next=function(t){this.observables.push(t)},e.prototype._complete=function(){var t=this.observables,e=t.length;if(0===e)this.destination.complete();else{for(var n=0;n<e&&!this.hasFirst;n++){var i=t[n],s=(0,a.D)(this,i,void 0,n);this.subscriptions&&this.subscriptions.push(s),this.add(s)}this.observables=null}},e.prototype.notifyNext=function(t,e,n){if(!this.hasFirst){this.hasFirst=!0;for(var i=0;i<this.subscriptions.length;i++)if(i!==n){var s=this.subscriptions[i];s.unsubscribe(),this.remove(s)}this.subscriptions=null}this.destination.next(e)},e}(o.L)},4944:(t,e,n)=>{"use strict";n.d(e,{_:()=>s});var i=n(2772);function s(t,e){return e?new i.y((function(n){return e.schedule(r,0,{error:t,subscriber:n})})):new i.y((function(e){return e.error(t)}))}function r(t){var e=t.error;t.subscriber.error(e)}},9604:(t,e,n)=>{"use strict";n.d(e,{H:()=>a});var i=n(2772),s=n(964),r=n(5812),o=n(7507);function a(t,e,n){void 0===t&&(t=0);var a=-1;return(0,r.k)(e)?a=Number(e)<1?1:Number(e):(0,o.K)(e)&&(n=e),(0,o.K)(n)||(n=s.P),new i.y((function(e){var i=(0,r.k)(t)?t:+t-n.now();return n.schedule(c,i,{index:0,period:a,subscriber:e})}))}function c(t){var e=t.index,n=t.period,i=t.subscriber;if(i.next(e),!i.closed){if(-1===n)return i.complete();t.index=e+1,this.schedule(t,n)}}},5080:(t,e,n)=>{"use strict";n.d(e,{$R:()=>u,mx:()=>l});var i=n(655),s=n(3375),r=n(9026),o=n(979),a=n(999),c=n(7604);function u(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t[t.length-1];return"function"==typeof n&&t.pop(),(0,s.n)(t,void 0).lift(new l(n))}var l=function(){function t(t){this.resultSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new h(t,this.resultSelector))},t}(),h=function(t){function e(e,n,i){void 0===i&&(i=Object.create(null));var s=t.call(this,e)||this;return s.resultSelector=n,s.iterators=[],s.active=0,s.resultSelector="function"==typeof n?n:void 0,s}return i.ZT(e,t),e.prototype._next=function(t){var e=this.iterators;(0,r.k)(t)?e.push(new d(t)):"function"==typeof t[a.hZ]?e.push(new p(t[a.hZ]())):e.push(new f(this.destination,this,t))},e.prototype._complete=function(){var t=this.iterators,e=t.length;if(this.unsubscribe(),0!==e){this.active=e;for(var n=0;n<e;n++){var i=t[n];i.stillUnsubscribed?this.destination.add(i.subscribe()):this.active--}}else this.destination.complete()},e.prototype.notifyInactive=function(){this.active--,0===this.active&&this.destination.complete()},e.prototype.checkIterators=function(){for(var t=this.iterators,e=t.length,n=this.destination,i=0;i<e;i++)if("function"==typeof(o=t[i]).hasValue&&!o.hasValue())return;var s=!1,r=[];for(i=0;i<e;i++){var o,a=(o=t[i]).next();if(o.hasCompleted()&&(s=!0),a.done)return void n.complete();r.push(a.value)}this.resultSelector?this._tryresultSelector(r):n.next(r),s&&n.complete()},e.prototype._tryresultSelector=function(t){var e;try{e=this.resultSelector.apply(this,t)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}(o.L),p=function(){function t(t){this.iterator=t,this.nextResult=t.next()}return t.prototype.hasValue=function(){return!0},t.prototype.next=function(){var t=this.nextResult;return this.nextResult=this.iterator.next(),t},t.prototype.hasCompleted=function(){var t=this.nextResult;return Boolean(t&&t.done)},t}(),d=function(){function t(t){this.array=t,this.index=0,this.length=0,this.length=t.length}return t.prototype[a.hZ]=function(){return this},t.prototype.next=function(t){var e=this.index++,n=this.array;return e<this.length?{value:n[e],done:!1}:{value:null,done:!0}},t.prototype.hasValue=function(){return this.array.length>this.index},t.prototype.hasCompleted=function(){return this.array.length===this.index},t}(),f=function(t){function e(e,n,i){var s=t.call(this,e)||this;return s.parent=n,s.observable=i,s.stillUnsubscribed=!0,s.buffer=[],s.isComplete=!1,s}return i.ZT(e,t),e.prototype[a.hZ]=function(){return this},e.prototype.next=function(){var t=this.buffer;return 0===t.length&&this.isComplete?{value:null,done:!0}:{value:t.shift(),done:!1}},e.prototype.hasValue=function(){return this.buffer.length>0},e.prototype.hasCompleted=function(){return 0===this.buffer.length&&this.isComplete},e.prototype.notifyComplete=function(){this.buffer.length>0?(this.isComplete=!0,this.parent.notifyInactive()):this.destination.complete()},e.prototype.notifyNext=function(t){this.buffer.push(t),this.parent.checkIterators()},e.prototype.subscribe=function(){return(0,c.ft)(this.observable,new c.IY(this))},e}(c.Ds)},2257:(t,e,n)=>{"use strict";n.d(e,{u:()=>s});var i=n(2556);function s(){return(0,i.J)(1)}},6008:(t,e,n)=>{"use strict";n.d(e,{h:()=>r});var i=n(655),s=n(979);function r(t,e){return function(n){return n.lift(new o(t,e))}}var o=function(){function t(t,e){this.predicate=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new a(t,this.predicate,this.thisArg))},t}(),a=function(t){function e(e,n,i){var s=t.call(this,e)||this;return s.predicate=n,s.thisArg=i,s.count=0,s}return i.ZT(e,t),e.prototype._next=function(t){var e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}e&&this.destination.next(t)},e}(s.L)},1120:(t,e,n)=>{"use strict";n.d(e,{v:()=>c,T:()=>p});var i=n(655),s=n(979),r=n(8760),o=n(2772),a=n(211);function c(t,e,n,i){return function(s){return s.lift(new u(t,e,n,i))}}var u=function(){function t(t,e,n,i){this.keySelector=t,this.elementSelector=e,this.durationSelector=n,this.subjectSelector=i}return t.prototype.call=function(t,e){return e.subscribe(new l(t,this.keySelector,this.elementSelector,this.durationSelector,this.subjectSelector))},t}(),l=function(t){function e(e,n,i,s,r){var o=t.call(this,e)||this;return o.keySelector=n,o.elementSelector=i,o.durationSelector=s,o.subjectSelector=r,o.groups=null,o.attemptedToUnsubscribe=!1,o.count=0,o}return i.ZT(e,t),e.prototype._next=function(t){var e;try{e=this.keySelector(t)}catch(t){return void this.error(t)}this._group(t,e)},e.prototype._group=function(t,e){var n=this.groups;n||(n=this.groups=new Map);var i,s=n.get(e);if(this.elementSelector)try{i=this.elementSelector(t)}catch(t){this.error(t)}else i=t;if(!s){s=this.subjectSelector?this.subjectSelector():new a.xQ,n.set(e,s);var r=new p(e,s,this);if(this.destination.next(r),this.durationSelector){var o=void 0;try{o=this.durationSelector(new p(e,s))}catch(t){return void this.error(t)}this.add(o.subscribe(new h(e,s,this)))}}s.closed||s.next(i)},e.prototype._error=function(t){var e=this.groups;e&&(e.forEach((function(e,n){e.error(t)})),e.clear()),this.destination.error(t)},e.prototype._complete=function(){var t=this.groups;t&&(t.forEach((function(t,e){t.complete()})),t.clear()),this.destination.complete()},e.prototype.removeGroup=function(t){this.groups.delete(t)},e.prototype.unsubscribe=function(){this.closed||(this.attemptedToUnsubscribe=!0,0===this.count&&t.prototype.unsubscribe.call(this))},e}(s.L),h=function(t){function e(e,n,i){var s=t.call(this,n)||this;return s.key=e,s.group=n,s.parent=i,s}return i.ZT(e,t),e.prototype._next=function(t){this.complete()},e.prototype._unsubscribe=function(){var t=this.parent,e=this.key;this.key=this.parent=null,t&&t.removeGroup(e)},e}(s.L),p=function(t){function e(e,n,i){var s=t.call(this)||this;return s.key=e,s.groupSubject=n,s.refCountSubscription=i,s}return i.ZT(e,t),e.prototype._subscribe=function(t){var e=new r.w,n=this.refCountSubscription,i=this.groupSubject;return n&&!n.closed&&e.add(new d(n)),e.add(i.subscribe(t)),e},e}(o.y),d=function(t){function e(e){var n=t.call(this)||this;return n.parent=e,e.count++,n}return i.ZT(e,t),e.prototype.unsubscribe=function(){var e=this.parent;e.closed||this.closed||(t.prototype.unsubscribe.call(this),e.count-=1,0===e.count&&e.attemptedToUnsubscribe&&e.unsubscribe())},e}(r.w)},5709:(t,e,n)=>{"use strict";n.d(e,{U:()=>r});var i=n(655),s=n(979);function r(t,e){return function(n){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new o(t,e))}}var o=function(){function t(t,e){this.project=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new a(t,this.project,this.thisArg))},t}(),a=function(t){function e(e,n,i){var s=t.call(this,e)||this;return s.project=n,s.count=0,s.thisArg=i||s,s}return i.ZT(e,t),e.prototype._next=function(t){var e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}(s.L)},2556:(t,e,n)=>{"use strict";n.d(e,{J:()=>r});var i=n(7746),s=n(3608);function r(t){return void 0===t&&(t=Number.POSITIVE_INFINITY),(0,i.zg)(s.y,t)}},7746:(t,e,n)=>{"use strict";n.d(e,{zg:()=>a,VS:()=>l});var i=n(655),s=n(5709),r=n(5760),o=n(7604);function a(t,e,n){return void 0===n&&(n=Number.POSITIVE_INFINITY),"function"==typeof e?function(i){return i.pipe(a((function(n,i){return(0,r.D)(t(n,i)).pipe((0,s.U)((function(t,s){return e(n,t,i,s)})))}),n))}:("number"==typeof e&&(n=e),function(e){return e.lift(new c(t,n))})}var c=function(){function t(t,e){void 0===e&&(e=Number.POSITIVE_INFINITY),this.project=t,this.concurrent=e}return t.prototype.call=function(t,e){return e.subscribe(new u(t,this.project,this.concurrent))},t}(),u=function(t){function e(e,n,i){void 0===i&&(i=Number.POSITIVE_INFINITY);var s=t.call(this,e)||this;return s.project=n,s.concurrent=i,s.hasCompleted=!1,s.buffer=[],s.active=0,s.index=0,s}return i.ZT(e,t),e.prototype._next=function(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)},e.prototype._tryNext=function(t){var e,n=this.index++;try{e=this.project(t,n)}catch(t){return void this.destination.error(t)}this.active++,this._innerSub(e)},e.prototype._innerSub=function(t){var e=new o.IY(this),n=this.destination;n.add(e);var i=(0,o.ft)(t,e);i!==e&&n.add(i)},e.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()},e.prototype.notifyNext=function(t){this.destination.next(t)},e.prototype.notifyComplete=function(){var t=this.buffer;this.active--,t.length>0?this._next(t.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},e}(o.Ds),l=a},9276:(t,e,n)=>{"use strict";n.d(e,{QV:()=>o,ht:()=>c});var i=n(655),s=n(979),r=n(2632);function o(t,e){return void 0===e&&(e=0),function(n){return n.lift(new a(t,e))}}var a=function(){function t(t,e){void 0===e&&(e=0),this.scheduler=t,this.delay=e}return t.prototype.call=function(t,e){return e.subscribe(new c(t,this.scheduler,this.delay))},t}(),c=function(t){function e(e,n,i){void 0===i&&(i=0);var s=t.call(this,e)||this;return s.scheduler=n,s.delay=i,s}return i.ZT(e,t),e.dispatch=function(t){var e=t.notification,n=t.destination;e.observe(n),this.unsubscribe()},e.prototype.scheduleMessage=function(t){this.destination.add(this.scheduler.schedule(e.dispatch,this.delay,new u(t,this.destination)))},e.prototype._next=function(t){this.scheduleMessage(r.P.createNext(t))},e.prototype._error=function(t){this.scheduleMessage(r.P.createError(t)),this.unsubscribe()},e.prototype._complete=function(){this.scheduleMessage(r.P.createComplete()),this.unsubscribe()},e}(s.L),u=function(){return function(t,e){this.notification=t,this.destination=e}}()},3018:(t,e,n)=>{"use strict";n.d(e,{x:()=>r});var i=n(655),s=n(979);function r(){return function(t){return t.lift(new o(t))}}var o=function(){function t(t){this.connectable=t}return t.prototype.call=function(t,e){var n=this.connectable;n._refCount++;var i=new a(t,n),s=e.subscribe(i);return i.closed||(i.connection=n.connect()),s},t}(),a=function(t){function e(e,n){var i=t.call(this,e)||this;return i.connectable=n,i}return i.ZT(e,t),e.prototype._unsubscribe=function(){var t=this.connectable;if(t){this.connectable=null;var e=t._refCount;if(e<=0)this.connection=null;else if(t._refCount=e-1,e>1)this.connection=null;else{var n=this.connection,i=t._connection;this.connection=null,!i||n&&i!==n||i.unsubscribe()}}else this.connection=null},e}(s.L)},3109:(t,e,n)=>{"use strict";n.d(e,{r:()=>r});var i=n(2772),s=n(8760);function r(t,e){return new i.y((function(n){var i=new s.w,r=0;return i.add(e.schedule((function(){r!==t.length?(n.next(t[r++]),n.closed||i.add(this.schedule())):n.complete()}))),i}))}},8107:(t,e,n)=>{"use strict";n.d(e,{x:()=>l});var i=n(2772),s=n(8760),r=n(5050),o=n(3109),a=n(999),c=n(336),u=n(9217);function l(t,e){if(null!=t){if(function(t){return t&&"function"==typeof t[r.L]}(t))return function(t,e){return new i.y((function(n){var i=new s.w;return i.add(e.schedule((function(){var s=t[r.L]();i.add(s.subscribe({next:function(t){i.add(e.schedule((function(){return n.next(t)})))},error:function(t){i.add(e.schedule((function(){return n.error(t)})))},complete:function(){i.add(e.schedule((function(){return n.complete()})))}}))}))),i}))}(t,e);if((0,c.t)(t))return function(t,e){return new i.y((function(n){var i=new s.w;return i.add(e.schedule((function(){return t.then((function(t){i.add(e.schedule((function(){n.next(t),i.add(e.schedule((function(){return n.complete()})))})))}),(function(t){i.add(e.schedule((function(){return n.error(t)})))}))}))),i}))}(t,e);if((0,u.z)(t))return(0,o.r)(t,e);if(function(t){return t&&"function"==typeof t[a.hZ]}(t)||"string"==typeof t)return function(t,e){if(!t)throw new Error("Iterable cannot be null");return new i.y((function(n){var i,r=new s.w;return r.add((function(){i&&"function"==typeof i.return&&i.return()})),r.add(e.schedule((function(){i=t[a.hZ](),r.add(e.schedule((function(){if(!n.closed){var t,e;try{var s=i.next();t=s.value,e=s.done}catch(t){return void n.error(t)}e?n.complete():(n.next(t),this.schedule())}})))}))),r}))}(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}},6114:(t,e,n)=>{"use strict";n.d(e,{o:()=>s});var i=n(655),s=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.scheduler=e,i.work=n,i.pending=!1,i}return i.ZT(e,t),e.prototype.schedule=function(t,e){if(void 0===e&&(e=0),this.closed)return this;this.state=t;var n=this.id,i=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(i,n,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(i,this.id,e),this},e.prototype.requestAsyncId=function(t,e,n){return void 0===n&&(n=0),setInterval(t.flush.bind(t,this),n)},e.prototype.recycleAsyncId=function(t,e,n){if(void 0===n&&(n=0),null!==n&&this.delay===n&&!1===this.pending)return e;clearInterval(e)},e.prototype.execute=function(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(t,e);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(t,e){var n=!1,i=void 0;try{this.work(t)}catch(t){n=!0,i=!!t&&t||new Error(t)}if(n)return this.unsubscribe(),i},e.prototype._unsubscribe=function(){var t=this.id,e=this.scheduler,n=e.actions,i=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==i&&n.splice(i,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null},e}(function(t){function e(e,n){return t.call(this)||this}return i.ZT(e,t),e.prototype.schedule=function(t,e){return void 0===e&&(e=0),this},e}(n(8760).w))},8399:(t,e,n)=>{"use strict";n.d(e,{v:()=>r});var i=n(655),s=n(8725),r=function(t){function e(n,i){void 0===i&&(i=s.b.now);var r=t.call(this,n,(function(){return e.delegate&&e.delegate!==r?e.delegate.now():i()}))||this;return r.actions=[],r.active=!1,r.scheduled=void 0,r}return i.ZT(e,t),e.prototype.schedule=function(n,i,s){return void 0===i&&(i=0),e.delegate&&e.delegate!==this?e.delegate.schedule(n,i,s):t.prototype.schedule.call(this,n,i,s)},e.prototype.flush=function(t){var e=this.actions;if(this.active)e.push(t);else{var n;this.active=!0;do{if(n=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,n){for(;t=e.shift();)t.unsubscribe();throw n}}},e}(s.b)},6650:(t,e,n)=>{"use strict";n.d(e,{e:()=>l,E:()=>u});var i=n(655),s=1,r=function(){return Promise.resolve()}(),o={};function a(t){return t in o&&(delete o[t],!0)}var c=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.scheduler=e,i.work=n,i}return i.ZT(e,t),e.prototype.requestAsyncId=function(e,n,i){return void 0===i&&(i=0),null!==i&&i>0?t.prototype.requestAsyncId.call(this,e,n,i):(e.actions.push(this),e.scheduled||(e.scheduled=(c=e.flush.bind(e,null),u=s++,o[u]=!0,r.then((function(){return a(u)&&c()})),u)));var c,u},e.prototype.recycleAsyncId=function(e,n,i){if(void 0===i&&(i=0),null!==i&&i>0||null===i&&this.delay>0)return t.prototype.recycleAsyncId.call(this,e,n,i);0===e.actions.length&&(a(n),e.scheduled=void 0)},e}(n(6114).o),u=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i.ZT(e,t),e.prototype.flush=function(t){this.active=!0,this.scheduled=void 0;var e,n=this.actions,i=-1,s=n.length;t=t||n.shift();do{if(e=t.execute(t.state,t.delay))break}while(++i<s&&(t=n.shift()));if(this.active=!1,e){for(;++i<s&&(t=n.shift());)t.unsubscribe();throw e}},e}(n(8399).v))(c),l=u},964:(t,e,n)=>{"use strict";n.d(e,{z:()=>s,P:()=>r});var i=n(6114),s=new(n(8399).v)(i.o),r=s},2546:(t,e,n)=>{"use strict";n.d(e,{c:()=>o,N:()=>r});var i=n(655),s=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.scheduler=e,i.work=n,i}return i.ZT(e,t),e.prototype.schedule=function(e,n){return void 0===n&&(n=0),n>0?t.prototype.schedule.call(this,e,n):(this.delay=n,this.state=e,this.scheduler.flush(this),this)},e.prototype.execute=function(e,n){return n>0||this.closed?t.prototype.execute.call(this,e,n):this._execute(e,n)},e.prototype.requestAsyncId=function(e,n,i){return void 0===i&&(i=0),null!==i&&i>0||null===i&&this.delay>0?t.prototype.requestAsyncId.call(this,e,n,i):e.flush(this)},e}(n(6114).o),r=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i.ZT(e,t),e}(n(8399).v))(s),o=r},999:(t,e,n)=>{"use strict";function i(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}n.d(e,{hZ:()=>s});var s=i()},5050:(t,e,n)=>{"use strict";n.d(e,{L:()=>i});var i=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}()},3142:(t,e,n)=>{"use strict";n.d(e,{b:()=>i});var i=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}()},6565:(t,e,n)=>{"use strict";n.d(e,{W:()=>i});var i=function(){function t(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return t.prototype=Object.create(Error.prototype),t}()},6929:(t,e,n)=>{"use strict";n.d(e,{K:()=>i});var i=function(){function t(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return t.prototype=Object.create(Error.prototype),t}()},1016:(t,e,n)=>{"use strict";n.d(e,{N:()=>i});var i=function(){function t(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return t.prototype=Object.create(Error.prototype),t}()},1462:(t,e,n)=>{"use strict";n.d(e,{W:()=>i});var i=function(){function t(){return Error.call(this),this.message="Timeout has occurred",this.name="TimeoutError",this}return t.prototype=Object.create(Error.prototype),t}()},8782:(t,e,n)=>{"use strict";n.d(e,{B:()=>i});var i=function(){function t(t){return Error.call(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(t,e){return e+1+") "+t.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t,this}return t.prototype=Object.create(Error.prototype),t}()},3642:(t,e,n)=>{"use strict";n.d(e,{_:()=>s});var i=n(979);function s(t){for(;t;){var e=t,n=e.closed,s=e.destination,r=e.isStopped;if(n||r)return!1;t=s&&s instanceof i.L?s:null}return!0}},1644:(t,e,n)=>{"use strict";function i(t){setTimeout((function(){throw t}),0)}n.d(e,{z:()=>i})},3608:(t,e,n)=>{"use strict";function i(t){return t}n.d(e,{y:()=>i})},9026:(t,e,n)=>{"use strict";n.d(e,{k:()=>i});var i=function(){return Array.isArray||function(t){return t&&"number"==typeof t.length}}()},9217:(t,e,n)=>{"use strict";n.d(e,{z:()=>i});var i=function(t){return t&&"number"==typeof t.length&&"function"!=typeof t}},4156:(t,e,n)=>{"use strict";function i(t){return"function"==typeof t}n.d(e,{m:()=>i})},5812:(t,e,n)=>{"use strict";n.d(e,{k:()=>s});var i=n(9026);function s(t){return!(0,i.k)(t)&&t-parseFloat(t)+1>=0}},2009:(t,e,n)=>{"use strict";function i(t){return null!==t&&"object"==typeof t}n.d(e,{K:()=>i})},336:(t,e,n)=>{"use strict";function i(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}n.d(e,{t:()=>i})},7507:(t,e,n)=>{"use strict";function i(t){return t&&"function"==typeof t.schedule}n.d(e,{K:()=>i})},3306:(t,e,n)=>{"use strict";function i(){}n.d(e,{Z:()=>i})},8463:(t,e,n)=>{"use strict";function i(t,e){function n(){return!n.pred.apply(n.thisArg,arguments)}return n.pred=t,n.thisArg=e,n}n.d(e,{f:()=>i})},2561:(t,e,n)=>{"use strict";n.d(e,{z:()=>s,U:()=>r});var i=n(3608);function s(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return r(t)}function r(t){return 0===t.length?i.y:1===t.length?t[0]:function(e){return t.reduce((function(t,e){return e(t)}),e)}}},7843:(t,e,n)=>{"use strict";n.d(e,{s:()=>l});var i=n(6900),s=n(1644),r=n(999),o=n(5050),a=n(9217),c=n(336),u=n(2009),l=function(t){if(t&&"function"==typeof t[o.L])return l=t,function(t){var e=l[o.L]();if("function"!=typeof e.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return e.subscribe(t)};if((0,a.z)(t))return(0,i.V)(t);if((0,c.t)(t))return n=t,function(t){return n.then((function(e){t.closed||(t.next(e),t.complete())}),(function(e){return t.error(e)})).then(null,s.z),t};if(t&&"function"==typeof t[r.hZ])return e=t,function(t){for(var n=e[r.hZ]();;){var i=void 0;try{i=n.next()}catch(e){return t.error(e),t}if(i.done){t.complete();break}if(t.next(i.value),t.closed)break}return"function"==typeof n.return&&t.add((function(){n.return&&n.return()})),t};var e,n,l,h=(0,u.K)(t)?"an invalid object":"'"+t+"'";throw new TypeError("You provided "+h+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")}},6900:(t,e,n)=>{"use strict";n.d(e,{V:()=>i});var i=function(t){return function(e){for(var n=0,i=t.length;n<i&&!e.closed;n++)e.next(t[n]);e.complete()}}},2080:(t,e,n)=>{"use strict";n.d(e,{D:()=>a});var i=n(655),s=function(t){function e(e,n,i){var s=t.call(this)||this;return s.parent=e,s.outerValue=n,s.outerIndex=i,s.index=0,s}return i.ZT(e,t),e.prototype._next=function(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)},e.prototype._error=function(t){this.parent.notifyError(t,this),this.unsubscribe()},e.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},e}(n(979).L),r=n(7843),o=n(2772);function a(t,e,n,i,a){if(void 0===a&&(a=new s(t,n,i)),!a.closed)return e instanceof o.y?e.subscribe(a):(0,r.s)(e)(a)}},1717:(t,e,n)=>{"use strict";n.r(e),n.d(e,{audit:()=>r,auditTime:()=>l,buffer:()=>h,bufferCount:()=>m,bufferTime:()=>b,bufferToggle:()=>D,bufferWhen:()=>P,catchError:()=>q,combineAll:()=>L,combineLatest:()=>W,concat:()=>U,concatAll:()=>Y.u,concatMap:()=>X,concatMapTo:()=>Q,count:()=>H,debounce:()=>J,debounceTime:()=>nt,defaultIfEmpty:()=>ot,delay:()=>ht,delayWhen:()=>vt,dematerialize:()=>xt,distinct:()=>St,distinctUntilChanged:()=>Et,distinctUntilKeyChanged:()=>Dt,elementAt:()=>Bt,endWith:()=>Zt,every:()=>Ut,exhaust:()=>Xt,exhaustMap:()=>Kt,expand:()=>ee,filter:()=>It.h,finalize:()=>se,find:()=>ae,findIndex:()=>le,first:()=>pe,flatMap:()=>G.VS,groupBy:()=>de.v,ignoreElements:()=>fe,isEmpty:()=>ge,last:()=>Te,map:()=>$t.U,mapTo:()=>Se,materialize:()=>Ee,max:()=>je,merge:()=>Ne,mergeAll:()=>Ve.J,mergeMap:()=>G.zg,mergeMapTo:()=>Fe,mergeScan:()=>Le,min:()=>We,multicast:()=>Ue,observeOn:()=>Ge.QV,onErrorResumeNext:()=>Xe,pairwise:()=>$e,partition:()=>en,pluck:()=>nn,publish:()=>on,publishBehavior:()=>cn,publishLast:()=>ln,publishReplay:()=>pn,race:()=>fn,reduce:()=>Re,refCount:()=>En.x,repeat:()=>mn,repeatWhen:()=>yn,retry:()=>xn,retryWhen:()=>Sn,sample:()=>Cn,sampleTime:()=>Mn,scan:()=>De,sequenceEqual:()=>jn,share:()=>Ln,shareReplay:()=>zn,single:()=>Bn,skip:()=>Un,skipLast:()=>Xn,skipUntil:()=>$n,skipWhile:()=>ti,startWith:()=>ii,subscribeOn:()=>ai,switchAll:()=>pi,switchMap:()=>ui,switchMapTo:()=>di,take:()=>Ft,takeLast:()=>be,takeUntil:()=>fi,takeWhile:()=>gi,tap:()=>wi,throttle:()=>Oi,throttleTime:()=>Ai,throwIfEmpty:()=>Rt,timeInterval:()=>Ri,timeout:()=>zi,timeoutWith:()=>Ni,timestamp:()=>Bi,toArray:()=>Ui,window:()=>Yi,windowCount:()=>Qi,windowTime:()=>Ki,windowToggle:()=>rs,windowWhen:()=>cs,withLatestFrom:()=>hs,zip:()=>ms,zipAll:()=>vs});var i=n(655),s=n(7604);function r(t){return function(e){return e.lift(new o(t))}}var o=function(){function t(t){this.durationSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new a(t,this.durationSelector))},t}(),a=function(t){function e(e,n){var i=t.call(this,e)||this;return i.durationSelector=n,i.hasValue=!1,i}return i.ZT(e,t),e.prototype._next=function(t){if(this.value=t,this.hasValue=!0,!this.throttled){var e=void 0;try{e=(0,this.durationSelector)(t)}catch(t){return this.destination.error(t)}var n=(0,s.ft)(e,new s.IY(this));!n||n.closed?this.clearThrottle():this.add(this.throttled=n)}},e.prototype.clearThrottle=function(){var t=this,e=t.value,n=t.hasValue,i=t.throttled;i&&(this.remove(i),this.throttled=void 0,i.unsubscribe()),n&&(this.value=void 0,this.hasValue=!1,this.destination.next(e))},e.prototype.notifyNext=function(){this.clearThrottle()},e.prototype.notifyComplete=function(){this.clearThrottle()},e}(s.Ds),c=n(964),u=n(9604);function l(t,e){return void 0===e&&(e=c.P),r((function(){return(0,u.H)(t,e)}))}function h(t){return function(e){return e.lift(new p(t))}}var p=function(){function t(t){this.closingNotifier=t}return t.prototype.call=function(t,e){return e.subscribe(new d(t,this.closingNotifier))},t}(),d=function(t){function e(e,n){var i=t.call(this,e)||this;return i.buffer=[],i.add((0,s.ft)(n,new s.IY(i))),i}return i.ZT(e,t),e.prototype._next=function(t){this.buffer.push(t)},e.prototype.notifyNext=function(){var t=this.buffer;this.buffer=[],this.destination.next(t)},e}(s.Ds),f=n(979);function m(t,e){return void 0===e&&(e=null),function(n){return n.lift(new v(t,e))}}var v=function(){function t(t,e){this.bufferSize=t,this.startBufferEvery=e,this.subscriberClass=e&&t!==e?y:g}return t.prototype.call=function(t,e){return e.subscribe(new this.subscriberClass(t,this.bufferSize,this.startBufferEvery))},t}(),g=function(t){function e(e,n){var i=t.call(this,e)||this;return i.bufferSize=n,i.buffer=[],i}return i.ZT(e,t),e.prototype._next=function(t){var e=this.buffer;e.push(t),e.length==this.bufferSize&&(this.destination.next(e),this.buffer=[])},e.prototype._complete=function(){var e=this.buffer;e.length>0&&this.destination.next(e),t.prototype._complete.call(this)},e}(f.L),y=function(t){function e(e,n,i){var s=t.call(this,e)||this;return s.bufferSize=n,s.startBufferEvery=i,s.buffers=[],s.count=0,s}return i.ZT(e,t),e.prototype._next=function(t){var e=this,n=e.bufferSize,i=e.startBufferEvery,s=e.buffers,r=e.count;this.count++,r%i==0&&s.push([]);for(var o=s.length;o--;){var a=s[o];a.push(t),a.length===n&&(s.splice(o,1),this.destination.next(a))}},e.prototype._complete=function(){for(var e=this.buffers,n=this.destination;e.length>0;){var i=e.shift();i.length>0&&n.next(i)}t.prototype._complete.call(this)},e}(f.L),_=n(7507);function b(t){var e=arguments.length,n=c.P;(0,_.K)(arguments[arguments.length-1])&&(n=arguments[arguments.length-1],e--);var i=null;e>=2&&(i=arguments[1]);var s=Number.POSITIVE_INFINITY;return e>=3&&(s=arguments[2]),function(e){return e.lift(new x(t,i,s,n))}}var x=function(){function t(t,e,n,i){this.bufferTimeSpan=t,this.bufferCreationInterval=e,this.maxBufferSize=n,this.scheduler=i}return t.prototype.call=function(t,e){return e.subscribe(new T(t,this.bufferTimeSpan,this.bufferCreationInterval,this.maxBufferSize,this.scheduler))},t}(),w=function(){return function(){this.buffer=[]}}(),T=function(t){function e(e,n,i,s,r){var o=t.call(this,e)||this;o.bufferTimeSpan=n,o.bufferCreationInterval=i,o.maxBufferSize=s,o.scheduler=r,o.contexts=[];var a=o.openContext();if(o.timespanOnly=null==i||i<0,o.timespanOnly){var c={subscriber:o,context:a,bufferTimeSpan:n};o.add(a.closeAction=r.schedule(S,n,c))}else{var u={subscriber:o,context:a},l={bufferTimeSpan:n,bufferCreationInterval:i,subscriber:o,scheduler:r};o.add(a.closeAction=r.schedule(O,n,u)),o.add(r.schedule(k,i,l))}return o}return i.ZT(e,t),e.prototype._next=function(t){for(var e,n=this.contexts,i=n.length,s=0;s<i;s++){var r=n[s],o=r.buffer;o.push(t),o.length==this.maxBufferSize&&(e=r)}e&&this.onBufferFull(e)},e.prototype._error=function(e){this.contexts.length=0,t.prototype._error.call(this,e)},e.prototype._complete=function(){for(var e=this.contexts,n=this.destination;e.length>0;){var i=e.shift();n.next(i.buffer)}t.prototype._complete.call(this)},e.prototype._unsubscribe=function(){this.contexts=null},e.prototype.onBufferFull=function(t){this.closeContext(t);var e=t.closeAction;if(e.unsubscribe(),this.remove(e),!this.closed&&this.timespanOnly){t=this.openContext();var n=this.bufferTimeSpan,i={subscriber:this,context:t,bufferTimeSpan:n};this.add(t.closeAction=this.scheduler.schedule(S,n,i))}},e.prototype.openContext=function(){var t=new w;return this.contexts.push(t),t},e.prototype.closeContext=function(t){this.destination.next(t.buffer);var e=this.contexts;(e?e.indexOf(t):-1)>=0&&e.splice(e.indexOf(t),1)},e}(f.L);function S(t){var e=t.subscriber,n=t.context;n&&e.closeContext(n),e.closed||(t.context=e.openContext(),t.context.closeAction=this.schedule(t,t.bufferTimeSpan))}function k(t){var e=t.bufferCreationInterval,n=t.bufferTimeSpan,i=t.subscriber,s=t.scheduler,r=i.openContext();i.closed||(i.add(r.closeAction=s.schedule(O,n,{subscriber:i,context:r})),this.schedule(t,e))}function O(t){var e=t.subscriber,n=t.context;e.closeContext(n)}var E=n(8760),C=n(2080),A=n(2039);function D(t,e){return function(n){return n.lift(new M(t,e))}}var M=function(){function t(t,e){this.openings=t,this.closingSelector=e}return t.prototype.call=function(t,e){return e.subscribe(new I(t,this.openings,this.closingSelector))},t}(),I=function(t){function e(e,n,i){var s=t.call(this,e)||this;return s.closingSelector=i,s.contexts=[],s.add((0,C.D)(s,n)),s}return i.ZT(e,t),e.prototype._next=function(t){for(var e=this.contexts,n=e.length,i=0;i<n;i++)e[i].buffer.push(t)},e.prototype._error=function(e){for(var n=this.contexts;n.length>0;){var i=n.shift();i.subscription.unsubscribe(),i.buffer=null,i.subscription=null}this.contexts=null,t.prototype._error.call(this,e)},e.prototype._complete=function(){for(var e=this.contexts;e.length>0;){var n=e.shift();this.destination.next(n.buffer),n.subscription.unsubscribe(),n.buffer=null,n.subscription=null}this.contexts=null,t.prototype._complete.call(this)},e.prototype.notifyNext=function(t,e){t?this.closeBuffer(t):this.openBuffer(e)},e.prototype.notifyComplete=function(t){this.closeBuffer(t.context)},e.prototype.openBuffer=function(t){try{var e=this.closingSelector.call(this,t);e&&this.trySubscribe(e)}catch(t){this._error(t)}},e.prototype.closeBuffer=function(t){var e=this.contexts;if(e&&t){var n=t.buffer,i=t.subscription;this.destination.next(n),e.splice(e.indexOf(t),1),this.remove(i),i.unsubscribe()}},e.prototype.trySubscribe=function(t){var e=this.contexts,n=new E.w,i={buffer:[],subscription:n};e.push(i);var s=(0,C.D)(this,t,i);!s||s.closed?this.closeBuffer(i):(s.context=i,this.add(s),n.add(s))},e}(A.L);function P(t){return function(e){return e.lift(new R(t))}}var R=function(){function t(t){this.closingSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new j(t,this.closingSelector))},t}(),j=function(t){function e(e,n){var i=t.call(this,e)||this;return i.closingSelector=n,i.subscribing=!1,i.openBuffer(),i}return i.ZT(e,t),e.prototype._next=function(t){this.buffer.push(t)},e.prototype._complete=function(){var e=this.buffer;e&&this.destination.next(e),t.prototype._complete.call(this)},e.prototype._unsubscribe=function(){this.buffer=void 0,this.subscribing=!1},e.prototype.notifyNext=function(){this.openBuffer()},e.prototype.notifyComplete=function(){this.subscribing?this.complete():this.openBuffer()},e.prototype.openBuffer=function(){var t=this.closingSubscription;t&&(this.remove(t),t.unsubscribe());var e,n=this.buffer;this.buffer&&this.destination.next(n),this.buffer=[];try{e=(0,this.closingSelector)()}catch(t){return this.error(t)}t=new E.w,this.closingSubscription=t,this.add(t),this.subscribing=!0,t.add((0,s.ft)(e,new s.IY(this))),this.subscribing=!1},e}(s.Ds);function q(t){return function(e){var n=new N(t),i=e.lift(n);return n.caught=i}}var N=function(){function t(t){this.selector=t}return t.prototype.call=function(t,e){return e.subscribe(new V(t,this.selector,this.caught))},t}(),V=function(t){function e(e,n,i){var s=t.call(this,e)||this;return s.selector=n,s.caught=i,s}return i.ZT(e,t),e.prototype.error=function(e){if(!this.isStopped){var n=void 0;try{n=this.selector(e,this.caught)}catch(e){return void t.prototype.error.call(this,e)}this._unsubscribeAndRecycle();var i=new s.IY(this);this.add(i);var r=(0,s.ft)(n,i);r!==i&&this.add(r)}},e}(s.Ds),F=n(5142);function L(t){return function(e){return e.lift(new F.Ms(t))}}var z=n(9026),B=n(5760);function W(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=null;return"function"==typeof t[t.length-1]&&(n=t.pop()),1===t.length&&(0,z.k)(t[0])&&(t=t[0].slice()),function(e){return e.lift.call((0,B.D)([e].concat(t)),new F.Ms(n))}}var Z=n(9795);function U(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){return e.lift.call(Z.z.apply(void 0,[e].concat(t)))}}var Y=n(2257),G=n(7746);function X(t,e){return(0,G.zg)(t,e,1)}function Q(t,e){return X((function(){return t}),e)}function H(t){return function(e){return e.lift(new $(t,e))}}var $=function(){function t(t,e){this.predicate=t,this.source=e}return t.prototype.call=function(t,e){return e.subscribe(new K(t,this.predicate,this.source))},t}(),K=function(t){function e(e,n,i){var s=t.call(this,e)||this;return s.predicate=n,s.source=i,s.count=0,s.index=0,s}return i.ZT(e,t),e.prototype._next=function(t){this.predicate?this._tryPredicate(t):this.count++},e.prototype._tryPredicate=function(t){var e;try{e=this.predicate(t,this.index++,this.source)}catch(t){return void this.destination.error(t)}e&&this.count++},e.prototype._complete=function(){this.destination.next(this.count),this.destination.complete()},e}(f.L);function J(t){return function(e){return e.lift(new tt(t))}}var tt=function(){function t(t){this.durationSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new et(t,this.durationSelector))},t}(),et=function(t){function e(e,n){var i=t.call(this,e)||this;return i.durationSelector=n,i.hasValue=!1,i}return i.ZT(e,t),e.prototype._next=function(t){try{var e=this.durationSelector.call(this,t);e&&this._tryNext(t,e)}catch(t){this.destination.error(t)}},e.prototype._complete=function(){this.emitValue(),this.destination.complete()},e.prototype._tryNext=function(t,e){var n=this.durationSubscription;this.value=t,this.hasValue=!0,n&&(n.unsubscribe(),this.remove(n)),(n=(0,s.ft)(e,new s.IY(this)))&&!n.closed&&this.add(this.durationSubscription=n)},e.prototype.notifyNext=function(){this.emitValue()},e.prototype.notifyComplete=function(){this.emitValue()},e.prototype.emitValue=function(){if(this.hasValue){var e=this.value,n=this.durationSubscription;n&&(this.durationSubscription=void 0,n.unsubscribe(),this.remove(n)),this.value=void 0,this.hasValue=!1,t.prototype._next.call(this,e)}},e}(s.Ds);function nt(t,e){return void 0===e&&(e=c.P),function(n){return n.lift(new it(t,e))}}var it=function(){function t(t,e){this.dueTime=t,this.scheduler=e}return t.prototype.call=function(t,e){return e.subscribe(new st(t,this.dueTime,this.scheduler))},t}(),st=function(t){function e(e,n,i){var s=t.call(this,e)||this;return s.dueTime=n,s.scheduler=i,s.debouncedSubscription=null,s.lastValue=null,s.hasValue=!1,s}return i.ZT(e,t),e.prototype._next=function(t){this.clearDebounce(),this.lastValue=t,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(rt,this.dueTime,this))},e.prototype._complete=function(){this.debouncedNext(),this.destination.complete()},e.prototype.debouncedNext=function(){if(this.clearDebounce(),this.hasValue){var t=this.lastValue;this.lastValue=null,this.hasValue=!1,this.destination.next(t)}},e.prototype.clearDebounce=function(){var t=this.debouncedSubscription;null!==t&&(this.remove(t),t.unsubscribe(),this.debouncedSubscription=null)},e}(f.L);function rt(t){t.debouncedNext()}function ot(t){return void 0===t&&(t=null),function(e){return e.lift(new at(t))}}var at=function(){function t(t){this.defaultValue=t}return t.prototype.call=function(t,e){return e.subscribe(new ct(t,this.defaultValue))},t}(),ct=function(t){function e(e,n){var i=t.call(this,e)||this;return i.defaultValue=n,i.isEmpty=!0,i}return i.ZT(e,t),e.prototype._next=function(t){this.isEmpty=!1,this.destination.next(t)},e.prototype._complete=function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()},e}(f.L);function ut(t){return t instanceof Date&&!isNaN(+t)}var lt=n(2632);function ht(t,e){void 0===e&&(e=c.P);var n=ut(t)?+t-e.now():Math.abs(t);return function(t){return t.lift(new pt(n,e))}}var pt=function(){function t(t,e){this.delay=t,this.scheduler=e}return t.prototype.call=function(t,e){return e.subscribe(new dt(t,this.delay,this.scheduler))},t}(),dt=function(t){function e(e,n,i){var s=t.call(this,e)||this;return s.delay=n,s.scheduler=i,s.queue=[],s.active=!1,s.errored=!1,s}return i.ZT(e,t),e.dispatch=function(t){for(var e=t.source,n=e.queue,i=t.scheduler,s=t.destination;n.length>0&&n[0].time-i.now()<=0;)n.shift().notification.observe(s);if(n.length>0){var r=Math.max(0,n[0].time-i.now());this.schedule(t,r)}else this.unsubscribe(),e.active=!1},e.prototype._schedule=function(t){this.active=!0,this.destination.add(t.schedule(e.dispatch,this.delay,{source:this,destination:this.destination,scheduler:t}))},e.prototype.scheduleNotification=function(t){if(!0!==this.errored){var e=this.scheduler,n=new ft(e.now()+this.delay,t);this.queue.push(n),!1===this.active&&this._schedule(e)}},e.prototype._next=function(t){this.scheduleNotification(lt.P.createNext(t))},e.prototype._error=function(t){this.errored=!0,this.queue=[],this.destination.error(t),this.unsubscribe()},e.prototype._complete=function(){this.scheduleNotification(lt.P.createComplete()),this.unsubscribe()},e}(f.L),ft=function(){return function(t,e){this.time=t,this.notification=e}}(),mt=n(2772);function vt(t,e){return e?function(n){return new _t(n,e).lift(new gt(t))}:function(e){return e.lift(new gt(t))}}var gt=function(){function t(t){this.delayDurationSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new yt(t,this.delayDurationSelector))},t}(),yt=function(t){function e(e,n){var i=t.call(this,e)||this;return i.delayDurationSelector=n,i.completed=!1,i.delayNotifierSubscriptions=[],i.index=0,i}return i.ZT(e,t),e.prototype.notifyNext=function(t,e,n,i,s){this.destination.next(t),this.removeSubscription(s),this.tryComplete()},e.prototype.notifyError=function(t,e){this._error(t)},e.prototype.notifyComplete=function(t){var e=this.removeSubscription(t);e&&this.destination.next(e),this.tryComplete()},e.prototype._next=function(t){var e=this.index++;try{var n=this.delayDurationSelector(t,e);n&&this.tryDelay(n,t)}catch(t){this.destination.error(t)}},e.prototype._complete=function(){this.completed=!0,this.tryComplete(),this.unsubscribe()},e.prototype.removeSubscription=function(t){t.unsubscribe();var e=this.delayNotifierSubscriptions.indexOf(t);return-1!==e&&this.delayNotifierSubscriptions.splice(e,1),t.outerValue},e.prototype.tryDelay=function(t,e){var n=(0,C.D)(this,t,e);n&&!n.closed&&(this.destination.add(n),this.delayNotifierSubscriptions.push(n))},e.prototype.tryComplete=function(){this.completed&&0===this.delayNotifierSubscriptions.length&&this.destination.complete()},e}(A.L),_t=function(t){function e(e,n){var i=t.call(this)||this;return i.source=e,i.subscriptionDelay=n,i}return i.ZT(e,t),e.prototype._subscribe=function(t){this.subscriptionDelay.subscribe(new bt(t,this.source))},e}(mt.y),bt=function(t){function e(e,n){var i=t.call(this)||this;return i.parent=e,i.source=n,i.sourceSubscribed=!1,i}return i.ZT(e,t),e.prototype._next=function(t){this.subscribeToSource()},e.prototype._error=function(t){this.unsubscribe(),this.parent.error(t)},e.prototype._complete=function(){this.unsubscribe(),this.subscribeToSource()},e.prototype.subscribeToSource=function(){this.sourceSubscribed||(this.sourceSubscribed=!0,this.unsubscribe(),this.source.subscribe(this.parent))},e}(f.L);function xt(){return function(t){return t.lift(new wt)}}var wt=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new Tt(t))},t}(),Tt=function(t){function e(e){return t.call(this,e)||this}return i.ZT(e,t),e.prototype._next=function(t){t.observe(this.destination)},e}(f.L);function St(t,e){return function(n){return n.lift(new kt(t,e))}}var kt=function(){function t(t,e){this.keySelector=t,this.flushes=e}return t.prototype.call=function(t,e){return e.subscribe(new Ot(t,this.keySelector,this.flushes))},t}(),Ot=function(t){function e(e,n,i){var r=t.call(this,e)||this;return r.keySelector=n,r.values=new Set,i&&r.add((0,s.ft)(i,new s.IY(r))),r}return i.ZT(e,t),e.prototype.notifyNext=function(){this.values.clear()},e.prototype.notifyError=function(t){this._error(t)},e.prototype._next=function(t){this.keySelector?this._useKeySelector(t):this._finalizeNext(t,t)},e.prototype._useKeySelector=function(t){var e,n=this.destination;try{e=this.keySelector(t)}catch(t){return void n.error(t)}this._finalizeNext(e,t)},e.prototype._finalizeNext=function(t,e){var n=this.values;n.has(t)||(n.add(t),this.destination.next(e))},e}(s.Ds);function Et(t,e){return function(n){return n.lift(new Ct(t,e))}}var Ct=function(){function t(t,e){this.compare=t,this.keySelector=e}return t.prototype.call=function(t,e){return e.subscribe(new At(t,this.compare,this.keySelector))},t}(),At=function(t){function e(e,n,i){var s=t.call(this,e)||this;return s.keySelector=i,s.hasKey=!1,"function"==typeof n&&(s.compare=n),s}return i.ZT(e,t),e.prototype.compare=function(t,e){return t===e},e.prototype._next=function(t){var e;try{var n=this.keySelector;e=n?n(t):t}catch(t){return this.destination.error(t)}var i=!1;if(this.hasKey)try{i=(0,this.compare)(this.key,e)}catch(t){return this.destination.error(t)}else this.hasKey=!0;i||(this.key=e,this.destination.next(t))},e}(f.L);function Dt(t,e){return Et((function(n,i){return e?e(n[t],i[t]):n[t]===i[t]}))}var Mt=n(6565),It=n(6008),Pt=n(6929);function Rt(t){return void 0===t&&(t=Nt),function(e){return e.lift(new jt(t))}}var jt=function(){function t(t){this.errorFactory=t}return t.prototype.call=function(t,e){return e.subscribe(new qt(t,this.errorFactory))},t}(),qt=function(t){function e(e,n){var i=t.call(this,e)||this;return i.errorFactory=n,i.hasValue=!1,i}return i.ZT(e,t),e.prototype._next=function(t){this.hasValue=!0,this.destination.next(t)},e.prototype._complete=function(){if(this.hasValue)return this.destination.complete();var t=void 0;try{t=this.errorFactory()}catch(e){t=e}this.destination.error(t)},e}(f.L);function Nt(){return new Pt.K}var Vt=n(5631);function Ft(t){return function(e){return 0===t?(0,Vt.c)():e.lift(new Lt(t))}}var Lt=function(){function t(t){if(this.total=t,this.total<0)throw new Mt.W}return t.prototype.call=function(t,e){return e.subscribe(new zt(t,this.total))},t}(),zt=function(t){function e(e,n){var i=t.call(this,e)||this;return i.total=n,i.count=0,i}return i.ZT(e,t),e.prototype._next=function(t){var e=this.total,n=++this.count;n<=e&&(this.destination.next(t),n===e&&(this.destination.complete(),this.unsubscribe()))},e}(f.L);function Bt(t,e){if(t<0)throw new Mt.W;var n=arguments.length>=2;return function(i){return i.pipe((0,It.h)((function(e,n){return n===t})),Ft(1),n?ot(e):Rt((function(){return new Mt.W})))}}var Wt=n(8170);function Zt(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){return(0,Z.z)(e,Wt.of.apply(void 0,t))}}function Ut(t,e){return function(n){return n.lift(new Yt(t,e,n))}}var Yt=function(){function t(t,e,n){this.predicate=t,this.thisArg=e,this.source=n}return t.prototype.call=function(t,e){return e.subscribe(new Gt(t,this.predicate,this.thisArg,this.source))},t}(),Gt=function(t){function e(e,n,i,s){var r=t.call(this,e)||this;return r.predicate=n,r.thisArg=i,r.source=s,r.index=0,r.thisArg=i||r,r}return i.ZT(e,t),e.prototype.notifyComplete=function(t){this.destination.next(t),this.destination.complete()},e.prototype._next=function(t){var e=!1;try{e=this.predicate.call(this.thisArg,t,this.index++,this.source)}catch(t){return void this.destination.error(t)}e||this.notifyComplete(!1)},e.prototype._complete=function(){this.notifyComplete(!0)},e}(f.L);function Xt(){return function(t){return t.lift(new Qt)}}var Qt=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new Ht(t))},t}(),Ht=function(t){function e(e){var n=t.call(this,e)||this;return n.hasCompleted=!1,n.hasSubscription=!1,n}return i.ZT(e,t),e.prototype._next=function(t){this.hasSubscription||(this.hasSubscription=!0,this.add((0,s.ft)(t,new s.IY(this))))},e.prototype._complete=function(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete()},e.prototype.notifyComplete=function(){this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()},e}(s.Ds),$t=n(5709);function Kt(t,e){return e?function(n){return n.pipe(Kt((function(n,i){return(0,B.D)(t(n,i)).pipe((0,$t.U)((function(t,s){return e(n,t,i,s)})))})))}:function(e){return e.lift(new Jt(t))}}var Jt=function(){function t(t){this.project=t}return t.prototype.call=function(t,e){return e.subscribe(new te(t,this.project))},t}(),te=function(t){function e(e,n){var i=t.call(this,e)||this;return i.project=n,i.hasSubscription=!1,i.hasCompleted=!1,i.index=0,i}return i.ZT(e,t),e.prototype._next=function(t){this.hasSubscription||this.tryNext(t)},e.prototype.tryNext=function(t){var e,n=this.index++;try{e=this.project(t,n)}catch(t){return void this.destination.error(t)}this.hasSubscription=!0,this._innerSub(e)},e.prototype._innerSub=function(t){var e=new s.IY(this),n=this.destination;n.add(e);var i=(0,s.ft)(t,e);i!==e&&n.add(i)},e.prototype._complete=function(){this.hasCompleted=!0,this.hasSubscription||this.destination.complete(),this.unsubscribe()},e.prototype.notifyNext=function(t){this.destination.next(t)},e.prototype.notifyError=function(t){this.destination.error(t)},e.prototype.notifyComplete=function(){this.hasSubscription=!1,this.hasCompleted&&this.destination.complete()},e}(s.Ds);function ee(t,e,n){return void 0===e&&(e=Number.POSITIVE_INFINITY),e=(e||0)<1?Number.POSITIVE_INFINITY:e,function(i){return i.lift(new ne(t,e,n))}}var ne=function(){function t(t,e,n){this.project=t,this.concurrent=e,this.scheduler=n}return t.prototype.call=function(t,e){return e.subscribe(new ie(t,this.project,this.concurrent,this.scheduler))},t}(),ie=function(t){function e(e,n,i,s){var r=t.call(this,e)||this;return r.project=n,r.concurrent=i,r.scheduler=s,r.index=0,r.active=0,r.hasCompleted=!1,i<Number.POSITIVE_INFINITY&&(r.buffer=[]),r}return i.ZT(e,t),e.dispatch=function(t){var e=t.subscriber,n=t.result,i=t.value,s=t.index;e.subscribeToProjection(n,i,s)},e.prototype._next=function(t){var n=this.destination;if(n.closed)this._complete();else{var i=this.index++;if(this.active<this.concurrent){n.next(t);try{var s=(0,this.project)(t,i);if(this.scheduler){var r={subscriber:this,result:s,value:t,index:i};this.destination.add(this.scheduler.schedule(e.dispatch,0,r))}else this.subscribeToProjection(s,t,i)}catch(t){n.error(t)}}else this.buffer.push(t)}},e.prototype.subscribeToProjection=function(t,e,n){this.active++,this.destination.add((0,s.ft)(t,new s.IY(this)))},e.prototype._complete=function(){this.hasCompleted=!0,this.hasCompleted&&0===this.active&&this.destination.complete(),this.unsubscribe()},e.prototype.notifyNext=function(t){this._next(t)},e.prototype.notifyComplete=function(){var t=this.buffer;this.active--,t&&t.length>0&&this._next(t.shift()),this.hasCompleted&&0===this.active&&this.destination.complete()},e}(s.Ds);function se(t){return function(e){return e.lift(new re(t))}}var re=function(){function t(t){this.callback=t}return t.prototype.call=function(t,e){return e.subscribe(new oe(t,this.callback))},t}(),oe=function(t){function e(e,n){var i=t.call(this,e)||this;return i.add(new E.w(n)),i}return i.ZT(e,t),e}(f.L);function ae(t,e){if("function"!=typeof t)throw new TypeError("predicate is not a function");return function(n){return n.lift(new ce(t,n,!1,e))}}var ce=function(){function t(t,e,n,i){this.predicate=t,this.source=e,this.yieldIndex=n,this.thisArg=i}return t.prototype.call=function(t,e){return e.subscribe(new ue(t,this.predicate,this.source,this.yieldIndex,this.thisArg))},t}(),ue=function(t){function e(e,n,i,s,r){var o=t.call(this,e)||this;return o.predicate=n,o.source=i,o.yieldIndex=s,o.thisArg=r,o.index=0,o}return i.ZT(e,t),e.prototype.notifyComplete=function(t){var e=this.destination;e.next(t),e.complete(),this.unsubscribe()},e.prototype._next=function(t){var e=this.predicate,n=this.thisArg,i=this.index++;try{e.call(n||this,t,i,this.source)&&this.notifyComplete(this.yieldIndex?i:t)}catch(t){this.destination.error(t)}},e.prototype._complete=function(){this.notifyComplete(this.yieldIndex?-1:void 0)},e}(f.L);function le(t,e){return function(n){return n.lift(new ce(t,n,!0,e))}}var he=n(3608);function pe(t,e){var n=arguments.length>=2;return function(i){return i.pipe(t?(0,It.h)((function(e,n){return t(e,n,i)})):he.y,Ft(1),n?ot(e):Rt((function(){return new Pt.K})))}}var de=n(1120);function fe(){return function(t){return t.lift(new me)}}var me=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new ve(t))},t}(),ve=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i.ZT(e,t),e.prototype._next=function(t){},e}(f.L);function ge(){return function(t){return t.lift(new ye)}}var ye=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new _e(t))},t}(),_e=function(t){function e(e){return t.call(this,e)||this}return i.ZT(e,t),e.prototype.notifyComplete=function(t){var e=this.destination;e.next(t),e.complete()},e.prototype._next=function(t){this.notifyComplete(!1)},e.prototype._complete=function(){this.notifyComplete(!0)},e}(f.L);function be(t){return function(e){return 0===t?(0,Vt.c)():e.lift(new xe(t))}}var xe=function(){function t(t){if(this.total=t,this.total<0)throw new Mt.W}return t.prototype.call=function(t,e){return e.subscribe(new we(t,this.total))},t}(),we=function(t){function e(e,n){var i=t.call(this,e)||this;return i.total=n,i.ring=new Array,i.count=0,i}return i.ZT(e,t),e.prototype._next=function(t){var e=this.ring,n=this.total,i=this.count++;e.length<n?e.push(t):e[i%n]=t},e.prototype._complete=function(){var t=this.destination,e=this.count;if(e>0)for(var n=this.count>=this.total?this.total:this.count,i=this.ring,s=0;s<n;s++){var r=e++%n;t.next(i[r])}t.complete()},e}(f.L);function Te(t,e){var n=arguments.length>=2;return function(i){return i.pipe(t?(0,It.h)((function(e,n){return t(e,n,i)})):he.y,be(1),n?ot(e):Rt((function(){return new Pt.K})))}}function Se(t){return function(e){return e.lift(new ke(t))}}var ke=function(){function t(t){this.value=t}return t.prototype.call=function(t,e){return e.subscribe(new Oe(t,this.value))},t}(),Oe=function(t){function e(e,n){var i=t.call(this,e)||this;return i.value=n,i}return i.ZT(e,t),e.prototype._next=function(t){this.destination.next(this.value)},e}(f.L);function Ee(){return function(t){return t.lift(new Ce)}}var Ce=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new Ae(t))},t}(),Ae=function(t){function e(e){return t.call(this,e)||this}return i.ZT(e,t),e.prototype._next=function(t){this.destination.next(lt.P.createNext(t))},e.prototype._error=function(t){var e=this.destination;e.next(lt.P.createError(t)),e.complete()},e.prototype._complete=function(){var t=this.destination;t.next(lt.P.createComplete()),t.complete()},e}(f.L);function De(t,e){var n=!1;return arguments.length>=2&&(n=!0),function(i){return i.lift(new Me(t,e,n))}}var Me=function(){function t(t,e,n){void 0===n&&(n=!1),this.accumulator=t,this.seed=e,this.hasSeed=n}return t.prototype.call=function(t,e){return e.subscribe(new Ie(t,this.accumulator,this.seed,this.hasSeed))},t}(),Ie=function(t){function e(e,n,i,s){var r=t.call(this,e)||this;return r.accumulator=n,r._seed=i,r.hasSeed=s,r.index=0,r}return i.ZT(e,t),Object.defineProperty(e.prototype,"seed",{get:function(){return this._seed},set:function(t){this.hasSeed=!0,this._seed=t},enumerable:!0,configurable:!0}),e.prototype._next=function(t){if(this.hasSeed)return this._tryNext(t);this.seed=t,this.destination.next(t)},e.prototype._tryNext=function(t){var e,n=this.index++;try{e=this.accumulator(this.seed,t,n)}catch(t){this.destination.error(t)}this.seed=e,this.destination.next(e)},e}(f.L),Pe=n(2561);function Re(t,e){return arguments.length>=2?function(n){return(0,Pe.z)(De(t,e),be(1),ot(e))(n)}:function(e){return(0,Pe.z)(De((function(e,n,i){return t(e,n,i+1)})),be(1))(e)}}function je(t){return Re("function"==typeof t?function(e,n){return t(e,n)>0?e:n}:function(t,e){return t>e?t:e})}var qe=n(4370);function Ne(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){return e.lift.call(qe.T.apply(void 0,[e].concat(t)))}}var Ve=n(2556);function Fe(t,e,n){return void 0===n&&(n=Number.POSITIVE_INFINITY),"function"==typeof e?(0,G.zg)((function(){return t}),e,n):("number"==typeof e&&(n=e),(0,G.zg)((function(){return t}),n))}function Le(t,e,n){return void 0===n&&(n=Number.POSITIVE_INFINITY),function(i){return i.lift(new ze(t,e,n))}}var ze=function(){function t(t,e,n){this.accumulator=t,this.seed=e,this.concurrent=n}return t.prototype.call=function(t,e){return e.subscribe(new Be(t,this.accumulator,this.seed,this.concurrent))},t}(),Be=function(t){function e(e,n,i,s){var r=t.call(this,e)||this;return r.accumulator=n,r.acc=i,r.concurrent=s,r.hasValue=!1,r.hasCompleted=!1,r.buffer=[],r.active=0,r.index=0,r}return i.ZT(e,t),e.prototype._next=function(t){if(this.active<this.concurrent){var e=this.index++,n=this.destination,i=void 0;try{i=(0,this.accumulator)(this.acc,t,e)}catch(t){return n.error(t)}this.active++,this._innerSub(i)}else this.buffer.push(t)},e.prototype._innerSub=function(t){var e=new s.IY(this),n=this.destination;n.add(e);var i=(0,s.ft)(t,e);i!==e&&n.add(i)},e.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&(!1===this.hasValue&&this.destination.next(this.acc),this.destination.complete()),this.unsubscribe()},e.prototype.notifyNext=function(t){var e=this.destination;this.acc=t,this.hasValue=!0,e.next(t)},e.prototype.notifyComplete=function(){var t=this.buffer;this.active--,t.length>0?this._next(t.shift()):0===this.active&&this.hasCompleted&&(!1===this.hasValue&&this.destination.next(this.acc),this.destination.complete())},e}(s.Ds);function We(t){return Re("function"==typeof t?function(e,n){return t(e,n)<0?e:n}:function(t,e){return t<e?t:e})}var Ze=n(3140);function Ue(t,e){return function(n){var i;if(i="function"==typeof t?t:function(){return t},"function"==typeof e)return n.lift(new Ye(i,e));var s=Object.create(n,Ze.N);return s.source=n,s.subjectFactory=i,s}}var Ye=function(){function t(t,e){this.subjectFactory=t,this.selector=e}return t.prototype.call=function(t,e){var n=this.selector,i=this.subjectFactory(),s=n(i).subscribe(t);return s.add(e.subscribe(i)),s},t}(),Ge=n(9276);function Xe(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 1===t.length&&(0,z.k)(t[0])&&(t=t[0]),function(e){return e.lift(new Qe(t))}}var Qe=function(){function t(t){this.nextSources=t}return t.prototype.call=function(t,e){return e.subscribe(new He(t,this.nextSources))},t}(),He=function(t){function e(e,n){var i=t.call(this,e)||this;return i.destination=e,i.nextSources=n,i}return i.ZT(e,t),e.prototype.notifyError=function(){this.subscribeToNextSource()},e.prototype.notifyComplete=function(){this.subscribeToNextSource()},e.prototype._error=function(t){this.subscribeToNextSource(),this.unsubscribe()},e.prototype._complete=function(){this.subscribeToNextSource(),this.unsubscribe()},e.prototype.subscribeToNextSource=function(){var t=this.nextSources.shift();if(t){var e=new s.IY(this),n=this.destination;n.add(e);var i=(0,s.ft)(t,e);i!==e&&n.add(i)}else this.destination.complete()},e}(s.Ds);function $e(){return function(t){return t.lift(new Ke)}}var Ke=function(){function t(){}return t.prototype.call=function(t,e){return e.subscribe(new Je(t))},t}(),Je=function(t){function e(e){var n=t.call(this,e)||this;return n.hasPrev=!1,n}return i.ZT(e,t),e.prototype._next=function(t){var e;this.hasPrev?e=[this.prev,t]:this.hasPrev=!0,this.prev=t,e&&this.destination.next(e)},e}(f.L),tn=n(8463);function en(t,e){return function(n){return[(0,It.h)(t,e)(n),(0,It.h)((0,tn.f)(t,e))(n)]}}function nn(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t.length;if(0===n)throw new Error("list of properties cannot be empty.");return function(e){return(0,$t.U)(sn(t,n))(e)}}function sn(t,e){return function(n){for(var i=n,s=0;s<e;s++){var r=null!=i?i[t[s]]:void 0;if(void 0===r)return;i=r}return i}}var rn=n(211);function on(t){return t?Ue((function(){return new rn.xQ}),t):Ue(new rn.xQ)}var an=n(9233);function cn(t){return function(e){return Ue(new an.X(t))(e)}}var un=n(364);function ln(){return function(t){return Ue(new un.c)(t)}}var hn=n(2630);function pn(t,e,n,i){n&&"function"!=typeof n&&(i=n);var s="function"==typeof n?n:void 0,r=new hn.t(t,e,i);return function(t){return Ue((function(){return r}),s)(t)}}var dn=n(8821);function fn(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){return 1===t.length&&(0,z.k)(t[0])&&(t=t[0]),e.lift.call(dn.S3.apply(void 0,[e].concat(t)))}}function mn(t){return void 0===t&&(t=-1),function(e){return 0===t?(0,Vt.c)():t<0?e.lift(new vn(-1,e)):e.lift(new vn(t-1,e))}}var vn=function(){function t(t,e){this.count=t,this.source=e}return t.prototype.call=function(t,e){return e.subscribe(new gn(t,this.count,this.source))},t}(),gn=function(t){function e(e,n,i){var s=t.call(this,e)||this;return s.count=n,s.source=i,s}return i.ZT(e,t),e.prototype.complete=function(){if(!this.isStopped){var e=this.source,n=this.count;if(0===n)return t.prototype.complete.call(this);n>-1&&(this.count=n-1),e.subscribe(this._unsubscribeAndRecycle())}},e}(f.L);function yn(t){return function(e){return e.lift(new _n(t))}}var _n=function(){function t(t){this.notifier=t}return t.prototype.call=function(t,e){return e.subscribe(new bn(t,this.notifier,e))},t}(),bn=function(t){function e(e,n,i){var s=t.call(this,e)||this;return s.notifier=n,s.source=i,s.sourceIsBeingSubscribedTo=!0,s}return i.ZT(e,t),e.prototype.notifyNext=function(){this.sourceIsBeingSubscribedTo=!0,this.source.subscribe(this)},e.prototype.notifyComplete=function(){if(!1===this.sourceIsBeingSubscribedTo)return t.prototype.complete.call(this)},e.prototype.complete=function(){if(this.sourceIsBeingSubscribedTo=!1,!this.isStopped){if(this.retries||this.subscribeToRetries(),!this.retriesSubscription||this.retriesSubscription.closed)return t.prototype.complete.call(this);this._unsubscribeAndRecycle(),this.notifications.next(void 0)}},e.prototype._unsubscribe=function(){var t=this.notifications,e=this.retriesSubscription;t&&(t.unsubscribe(),this.notifications=void 0),e&&(e.unsubscribe(),this.retriesSubscription=void 0),this.retries=void 0},e.prototype._unsubscribeAndRecycle=function(){var e=this._unsubscribe;return this._unsubscribe=null,t.prototype._unsubscribeAndRecycle.call(this),this._unsubscribe=e,this},e.prototype.subscribeToRetries=function(){var e;this.notifications=new rn.xQ;try{e=(0,this.notifier)(this.notifications)}catch(e){return t.prototype.complete.call(this)}this.retries=e,this.retriesSubscription=(0,s.ft)(e,new s.IY(this))},e}(s.Ds);function xn(t){return void 0===t&&(t=-1),function(e){return e.lift(new wn(t,e))}}var wn=function(){function t(t,e){this.count=t,this.source=e}return t.prototype.call=function(t,e){return e.subscribe(new Tn(t,this.count,this.source))},t}(),Tn=function(t){function e(e,n,i){var s=t.call(this,e)||this;return s.count=n,s.source=i,s}return i.ZT(e,t),e.prototype.error=function(e){if(!this.isStopped){var n=this.source,i=this.count;if(0===i)return t.prototype.error.call(this,e);i>-1&&(this.count=i-1),n.subscribe(this._unsubscribeAndRecycle())}},e}(f.L);function Sn(t){return function(e){return e.lift(new kn(t,e))}}var kn=function(){function t(t,e){this.notifier=t,this.source=e}return t.prototype.call=function(t,e){return e.subscribe(new On(t,this.notifier,this.source))},t}(),On=function(t){function e(e,n,i){var s=t.call(this,e)||this;return s.notifier=n,s.source=i,s}return i.ZT(e,t),e.prototype.error=function(e){if(!this.isStopped){var n=this.errors,i=this.retries,r=this.retriesSubscription;if(i)this.errors=void 0,this.retriesSubscription=void 0;else{n=new rn.xQ;try{i=(0,this.notifier)(n)}catch(e){return t.prototype.error.call(this,e)}r=(0,s.ft)(i,new s.IY(this))}this._unsubscribeAndRecycle(),this.errors=n,this.retries=i,this.retriesSubscription=r,n.next(e)}},e.prototype._unsubscribe=function(){var t=this.errors,e=this.retriesSubscription;t&&(t.unsubscribe(),this.errors=void 0),e&&(e.unsubscribe(),this.retriesSubscription=void 0),this.retries=void 0},e.prototype.notifyNext=function(){var t=this._unsubscribe;this._unsubscribe=null,this._unsubscribeAndRecycle(),this._unsubscribe=t,this.source.subscribe(this)},e}(s.Ds),En=n(3018);function Cn(t){return function(e){return e.lift(new An(t))}}var An=function(){function t(t){this.notifier=t}return t.prototype.call=function(t,e){var n=new Dn(t),i=e.subscribe(n);return i.add((0,s.ft)(this.notifier,new s.IY(n))),i},t}(),Dn=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.hasValue=!1,e}return i.ZT(e,t),e.prototype._next=function(t){this.value=t,this.hasValue=!0},e.prototype.notifyNext=function(){this.emitValue()},e.prototype.notifyComplete=function(){this.emitValue()},e.prototype.emitValue=function(){this.hasValue&&(this.hasValue=!1,this.destination.next(this.value))},e}(s.Ds);function Mn(t,e){return void 0===e&&(e=c.P),function(n){return n.lift(new In(t,e))}}var In=function(){function t(t,e){this.period=t,this.scheduler=e}return t.prototype.call=function(t,e){return e.subscribe(new Pn(t,this.period,this.scheduler))},t}(),Pn=function(t){function e(e,n,i){var s=t.call(this,e)||this;return s.period=n,s.scheduler=i,s.hasValue=!1,s.add(i.schedule(Rn,n,{subscriber:s,period:n})),s}return i.ZT(e,t),e.prototype._next=function(t){this.lastValue=t,this.hasValue=!0},e.prototype.notifyNext=function(){this.hasValue&&(this.hasValue=!1,this.destination.next(this.lastValue))},e}(f.L);function Rn(t){var e=t.subscriber,n=t.period;e.notifyNext(),this.schedule(t,n)}function jn(t,e){return function(n){return n.lift(new qn(t,e))}}var qn=function(){function t(t,e){this.compareTo=t,this.comparator=e}return t.prototype.call=function(t,e){return e.subscribe(new Nn(t,this.compareTo,this.comparator))},t}(),Nn=function(t){function e(e,n,i){var s=t.call(this,e)||this;return s.compareTo=n,s.comparator=i,s._a=[],s._b=[],s._oneComplete=!1,s.destination.add(n.subscribe(new Vn(e,s))),s}return i.ZT(e,t),e.prototype._next=function(t){this._oneComplete&&0===this._b.length?this.emit(!1):(this._a.push(t),this.checkValues())},e.prototype._complete=function(){this._oneComplete?this.emit(0===this._a.length&&0===this._b.length):this._oneComplete=!0,this.unsubscribe()},e.prototype.checkValues=function(){for(var t=this,e=t._a,n=t._b,i=t.comparator;e.length>0&&n.length>0;){var s=e.shift(),r=n.shift(),o=!1;try{o=i?i(s,r):s===r}catch(t){this.destination.error(t)}o||this.emit(!1)}},e.prototype.emit=function(t){var e=this.destination;e.next(t),e.complete()},e.prototype.nextB=function(t){this._oneComplete&&0===this._a.length?this.emit(!1):(this._b.push(t),this.checkValues())},e.prototype.completeB=function(){this._oneComplete?this.emit(0===this._a.length&&0===this._b.length):this._oneComplete=!0},e}(f.L),Vn=function(t){function e(e,n){var i=t.call(this,e)||this;return i.parent=n,i}return i.ZT(e,t),e.prototype._next=function(t){this.parent.nextB(t)},e.prototype._error=function(t){this.parent.error(t),this.unsubscribe()},e.prototype._complete=function(){this.parent.completeB(),this.unsubscribe()},e}(f.L);function Fn(){return new rn.xQ}function Ln(){return function(t){return(0,En.x)()(Ue(Fn)(t))}}function zn(t,e,n){var i;return i=t&&"object"==typeof t?t:{bufferSize:t,windowTime:e,refCount:!1,scheduler:n},function(t){return t.lift(function(t){var e,n,i=t.bufferSize,s=void 0===i?Number.POSITIVE_INFINITY:i,r=t.windowTime,o=void 0===r?Number.POSITIVE_INFINITY:r,a=t.refCount,c=t.scheduler,u=0,l=!1,h=!1;return function(t){var i;u++,!e||l?(l=!1,e=new hn.t(s,o,c),i=e.subscribe(this),n=t.subscribe({next:function(t){e.next(t)},error:function(t){l=!0,e.error(t)},complete:function(){h=!0,n=void 0,e.complete()}}),h&&(n=void 0)):i=e.subscribe(this),this.add((function(){u--,i.unsubscribe(),i=void 0,n&&!h&&a&&0===u&&(n.unsubscribe(),n=void 0,e=void 0)}))}}(i))}}function Bn(t){return function(e){return e.lift(new Wn(t,e))}}var Wn=function(){function t(t,e){this.predicate=t,this.source=e}return t.prototype.call=function(t,e){return e.subscribe(new Zn(t,this.predicate,this.source))},t}(),Zn=function(t){function e(e,n,i){var s=t.call(this,e)||this;return s.predicate=n,s.source=i,s.seenValue=!1,s.index=0,s}return i.ZT(e,t),e.prototype.applySingleValue=function(t){this.seenValue?this.destination.error("Sequence contains more than one element"):(this.seenValue=!0,this.singleValue=t)},e.prototype._next=function(t){var e=this.index++;this.predicate?this.tryNext(t,e):this.applySingleValue(t)},e.prototype.tryNext=function(t,e){try{this.predicate(t,e,this.source)&&this.applySingleValue(t)}catch(t){this.destination.error(t)}},e.prototype._complete=function(){var t=this.destination;this.index>0?(t.next(this.seenValue?this.singleValue:void 0),t.complete()):t.error(new Pt.K)},e}(f.L);function Un(t){return function(e){return e.lift(new Yn(t))}}var Yn=function(){function t(t){this.total=t}return t.prototype.call=function(t,e){return e.subscribe(new Gn(t,this.total))},t}(),Gn=function(t){function e(e,n){var i=t.call(this,e)||this;return i.total=n,i.count=0,i}return i.ZT(e,t),e.prototype._next=function(t){++this.count>this.total&&this.destination.next(t)},e}(f.L);function Xn(t){return function(e){return e.lift(new Qn(t))}}var Qn=function(){function t(t){if(this._skipCount=t,this._skipCount<0)throw new Mt.W}return t.prototype.call=function(t,e){return 0===this._skipCount?e.subscribe(new f.L(t)):e.subscribe(new Hn(t,this._skipCount))},t}(),Hn=function(t){function e(e,n){var i=t.call(this,e)||this;return i._skipCount=n,i._count=0,i._ring=new Array(n),i}return i.ZT(e,t),e.prototype._next=function(t){var e=this._skipCount,n=this._count++;if(n<e)this._ring[n]=t;else{var i=n%e,s=this._ring,r=s[i];s[i]=t,this.destination.next(r)}},e}(f.L);function $n(t){return function(e){return e.lift(new Kn(t))}}var Kn=function(){function t(t){this.notifier=t}return t.prototype.call=function(t,e){return e.subscribe(new Jn(t,this.notifier))},t}(),Jn=function(t){function e(e,n){var i=t.call(this,e)||this;i.hasValue=!1;var r=new s.IY(i);i.add(r),i.innerSubscription=r;var o=(0,s.ft)(n,r);return o!==r&&(i.add(o),i.innerSubscription=o),i}return i.ZT(e,t),e.prototype._next=function(e){this.hasValue&&t.prototype._next.call(this,e)},e.prototype.notifyNext=function(){this.hasValue=!0,this.innerSubscription&&this.innerSubscription.unsubscribe()},e.prototype.notifyComplete=function(){},e}(s.Ds);function ti(t){return function(e){return e.lift(new ei(t))}}var ei=function(){function t(t){this.predicate=t}return t.prototype.call=function(t,e){return e.subscribe(new ni(t,this.predicate))},t}(),ni=function(t){function e(e,n){var i=t.call(this,e)||this;return i.predicate=n,i.skipping=!0,i.index=0,i}return i.ZT(e,t),e.prototype._next=function(t){var e=this.destination;this.skipping&&this.tryCallPredicate(t),this.skipping||e.next(t)},e.prototype.tryCallPredicate=function(t){try{var e=this.predicate(t,this.index++);this.skipping=Boolean(e)}catch(t){this.destination.error(t)}},e}(f.L);function ii(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t[t.length-1];return(0,_.K)(n)?(t.pop(),function(e){return(0,Z.z)(t,e,n)}):function(e){return(0,Z.z)(t,e)}}var si=n(6650),ri=n(5812),oi=function(t){function e(e,n,i){void 0===n&&(n=0),void 0===i&&(i=si.e);var s=t.call(this)||this;return s.source=e,s.delayTime=n,s.scheduler=i,(!(0,ri.k)(n)||n<0)&&(s.delayTime=0),i&&"function"==typeof i.schedule||(s.scheduler=si.e),s}return i.ZT(e,t),e.create=function(t,n,i){return void 0===n&&(n=0),void 0===i&&(i=si.e),new e(t,n,i)},e.dispatch=function(t){var e=t.source,n=t.subscriber;return this.add(e.subscribe(n))},e.prototype._subscribe=function(t){var n=this.delayTime,i=this.source;return this.scheduler.schedule(e.dispatch,n,{source:i,subscriber:t})},e}(mt.y);function ai(t,e){return void 0===e&&(e=0),function(n){return n.lift(new ci(t,e))}}var ci=function(){function t(t,e){this.scheduler=t,this.delay=e}return t.prototype.call=function(t,e){return new oi(e,this.delay,this.scheduler).subscribe(t)},t}();function ui(t,e){return"function"==typeof e?function(n){return n.pipe(ui((function(n,i){return(0,B.D)(t(n,i)).pipe((0,$t.U)((function(t,s){return e(n,t,i,s)})))})))}:function(e){return e.lift(new li(t))}}var li=function(){function t(t){this.project=t}return t.prototype.call=function(t,e){return e.subscribe(new hi(t,this.project))},t}(),hi=function(t){function e(e,n){var i=t.call(this,e)||this;return i.project=n,i.index=0,i}return i.ZT(e,t),e.prototype._next=function(t){var e,n=this.index++;try{e=this.project(t,n)}catch(t){return void this.destination.error(t)}this._innerSub(e)},e.prototype._innerSub=function(t){var e=this.innerSubscription;e&&e.unsubscribe();var n=new s.IY(this),i=this.destination;i.add(n),this.innerSubscription=(0,s.ft)(t,n),this.innerSubscription!==n&&i.add(this.innerSubscription)},e.prototype._complete=function(){var e=this.innerSubscription;e&&!e.closed||t.prototype._complete.call(this),this.unsubscribe()},e.prototype._unsubscribe=function(){this.innerSubscription=void 0},e.prototype.notifyComplete=function(){this.innerSubscription=void 0,this.isStopped&&t.prototype._complete.call(this)},e.prototype.notifyNext=function(t){this.destination.next(t)},e}(s.Ds);function pi(){return ui(he.y)}function di(t,e){return e?ui((function(){return t}),e):ui((function(){return t}))}function fi(t){return function(e){return e.lift(new mi(t))}}var mi=function(){function t(t){this.notifier=t}return t.prototype.call=function(t,e){var n=new vi(t),i=(0,s.ft)(this.notifier,new s.IY(n));return i&&!n.seenValue?(n.add(i),e.subscribe(n)):n},t}(),vi=function(t){function e(e){var n=t.call(this,e)||this;return n.seenValue=!1,n}return i.ZT(e,t),e.prototype.notifyNext=function(){this.seenValue=!0,this.complete()},e.prototype.notifyComplete=function(){},e}(s.Ds);function gi(t,e){return void 0===e&&(e=!1),function(n){return n.lift(new yi(t,e))}}var yi=function(){function t(t,e){this.predicate=t,this.inclusive=e}return t.prototype.call=function(t,e){return e.subscribe(new _i(t,this.predicate,this.inclusive))},t}(),_i=function(t){function e(e,n,i){var s=t.call(this,e)||this;return s.predicate=n,s.inclusive=i,s.index=0,s}return i.ZT(e,t),e.prototype._next=function(t){var e,n=this.destination;try{e=this.predicate(t,this.index++)}catch(t){return void n.error(t)}this.nextOrComplete(t,e)},e.prototype.nextOrComplete=function(t,e){var n=this.destination;Boolean(e)?n.next(t):(this.inclusive&&n.next(t),n.complete())},e}(f.L),bi=n(3306),xi=n(4156);function wi(t,e,n){return function(i){return i.lift(new Ti(t,e,n))}}var Ti=function(){function t(t,e,n){this.nextOrObserver=t,this.error=e,this.complete=n}return t.prototype.call=function(t,e){return e.subscribe(new Si(t,this.nextOrObserver,this.error,this.complete))},t}(),Si=function(t){function e(e,n,i,s){var r=t.call(this,e)||this;return r._tapNext=bi.Z,r._tapError=bi.Z,r._tapComplete=bi.Z,r._tapError=i||bi.Z,r._tapComplete=s||bi.Z,(0,xi.m)(n)?(r._context=r,r._tapNext=n):n&&(r._context=n,r._tapNext=n.next||bi.Z,r._tapError=n.error||bi.Z,r._tapComplete=n.complete||bi.Z),r}return i.ZT(e,t),e.prototype._next=function(t){try{this._tapNext.call(this._context,t)}catch(t){return void this.destination.error(t)}this.destination.next(t)},e.prototype._error=function(t){try{this._tapError.call(this._context,t)}catch(t){return void this.destination.error(t)}this.destination.error(t)},e.prototype._complete=function(){try{this._tapComplete.call(this._context)}catch(t){return void this.destination.error(t)}return this.destination.complete()},e}(f.L),ki={leading:!0,trailing:!1};function Oi(t,e){return void 0===e&&(e=ki),function(n){return n.lift(new Ei(t,!!e.leading,!!e.trailing))}}var Ei=function(){function t(t,e,n){this.durationSelector=t,this.leading=e,this.trailing=n}return t.prototype.call=function(t,e){return e.subscribe(new Ci(t,this.durationSelector,this.leading,this.trailing))},t}(),Ci=function(t){function e(e,n,i,s){var r=t.call(this,e)||this;return r.destination=e,r.durationSelector=n,r._leading=i,r._trailing=s,r._hasValue=!1,r}return i.ZT(e,t),e.prototype._next=function(t){this._hasValue=!0,this._sendValue=t,this._throttled||(this._leading?this.send():this.throttle(t))},e.prototype.send=function(){var t=this._hasValue,e=this._sendValue;t&&(this.destination.next(e),this.throttle(e)),this._hasValue=!1,this._sendValue=void 0},e.prototype.throttle=function(t){var e=this.tryDurationSelector(t);e&&this.add(this._throttled=(0,s.ft)(e,new s.IY(this)))},e.prototype.tryDurationSelector=function(t){try{return this.durationSelector(t)}catch(t){return this.destination.error(t),null}},e.prototype.throttlingDone=function(){var t=this._throttled,e=this._trailing;t&&t.unsubscribe(),this._throttled=void 0,e&&this.send()},e.prototype.notifyNext=function(){this.throttlingDone()},e.prototype.notifyComplete=function(){this.throttlingDone()},e}(s.Ds);function Ai(t,e,n){return void 0===e&&(e=c.P),void 0===n&&(n=ki),function(i){return i.lift(new Di(t,e,n.leading,n.trailing))}}var Di=function(){function t(t,e,n,i){this.duration=t,this.scheduler=e,this.leading=n,this.trailing=i}return t.prototype.call=function(t,e){return e.subscribe(new Mi(t,this.duration,this.scheduler,this.leading,this.trailing))},t}(),Mi=function(t){function e(e,n,i,s,r){var o=t.call(this,e)||this;return o.duration=n,o.scheduler=i,o.leading=s,o.trailing=r,o._hasTrailingValue=!1,o._trailingValue=null,o}return i.ZT(e,t),e.prototype._next=function(t){this.throttled?this.trailing&&(this._trailingValue=t,this._hasTrailingValue=!0):(this.add(this.throttled=this.scheduler.schedule(Ii,this.duration,{subscriber:this})),this.leading?this.destination.next(t):this.trailing&&(this._trailingValue=t,this._hasTrailingValue=!0))},e.prototype._complete=function(){this._hasTrailingValue?(this.destination.next(this._trailingValue),this.destination.complete()):this.destination.complete()},e.prototype.clearThrottle=function(){var t=this.throttled;t&&(this.trailing&&this._hasTrailingValue&&(this.destination.next(this._trailingValue),this._trailingValue=null,this._hasTrailingValue=!1),t.unsubscribe(),this.remove(t),this.throttled=null)},e}(f.L);function Ii(t){t.subscriber.clearThrottle()}var Pi=n(1410);function Ri(t){return void 0===t&&(t=c.P),function(e){return(0,Pi.P)((function(){return e.pipe(De((function(e,n){var i=e.current;return{value:n,current:t.now(),last:i}}),{current:t.now(),value:void 0,last:void 0}),(0,$t.U)((function(t){var e=t.current,n=t.last,i=t.value;return new ji(i,e-n)})))}))}}var ji=function(){return function(t,e){this.value=t,this.interval=e}}(),qi=n(1462);function Ni(t,e,n){return void 0===n&&(n=c.P),function(i){var s=ut(t),r=s?+t-n.now():Math.abs(t);return i.lift(new Vi(r,s,e,n))}}var Vi=function(){function t(t,e,n,i){this.waitFor=t,this.absoluteTimeout=e,this.withObservable=n,this.scheduler=i}return t.prototype.call=function(t,e){return e.subscribe(new Fi(t,this.absoluteTimeout,this.waitFor,this.withObservable,this.scheduler))},t}(),Fi=function(t){function e(e,n,i,s,r){var o=t.call(this,e)||this;return o.absoluteTimeout=n,o.waitFor=i,o.withObservable=s,o.scheduler=r,o.scheduleTimeout(),o}return i.ZT(e,t),e.dispatchTimeout=function(t){var e=t.withObservable;t._unsubscribeAndRecycle(),t.add((0,s.ft)(e,new s.IY(t)))},e.prototype.scheduleTimeout=function(){var t=this.action;t?this.action=t.schedule(this,this.waitFor):this.add(this.action=this.scheduler.schedule(e.dispatchTimeout,this.waitFor,this))},e.prototype._next=function(e){this.absoluteTimeout||this.scheduleTimeout(),t.prototype._next.call(this,e)},e.prototype._unsubscribe=function(){this.action=void 0,this.scheduler=null,this.withObservable=null},e}(s.Ds),Li=n(4944);function zi(t,e){return void 0===e&&(e=c.P),Ni(t,(0,Li._)(new qi.W),e)}function Bi(t){return void 0===t&&(t=c.P),(0,$t.U)((function(e){return new Wi(e,t.now())}))}var Wi=function(){return function(t,e){this.value=t,this.timestamp=e}}();function Zi(t,e,n){return 0===n?[e]:(t.push(e),t)}function Ui(){return Re(Zi,[])}function Yi(t){return function(e){return e.lift(new Gi(t))}}var Gi=function(){function t(t){this.windowBoundaries=t}return t.prototype.call=function(t,e){var n=new Xi(t),i=e.subscribe(n);return i.closed||n.add((0,s.ft)(this.windowBoundaries,new s.IY(n))),i},t}(),Xi=function(t){function e(e){var n=t.call(this,e)||this;return n.window=new rn.xQ,e.next(n.window),n}return i.ZT(e,t),e.prototype.notifyNext=function(){this.openWindow()},e.prototype.notifyError=function(t){this._error(t)},e.prototype.notifyComplete=function(){this._complete()},e.prototype._next=function(t){this.window.next(t)},e.prototype._error=function(t){this.window.error(t),this.destination.error(t)},e.prototype._complete=function(){this.window.complete(),this.destination.complete()},e.prototype._unsubscribe=function(){this.window=null},e.prototype.openWindow=function(){var t=this.window;t&&t.complete();var e=this.destination,n=this.window=new rn.xQ;e.next(n)},e}(s.Ds);function Qi(t,e){return void 0===e&&(e=0),function(n){return n.lift(new Hi(t,e))}}var Hi=function(){function t(t,e){this.windowSize=t,this.startWindowEvery=e}return t.prototype.call=function(t,e){return e.subscribe(new $i(t,this.windowSize,this.startWindowEvery))},t}(),$i=function(t){function e(e,n,i){var s=t.call(this,e)||this;return s.destination=e,s.windowSize=n,s.startWindowEvery=i,s.windows=[new rn.xQ],s.count=0,e.next(s.windows[0]),s}return i.ZT(e,t),e.prototype._next=function(t){for(var e=this.startWindowEvery>0?this.startWindowEvery:this.windowSize,n=this.destination,i=this.windowSize,s=this.windows,r=s.length,o=0;o<r&&!this.closed;o++)s[o].next(t);var a=this.count-i+1;if(a>=0&&a%e==0&&!this.closed&&s.shift().complete(),++this.count%e==0&&!this.closed){var c=new rn.xQ;s.push(c),n.next(c)}},e.prototype._error=function(t){var e=this.windows;if(e)for(;e.length>0&&!this.closed;)e.shift().error(t);this.destination.error(t)},e.prototype._complete=function(){var t=this.windows;if(t)for(;t.length>0&&!this.closed;)t.shift().complete();this.destination.complete()},e.prototype._unsubscribe=function(){this.count=0,this.windows=null},e}(f.L);function Ki(t){var e=c.P,n=null,i=Number.POSITIVE_INFINITY;return(0,_.K)(arguments[3])&&(e=arguments[3]),(0,_.K)(arguments[2])?e=arguments[2]:(0,ri.k)(arguments[2])&&(i=Number(arguments[2])),(0,_.K)(arguments[1])?e=arguments[1]:(0,ri.k)(arguments[1])&&(n=Number(arguments[1])),function(s){return s.lift(new Ji(t,n,i,e))}}var Ji=function(){function t(t,e,n,i){this.windowTimeSpan=t,this.windowCreationInterval=e,this.maxWindowSize=n,this.scheduler=i}return t.prototype.call=function(t,e){return e.subscribe(new es(t,this.windowTimeSpan,this.windowCreationInterval,this.maxWindowSize,this.scheduler))},t}(),ts=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._numberOfNextedValues=0,e}return i.ZT(e,t),e.prototype.next=function(e){this._numberOfNextedValues++,t.prototype.next.call(this,e)},Object.defineProperty(e.prototype,"numberOfNextedValues",{get:function(){return this._numberOfNextedValues},enumerable:!0,configurable:!0}),e}(rn.xQ),es=function(t){function e(e,n,i,s,r){var o=t.call(this,e)||this;o.destination=e,o.windowTimeSpan=n,o.windowCreationInterval=i,o.maxWindowSize=s,o.scheduler=r,o.windows=[];var a=o.openWindow();if(null!==i&&i>=0){var c={subscriber:o,window:a,context:null},u={windowTimeSpan:n,windowCreationInterval:i,subscriber:o,scheduler:r};o.add(r.schedule(ss,n,c)),o.add(r.schedule(is,i,u))}else{var l={subscriber:o,window:a,windowTimeSpan:n};o.add(r.schedule(ns,n,l))}return o}return i.ZT(e,t),e.prototype._next=function(t){for(var e=this.windows,n=e.length,i=0;i<n;i++){var s=e[i];s.closed||(s.next(t),s.numberOfNextedValues>=this.maxWindowSize&&this.closeWindow(s))}},e.prototype._error=function(t){for(var e=this.windows;e.length>0;)e.shift().error(t);this.destination.error(t)},e.prototype._complete=function(){for(var t=this.windows;t.length>0;){var e=t.shift();e.closed||e.complete()}this.destination.complete()},e.prototype.openWindow=function(){var t=new ts;return this.windows.push(t),this.destination.next(t),t},e.prototype.closeWindow=function(t){t.complete();var e=this.windows;e.splice(e.indexOf(t),1)},e}(f.L);function ns(t){var e=t.subscriber,n=t.windowTimeSpan,i=t.window;i&&e.closeWindow(i),t.window=e.openWindow(),this.schedule(t,n)}function is(t){var e=t.windowTimeSpan,n=t.subscriber,i=t.scheduler,s=t.windowCreationInterval,r=n.openWindow(),o=this,a={action:o,subscription:null},c={subscriber:n,window:r,context:a};a.subscription=i.schedule(ss,e,c),o.add(a.subscription),o.schedule(t,s)}function ss(t){var e=t.subscriber,n=t.window,i=t.context;i&&i.action&&i.subscription&&i.action.remove(i.subscription),e.closeWindow(n)}function rs(t,e){return function(n){return n.lift(new os(t,e))}}var os=function(){function t(t,e){this.openings=t,this.closingSelector=e}return t.prototype.call=function(t,e){return e.subscribe(new as(t,this.openings,this.closingSelector))},t}(),as=function(t){function e(e,n,i){var s=t.call(this,e)||this;return s.openings=n,s.closingSelector=i,s.contexts=[],s.add(s.openSubscription=(0,C.D)(s,n,n)),s}return i.ZT(e,t),e.prototype._next=function(t){var e=this.contexts;if(e)for(var n=e.length,i=0;i<n;i++)e[i].window.next(t)},e.prototype._error=function(e){var n=this.contexts;if(this.contexts=null,n)for(var i=n.length,s=-1;++s<i;){var r=n[s];r.window.error(e),r.subscription.unsubscribe()}t.prototype._error.call(this,e)},e.prototype._complete=function(){var e=this.contexts;if(this.contexts=null,e)for(var n=e.length,i=-1;++i<n;){var s=e[i];s.window.complete(),s.subscription.unsubscribe()}t.prototype._complete.call(this)},e.prototype._unsubscribe=function(){var t=this.contexts;if(this.contexts=null,t)for(var e=t.length,n=-1;++n<e;){var i=t[n];i.window.unsubscribe(),i.subscription.unsubscribe()}},e.prototype.notifyNext=function(t,e,n,i,s){if(t===this.openings){var r=void 0;try{r=(0,this.closingSelector)(e)}catch(t){return this.error(t)}var o=new rn.xQ,a=new E.w,c={window:o,subscription:a};this.contexts.push(c);var u=(0,C.D)(this,r,c);u.closed?this.closeWindow(this.contexts.length-1):(u.context=c,a.add(u)),this.destination.next(o)}else this.closeWindow(this.contexts.indexOf(t))},e.prototype.notifyError=function(t){this.error(t)},e.prototype.notifyComplete=function(t){t!==this.openSubscription&&this.closeWindow(this.contexts.indexOf(t.context))},e.prototype.closeWindow=function(t){if(-1!==t){var e=this.contexts,n=e[t],i=n.window,s=n.subscription;e.splice(t,1),i.complete(),s.unsubscribe()}},e}(A.L);function cs(t){return function(e){return e.lift(new us(t))}}var us=function(){function t(t){this.closingSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new ls(t,this.closingSelector))},t}(),ls=function(t){function e(e,n){var i=t.call(this,e)||this;return i.destination=e,i.closingSelector=n,i.openWindow(),i}return i.ZT(e,t),e.prototype.notifyNext=function(t,e,n,i,s){this.openWindow(s)},e.prototype.notifyError=function(t){this._error(t)},e.prototype.notifyComplete=function(t){this.openWindow(t)},e.prototype._next=function(t){this.window.next(t)},e.prototype._error=function(t){this.window.error(t),this.destination.error(t),this.unsubscribeClosingNotification()},e.prototype._complete=function(){this.window.complete(),this.destination.complete(),this.unsubscribeClosingNotification()},e.prototype.unsubscribeClosingNotification=function(){this.closingNotification&&this.closingNotification.unsubscribe()},e.prototype.openWindow=function(t){void 0===t&&(t=null),t&&(this.remove(t),t.unsubscribe());var e=this.window;e&&e.complete();var n,i=this.window=new rn.xQ;this.destination.next(i);try{n=(0,this.closingSelector)()}catch(t){return this.destination.error(t),void this.window.error(t)}this.add(this.closingNotification=(0,C.D)(this,n))},e}(A.L);function hs(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){var n;"function"==typeof t[t.length-1]&&(n=t.pop());var i=t;return e.lift(new ps(i,n))}}var ps=function(){function t(t,e){this.observables=t,this.project=e}return t.prototype.call=function(t,e){return e.subscribe(new ds(t,this.observables,this.project))},t}(),ds=function(t){function e(e,n,i){var s=t.call(this,e)||this;s.observables=n,s.project=i,s.toRespond=[];var r=n.length;s.values=new Array(r);for(var o=0;o<r;o++)s.toRespond.push(o);for(o=0;o<r;o++){var a=n[o];s.add((0,C.D)(s,a,void 0,o))}return s}return i.ZT(e,t),e.prototype.notifyNext=function(t,e,n){this.values[n]=e;var i=this.toRespond;if(i.length>0){var s=i.indexOf(n);-1!==s&&i.splice(s,1)}},e.prototype.notifyComplete=function(){},e.prototype._next=function(t){if(0===this.toRespond.length){var e=[t].concat(this.values);this.project?this._tryProject(e):this.destination.next(e)}},e.prototype._tryProject=function(t){var e;try{e=this.project.apply(this,t)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}(A.L),fs=n(5080);function ms(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){return e.lift.call(fs.$R.apply(void 0,[e].concat(t)))}}function vs(t){return function(e){return e.lift(new fs.mx(t))}}},879:(t,e,n)=>{"use strict";n.r(e),n.d(e,{AMOscillator:()=>Mr,AMSynth:()=>uo,Abs:()=>Gr,Add:()=>Vr,AmplitudeEnvelope:()=>oo,Analyser:()=>Ia,AudioToGain:()=>Ar,AutoFilter:()=>Qo,AutoPanner:()=>$o,AutoWah:()=>Jo,BaseContext:()=>hs,BiquadFilter:()=>lo,BitCrusher:()=>ea,Buffer:()=>pc,BufferSource:()=>fc,Buffers:()=>dc,Channel:()=>La,Chebyshev:()=>ia,Chorus:()=>ca,Clock:()=>tr,Compressor:()=>Ya,Context:()=>ps,Convolver:()=>Ka,CrossFade:()=>Yo,DCMeter:()=>qa,Delay:()=>er,Destination:()=>ic,Distortion:()=>ua,Draw:()=>cc,DuoSynth:()=>mo,EQ3:()=>$a,Emitter:()=>ls,Envelope:()=>no,FFT:()=>ja,FMOscillator:()=>Ir,FMSynth:()=>vo,FatOscillator:()=>Rr,FeedbackCombFilter:()=>Oo,FeedbackDelay:()=>ha,Filter:()=>ho,Follower:()=>Ko,Freeverb:()=>va,Frequency:()=>qs,FrequencyClass:()=>Ps,FrequencyEnvelope:()=>po,FrequencyShifter:()=>da,Gain:()=>Ys,GainToAudio:()=>Xr,Gate:()=>Ga,GrainPlayer:()=>Yr,GreaterThan:()=>Kr,GreaterThanZero:()=>$r,IntervalTimeline:()=>ur,JCReverb:()=>ba,LFO:()=>zr,Limiter:()=>Xa,Listener:()=>oc,Loop:()=>Po,LowpassCombFilter:()=>Co,Master:()=>sc,MembraneSynth:()=>_o,Merge:()=>ra,MetalSynth:()=>yo,Meter:()=>Ra,MidSideCompressor:()=>Qa,MidSideMerge:()=>Ea,MidSideSplit:()=>Oa,Midi:()=>rr,MidiClass:()=>sr,Mono:()=>za,MonoSynth:()=>fo,MultibandCompressor:()=>Ha,MultibandSplit:()=>Ba,Multiply:()=>Dr,Negate:()=>Qr,Noise:()=>_r,NoiseSynth:()=>bo,Offline:()=>nr,OfflineContext:()=>gs,OmniOscillator:()=>Nr,OnePoleFilter:()=>Eo,Oscillator:()=>Or,PWMOscillator:()=>jr,PanVol:()=>Fa,Panner:()=>Ho,Panner3D:()=>Za,Param:()=>zs,Part:()=>Ro,Pattern:()=>Zo,Phaser:()=>Sa,PingPongDelay:()=>wa,PitchShift:()=>Ta,Player:()=>Zr,Players:()=>Ur,PluckSynth:()=>Ao,PolySynth:()=>Do,Pow:()=>Jr,PulseOscillator:()=>Pr,Recorder:()=>Ua,Reverb:()=>ka,Sampler:()=>Mo,Scale:()=>Fr,ScaleExp:()=>to,Sequence:()=>Uo,Signal:()=>Qs,Solo:()=>Va,Split:()=>sa,StateTimeline:()=>Ls,StereoWidener:()=>Aa,Subtract:()=>Hr,SyncedSignal:()=>eo,Synth:()=>ao,Ticks:()=>ar,TicksClass:()=>or,Time:()=>Is,TimeClass:()=>Ms,Timeline:()=>rs,ToneAudioBuffer:()=>vs,ToneAudioBuffers:()=>ir,ToneAudioNode:()=>Bs,ToneBufferSource:()=>yr,ToneEvent:()=>Io,ToneOscillatorNode:()=>kr,Transport:()=>ec,TransportTime:()=>Vs,TransportTimeClass:()=>Ns,Tremolo:()=>Da,Unit:()=>s,UserMedia:()=>Tr,Vibrato:()=>Ma,Volume:()=>hr,WaveShaper:()=>Cr,Waveform:()=>Na,Zero:()=>Lr,connect:()=>Zs,connectSeries:()=>Ws,connectSignal:()=>Hs,context:()=>lc,dbToGain:()=>Ts,debug:()=>i,defaultArg:()=>Hi,disconnect:()=>Us,ftom:()=>Es,gainToDb:()=>Ss,getContext:()=>bs,getDestination:()=>rc,getDraw:()=>uc,getListener:()=>ac,getTransport:()=>nc,immediate:()=>tc,intervalToFrequencyRatio:()=>ks,isArray:()=>Ri,isBoolean:()=>Pi,isDefined:()=>Ai,isFunction:()=>Di,isNote:()=>qi,isNumber:()=>Mi,isObject:()=>Ii,isString:()=>ji,isUndef:()=>Ci,loaded:()=>hc,mtof:()=>As,now:()=>Ja,optionsFromArguments:()=>Qi,setContext:()=>xs,start:()=>ws,supported:()=>_i,version:()=>r});var i={};n.r(i),n.d(i,{assert:()=>xi,assertContextRunning:()=>Ti,assertRange:()=>wi,log:()=>Oi,setLogger:()=>ki,warn:()=>Ei});var s={};n.r(s);const r="14.7.77";var o=n(5382);const a=new WeakSet,c=new WeakMap,u=new WeakMap,l=new WeakMap,h=new WeakMap,p=new WeakMap,d=new WeakMap,f=new WeakMap,m=new WeakMap,v=new WeakMap,g={construct:()=>g},y=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,_=(t,e)=>{const n=[];let i=t.replace(/^[\s]+/,""),s=i.match(y);for(;null!==s;){const t=s[1].slice(1,-1),r=s[0].replace(/([\s]+)?;?$/,"").replace(t,new URL(t,e).toString());n.push(r),i=i.slice(s[0].length).replace(/^[\s]+/,""),s=i.match(y)}return[n.join(";"),i]},b=t=>{if(void 0!==t&&!Array.isArray(t))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},x=t=>{if(!(t=>{try{new new Proxy(t,g)}catch{return!1}return!0})(t))throw new TypeError("The given value for processorCtor should be a constructor.");if(null===t.prototype||"object"!=typeof t.prototype)throw new TypeError("The given value for processorCtor should have a prototype.")},w=(t,e)=>{const n=t.get(e);if(void 0===n)throw new Error("A value with the given key could not be found.");return n},T=(t,e)=>{const n=Array.from(t).filter(e);if(n.length>1)throw Error("More than one element was found.");if(0===n.length)throw Error("No element was found.");const[i]=n;return t.delete(i),i},S=(t,e,n,i)=>{const s=w(t,e),r=T(s,(t=>t[0]===n&&t[1]===i));return 0===s.size&&t.delete(e),r},k=t=>w(d,t),O=t=>{if(a.has(t))throw new Error("The AudioNode is already stored.");a.add(t),k(t).forEach((t=>t(!0)))},E=t=>"port"in t,C=t=>{if(!a.has(t))throw new Error("The AudioNode is not stored.");a.delete(t),k(t).forEach((t=>t(!1)))},A=(t,e)=>{!E(t)&&e.every((t=>0===t.size))&&C(t)},D={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},M=(t,e)=>t.context===e,I=t=>{try{t.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},P=()=>new DOMException("","IndexSizeError"),R=t=>{var e;t.getChannelData=(e=t.getChannelData,n=>{try{return e.call(t,n)}catch(t){if(12===t.code)throw P();throw t}})},j={numberOfChannels:1},q=-34028234663852886e22,N=-q,V=t=>a.has(t),F={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},L=t=>w(c,t),z=t=>w(l,t),B=(t,e)=>{const{activeInputs:n}=L(t);n.forEach((n=>n.forEach((([n])=>{e.includes(t)||B(n,[...e,t])}))));const i=(t=>"playbackRate"in t)(t)?[t.playbackRate]:E(t)?Array.from(t.parameters.values()):(t=>"frequency"in t&&"gain"in t)(t)?[t.Q,t.detune,t.frequency,t.gain]:(t=>"offset"in t)(t)?[t.offset]:(t=>!("frequency"in t)&&"gain"in t)(t)?[t.gain]:(t=>"detune"in t&&"frequency"in t)(t)?[t.detune,t.frequency]:(t=>"pan"in t)(t)?[t.pan]:[];for(const t of i){const n=z(t);void 0!==n&&n.activeInputs.forEach((([t])=>B(t,e)))}V(t)&&C(t)},W=t=>{B(t.destination,[])},Z=t=>"context"in t,U=t=>Z(t[0]),Y=(t,e,n,i)=>{for(const e of t)if(n(e)){if(i)return!1;throw Error("The set contains at least one similar element.")}return t.add(e),!0},G=(t,e,[n,i],s)=>{Y(t,[e,n,i],(t=>t[0]===e&&t[1]===n),s)},X=(t,[e,n,i],s)=>{const r=t.get(e);void 0===r?t.set(e,new Set([[n,i]])):Y(r,[n,i],(t=>t[0]===n),s)},Q=t=>"inputs"in t,H=(t,e,n,i)=>{if(Q(e)){const s=e.inputs[i];return t.connect(s,n,0),[s,n,0]}return t.connect(e,n,i),[e,n,i]},$=(t,e,n)=>{for(const i of t)if(i[0]===e&&i[1]===n)return t.delete(i),i;return null},K=(t,e)=>{if(!k(t).delete(e))throw new Error("Missing the expected event listener.")},J=(t,e,n)=>{const i=w(t,e),s=T(i,(t=>t[0]===n));return 0===i.size&&t.delete(e),s},tt=(t,e,n,i)=>{Q(e)?t.disconnect(e.inputs[i],n,0):t.disconnect(e,n,i)},et=t=>w(u,t),nt=t=>w(h,t),it=t=>f.has(t),st=t=>!a.has(t),rt=t=>new Promise((e=>{const n=t.createScriptProcessor(256,1,1),i=t.createGain(),s=t.createBuffer(1,2,44100),r=s.getChannelData(0);r[0]=1,r[1]=1;const o=t.createBufferSource();o.buffer=s,o.loop=!0,o.connect(n).connect(t.destination),o.connect(i),o.disconnect(i),n.onaudioprocess=i=>{const s=i.inputBuffer.getChannelData(0);Array.prototype.some.call(s,(t=>1===t))?e(!0):e(!1),o.stop(),n.onaudioprocess=null,o.disconnect(n),n.disconnect(t.destination)},o.start()})),ot=(t,e)=>{const n=new Map;for(const e of t)for(const t of e){const e=n.get(t);n.set(t,void 0===e?1:e+1)}n.forEach(((t,n)=>e(n,t)))},at=t=>"context"in t,ct=t=>{const e=new Map;t.connect=(t=>(n,i=0,s=0)=>{const r=at(n)?t(n,i,s):t(n,i),o=e.get(n);return void 0===o?e.set(n,[{input:s,output:i}]):o.every((t=>t.input!==s||t.output!==i))&&o.push({input:s,output:i}),r})(t.connect.bind(t)),t.disconnect=(n=>(i,s,r)=>{if(n.apply(t),void 0===i)e.clear();else if("number"==typeof i)for(const[t,n]of e){const s=n.filter((t=>t.output!==i));0===s.length?e.delete(t):e.set(t,s)}else if(e.has(i))if(void 0===s)e.delete(i);else{const t=e.get(i);if(void 0!==t){const n=t.filter((t=>t.output!==s&&(t.input!==r||void 0===r)));0===n.length?e.delete(i):e.set(i,n)}}for(const[n,i]of e)i.forEach((e=>{at(n)?t.connect(n,e.output,e.input):t.connect(n,e.output)}))})(t.disconnect)},ut=(t,e,n,i,s)=>{const[r,o]=((t,e,n,i)=>{const{activeInputs:s,passiveInputs:r}=L(e),o=$(s[i],t,n);return null===o?[S(r,t,n,i)[2],!1]:[o[2],!0]})(t,n,i,s);if(null!==r&&(K(t,r),!o||e||it(t)||tt(et(t),et(n),i,s)),V(n)){const{activeInputs:t}=L(n);A(n,t)}},lt=(t,e,n,i)=>{const[s,r]=((t,e,n)=>{const{activeInputs:i,passiveInputs:s}=z(e),r=$(i,t,n);return null===r?[J(s,t,n)[1],!1]:[r[2],!0]})(t,n,i);null!==s&&(K(t,s),!r||e||it(t)||et(t).disconnect(nt(n),i))};class ht{constructor(t){this._map=new Map(t)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(t,e=null){return this._map.forEach(((n,i)=>t.call(e,n,i,this)))}get(t){return this._map.get(t)}has(t){return this._map.has(t)}keys(){return this._map.keys()}values(){return this._map.values()}}const pt={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}};function dt(t,e,n,i,s){if("function"==typeof t.copyFromChannel)0===e[n].byteLength&&(e[n]=new Float32Array(128)),t.copyFromChannel(e[n],i,s);else{const r=t.getChannelData(i);if(0===e[n].byteLength)e[n]=r.slice(s,s+128);else{const t=new Float32Array(r.buffer,s*Float32Array.BYTES_PER_ELEMENT,128);e[n].set(t)}}}const ft=(t,e,n,i,s)=>{"function"==typeof t.copyToChannel?0!==e[n].byteLength&&t.copyToChannel(e[n],i,s):0!==e[n].byteLength&&t.getChannelData(i).set(e[n],s)},mt=(t,e)=>{const n=[];for(let i=0;i<t;i+=1){const t=[],s="number"==typeof e?e:e[i];for(let e=0;e<s;e+=1)t.push(new Float32Array(128));n.push(t)}return n},vt=async(t,e,n,i,s,r,o)=>{const a=null===e?128*Math.ceil(t.context.length/128):e.length,c=i.channelCount*i.numberOfInputs,u=s.reduce(((t,e)=>t+e),0),l=0===u?null:n.createBuffer(u,a,n.sampleRate);if(void 0===r)throw new Error("Missing the processor constructor.");const h=L(t),p=await((t,e)=>{const n=w(v,t),i=et(e);return w(n,i)})(n,t),d=mt(i.numberOfInputs,i.channelCount),f=mt(i.numberOfOutputs,s),m=Array.from(t.parameters.keys()).reduce(((t,e)=>({...t,[e]:new Float32Array(128)})),{});for(let u=0;u<a;u+=128){if(i.numberOfInputs>0&&null!==e)for(let t=0;t<i.numberOfInputs;t+=1)for(let n=0;n<i.channelCount;n+=1)dt(e,d[t],n,n,u);void 0!==r.parameterDescriptors&&null!==e&&r.parameterDescriptors.forEach((({name:t},n)=>{dt(e,m,t,c+n,u)}));for(let t=0;t<i.numberOfInputs;t+=1)for(let e=0;e<s[t];e+=1)0===f[t][e].byteLength&&(f[t][e]=new Float32Array(128));try{const t=d.map(((t,e)=>0===h.activeInputs[e].size?[]:t)),e=o(u/n.sampleRate,n.sampleRate,(()=>p.process(t,f,m)));if(null!==l)for(let t=0,e=0;t<i.numberOfOutputs;t+=1){for(let n=0;n<s[t];n+=1)ft(l,f[t],n,e+n,u);e+=s[t]}if(!e)break}catch(e){t.dispatchEvent(new ErrorEvent("processorerror",{colno:e.colno,filename:e.filename,lineno:e.lineno,message:e.message}));break}}return l},gt={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},yt={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},_t={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},bt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},xt={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},wt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},Tt=(t,e,n)=>{const i=e[n];if(void 0===i)throw t();return i},St={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},kt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},Ot=()=>new DOMException("","InvalidStateError"),Et=()=>new DOMException("","InvalidAccessError"),Ct={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},At=(t,e,n,i,s,r,o,a,c,u,l)=>{const h=u.length;let p=a;for(let a=0;a<h;a+=1){let h=n[0]*u[a];for(let e=1;e<s;e+=1){const i=p-e&c-1;h+=n[e]*r[i],h-=t[e]*o[i]}for(let t=s;t<i;t+=1)h+=n[t]*r[p-t&c-1];for(let n=s;n<e;n+=1)h-=t[n]*o[p-n&c-1];r[p]=u[a],o[p]=h,p=p+1&c-1,l[a]=h}return p},Dt={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},Mt=t=>{const e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const n=t.decodeAudioData(e.buffer,(()=>{}));return void 0!==n&&(n.catch((()=>{})),!0)}catch{}return!1},It=(t,e,n)=>{const i=e[n];void 0!==i&&i!==t[n]&&(t[n]=i)},Pt=(t,e)=>{It(t,e,"channelCount"),It(t,e,"channelCountMode"),It(t,e,"channelInterpretation")},Rt=t=>"function"==typeof t.getFloatTimeDomainData,jt=(t,e,n)=>{const i=e[n];void 0!==i&&i!==t[n].value&&(t[n].value=i)},qt=t=>{t.start=(e=>(n=0,i=0,s)=>{if("number"==typeof s&&s<0||i<0||n<0)throw new RangeError("The parameters can't be negative.");e.call(t,n,i,s)})(t.start)},Nt=t=>{var e;t.stop=(e=t.stop,(n=0)=>{if(n<0)throw new RangeError("The parameter can't be negative.");e.call(t,n)})},Vt=(t,e)=>null===t?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(t*e))))),Ft=(t,e)=>{const n=t.createBiquadFilter();return Pt(n,e),jt(n,e,"Q"),jt(n,e,"detune"),jt(n,e,"frequency"),jt(n,e,"gain"),It(n,e,"type"),n},Lt=(t,e)=>{const n=t.createChannelSplitter(e.numberOfOutputs);return Pt(n,e),(t=>{const e=t.numberOfOutputs;Object.defineProperty(t,"channelCount",{get:()=>e,set:t=>{if(t!==e)throw Ot()}}),Object.defineProperty(t,"channelCountMode",{get:()=>"explicit",set:t=>{if("explicit"!==t)throw Ot()}}),Object.defineProperty(t,"channelInterpretation",{get:()=>"discrete",set:t=>{if("discrete"!==t)throw Ot()}})})(n),n},zt=(t,e)=>(t.connect=e.connect.bind(e),t.disconnect=e.disconnect.bind(e),t),Bt=(t,e)=>{const n=t.createDelay(e.maxDelayTime);return Pt(n,e),jt(n,e,"delayTime"),n},Wt=(t,e)=>{const n=t.createGain();return Pt(n,e),jt(n,e,"gain"),n};function Zt(t,e){const n=e[0]*e[0]+e[1]*e[1];return[(t[0]*e[0]+t[1]*e[1])/n,(t[1]*e[0]-t[0]*e[1])/n]}function Ut(t,e){let n=[0,0];for(let r=t.length-1;r>=0;r-=1)s=e,n=[(i=n)[0]*s[0]-i[1]*s[1],i[0]*s[1]+i[1]*s[0]],n[0]+=t[r];var i,s;return n}const Yt=(t,e,n,i)=>t.createScriptProcessor(e,n,i),Gt=()=>new DOMException("","NotSupportedError"),Xt={numberOfChannels:1},Qt={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},Ht={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},$t={disableNormalization:!1},Kt={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},Jt=()=>new DOMException("","UnknownError"),te={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},ee=t=>{if(null===t)return!1;const e=t.length;return e%2!=0?0!==t[Math.floor(e/2)]:t[e/2-1]+t[e/2]!==0},ne=(t,e,n,i)=>{let s=Object.getPrototypeOf(t);for(;!s.hasOwnProperty(e);)s=Object.getPrototypeOf(s);const{get:r,set:o}=Object.getOwnPropertyDescriptor(s,e);Object.defineProperty(t,e,{get:n(r),set:i(o)})},ie=(t,e,n)=>{try{t.setValueAtTime(e,n)}catch(i){if(9!==i.code)throw i;ie(t,e,n+1e-7)}},se=t=>{const e=t.createOscillator();try{e.start(-1)}catch(t){return t instanceof RangeError}return!1},re=t=>{const e=t.createBuffer(1,1,44100),n=t.createBufferSource();n.buffer=e,n.start(),n.stop();try{return n.stop(),!0}catch{return!1}},oe=t=>{const e=t.createOscillator();try{e.stop(-1)}catch(t){return t instanceof RangeError}return!1},ae=()=>{try{new DOMException}catch{return!1}return!0},ce=()=>new Promise((t=>{const e=new ArrayBuffer(0),{port1:n,port2:i}=new MessageChannel;n.onmessage=({data:e})=>t(null!==e),i.postMessage(e,[e])})),ue=(t,e)=>{const n=e.createGain();t.connect(n);const i=(e=>()=>{e.call(t,n),t.removeEventListener("ended",i)})(t.disconnect);t.addEventListener("ended",i),zt(t,n),t.stop=(e=>{let i=!1;return(s=0)=>{if(i)try{e.call(t,s)}catch{n.gain.setValueAtTime(0,s)}else e.call(t,s),i=!0}})(t.stop)},le=(t,e)=>n=>{const i={value:t};return Object.defineProperties(n,{currentTarget:i,target:i}),"function"==typeof e?e.call(t,n):e.handleEvent.call(t,n)},he=(t=>(e,n,[i,s,r],o)=>{t(e[s],[n,i,r],(t=>t[0]===n&&t[1]===i),o)})(Y),pe=(t=>(e,n,[i,s,r],o)=>{const a=e.get(i);void 0===a?e.set(i,new Set([[s,n,r]])):t(a,[s,n,r],(t=>t[0]===s&&t[1]===n),o)})(Y),de=(t=>(e,n,i,s)=>t(e[s],(t=>t[0]===n&&t[1]===i)))(T),fe=new WeakMap,me=(t=>e=>{var n;return null!==(n=t.get(e))&&void 0!==n?n:0})(fe),ve=(ge=new Map,ye=new WeakMap,(t,e)=>{const n=ye.get(t);if(void 0!==n)return n;const i=ge.get(t);if(void 0!==i)return i;try{const n=e();return n instanceof Promise?(ge.set(t,n),n.catch((()=>!1)).then((e=>(ge.delete(t),ye.set(t,e),e)))):(ye.set(t,n),n)}catch{return ye.set(t,!1),!1}});var ge,ye;const _e="undefined"==typeof window?null:window,be=((t,e)=>(n,i)=>{const s=n.createAnalyser();if(Pt(s,i),!(i.maxDecibels>i.minDecibels))throw e();return It(s,i,"fftSize"),It(s,i,"maxDecibels"),It(s,i,"minDecibels"),It(s,i,"smoothingTimeConstant"),t(Rt,(()=>Rt(s)))||(t=>{t.getFloatTimeDomainData=e=>{const n=new Uint8Array(e.length);t.getByteTimeDomainData(n);const i=Math.max(n.length,t.fftSize);for(let t=0;t<i;t+=1)e[t]=.0078125*(n[t]-128);return e}})(s),s})(ve,P),xe=(t=>e=>{const n=t(e);if(null===n.renderer)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return n.renderer})(L),we=((t,e,n)=>async(i,s,r,o)=>{const a=t(i),c=[...o,i];await Promise.all(a.activeInputs.map(((t,o)=>Array.from(t).filter((([t])=>!c.includes(t))).map((async([t,a])=>{const u=e(t),l=await u.render(t,s,c),h=i.context.destination;n(t)||i===h&&n(i)||l.connect(r,a,o)})))).reduce(((t,e)=>[...t,...e]),[]))})(L,xe,it),Te=((t,e,n)=>()=>{const i=new WeakMap;return{render(s,r,o){const a=i.get(r);return void 0!==a?Promise.resolve(a):(async(s,r,o)=>{let a=e(s);if(!M(a,r)){const e={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,fftSize:a.fftSize,maxDecibels:a.maxDecibels,minDecibels:a.minDecibels,smoothingTimeConstant:a.smoothingTimeConstant};a=t(r,e)}return i.set(r,a),await n(s,r,a,o),a})(s,r,o)}}})(be,et,we),Se=(ke=p,t=>{const e=ke.get(t);if(void 0===e)throw Ot();return e});var ke;const Oe=(t=>null===t?null:t.hasOwnProperty("OfflineAudioContext")?t.OfflineAudioContext:t.hasOwnProperty("webkitOfflineAudioContext")?t.webkitOfflineAudioContext:null)(_e),Ee=(t=>e=>null!==t&&e instanceof t)(Oe),Ce=new WeakMap,Ae=(t=>class{constructor(t){this._nativeEventTarget=t,this._listeners=new WeakMap}addEventListener(e,n,i){if(null!==n){let s=this._listeners.get(n);void 0===s&&(s=t(this,n),"function"==typeof n&&this._listeners.set(n,s)),this._nativeEventTarget.addEventListener(e,s,i)}}dispatchEvent(t){return this._nativeEventTarget.dispatchEvent(t)}removeEventListener(t,e,n){const i=null===e?void 0:this._listeners.get(e);this._nativeEventTarget.removeEventListener(t,void 0===i?null:i,n)}})(le),De=(t=>null===t?null:t.hasOwnProperty("AudioContext")?t.AudioContext:t.hasOwnProperty("webkitAudioContext")?t.webkitAudioContext:null)(_e),Me=(t=>e=>null!==t&&e instanceof t)(De),Ie=(t=>e=>null!==t&&"function"==typeof t.AudioNode&&e instanceof t.AudioNode)(_e),Pe=(t=>e=>null!==t&&"function"==typeof t.AudioParam&&e instanceof t.AudioParam)(_e),Re=((t,e,n,i,s,r,o,a,c,l,h,p,f,m,v)=>class extends l{constructor(e,i,s,r){super(s),this._context=e,this._nativeAudioNode=s;const o=h(e);p(o)&&!0!==n(rt,(()=>rt(o)))&&ct(s),u.set(this,s),d.set(this,new Set),"closed"!==e.state&&i&&O(this),t(this,r,s)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(t){this._nativeAudioNode.channelCount=t}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(t){this._nativeAudioNode.channelCountMode=t}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(t){this._nativeAudioNode.channelInterpretation=t}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(t,n=0,a=0){if(n<0||n>=this._nativeAudioNode.numberOfOutputs)throw s();const u=h(this._context),l=v(u);if(f(t)||m(t))throw r();if(Z(t)){const s=et(t);try{const e=H(this._nativeAudioNode,s,n,a),i=st(this);(l||i)&&this._nativeAudioNode.disconnect(...e),"closed"!==this.context.state&&!i&&st(t)&&O(t)}catch(t){if(12===t.code)throw r();throw t}if(e(this,t,n,a,l)){const e=c([this],t);ot(e,i(l))}return t}const p=nt(t);if("playbackRate"===p.name&&1024===p.maxValue)throw o();try{this._nativeAudioNode.connect(p,n),(l||st(this))&&this._nativeAudioNode.disconnect(p,n)}catch(t){if(12===t.code)throw r();throw t}if(((t,e,n,i)=>{const{activeInputs:s,passiveInputs:r}=z(e),{outputs:o}=L(t),a=k(t),c=o=>{const a=et(t),c=nt(e);if(o){const e=J(r,t,n);G(s,t,e,!1),i||it(t)||a.connect(c,n)}else{const e=((t,e,n)=>T(t,(t=>t[0]===e&&t[1]===n)))(s,t,n);X(r,e,!1),i||it(t)||a.disconnect(c,n)}};return!!Y(o,[e,n],(t=>t[0]===e&&t[1]===n),!0)&&(a.add(c),V(t)?G(s,t,[n,c],!0):X(r,[t,n,c],!0),!0)})(this,t,n,l)){const e=c([this],t);ot(e,i(l))}}disconnect(t,e,n){let i;const o=h(this._context),u=v(o);if(void 0===t)i=((t,e)=>{const n=L(t),i=[];for(const s of n.outputs)U(s)?ut(t,e,...s):lt(t,e,...s),i.push(s[0]);return n.outputs.clear(),i})(this,u);else if("number"==typeof t){if(t<0||t>=this.numberOfOutputs)throw s();i=((t,e,n)=>{const i=L(t),s=[];for(const r of i.outputs)r[1]===n&&(U(r)?ut(t,e,...r):lt(t,e,...r),s.push(r[0]),i.outputs.delete(r));return s})(this,u,t)}else{if(void 0!==e&&(e<0||e>=this.numberOfOutputs))throw s();if(Z(t)&&void 0!==n&&(n<0||n>=t.numberOfInputs))throw s();if(i=((t,e,n,i,s)=>{const r=L(t);return Array.from(r.outputs).filter((t=>!(t[0]!==n||void 0!==i&&t[1]!==i||void 0!==s&&t[2]!==s))).map((n=>(U(n)?ut(t,e,...n):lt(t,e,...n),r.outputs.delete(n),n[0])))})(this,u,t,e,n),0===i.length)throw r()}for(const t of i){const e=c([this],t);ot(e,a)}}})((je=c,(t,e,n)=>{const i=[];for(let t=0;t<n.numberOfInputs;t+=1)i.push(new Set);je.set(t,{activeInputs:i,outputs:new Set,passiveInputs:new WeakMap,renderer:e})}),((t,e,n,i,s,r,o,a,c,u,l,h,p)=>{const d=new WeakMap;return(f,m,v,g,y)=>{const{activeInputs:_,passiveInputs:b}=r(m),{outputs:x}=r(f),w=a(f),T=r=>{const a=c(m),u=c(f);if(r){const e=S(b,f,v,g);t(_,f,e,!1),y||h(f)||n(u,a,v,g),p(m)&&O(m)}else{const t=i(_,f,v,g);e(b,g,t,!1),y||h(f)||s(u,a,v,g);const n=o(m);if(0===n)l(m)&&A(m,_);else{const t=d.get(m);void 0!==t&&clearTimeout(t),d.set(m,setTimeout((()=>{l(m)&&A(m,_)}),1e3*n))}}};return!!u(x,[m,v,g],(t=>t[0]===m&&t[1]===v&&t[2]===g),!0)&&(w.add(T),l(f)?t(_,f,[v,g,T],!0):e(b,g,[f,v,T],!0),!0)}})(he,pe,H,de,tt,L,me,k,et,Y,V,it,st),ve,((t,e,n,i,s,r)=>o=>(a,c)=>{const u=t.get(a);if(void 0===u){if(!o&&r(a)){const t=i(a),{outputs:r}=n(a);for(const n of r)if(U(n)){const s=i(n[0]);e(t,s,n[1],n[2])}else{const e=s(n[0]);t.disconnect(e,n[1])}}t.set(a,c)}else t.set(a,u+c)})(f,tt,L,et,nt,V),P,Et,Gt,((t,e,n,i,s,r,o,a)=>(c,u)=>{const l=e.get(c);if(void 0===l)throw new Error("Missing the expected cycle count.");const h=r(c.context),p=a(h);if(l===u){if(e.delete(c),!p&&o(c)){const e=i(c),{outputs:r}=n(c);for(const n of r)if(U(n)){const s=i(n[0]);t(e,s,n[1],n[2])}else{const t=s(n[0]);e.connect(t,n[1])}}}else e.set(c,l-u)})(H,f,L,et,nt,Se,V,Ee),((t,e,n)=>function i(s,r){const o=Z(r)?r:n(t,r);if((t=>"delayTime"in t)(o))return[];if(s[0]===o)return[s];if(s.includes(o))return[];const{outputs:a}=e(o);return Array.from(a).map((t=>i([...s,o],t[0]))).reduce(((t,e)=>t.concat(e)),[])})(Ce,L,w),Ae,Se,Me,Ie,Pe,Ee);var je;const qe=((t,e,n,i,s,r)=>class extends t{constructor(t,n){const o=s(t),a={...D,...n},c=i(o,a);super(t,!1,c,r(o)?e():null),this._nativeAnalyserNode=c}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(t){this._nativeAnalyserNode.fftSize=t}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(t){const e=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=t,!(t>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=e,n()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(t){const e=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=t,!(this._nativeAnalyserNode.maxDecibels>t))throw this._nativeAnalyserNode.minDecibels=e,n()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(t){this._nativeAnalyserNode.smoothingTimeConstant=t}getByteFrequencyData(t){this._nativeAnalyserNode.getByteFrequencyData(t)}getByteTimeDomainData(t){this._nativeAnalyserNode.getByteTimeDomainData(t)}getFloatFrequencyData(t){this._nativeAnalyserNode.getFloatFrequencyData(t)}getFloatTimeDomainData(t){this._nativeAnalyserNode.getFloatTimeDomainData(t)}})(Re,Te,P,be,Se,Ee),Ne=new WeakSet,Ve=(t=>null===t?null:t.hasOwnProperty("AudioBuffer")?t.AudioBuffer:null)(_e),Fe=(Le=new Uint32Array(1),t=>(Le[0]=t,Le[0]));var Le;const ze=((t,e)=>n=>{n.copyFromChannel=(i,s,r=0)=>{const o=t(r),a=t(s);if(a>=n.numberOfChannels)throw e();const c=n.length,u=n.getChannelData(a),l=i.length;for(let t=o<0?-o:0;t+o<c&&t<l;t+=1)i[t]=u[t+o]},n.copyToChannel=(i,s,r=0)=>{const o=t(r),a=t(s);if(a>=n.numberOfChannels)throw e();const c=n.length,u=n.getChannelData(a),l=i.length;for(let t=o<0?-o:0;t+o<c&&t<l;t+=1)u[t+o]=i[t]}})(Fe,P),Be=(t=>e=>{e.copyFromChannel=(n=>(i,s,r=0)=>{const o=t(r),a=t(s);if(o<e.length)return n.call(e,i,a,o)})(e.copyFromChannel),e.copyToChannel=(n=>(i,s,r=0)=>{const o=t(r),a=t(s);if(o<e.length)return n.call(e,i,a,o)})(e.copyToChannel)})(Fe),We=((t,e,n,i,s,r,o,a)=>{let c=null;return class u{constructor(u){if(null===s)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:l,numberOfChannels:h,sampleRate:p}={...j,...u};null===c&&(c=new s(1,1,44100));const d=null!==i&&e(r,r)?new i({length:l,numberOfChannels:h,sampleRate:p}):c.createBuffer(h,l,p);if(0===d.numberOfChannels)throw n();return"function"!=typeof d.copyFromChannel?(o(d),R(d)):e(I,(()=>I(d)))||a(d),t.add(d),d}static[Symbol.hasInstance](e){return null!==e&&"object"==typeof e&&Object.getPrototypeOf(e)===u.prototype||t.has(e)}}})(Ne,ve,Gt,Ve,Oe,(t=>()=>{if(null===t)return!1;try{new t({length:1,sampleRate:44100})}catch{return!1}return!0})(Ve),ze,Be),Ze=(t=>(e,n)=>{const i=t(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});n.connect(i).connect(e.destination);const s=()=>{n.removeEventListener("ended",s),n.disconnect(i),i.disconnect()};n.addEventListener("ended",s)})(Wt),Ue=((t,e,n)=>async(i,s,r,o)=>{const a=e(i);await Promise.all(Array.from(a.activeInputs).map((async([e,i])=>{const a=t(e),c=await a.render(e,s,o);n(e)||c.connect(r,i)})))})(xe,z,it),Ye=(t=>(e,n,i,s)=>t(n,e,i,s))(Ue),Ge=((t,e,n,i,s,r,o,a,c,u,l)=>(c,h)=>{const p=c.createBufferSource();return Pt(p,h),jt(p,h,"playbackRate"),It(p,h,"buffer"),It(p,h,"loop"),It(p,h,"loopEnd"),It(p,h,"loopStart"),e(n,(()=>n(c)))||(t=>{t.start=(e=>{let n=!1;return(i=0,s=0,r)=>{if(n)throw Ot();e.call(t,i,s,r),n=!0}})(t.start)})(p),e(i,(()=>i(c)))||(t=>{t.start=(e=>(n=0,i=0,s)=>{const r=t.buffer,o=null===r?i:Math.min(r.duration,i);null!==r&&o>r.duration-.5/t.context.sampleRate?e.call(t,n,0,0):e.call(t,n,o,s)})(t.start)})(p),e(s,(()=>s(c)))||u(p,c),e(r,(()=>r(c)))||qt(p),e(o,(()=>o(c)))||l(p,c),e(a,(()=>a(c)))||Nt(p),t(c,p),p})(Ze,ve,(t=>{const e=t.createBufferSource();e.start();try{e.start()}catch{return!0}return!1}),(t=>{const e=t.createBufferSource(),n=t.createBuffer(1,1,44100);e.buffer=n;try{e.start(0,1)}catch{return!1}return!0}),(t=>{const e=t.createBufferSource();e.start();try{e.stop()}catch{return!1}return!0}),se,re,oe,0,(t=>(e,n)=>{const i=n.createBuffer(1,1,44100);null===e.buffer&&(e.buffer=i),t(e,"buffer",(t=>()=>{const n=t.call(e);return n===i?null:n}),(t=>n=>t.call(e,null===n?i:n)))})(ne),ue),Xe=((t,e)=>(n,i,s,r)=>(t(i).replay(s),e(i,n,s,r)))((t=>e=>{const n=t(e);if(null===n.renderer)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return n.renderer})(z),Ue),Qe=((t,e,n,i,s)=>()=>{const r=new WeakMap;let o=null,a=null;return{set start(t){o=t},set stop(t){a=t},render(c,u,l){const h=r.get(u);return void 0!==h?Promise.resolve(h):(async(c,u,l)=>{let h=n(c);const p=M(h,u);if(!p){const t={buffer:h.buffer,channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,loop:h.loop,loopEnd:h.loopEnd,loopStart:h.loopStart,playbackRate:h.playbackRate.value};h=e(u,t),null!==o&&h.start(...o),null!==a&&h.stop(a)}return r.set(u,h),p?await t(u,c.playbackRate,h.playbackRate,l):await i(u,c.playbackRate,h.playbackRate,l),await s(c,u,h,l),h})(c,u,l)}}})(Ye,Ge,et,Xe,we),He=((t,e,n,i,s,r,a,c,u,l,h,p,d)=>(i,f,m,v=null,g=null)=>{const y=new o.AutomationEventList(m.defaultValue),_=f?(t=>({replay(e){for(const n of t)if("exponentialRampToValue"===n.type){const{endTime:t,value:i}=n;e.exponentialRampToValueAtTime(i,t)}else if("linearRampToValue"===n.type){const{endTime:t,value:i}=n;e.linearRampToValueAtTime(i,t)}else if("setTarget"===n.type){const{startTime:t,target:i,timeConstant:s}=n;e.setTargetAtTime(i,t,s)}else if("setValue"===n.type){const{startTime:t,value:i}=n;e.setValueAtTime(i,t)}else{if("setValueCurve"!==n.type)throw new Error("Can't apply an unknown automation.");{const{duration:t,startTime:i,values:s}=n;e.setValueCurveAtTime(s,i,t)}}}}))(y):null,b={get defaultValue(){return m.defaultValue},get maxValue(){return null===v?m.maxValue:v},get minValue(){return null===g?m.minValue:g},get value(){return m.value},set value(t){m.value=t,b.setValueAtTime(t,i.context.currentTime)},cancelAndHoldAtTime(t){if("function"==typeof m.cancelAndHoldAtTime)null===_&&y.flush(i.context.currentTime),y.add(s(t)),m.cancelAndHoldAtTime(t);else{const e=Array.from(y).pop();null===_&&y.flush(i.context.currentTime),y.add(s(t));const n=Array.from(y).pop();m.cancelScheduledValues(t),e!==n&&void 0!==n&&("exponentialRampToValue"===n.type?m.exponentialRampToValueAtTime(n.value,n.endTime):"linearRampToValue"===n.type?m.linearRampToValueAtTime(n.value,n.endTime):"setValue"===n.type?m.setValueAtTime(n.value,n.startTime):"setValueCurve"===n.type&&m.setValueCurveAtTime(n.values,n.startTime,n.duration))}return b},cancelScheduledValues:t=>(null===_&&y.flush(i.context.currentTime),y.add(r(t)),m.cancelScheduledValues(t),b),exponentialRampToValueAtTime(t,e){if(0===t)throw new RangeError;if(!Number.isFinite(e)||e<0)throw new RangeError;return null===_&&y.flush(i.context.currentTime),y.add(a(t,e)),m.exponentialRampToValueAtTime(t,e),b},linearRampToValueAtTime:(t,e)=>(null===_&&y.flush(i.context.currentTime),y.add(c(t,e)),m.linearRampToValueAtTime(t,e),b),setTargetAtTime:(t,e,n)=>(null===_&&y.flush(i.context.currentTime),y.add(u(t,e,n)),m.setTargetAtTime(t,e,n),b),setValueAtTime:(t,e)=>(null===_&&y.flush(i.context.currentTime),y.add(l(t,e)),m.setValueAtTime(t,e),b),setValueCurveAtTime(t,e,n){const s=t instanceof Float32Array?t:new Float32Array(t);if(null!==p&&"webkitAudioContext"===p.name){const t=e+n,r=i.context.sampleRate,o=Math.ceil(e*r),a=Math.floor(t*r),c=a-o,u=new Float32Array(c);for(let t=0;t<c;t+=1){const i=(s.length-1)/n*((o+t)/r-e),a=Math.floor(i),c=Math.ceil(i);u[t]=a===c?s[a]:(1-(i-a))*s[a]+(1-(c-i))*s[c]}null===_&&y.flush(i.context.currentTime),y.add(h(u,e,n)),m.setValueCurveAtTime(u,e,n);const l=a/r;l<t&&d(b,u[u.length-1],l),d(b,s[s.length-1],t)}else null===_&&y.flush(i.context.currentTime),y.add(h(s,e,n)),m.setValueCurveAtTime(s,e,n);return b}};return n.set(b,m),e.set(b,i),t(b,_),b})(($e=l,(t,e)=>{$e.set(t,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:e})}),Ce,h,0,o.createCancelAndHoldAutomationEvent,o.createCancelScheduledValuesAutomationEvent,o.createExponentialRampToValueAutomationEvent,o.createLinearRampToValueAutomationEvent,o.createSetTargetAutomationEvent,o.createSetValueAutomationEvent,o.createSetValueCurveAutomationEvent,De,ie);var $e;const Ke=((t,e,n,i,s,r,o,a)=>class extends t{constructor(t,i){const a=r(t),c={...F,...i},u=s(a,c),l=o(a),h=l?e():null;super(t,!1,u,h),this._audioBufferSourceNodeRenderer=h,this._isBufferNullified=!1,this._isBufferSet=null!==c.buffer,this._nativeAudioBufferSourceNode=u,this._onended=null,this._playbackRate=n(this,l,u.playbackRate,N,q)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(t){if(this._nativeAudioBufferSourceNode.buffer=t,null!==t){if(this._isBufferSet)throw i();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(t){this._nativeAudioBufferSourceNode.loop=t}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(t){this._nativeAudioBufferSourceNode.loopEnd=t}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(t){this._nativeAudioBufferSourceNode.loopStart=t}get onended(){return this._onended}set onended(t){const e="function"==typeof t?a(this,t):null;this._nativeAudioBufferSourceNode.onended=e;const n=this._nativeAudioBufferSourceNode.onended;this._onended=null!==n&&n===e?t:n}get playbackRate(){return this._playbackRate}start(t=0,e=0,n){if(this._nativeAudioBufferSourceNode.start(t,e,n),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.start=void 0===n?[t,e]:[t,e,n]),"closed"!==this.context.state){O(this);const t=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",t),V(this)&&C(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",t)}}stop(t=0){this._nativeAudioBufferSourceNode.stop(t),null!==this._audioBufferSourceNodeRenderer&&(this._audioBufferSourceNodeRenderer.stop=t)}})(Re,Qe,He,Ot,Ge,Se,Ee,le),Je=((t,e,n,i,s,r,o,a)=>class extends t{constructor(t,e){const n=r(t),i=o(n),c=s(n,e,i);super(t,!1,c,i?(t=>{let e=null;return{render:(n,i,s)=>(null===e&&(e=(async(e,n,i)=>{const s=n.destination;return await t(e,n,s,i),s})(n,i,s)),e)}})(a):null),this._isNodeOfNativeOfflineAudioContext=i,this._nativeAudioDestinationNode=c}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(t){if(this._isNodeOfNativeOfflineAudioContext)throw i();if(t>this._nativeAudioDestinationNode.maxChannelCount)throw n();this._nativeAudioDestinationNode.channelCount=t}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(t){if(this._isNodeOfNativeOfflineAudioContext)throw i();this._nativeAudioDestinationNode.channelCountMode=t}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}})(Re,0,P,Ot,((t,e)=>(n,i,s)=>{const r=n.destination;if(r.channelCount!==i)try{r.channelCount=i}catch{}s&&"explicit"!==r.channelCountMode&&(r.channelCountMode="explicit"),0===r.maxChannelCount&&Object.defineProperty(r,"maxChannelCount",{value:i});const o=t(n,{channelCount:i,channelCountMode:r.channelCountMode,channelInterpretation:r.channelInterpretation,gain:1});return e(o,"channelCount",(t=>()=>t.call(o)),(t=>e=>{t.call(o,e);try{r.channelCount=e}catch(t){if(e>r.maxChannelCount)throw t}})),e(o,"channelCountMode",(t=>()=>t.call(o)),(t=>e=>{t.call(o,e),r.channelCountMode=e})),e(o,"channelInterpretation",(t=>()=>t.call(o)),(t=>e=>{t.call(o,e),r.channelInterpretation=e})),Object.defineProperty(o,"maxChannelCount",{get:()=>r.maxChannelCount}),o.connect(r),o})(Wt,ne),Se,Ee,we),tn=((t,e,n,i,s)=>()=>{const r=new WeakMap;return{render(o,a,c){const u=r.get(a);return void 0!==u?Promise.resolve(u):(async(o,a,c)=>{let u=n(o);const l=M(u,a);if(!l){const t={Q:u.Q.value,channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,detune:u.detune.value,frequency:u.frequency.value,gain:u.gain.value,type:u.type};u=e(a,t)}return r.set(a,u),l?(await t(a,o.Q,u.Q,c),await t(a,o.detune,u.detune,c),await t(a,o.frequency,u.frequency,c),await t(a,o.gain,u.gain,c)):(await i(a,o.Q,u.Q,c),await i(a,o.detune,u.detune,c),await i(a,o.frequency,u.frequency,c),await i(a,o.gain,u.gain,c)),await s(o,a,u,c),u})(o,a,c)}}})(Ye,Ft,et,Xe,we),en=(t=>(e,n)=>t.set(e,n))(fe),nn=((t,e,n,i,s,r,o,a)=>class extends t{constructor(t,i){const c=r(t),u={...gt,...i},l=s(c,u),h=o(c);super(t,!1,l,h?n():null),this._Q=e(this,h,l.Q,N,q),this._detune=e(this,h,l.detune,1200*Math.log2(N),-1200*Math.log2(N)),this._frequency=e(this,h,l.frequency,t.sampleRate/2,0),this._gain=e(this,h,l.gain,40*Math.log10(N),q),this._nativeBiquadFilterNode=l,a(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(t){this._nativeBiquadFilterNode.type=t}getFrequencyResponse(t,e,n){try{this._nativeBiquadFilterNode.getFrequencyResponse(t,e,n)}catch(t){if(11===t.code)throw i();throw t}if(t.length!==e.length||e.length!==n.length)throw i()}})(Re,He,tn,Et,Ft,Se,Ee,en),sn=((t,e)=>(n,i,s)=>{const r=new Set;return n.connect=(s=>(o,a=0,c=0)=>{const u=0===r.size;if(e(o))return s.call(n,o,a,c),t(r,[o,a,c],(t=>t[0]===o&&t[1]===a&&t[2]===c),!0),u&&i(),o;s.call(n,o,a),t(r,[o,a],(t=>t[0]===o&&t[1]===a),!0),u&&i()})(n.connect),n.disconnect=(t=>(i,o,a)=>{const c=r.size>0;if(void 0===i)t.apply(n),r.clear();else if("number"==typeof i){t.call(n,i);for(const t of r)t[1]===i&&r.delete(t)}else{e(i)?t.call(n,i,o,a):t.call(n,i,o);for(const t of r)t[0]!==i||void 0!==o&&t[1]!==o||void 0!==a&&t[2]!==a||r.delete(t)}const u=0===r.size;c&&u&&s()})(n.disconnect),n})(Y,Ie),rn=((t,e)=>(n,i)=>{i.channelCount=1,i.channelCountMode="explicit",Object.defineProperty(i,"channelCount",{get:()=>1,set:()=>{throw t()}}),Object.defineProperty(i,"channelCountMode",{get:()=>"explicit",set:()=>{throw t()}});const s=n.createBufferSource();e(i,(()=>{const t=i.numberOfInputs;for(let e=0;e<t;e+=1)s.connect(i,0,e)}),(()=>s.disconnect(i)))})(Ot,sn),on=((t,e)=>(n,i)=>{const s=n.createChannelMerger(i.numberOfInputs);return null!==t&&"webkitAudioContext"===t.name&&e(n,s),Pt(s,i),s})(De,rn),an=((t,e,n,i,s)=>class extends t{constructor(t,r){const o=i(t),a={...yt,...r};super(t,!1,n(o,a),s(o)?e():null)}})(Re,((t,e,n)=>()=>{const i=new WeakMap;return{render(s,r,o){const a=i.get(r);return void 0!==a?Promise.resolve(a):(async(s,r,o)=>{let a=e(s);if(!M(a,r)){const e={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfInputs:a.numberOfInputs};a=t(r,e)}return i.set(r,a),await n(s,r,a,o),a})(s,r,o)}}})(on,et,we),on,Se,Ee),cn=((t,e,n,i,s,r)=>class extends t{constructor(t,r){const o=i(t),a=(t=>({...t,channelCount:t.numberOfOutputs}))({..._t,...r});super(t,!1,n(o,a),s(o)?e():null)}})(Re,((t,e,n)=>()=>{const i=new WeakMap;return{render(s,r,o){const a=i.get(r);return void 0!==a?Promise.resolve(a):(async(s,r,o)=>{let a=e(s);if(!M(a,r)){const e={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfOutputs:a.numberOfOutputs};a=t(r,e)}return i.set(r,a),await n(s,r,a,o),a})(s,r,o)}}})(Lt,et,we),Lt,Se,Ee),un=((t,e,n,i)=>(s,{offset:r,...o})=>{const a=s.createBuffer(1,2,44100),c=e(s,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),u=n(s,{...o,gain:r}),l=a.getChannelData(0);l[0]=1,l[1]=1,c.buffer=a,c.loop=!0;const h={get bufferSize(){},get channelCount(){return u.channelCount},set channelCount(t){u.channelCount=t},get channelCountMode(){return u.channelCountMode},set channelCountMode(t){u.channelCountMode=t},get channelInterpretation(){return u.channelInterpretation},set channelInterpretation(t){u.channelInterpretation=t},get context(){return u.context},get inputs(){return[]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return u.numberOfOutputs},get offset(){return u.gain},get onended(){return c.onended},set onended(t){c.onended=t},addEventListener:(...t)=>c.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>c.dispatchEvent(t[0]),removeEventListener:(...t)=>c.removeEventListener(t[0],t[1],t[2]),start(t=0){c.start.call(c,t)},stop(t=0){c.stop.call(c,t)}};return t(s,c),i(zt(h,u),(()=>c.connect(u)),(()=>c.disconnect(u)))})(Ze,Ge,Wt,sn),ln=((t,e,n,i,s)=>(r,o)=>{if(void 0===r.createConstantSource)return n(r,o);const a=r.createConstantSource();return Pt(a,o),jt(a,o,"offset"),e(i,(()=>i(r)))||qt(a),e(s,(()=>s(r)))||Nt(a),t(r,a),a})(Ze,ve,un,se,oe),hn=((t,e,n,i,s,r,o)=>class extends t{constructor(t,o){const a=s(t),c={...bt,...o},u=i(a,c),l=r(a),h=l?n():null;super(t,!1,u,h),this._constantSourceNodeRenderer=h,this._nativeConstantSourceNode=u,this._offset=e(this,l,u.offset,N,q),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(t){const e="function"==typeof t?o(this,t):null;this._nativeConstantSourceNode.onended=e;const n=this._nativeConstantSourceNode.onended;this._onended=null!==n&&n===e?t:n}start(t=0){if(this._nativeConstantSourceNode.start(t),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.start=t),"closed"!==this.context.state){O(this);const t=()=>{this._nativeConstantSourceNode.removeEventListener("ended",t),V(this)&&C(this)};this._nativeConstantSourceNode.addEventListener("ended",t)}}stop(t=0){this._nativeConstantSourceNode.stop(t),null!==this._constantSourceNodeRenderer&&(this._constantSourceNodeRenderer.stop=t)}})(Re,He,((t,e,n,i,s)=>()=>{const r=new WeakMap;let o=null,a=null;return{set start(t){o=t},set stop(t){a=t},render(c,u,l){const h=r.get(u);return void 0!==h?Promise.resolve(h):(async(c,u,l)=>{let h=n(c);const p=M(h,u);if(!p){const t={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,offset:h.offset.value};h=e(u,t),null!==o&&h.start(o),null!==a&&h.stop(a)}return r.set(u,h),p?await t(u,c.offset,h.offset,l):await i(u,c.offset,h.offset,l),await s(c,u,h,l),h})(c,u,l)}}})(Ye,ln,et,Xe,we),ln,Se,Ee,le),pn=((t,e)=>(n,i)=>{const s=n.createConvolver();if(Pt(s,i),i.disableNormalization===s.normalize&&(s.normalize=!i.disableNormalization),It(s,i,"buffer"),i.channelCount>2)throw t();if(e(s,"channelCount",(t=>()=>t.call(s)),(e=>n=>{if(n>2)throw t();return e.call(s,n)})),"max"===i.channelCountMode)throw t();return e(s,"channelCountMode",(t=>()=>t.call(s)),(e=>n=>{if("max"===n)throw t();return e.call(s,n)})),s})(Gt,ne),dn=((t,e,n,i,s,r)=>class extends t{constructor(t,o){const a=i(t),c={...xt,...o},u=n(a,c);super(t,!1,u,s(a)?e():null),this._isBufferNullified=!1,this._nativeConvolverNode=u,null!==c.buffer&&r(this,c.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(t){if(this._nativeConvolverNode.buffer=t,null===t&&null!==this._nativeConvolverNode.buffer){const t=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=t.createBuffer(1,1,44100),this._isBufferNullified=!0,r(this,0)}else this._isBufferNullified=!1,r(this,null===this._nativeConvolverNode.buffer?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(t){this._nativeConvolverNode.normalize=t}})(Re,((t,e,n)=>()=>{const i=new WeakMap;return{render(s,r,o){const a=i.get(r);return void 0!==a?Promise.resolve(a):(async(s,r,o)=>{let a=e(s);if(!M(a,r)){const e={buffer:a.buffer,channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,disableNormalization:!a.normalize};a=t(r,e)}return i.set(r,a),Q(a)?await n(s,r,a.inputs[0],o):await n(s,r,a,o),a})(s,r,o)}}})(pn,et,we),pn,Se,Ee,en),fn=((t,e,n,i,s,r,o)=>class extends t{constructor(t,a){const c=s(t),u={...wt,...a},l=i(c,u),h=r(c);super(t,!1,l,h?n(u.maxDelayTime):null),this._delayTime=e(this,h,l.delayTime),o(this,u.maxDelayTime)}get delayTime(){return this._delayTime}})(Re,He,((t,e,n,i,s)=>r=>{const o=new WeakMap;return{render(a,c,u){const l=o.get(c);return void 0!==l?Promise.resolve(l):(async(a,c,u)=>{let l=n(a);const h=M(l,c);if(!h){const t={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,delayTime:l.delayTime.value,maxDelayTime:r};l=e(c,t)}return o.set(c,l),h?await t(c,a.delayTime,l.delayTime,u):await i(c,a.delayTime,l.delayTime,u),await s(a,c,l,u),l})(a,c,u)}}})(Ye,Bt,et,Xe,we),Bt,Se,Ee,en),mn=(t=>(e,n)=>{const i=e.createDynamicsCompressor();if(Pt(i,n),n.channelCount>2)throw t();if("max"===n.channelCountMode)throw t();return jt(i,n,"attack"),jt(i,n,"knee"),jt(i,n,"ratio"),jt(i,n,"release"),jt(i,n,"threshold"),i})(Gt),vn=((t,e,n,i,s,r,o,a)=>class extends t{constructor(t,s){const c=r(t),u={...St,...s},l=i(c,u),h=o(c);super(t,!1,l,h?n():null),this._attack=e(this,h,l.attack),this._knee=e(this,h,l.knee),this._nativeDynamicsCompressorNode=l,this._ratio=e(this,h,l.ratio),this._release=e(this,h,l.release),this._threshold=e(this,h,l.threshold),a(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(t){const e=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=t,t>2)throw this._nativeDynamicsCompressorNode.channelCount=e,s()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(t){const e=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=t,"max"===t)throw this._nativeDynamicsCompressorNode.channelCountMode=e,s()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return"number"==typeof this._nativeDynamicsCompressorNode.reduction.value?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}})(Re,He,((t,e,n,i,s)=>()=>{const r=new WeakMap;return{render(o,a,c){const u=r.get(a);return void 0!==u?Promise.resolve(u):(async(o,a,c)=>{let u=n(o);const l=M(u,a);if(!l){const t={attack:u.attack.value,channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,knee:u.knee.value,ratio:u.ratio.value,release:u.release.value,threshold:u.threshold.value};u=e(a,t)}return r.set(a,u),l?(await t(a,o.attack,u.attack,c),await t(a,o.knee,u.knee,c),await t(a,o.ratio,u.ratio,c),await t(a,o.release,u.release,c),await t(a,o.threshold,u.threshold,c)):(await i(a,o.attack,u.attack,c),await i(a,o.knee,u.knee,c),await i(a,o.ratio,u.ratio,c),await i(a,o.release,u.release,c),await i(a,o.threshold,u.threshold,c)),await s(o,a,u,c),u})(o,a,c)}}})(Ye,mn,et,Xe,we),mn,Gt,Se,Ee,en),gn=((t,e,n,i,s,r)=>class extends t{constructor(t,o){const a=s(t),c={...kt,...o},u=i(a,c),l=r(a);super(t,!1,u,l?n():null),this._gain=e(this,l,u.gain,N,q)}get gain(){return this._gain}})(Re,He,((t,e,n,i,s)=>()=>{const r=new WeakMap;return{render(o,a,c){const u=r.get(a);return void 0!==u?Promise.resolve(u):(async(o,a,c)=>{let u=n(o);const l=M(u,a);if(!l){const t={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,gain:u.gain.value};u=e(a,t)}return r.set(a,u),l?await t(a,o.gain,u.gain,c):await i(a,o.gain,u.gain,c),await s(o,a,u,c),u})(o,a,c)}}})(Ye,Wt,et,Xe,we),Wt,Se,Ee),yn=((t,e,n,i)=>(s,r,{channelCount:o,channelCountMode:a,channelInterpretation:c,feedback:u,feedforward:l})=>{const h=Vt(r,s.sampleRate),p=u instanceof Float64Array?u:new Float64Array(u),d=l instanceof Float64Array?l:new Float64Array(l),f=p.length,m=d.length,v=Math.min(f,m);if(0===f||f>20)throw i();if(0===p[0])throw e();if(0===m||m>20)throw i();if(0===d[0])throw e();if(1!==p[0]){for(let t=0;t<m;t+=1)d[t]/=p[0];for(let t=1;t<f;t+=1)p[t]/=p[0]}const g=n(s,h,o,o);g.channelCount=o,g.channelCountMode=a,g.channelInterpretation=c;const y=[],_=[],b=[];for(let t=0;t<o;t+=1){y.push(0);const t=new Float32Array(32),e=new Float32Array(32);t.fill(0),e.fill(0),_.push(t),b.push(e)}g.onaudioprocess=t=>{const e=t.inputBuffer,n=t.outputBuffer,i=e.numberOfChannels;for(let t=0;t<i;t+=1){const i=e.getChannelData(t),s=n.getChannelData(t);y[t]=At(p,f,d,m,v,_[t],b[t],y[t],32,i,s)}};const x=s.sampleRate/2;return zt({get bufferSize(){return h},get channelCount(){return g.channelCount},set channelCount(t){g.channelCount=t},get channelCountMode(){return g.channelCountMode},set channelCountMode(t){g.channelCountMode=t},get channelInterpretation(){return g.channelInterpretation},set channelInterpretation(t){g.channelInterpretation=t},get context(){return g.context},get inputs(){return[g]},get numberOfInputs(){return g.numberOfInputs},get numberOfOutputs(){return g.numberOfOutputs},addEventListener:(...t)=>g.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>g.dispatchEvent(t[0]),getFrequencyResponse(e,n,i){if(e.length!==n.length||n.length!==i.length)throw t();const s=e.length;for(let t=0;t<s;t+=1){const s=-Math.PI*(e[t]/x),r=[Math.cos(s),Math.sin(s)],o=Zt(Ut(d,r),Ut(p,r));n[t]=Math.sqrt(o[0]*o[0]+o[1]*o[1]),i[t]=Math.atan2(o[1],o[0])}},removeEventListener:(...t)=>g.removeEventListener(t[0],t[1],t[2])},g)})(Et,Ot,Yt,Gt),_n=((t,e,n,i)=>s=>t(Mt,(()=>Mt(s)))?Promise.resolve(t(i,i)).then((t=>{if(!t){const t=n(s,512,0,1);s.oncomplete=()=>{t.onaudioprocess=null,t.disconnect()},t.onaudioprocess=()=>s.currentTime,t.connect(s.destination)}return s.startRendering()})):new Promise((t=>{const n=e(s,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});s.oncomplete=e=>{n.disconnect(),t(e.renderedBuffer)},n.connect(s.destination),s.startRendering()})))(ve,Wt,Yt,((t,e)=>()=>{if(null===e)return Promise.resolve(!1);const n=new e(1,1,44100),i=t(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise((t=>{n.oncomplete=()=>{i.disconnect(),t(0!==n.currentTime)},n.startRendering()}))})(Wt,Oe)),bn=((t,e,n,i,s)=>(r,o)=>{const a=new WeakMap;let c=null;return{render(u,l,h){const p=a.get(l);return void 0!==p?Promise.resolve(p):(async(u,l,h)=>{let p=null,d=e(u);const f=M(d,l);if(void 0===l.createIIRFilter?p=t(l,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):f||(d=l.createIIRFilter(o,r)),a.set(l,null===p?d:p),null!==p){if(null===c){if(null===n)throw new Error("Missing the native OfflineAudioContext constructor.");const t=new n(u.context.destination.channelCount,u.context.length,l.sampleRate);c=(async()=>(await i(u,t,t.destination,h),((t,e,n,i)=>{const s=n instanceof Float64Array?n:new Float64Array(n),r=i instanceof Float64Array?i:new Float64Array(i),o=s.length,a=r.length,c=Math.min(o,a);if(1!==s[0]){for(let t=0;t<o;t+=1)r[t]/=s[0];for(let t=1;t<a;t+=1)s[t]/=s[0]}const u=new Float32Array(32),l=new Float32Array(32),h=e.createBuffer(t.numberOfChannels,t.length,t.sampleRate),p=t.numberOfChannels;for(let e=0;e<p;e+=1){const n=t.getChannelData(e),i=h.getChannelData(e);u.fill(0),l.fill(0),At(s,o,r,a,c,u,l,0,32,n,i)}return h})(await s(t),l,r,o)))()}const t=await c;return p.buffer=t,p.start(0),p}return await i(u,l,d,h),d})(u,l,h)}}})(Ge,et,Oe,we,_n),xn=((t,e,n,i,s,r)=>class extends t{constructor(t,o){const a=i(t),c=s(a),u={...Ct,...o},l=e(a,c?null:t.baseLatency,u);super(t,!1,l,c?n(u.feedback,u.feedforward):null),(t=>{var e;t.getFrequencyResponse=(e=t.getFrequencyResponse,(n,i,s)=>{if(n.length!==i.length||i.length!==s.length)throw Et();return e.call(t,n,i,s)})})(l),this._nativeIIRFilterNode=l,r(this,1)}getFrequencyResponse(t,e,n){return this._nativeIIRFilterNode.getFrequencyResponse(t,e,n)}})(Re,(t=>(e,n,i)=>{if(void 0===e.createIIRFilter)return t(e,n,i);const s=e.createIIRFilter(i.feedforward,i.feedback);return Pt(s,i),s})(yn),bn,Se,Ee,en),wn=((t,e,n,i,s)=>(r,o)=>{const a=o.listener,{forwardX:c,forwardY:u,forwardZ:l,positionX:h,positionY:p,positionZ:d,upX:f,upY:m,upZ:v}=void 0===a.forwardX?(()=>{const c=e(o,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),u=s(o),l=i(o,256,9,0),h=(e,i)=>{const s=n(o,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:i});return s.connect(c,0,e),s.start(),Object.defineProperty(s.offset,"defaultValue",{get:()=>i}),t({context:r},u,s.offset,N,q)};let p=[0,0,-1,0,1,0],d=[0,0,0];return l.onaudioprocess=({inputBuffer:t})=>{const e=[t.getChannelData(0)[0],t.getChannelData(1)[0],t.getChannelData(2)[0],t.getChannelData(3)[0],t.getChannelData(4)[0],t.getChannelData(5)[0]];e.some(((t,e)=>t!==p[e]))&&(a.setOrientation(...e),p=e);const n=[t.getChannelData(6)[0],t.getChannelData(7)[0],t.getChannelData(8)[0]];n.some(((t,e)=>t!==d[e]))&&(a.setPosition(...n),d=n)},c.connect(l),{forwardX:h(0,0),forwardY:h(1,0),forwardZ:h(2,-1),positionX:h(6,0),positionY:h(7,0),positionZ:h(8,0),upX:h(3,0),upY:h(4,1),upZ:h(5,0)}})():a;return{get forwardX(){return c},get forwardY(){return u},get forwardZ(){return l},get positionX(){return h},get positionY(){return p},get positionZ(){return d},get upX(){return f},get upY(){return m},get upZ(){return v}}})(He,on,ln,Yt,Ee),Tn=new WeakMap,Sn=((t,e,n,i,s,r)=>class extends n{constructor(n,r){super(n),this._nativeContext=n,p.set(this,n),i(n)&&s.set(n,new Set),this._destination=new t(this,r),this._listener=e(this,n),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(t){const e="function"==typeof t?r(this,t):null;this._nativeContext.onstatechange=e;const n=this._nativeContext.onstatechange;this._onstatechange=null!==n&&n===e?t:n}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}})(Je,wn,Ae,Ee,Tn,le),kn=((t,e,n,i,s,r)=>(o,a)=>{const c=o.createOscillator();return Pt(c,a),jt(c,a,"detune"),jt(c,a,"frequency"),void 0!==a.periodicWave?c.setPeriodicWave(a.periodicWave):It(c,a,"type"),e(n,(()=>n(o)))||qt(c),e(i,(()=>i(o)))||r(c,o),e(s,(()=>s(o)))||Nt(c),t(o,c),c})(Ze,ve,se,re,oe,ue),On=((t,e,n,i,s)=>()=>{const r=new WeakMap;let o=null,a=null,c=null;return{set periodicWave(t){o=t},set start(t){a=t},set stop(t){c=t},render(u,l,h){const p=r.get(l);return void 0!==p?Promise.resolve(p):(async(u,l,h)=>{let p=n(u);const d=M(p,l);if(!d){const t={channelCount:p.channelCount,channelCountMode:p.channelCountMode,channelInterpretation:p.channelInterpretation,detune:p.detune.value,frequency:p.frequency.value,periodicWave:null===o?void 0:o,type:p.type};p=e(l,t),null!==a&&p.start(a),null!==c&&p.stop(c)}return r.set(l,p),d?(await t(l,u.detune,p.detune,h),await t(l,u.frequency,p.frequency,h)):(await i(l,u.detune,p.detune,h),await i(l,u.frequency,p.frequency,h)),await s(u,l,p,h),p})(u,l,h)}}})(Ye,kn,et,Xe,we),En=((t,e,n,i,s,r,o)=>class extends t{constructor(t,o){const a=s(t),c={...Qt,...o},u=n(a,c),l=r(a),h=l?i():null,p=t.sampleRate/2;super(t,!1,u,h),this._detune=e(this,l,u.detune,153600,-153600),this._frequency=e(this,l,u.frequency,p,-p),this._nativeOscillatorNode=u,this._onended=null,this._oscillatorNodeRenderer=h,null!==this._oscillatorNodeRenderer&&void 0!==c.periodicWave&&(this._oscillatorNodeRenderer.periodicWave=c.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(t){const e="function"==typeof t?o(this,t):null;this._nativeOscillatorNode.onended=e;const n=this._nativeOscillatorNode.onended;this._onended=null!==n&&n===e?t:n}get type(){return this._nativeOscillatorNode.type}set type(t){this._nativeOscillatorNode.type=t,null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(t){this._nativeOscillatorNode.setPeriodicWave(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.periodicWave=t)}start(t=0){if(this._nativeOscillatorNode.start(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.start=t),"closed"!==this.context.state){O(this);const t=()=>{this._nativeOscillatorNode.removeEventListener("ended",t),V(this)&&C(this)};this._nativeOscillatorNode.addEventListener("ended",t)}}stop(t=0){this._nativeOscillatorNode.stop(t),null!==this._oscillatorNodeRenderer&&(this._oscillatorNodeRenderer.stop=t)}})(Re,He,kn,On,Se,Ee,le),Cn=(t=>(e,n)=>{const i=t(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),s=e.createBuffer(1,2,44100);return i.buffer=s,i.loop=!0,i.connect(n),i.start(),()=>{i.stop(),i.disconnect(n)}})(Ge),An=((t,e,n,i,s)=>(r,{curve:o,oversample:a,...c})=>{const u=r.createWaveShaper(),l=r.createWaveShaper();Pt(u,c),Pt(l,c);const h=n(r,{...c,gain:1}),p=n(r,{...c,gain:-1}),d=n(r,{...c,gain:1}),f=n(r,{...c,gain:-1});let m=null,v=!1,g=null;const y={get bufferSize(){},get channelCount(){return u.channelCount},set channelCount(t){h.channelCount=t,p.channelCount=t,u.channelCount=t,d.channelCount=t,l.channelCount=t,f.channelCount=t},get channelCountMode(){return u.channelCountMode},set channelCountMode(t){h.channelCountMode=t,p.channelCountMode=t,u.channelCountMode=t,d.channelCountMode=t,l.channelCountMode=t,f.channelCountMode=t},get channelInterpretation(){return u.channelInterpretation},set channelInterpretation(t){h.channelInterpretation=t,p.channelInterpretation=t,u.channelInterpretation=t,d.channelInterpretation=t,l.channelInterpretation=t,f.channelInterpretation=t},get context(){return u.context},get curve(){return g},set curve(n){if(null!==n&&n.length<2)throw e();if(null===n)u.curve=n,l.curve=n;else{const t=n.length,e=new Float32Array(t+2-t%2),i=new Float32Array(t+2-t%2);e[0]=n[0],i[0]=-n[t-1];const s=Math.ceil((t+1)/2),r=(t+1)/2-1;for(let o=1;o<s;o+=1){const a=o/s*r,c=Math.floor(a),u=Math.ceil(a);e[o]=c===u?n[c]:(1-(a-c))*n[c]+(1-(u-a))*n[u],i[o]=c===u?-n[t-1-c]:-(1-(a-c))*n[t-1-c]-(1-(u-a))*n[t-1-u]}e[s]=t%2==1?n[s-1]:(n[s-2]+n[s-1])/2,u.curve=e,l.curve=i}g=n,v&&(i(g)&&null===m?m=t(r,h):null!==m&&(m(),m=null))},get inputs(){return[h]},get numberOfInputs(){return u.numberOfInputs},get numberOfOutputs(){return u.numberOfOutputs},get oversample(){return u.oversample},set oversample(t){u.oversample=t,l.oversample=t},addEventListener:(...t)=>h.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>h.dispatchEvent(t[0]),removeEventListener:(...t)=>h.removeEventListener(t[0],t[1],t[2])};return null!==o&&(y.curve=o instanceof Float32Array?o:new Float32Array(o)),a!==y.oversample&&(y.oversample=a),s(zt(y,d),(()=>{h.connect(u).connect(d),h.connect(p).connect(l).connect(f).connect(d),v=!0,i(g)&&(m=t(r,h))}),(()=>{h.disconnect(u),u.disconnect(d),h.disconnect(p),p.disconnect(l),l.disconnect(f),f.disconnect(d),v=!1,null!==m&&(m(),m=null)}))})(Cn,Ot,Wt,ee,sn),Dn=((t,e,n,i,s,r,o)=>(a,c)=>{const u=a.createWaveShaper();if(null!==r&&"webkitAudioContext"===r.name&&void 0===a.createGain().gain.automationRate)return n(a,c);Pt(u,c);const l=null===c.curve||c.curve instanceof Float32Array?c.curve:new Float32Array(c.curve);if(null!==l&&l.length<2)throw e();It(u,{curve:l},"curve"),It(u,c,"oversample");let h=null,p=!1;return o(u,"curve",(t=>()=>t.call(u)),(e=>n=>(e.call(u,n),p&&(i(n)&&null===h?h=t(a,u):i(n)||null===h||(h(),h=null)),n))),s(u,(()=>{p=!0,i(u.curve)&&(h=t(a,u))}),(()=>{p=!1,null!==h&&(h(),h=null)}))})(Cn,Ot,An,ee,sn,De,ne),Mn=(bi=((t,e,n,i,s,r,o,a,c)=>(u,{coneInnerAngle:l,coneOuterAngle:h,coneOuterGain:p,distanceModel:d,maxDistance:f,orientationX:m,orientationY:v,orientationZ:g,panningModel:y,positionX:_,positionY:b,positionZ:x,refDistance:w,rolloffFactor:T,...S})=>{const k=u.createPanner();if(S.channelCount>2)throw o();if("max"===S.channelCountMode)throw o();Pt(k,S);const O={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},E=n(u,{...O,channelInterpretation:"speakers",numberOfInputs:6}),C=i(u,{...S,gain:1}),A=i(u,{...O,gain:1}),D=i(u,{...O,gain:0}),M=i(u,{...O,gain:0}),I=i(u,{...O,gain:0}),P=i(u,{...O,gain:0}),R=i(u,{...O,gain:0}),j=s(u,256,6,1),q=r(u,{...O,curve:new Float32Array([1,1]),oversample:"none"});let N=[m,v,g],V=[_,b,x];j.onaudioprocess=({inputBuffer:t})=>{const e=[t.getChannelData(0)[0],t.getChannelData(1)[0],t.getChannelData(2)[0]];e.some(((t,e)=>t!==N[e]))&&(k.setOrientation(...e),N=e);const n=[t.getChannelData(3)[0],t.getChannelData(4)[0],t.getChannelData(5)[0]];n.some(((t,e)=>t!==V[e]))&&(k.setPosition(...n),V=n)},Object.defineProperty(D.gain,"defaultValue",{get:()=>0}),Object.defineProperty(M.gain,"defaultValue",{get:()=>0}),Object.defineProperty(I.gain,"defaultValue",{get:()=>0}),Object.defineProperty(P.gain,"defaultValue",{get:()=>0}),Object.defineProperty(R.gain,"defaultValue",{get:()=>0});const F={get bufferSize(){},get channelCount(){return k.channelCount},set channelCount(t){if(t>2)throw o();C.channelCount=t,k.channelCount=t},get channelCountMode(){return k.channelCountMode},set channelCountMode(t){if("max"===t)throw o();C.channelCountMode=t,k.channelCountMode=t},get channelInterpretation(){return k.channelInterpretation},set channelInterpretation(t){C.channelInterpretation=t,k.channelInterpretation=t},get coneInnerAngle(){return k.coneInnerAngle},set coneInnerAngle(t){k.coneInnerAngle=t},get coneOuterAngle(){return k.coneOuterAngle},set coneOuterAngle(t){k.coneOuterAngle=t},get coneOuterGain(){return k.coneOuterGain},set coneOuterGain(t){if(t<0||t>1)throw e();k.coneOuterGain=t},get context(){return k.context},get distanceModel(){return k.distanceModel},set distanceModel(t){k.distanceModel=t},get inputs(){return[C]},get maxDistance(){return k.maxDistance},set maxDistance(t){if(t<0)throw new RangeError;k.maxDistance=t},get numberOfInputs(){return k.numberOfInputs},get numberOfOutputs(){return k.numberOfOutputs},get orientationX(){return A.gain},get orientationY(){return D.gain},get orientationZ(){return M.gain},get panningModel(){return k.panningModel},set panningModel(t){k.panningModel=t},get positionX(){return I.gain},get positionY(){return P.gain},get positionZ(){return R.gain},get refDistance(){return k.refDistance},set refDistance(t){if(t<0)throw new RangeError;k.refDistance=t},get rolloffFactor(){return k.rolloffFactor},set rolloffFactor(t){if(t<0)throw new RangeError;k.rolloffFactor=t},addEventListener:(...t)=>C.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>C.dispatchEvent(t[0]),removeEventListener:(...t)=>C.removeEventListener(t[0],t[1],t[2])};return l!==F.coneInnerAngle&&(F.coneInnerAngle=l),h!==F.coneOuterAngle&&(F.coneOuterAngle=h),p!==F.coneOuterGain&&(F.coneOuterGain=p),d!==F.distanceModel&&(F.distanceModel=d),f!==F.maxDistance&&(F.maxDistance=f),m!==F.orientationX.value&&(F.orientationX.value=m),v!==F.orientationY.value&&(F.orientationY.value=v),g!==F.orientationZ.value&&(F.orientationZ.value=g),y!==F.panningModel&&(F.panningModel=y),_!==F.positionX.value&&(F.positionX.value=_),b!==F.positionY.value&&(F.positionY.value=b),x!==F.positionZ.value&&(F.positionZ.value=x),w!==F.refDistance&&(F.refDistance=w),T!==F.rolloffFactor&&(F.rolloffFactor=T),1===N[0]&&0===N[1]&&0===N[2]||k.setOrientation(...N),0===V[0]&&0===V[1]&&0===V[2]||k.setPosition(...V),c(zt(F,k),(()=>{C.connect(k),t(C,q,0,0),q.connect(A).connect(E,0,0),q.connect(D).connect(E,0,1),q.connect(M).connect(E,0,2),q.connect(I).connect(E,0,3),q.connect(P).connect(E,0,4),q.connect(R).connect(E,0,5),E.connect(j).connect(u.destination)}),(()=>{C.disconnect(k),a(C,q,0,0),q.disconnect(A),A.disconnect(E),q.disconnect(D),D.disconnect(E),q.disconnect(M),M.disconnect(E),q.disconnect(I),I.disconnect(E),q.disconnect(P),P.disconnect(E),q.disconnect(R),R.disconnect(E),E.disconnect(j),j.disconnect(u.destination)}))})(H,Ot,on,Wt,Yt,Dn,Gt,tt,sn),(t,e)=>{const n=t.createPanner();return void 0===n.orientationX?bi(t,e):(Pt(n,e),jt(n,e,"orientationX"),jt(n,e,"orientationY"),jt(n,e,"orientationZ"),jt(n,e,"positionX"),jt(n,e,"positionY"),jt(n,e,"positionZ"),It(n,e,"coneInnerAngle"),It(n,e,"coneOuterAngle"),It(n,e,"coneOuterGain"),It(n,e,"distanceModel"),It(n,e,"maxDistance"),It(n,e,"panningModel"),It(n,e,"refDistance"),It(n,e,"rolloffFactor"),n)}),In=((t,e,n,i,s,r,o,a,c,u)=>()=>{const l=new WeakMap;let h=null;return{render(p,d,f){const m=l.get(d);return void 0!==m?Promise.resolve(m):(async(p,d,f)=>{let m=null,v=r(p);const g={channelCount:v.channelCount,channelCountMode:v.channelCountMode,channelInterpretation:v.channelInterpretation},y={...g,coneInnerAngle:v.coneInnerAngle,coneOuterAngle:v.coneOuterAngle,coneOuterGain:v.coneOuterGain,distanceModel:v.distanceModel,maxDistance:v.maxDistance,panningModel:v.panningModel,refDistance:v.refDistance,rolloffFactor:v.rolloffFactor},_=M(v,d);if("bufferSize"in v)m=i(d,{...g,gain:1});else if(!_){const t={...y,orientationX:v.orientationX.value,orientationY:v.orientationY.value,orientationZ:v.orientationZ.value,positionX:v.positionX.value,positionY:v.positionY.value,positionZ:v.positionZ.value};v=s(d,t)}if(l.set(d,null===m?v:m),null!==m){if(null===h){if(null===o)throw new Error("Missing the native OfflineAudioContext constructor.");const t=new o(6,p.context.length,d.sampleRate),i=e(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});i.connect(t.destination),h=(async()=>{const e=await Promise.all([p.orientationX,p.orientationY,p.orientationZ,p.positionX,p.positionY,p.positionZ].map((async(e,i)=>{const s=n(t,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:0===i?1:0});return await a(t,e,s.offset,f),s})));for(let t=0;t<6;t+=1)e[t].connect(i,0,t),e[t].start(0);return u(t)})()}const t=await h,r=i(d,{...g,gain:1});await c(p,d,r,f);const l=[];for(let e=0;e<t.numberOfChannels;e+=1)l.push(t.getChannelData(e));let v=[l[0][0],l[1][0],l[2][0]],_=[l[3][0],l[4][0],l[5][0]],b=i(d,{...g,gain:1}),x=s(d,{...y,orientationX:v[0],orientationY:v[1],orientationZ:v[2],positionX:_[0],positionY:_[1],positionZ:_[2]});r.connect(b).connect(x.inputs[0]),x.connect(m);for(let e=128;e<t.length;e+=128){const t=[l[0][e],l[1][e],l[2][e]],n=[l[3][e],l[4][e],l[5][e]];if(t.some(((t,e)=>t!==v[e]))||n.some(((t,e)=>t!==_[e]))){v=t,_=n;const o=e/d.sampleRate;b.gain.setValueAtTime(0,o),b=i(d,{...g,gain:0}),x=s(d,{...y,orientationX:v[0],orientationY:v[1],orientationZ:v[2],positionX:_[0],positionY:_[1],positionZ:_[2]}),b.gain.setValueAtTime(1,o),r.connect(b).connect(x.inputs[0]),x.connect(m)}}return m}return _?(await t(d,p.orientationX,v.orientationX,f),await t(d,p.orientationY,v.orientationY,f),await t(d,p.orientationZ,v.orientationZ,f),await t(d,p.positionX,v.positionX,f),await t(d,p.positionY,v.positionY,f),await t(d,p.positionZ,v.positionZ,f)):(await a(d,p.orientationX,v.orientationX,f),await a(d,p.orientationY,v.orientationY,f),await a(d,p.orientationZ,v.orientationZ,f),await a(d,p.positionX,v.positionX,f),await a(d,p.positionY,v.positionY,f),await a(d,p.positionZ,v.positionZ,f)),Q(v)?await c(p,d,v.inputs[0],f):await c(p,d,v,f),v})(p,d,f)}}})(Ye,on,ln,Wt,Mn,et,Oe,Xe,we,_n),Pn=((t,e,n,i,s,r,o)=>class extends t{constructor(t,a){const c=s(t),u={...Ht,...a},l=n(c,u),h=r(c);super(t,!1,l,h?i():null),this._nativePannerNode=l,this._orientationX=e(this,h,l.orientationX,N,q),this._orientationY=e(this,h,l.orientationY,N,q),this._orientationZ=e(this,h,l.orientationZ,N,q),this._positionX=e(this,h,l.positionX,N,q),this._positionY=e(this,h,l.positionY,N,q),this._positionZ=e(this,h,l.positionZ,N,q),o(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(t){this._nativePannerNode.coneInnerAngle=t}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(t){this._nativePannerNode.coneOuterAngle=t}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(t){this._nativePannerNode.coneOuterGain=t}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(t){this._nativePannerNode.distanceModel=t}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(t){this._nativePannerNode.maxDistance=t}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(t){this._nativePannerNode.panningModel=t}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(t){this._nativePannerNode.refDistance=t}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(t){this._nativePannerNode.rolloffFactor=t}})(Re,He,Mn,In,Se,Ee,en),Rn=((t,e,n,i)=>class i{constructor(i,s){const r=e(i),o=(t=>{const{imag:e,real:n}=t;return void 0===e?void 0===n?{...t,imag:[0,0],real:[0,0]}:{...t,imag:Array.from(n,(()=>0)),real:n}:void 0===n?{...t,imag:e,real:Array.from(e,(()=>0))}:{...t,imag:e,real:n}})({...$t,...s}),a=t(r,o);return n.add(a),a}static[Symbol.hasInstance](t){return null!==t&&"object"==typeof t&&Object.getPrototypeOf(t)===i.prototype||n.has(t)}})((t=>(e,{disableNormalization:n,imag:i,real:s})=>{const r=i instanceof Float32Array?i:new Float32Array(i),o=s instanceof Float32Array?s:new Float32Array(s),a=e.createPeriodicWave(o,r,{disableNormalization:n});if(Array.from(i).length<2)throw t();return a})(P),Se,new WeakSet),jn=((t,e)=>(n,i)=>{const s=i.channelCountMode;if("clamped-max"===s)throw e();if(void 0===n.createStereoPanner)return t(n,i);const r=n.createStereoPanner();return Pt(r,i),jt(r,i,"pan"),Object.defineProperty(r,"channelCountMode",{get:()=>s,set:t=>{if(t!==s)throw e()}}),r})(((t,e,n,i,s,r)=>{const o=16385,a=new Float32Array([1,1]),c=Math.PI/2,u={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},l={...u,oversample:"none"},h=(t,r,h,p,d)=>{if(1===r)return((t,e,s,r)=>{const h=new Float32Array(o),p=new Float32Array(o);for(let t=0;t<o;t+=1){const e=t/16384*c;h[t]=Math.cos(e),p[t]=Math.sin(e)}const d=n(t,{...u,gain:0}),f=i(t,{...l,curve:h}),m=i(t,{...l,curve:a}),v=n(t,{...u,gain:0}),g=i(t,{...l,curve:p});return{connectGraph(){e.connect(d),e.connect(void 0===m.inputs?m:m.inputs[0]),e.connect(v),m.connect(s),s.connect(void 0===f.inputs?f:f.inputs[0]),s.connect(void 0===g.inputs?g:g.inputs[0]),f.connect(d.gain),g.connect(v.gain),d.connect(r,0,0),v.connect(r,0,1)},disconnectGraph(){e.disconnect(d),e.disconnect(void 0===m.inputs?m:m.inputs[0]),e.disconnect(v),m.disconnect(s),s.disconnect(void 0===f.inputs?f:f.inputs[0]),s.disconnect(void 0===g.inputs?g:g.inputs[0]),f.disconnect(d.gain),g.disconnect(v.gain),d.disconnect(r,0,0),v.disconnect(r,0,1)}}})(t,h,p,d);if(2===r)return((t,s,r,h)=>{const p=new Float32Array(o),d=new Float32Array(o),f=new Float32Array(o),m=new Float32Array(o),v=Math.floor(8192.5);for(let t=0;t<o;t+=1)if(t>v){const e=(t-v)/(16384-v)*c;p[t]=Math.cos(e),d[t]=Math.sin(e),f[t]=0,m[t]=1}else{const e=t/(16384-v)*c;p[t]=1,d[t]=0,f[t]=Math.cos(e),m[t]=Math.sin(e)}const g=e(t,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),y=n(t,{...u,gain:0}),_=i(t,{...l,curve:p}),b=n(t,{...u,gain:0}),x=i(t,{...l,curve:d}),w=i(t,{...l,curve:a}),T=n(t,{...u,gain:0}),S=i(t,{...l,curve:f}),k=n(t,{...u,gain:0}),O=i(t,{...l,curve:m});return{connectGraph(){s.connect(g),s.connect(void 0===w.inputs?w:w.inputs[0]),g.connect(y,0),g.connect(b,0),g.connect(T,1),g.connect(k,1),w.connect(r),r.connect(void 0===_.inputs?_:_.inputs[0]),r.connect(void 0===x.inputs?x:x.inputs[0]),r.connect(void 0===S.inputs?S:S.inputs[0]),r.connect(void 0===O.inputs?O:O.inputs[0]),_.connect(y.gain),x.connect(b.gain),S.connect(T.gain),O.connect(k.gain),y.connect(h,0,0),T.connect(h,0,0),b.connect(h,0,1),k.connect(h,0,1)},disconnectGraph(){s.disconnect(g),s.disconnect(void 0===w.inputs?w:w.inputs[0]),g.disconnect(y,0),g.disconnect(b,0),g.disconnect(T,1),g.disconnect(k,1),w.disconnect(r),r.disconnect(void 0===_.inputs?_:_.inputs[0]),r.disconnect(void 0===x.inputs?x:x.inputs[0]),r.disconnect(void 0===S.inputs?S:S.inputs[0]),r.disconnect(void 0===O.inputs?O:O.inputs[0]),_.disconnect(y.gain),x.disconnect(b.gain),S.disconnect(T.gain),O.disconnect(k.gain),y.disconnect(h,0,0),T.disconnect(h,0,0),b.disconnect(h,0,1),k.disconnect(h,0,1)}}})(t,h,p,d);throw s()};return(e,{channelCount:i,channelCountMode:o,pan:a,...c})=>{if("max"===o)throw s();const u=t(e,{...c,channelCount:1,channelCountMode:o,numberOfInputs:2}),l=n(e,{...c,channelCount:i,channelCountMode:o,gain:1}),p=n(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:a});let{connectGraph:d,disconnectGraph:f}=h(e,i,l,p,u);Object.defineProperty(p.gain,"defaultValue",{get:()=>0}),Object.defineProperty(p.gain,"maxValue",{get:()=>1}),Object.defineProperty(p.gain,"minValue",{get:()=>-1});const m={get bufferSize(){},get channelCount(){return l.channelCount},set channelCount(t){l.channelCount!==t&&(v&&f(),({connectGraph:d,disconnectGraph:f}=h(e,t,l,p,u)),v&&d()),l.channelCount=t},get channelCountMode(){return l.channelCountMode},set channelCountMode(t){if("clamped-max"===t||"max"===t)throw s();l.channelCountMode=t},get channelInterpretation(){return l.channelInterpretation},set channelInterpretation(t){l.channelInterpretation=t},get context(){return l.context},get inputs(){return[l]},get numberOfInputs(){return l.numberOfInputs},get numberOfOutputs(){return l.numberOfOutputs},get pan(){return p.gain},addEventListener:(...t)=>l.addEventListener(t[0],t[1],t[2]),dispatchEvent:(...t)=>l.dispatchEvent(t[0]),removeEventListener:(...t)=>l.removeEventListener(t[0],t[1],t[2])};let v=!1;return r(zt(m,u),(()=>{d(),v=!0}),(()=>{f(),v=!1}))}})(on,Lt,Wt,Dn,Gt,sn),Gt),qn=((t,e,n,i,s)=>()=>{const r=new WeakMap;return{render(o,a,c){const u=r.get(a);return void 0!==u?Promise.resolve(u):(async(o,a,c)=>{let u=n(o);const l=M(u,a);if(!l){const t={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,pan:u.pan.value};u=e(a,t)}return r.set(a,u),l?await t(a,o.pan,u.pan,c):await i(a,o.pan,u.pan,c),Q(u)?await s(o,a,u.inputs[0],c):await s(o,a,u,c),u})(o,a,c)}}})(Ye,jn,et,Xe,we),Nn=((t,e,n,i,s,r)=>class extends t{constructor(t,o){const a=s(t),c={...Kt,...o},u=n(a,c),l=r(a);super(t,!1,u,l?i():null),this._pan=e(this,l,u.pan)}get pan(){return this._pan}})(Re,He,jn,qn,Se,Ee),Vn=((t,e,n)=>()=>{const i=new WeakMap;return{render(s,r,o){const a=i.get(r);return void 0!==a?Promise.resolve(a):(async(s,r,o)=>{let a=e(s);if(!M(a,r)){const e={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,curve:a.curve,oversample:a.oversample};a=t(r,e)}return i.set(r,a),Q(a)?await n(s,r,a.inputs[0],o):await n(s,r,a,o),a})(s,r,o)}}})(Dn,et,we),Fn=((t,e,n,i,s,r,o)=>class extends t{constructor(t,e){const a=s(t),c={...te,...e},u=n(a,c);super(t,!0,u,r(a)?i():null),this._isCurveNullified=!1,this._nativeWaveShaperNode=u,o(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(t){if(null===t)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(t.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=t}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(t){this._nativeWaveShaperNode.oversample=t}})(Re,Ot,Dn,Vn,Se,Ee,en),Ln=(t=>null!==t&&t.isSecureContext)(_e),zn=(t=>(e,n,i)=>{Object.defineProperties(t,{currentFrame:{configurable:!0,get:()=>Math.round(e*n)},currentTime:{configurable:!0,get:()=>e}});try{return i()}finally{null!==t&&(delete t.currentFrame,delete t.currentTime)}})(_e),Bn=new WeakMap,Wn=((t,e)=>n=>{let i=t.get(n);if(void 0!==i)return i;if(null===e)throw new Error("Missing the native OfflineAudioContext constructor.");return i=new e(1,1,8e3),t.set(n,i),i})(Bn,Oe),Zn=(t=>null===t?null:t.hasOwnProperty("AudioWorkletNode")?t.AudioWorkletNode:null)(_e),Un=Ln?((t,e,n,i,s,r,o,a,c,u,l,h)=>(p,d,f={credentials:"omit"})=>{const v=r(p);if(void 0!==v.audioWorklet)return Promise.all([s(d),Promise.resolve(t(l,l))]).then((([[t,e],n])=>{const[i,s]=_(t,e),r=n?s:s.replace(/\s+extends\s+AudioWorkletProcessor\s*{/," extends (class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}){"),c=new Blob([`${i};(registerProcessor=>{${r}\n})((n,p)=>registerProcessor(n,class extends p{${n?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${n?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}))`],{type:"application/javascript; charset=utf-8"}),u=URL.createObjectURL(c);return v.audioWorklet.addModule(u,f).then((()=>{if(!a(v))return o(v).audioWorklet.addModule(u,f)})).finally((()=>URL.revokeObjectURL(u)))}));const g=u.get(p);if(void 0!==g&&g.has(d))return Promise.resolve();const y=c.get(p);if(void 0!==y){const t=y.get(d);if(void 0!==t)return t}const w=s(d).then((([t,e])=>{const[i,s]=_(t,e);return n(`${i};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${s}\n})})(window,'_AWGS')`)})).then((()=>{const t=h._AWGS.pop();if(void 0===t)throw new SyntaxError;i(v.currentTime,v.sampleRate,(()=>t(class{},void 0,((t,n)=>{if(""===t.trim())throw e();const i=m.get(v);if(void 0!==i){if(i.has(t))throw e();x(n),b(n.parameterDescriptors),i.set(t,n)}else x(n),b(n.parameterDescriptors),m.set(v,new Map([[t,n]]))}),v.sampleRate,void 0,void 0)))}));return void 0===y?c.set(p,new Map([[d,w]])):y.set(d,w),w.then((()=>{const t=u.get(p);void 0===t?u.set(p,new Set([d])):t.add(d)})).finally((()=>{const t=c.get(p);void 0!==t&&t.delete(d)})),w})(ve,Gt,(t=>e=>new Promise(((n,i)=>{if(null===t)return void i(new SyntaxError);const s=t.document.head;if(null===s)i(new SyntaxError);else{const r=t.document.createElement("script"),o=new Blob([e],{type:"application/javascript"}),a=URL.createObjectURL(o),c=t.onerror,u=()=>{t.onerror=c,URL.revokeObjectURL(a)};t.onerror=(e,n,s,r,o)=>n===a||n===t.location.href&&1===s&&1===r?(u(),i(o),!1):null!==c?c(e,n,s,r,o):void 0,r.onerror=()=>{u(),i(new SyntaxError)},r.onload=()=>{u(),n()},r.src=a,r.type="module",s.appendChild(r)}})))(_e),zn,(async t=>{try{const e=await fetch(t);if(e.ok)return[await e.text(),e.url]}catch{}throw new DOMException("","AbortError")}),Se,Wn,Ee,new WeakMap,new WeakMap,((t,e)=>async()=>{if(null===t)return!0;if(null===e)return!1;const n=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),i=new e(1,128,8e3),s=URL.createObjectURL(n);let r=!1,o=!1;try{await i.audioWorklet.addModule(s);const e=new t(i,"a",{numberOfOutputs:0}),n=i.createOscillator();e.port.onmessage=()=>r=!0,e.onprocessorerror=()=>o=!0,n.connect(e),await i.startRendering()}catch{}finally{URL.revokeObjectURL(s)}return r&&!o})(Zn,Oe),_e):void 0,Yn=((t,e)=>n=>t(n)||e(n))(Me,Ee),Gn=((t,e,n,i,s,r,o,a,c,u,l,h,p,d,f,m,v,g,y,_)=>class extends f{constructor(e,n){super(e,n),this._nativeContext=e,this._audioWorklet=void 0===t?void 0:{addModule:(e,n)=>t(this,e,n)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new e(this)}createBiquadFilter(){return new s(this)}createBuffer(t,e,i){return new n({length:e,numberOfChannels:t,sampleRate:i})}createBufferSource(){return new i(this)}createChannelMerger(t=6){return new r(this,{numberOfInputs:t})}createChannelSplitter(t=6){return new o(this,{numberOfOutputs:t})}createConstantSource(){return new a(this)}createConvolver(){return new c(this)}createDelay(t=1){return new l(this,{maxDelayTime:t})}createDynamicsCompressor(){return new h(this)}createGain(){return new p(this)}createIIRFilter(t,e){return new d(this,{feedback:e,feedforward:t})}createOscillator(){return new m(this)}createPanner(){return new v(this)}createPeriodicWave(t,e,n={disableNormalization:!1}){return new g(this,{...n,imag:e,real:t})}createStereoPanner(){return new y(this)}createWaveShaper(){return new _(this)}decodeAudioData(t,e,n){return u(this._nativeContext,t).then((t=>("function"==typeof e&&e(t),t))).catch((t=>{throw"function"==typeof n&&n(t),t}))}})(Un,qe,We,Ke,nn,an,cn,hn,dn,((t,e,n,i,s,r,o,a,c,u,l)=>(n,i)=>{const h=o(n)?n:r(n);if(s.has(i)){const t=new DOMException("","DataCloneError");return Promise.reject(t)}try{s.add(i)}catch{}return e(c,(()=>c(h)))?h.decodeAudioData(i).then((n=>(e(a,(()=>a(n)))||l(n),t.add(n),n))):new Promise(((e,n)=>{const s=async()=>{try{await(t=>{const{port1:e,port2:n}=new MessageChannel;return new Promise((i=>{n.onmessage=()=>{e.close(),n.close(),i()},e.postMessage(t,[t])}))})(i)}catch{}},r=t=>{n(t),s()};try{h.decodeAudioData(i,(n=>{"function"!=typeof n.copyFromChannel&&(u(n),R(n)),t.add(n),s().then((()=>e(n)))}),(t=>{r(null===t?new DOMException("","EncodingError"):t)}))}catch(t){r(t)}}))})(Ne,ve,0,0,new WeakSet,Se,Yn,I,Mt,ze,Be),fn,vn,gn,xn,Sn,En,Pn,Rn,Nn,Fn),Xn=((t,e,n,i)=>class extends t{constructor(t,e){const s=n(t),r=((t,e)=>t.createMediaElementSource(e.mediaElement))(s,e);if(i(s))throw TypeError();super(t,!0,r,null),this._nativeMediaElementAudioSourceNode=r}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}})(Re,0,Se,Ee),Qn=((t,e,n,i)=>class extends t{constructor(t,e){const s=n(t);if(i(s))throw new TypeError;const r=((t,e)=>{const n=t.createMediaStreamDestination();return Pt(n,e),1===n.numberOfOutputs&&Object.defineProperty(n,"numberOfOutputs",{get:()=>0}),n})(s,{...Dt,...e});super(t,!1,r,null),this._nativeMediaStreamAudioDestinationNode=r}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}})(Re,0,Se,Ee),Hn=((t,e,n,i)=>class extends t{constructor(t,e){const s=n(t),r=((t,{mediaStream:e})=>{const n=e.getAudioTracks();n.sort(((t,e)=>t.id<e.id?-1:t.id>e.id?1:0));const i=n.slice(0,1),s=t.createMediaStreamSource(new MediaStream(i));return Object.defineProperty(s,"mediaStream",{value:e}),s})(s,e);if(i(s))throw new TypeError;super(t,!0,r,null),this._nativeMediaStreamAudioSourceNode=r}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}})(Re,0,Se,Ee),$n=((t,e,n)=>class extends t{constructor(t,i){const s=n(t);super(t,!0,e(s,i),null)}})(Re,((t,e)=>(n,{mediaStreamTrack:i})=>{if("function"==typeof n.createMediaStreamTrackSource)return n.createMediaStreamTrackSource(i);const s=new MediaStream([i]),r=n.createMediaStreamSource(s);if("audio"!==i.kind)throw t();if(e(n))throw new TypeError;return r})(Ot,Ee),Se),Kn=((t,e,n,i,s,r,o,a,c)=>class extends t{constructor(t={}){if(null===c)throw new Error("Missing the native AudioContext constructor.");const e=new c(t);if(null===e)throw i();if(!(t=>void 0===t||"number"==typeof t||"string"==typeof t&&("balanced"===t||"interactive"===t||"playback"===t))(t.latencyHint))throw new TypeError(`The provided value '${t.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(void 0!==t.sampleRate&&e.sampleRate!==t.sampleRate)throw n();super(e,2);const{latencyHint:s}=t,{sampleRate:r}=e;if(this._baseLatency="number"==typeof e.baseLatency?e.baseLatency:"balanced"===s?512/r:"interactive"===s||void 0===s?256/r:"playback"===s?1024/r:128*Math.max(2,Math.min(128,Math.round(s*r/128)))/r,this._nativeAudioContext=e,"webkitAudioContext"===c.name?(this._nativeGainNode=e.createGain(),this._nativeOscillatorNode=e.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(e.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,"running"===e.state){this._state="suspended";const t=()=>{"suspended"===this._state&&(this._state=null),e.removeEventListener("statechange",t)};e.addEventListener("statechange",t)}}get baseLatency(){return this._baseLatency}get state(){return null!==this._state?this._state:this._nativeAudioContext.state}close(){return"closed"===this.state?this._nativeAudioContext.close().then((()=>{throw e()})):("suspended"===this._state&&(this._state=null),this._nativeAudioContext.close().then((()=>{null!==this._nativeGainNode&&null!==this._nativeOscillatorNode&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),W(this)})))}createMediaElementSource(t){return new s(this,{mediaElement:t})}createMediaStreamDestination(){return new r(this)}createMediaStreamSource(t){return new o(this,{mediaStream:t})}createMediaStreamTrackSource(t){return new a(this,{mediaStreamTrack:t})}resume(){return"suspended"===this._state?new Promise(((t,e)=>{const n=()=>{this._nativeAudioContext.removeEventListener("statechange",n),"running"===this._nativeAudioContext.state?t():this.resume().then(t,e)};this._nativeAudioContext.addEventListener("statechange",n)})):this._nativeAudioContext.resume().catch((t=>{if(void 0===t||15===t.code)throw e();throw t}))}suspend(){return this._nativeAudioContext.suspend().catch((t=>{if(void 0===t)throw e();throw t}))}})(Gn,Ot,Gt,Jt,Xn,Qn,Hn,$n,De),Jn=(t=>e=>{const n=t.get(e);if(void 0===n)throw new Error("The context has no set of AudioWorkletNodes.");return n})(Tn),ti=(t=>(e,n)=>{t(e).add(n)})(Jn),ei=(t=>(e,n,i=0,s=0)=>{const r=e[i];if(void 0===r)throw t();return at(n)?r.connect(n,0,s):r.connect(n,0)})(P),ni=(t=>(e,n)=>{t(e).delete(n)})(Jn),ii=(t=>(e,n,i,s=0)=>void 0===n?e.forEach((t=>t.disconnect())):"number"==typeof n?Tt(t,e,n).disconnect():at(n)?void 0===i?e.forEach((t=>t.disconnect(n))):void 0===s?Tt(t,e,i).disconnect(n,0):Tt(t,e,i).disconnect(n,0,s):void 0===i?e.forEach((t=>t.disconnect(n))):Tt(t,e,i).disconnect(n,0))(P),si=new WeakMap,ri=((t,e)=>n=>e(t,n))(si,w),oi=((t,e,n,i,s,r,o,a,c,u,l,h,p)=>(d,f,m,g)=>{if(0===g.numberOfInputs&&0===g.numberOfOutputs)throw c();const y=Array.isArray(g.outputChannelCount)?g.outputChannelCount:Array.from(g.outputChannelCount);if(y.some((t=>t<1)))throw c();if(y.length!==g.numberOfOutputs)throw e();if("explicit"!==g.channelCountMode)throw c();const _=g.channelCount*g.numberOfInputs,b=y.reduce(((t,e)=>t+e),0),x=void 0===m.parameterDescriptors?0:m.parameterDescriptors.length;if(_+x>6||b>6)throw c();const w=new MessageChannel,T=[],S=[];for(let t=0;t<g.numberOfInputs;t+=1)T.push(o(d,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1})),S.push(s(d,{channelCount:g.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:g.channelCount}));const k=[];if(void 0!==m.parameterDescriptors)for(const{defaultValue:t,maxValue:e,minValue:n,name:i}of m.parameterDescriptors){const s=r(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:void 0!==g.parameterData[i]?g.parameterData[i]:void 0===t?0:t});Object.defineProperties(s.offset,{defaultValue:{get:()=>void 0===t?0:t},maxValue:{get:()=>void 0===e?N:e},minValue:{get:()=>void 0===n?q:n}}),k.push(s)}const O=i(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,_+x)}),E=Vt(f,d.sampleRate),C=a(d,E,_+x,Math.max(1,b)),A=s(d,{channelCount:Math.max(1,b),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,b)}),D=[];for(let t=0;t<g.numberOfOutputs;t+=1)D.push(i(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:y[t]}));for(let t=0;t<g.numberOfInputs;t+=1){T[t].connect(S[t]);for(let e=0;e<g.channelCount;e+=1)S[t].connect(O,e,t*g.channelCount+e)}const M=new ht(void 0===m.parameterDescriptors?[]:m.parameterDescriptors.map((({name:t},e)=>{const n=k[e];return n.connect(O,0,_+e),n.start(0),[t,n.offset]})));O.connect(C);let I=g.channelInterpretation,P=null;const R=0===g.numberOfOutputs?[C]:D,j={get bufferSize(){return E},get channelCount(){return g.channelCount},set channelCount(t){throw n()},get channelCountMode(){return g.channelCountMode},set channelCountMode(t){throw n()},get channelInterpretation(){return I},set channelInterpretation(t){for(const e of T)e.channelInterpretation=t;I=t},get context(){return C.context},get inputs(){return T},get numberOfInputs(){return g.numberOfInputs},get numberOfOutputs(){return g.numberOfOutputs},get onprocessorerror(){return P},set onprocessorerror(t){"function"==typeof P&&j.removeEventListener("processorerror",P),P="function"==typeof t?t:null,"function"==typeof P&&j.addEventListener("processorerror",P)},get parameters(){return M},get port(){return w.port2},addEventListener:(...t)=>C.addEventListener(t[0],t[1],t[2]),connect:t.bind(null,R),disconnect:u.bind(null,R),dispatchEvent:(...t)=>C.dispatchEvent(t[0]),removeEventListener:(...t)=>C.removeEventListener(t[0],t[1],t[2])},V=new Map;var F,L;w.port1.addEventListener=(F=w.port1.addEventListener,(...t)=>{if("message"===t[0]){const e="function"==typeof t[1]?t[1]:"object"==typeof t[1]&&null!==t[1]&&"function"==typeof t[1].handleEvent?t[1].handleEvent:null;if(null!==e){const n=V.get(t[1]);void 0!==n?t[1]=n:(t[1]=t=>{l(d.currentTime,d.sampleRate,(()=>e(t)))},V.set(e,t[1]))}}return F.call(w.port1,t[0],t[1],t[2])}),w.port1.removeEventListener=(L=w.port1.removeEventListener,(...t)=>{if("message"===t[0]){const e=V.get(t[1]);void 0!==e&&(V.delete(t[1]),t[1]=e)}return L.call(w.port1,t[0],t[1],t[2])});let z=null;Object.defineProperty(w.port1,"onmessage",{get:()=>z,set:t=>{"function"==typeof z&&w.port1.removeEventListener("message",z),z="function"==typeof t?t:null,"function"==typeof z&&(w.port1.addEventListener("message",z),w.port1.start())}}),m.prototype.port=w.port1;let B=null;((t,e,n,i)=>{let s=v.get(t);void 0===s&&(s=new WeakMap,v.set(t,s));const r=(async(t,e)=>new t(await(t=>new Promise(((e,n)=>{const{port1:i,port2:s}=new MessageChannel;i.onmessage=({data:t})=>{i.close(),s.close(),e(t)},i.onmessageerror=({data:t})=>{i.close(),s.close(),n(t)},s.postMessage(t)})))(e)))(n,i);return s.set(e,r),r})(d,j,m,g).then((t=>B=t));const W=mt(g.numberOfInputs,g.channelCount),Z=mt(g.numberOfOutputs,y),U=void 0===m.parameterDescriptors?[]:m.parameterDescriptors.reduce(((t,{name:e})=>({...t,[e]:new Float32Array(128)})),{});let Y=!0;const G=()=>{g.numberOfOutputs>0&&C.disconnect(A);for(let t=0,e=0;t<g.numberOfOutputs;t+=1){const n=D[t];for(let i=0;i<y[t];i+=1)A.disconnect(n,e+i,i);e+=y[t]}},X=new Map;C.onaudioprocess=({inputBuffer:t,outputBuffer:e})=>{if(null!==B){const n=h(j);for(let i=0;i<E;i+=128){for(let e=0;e<g.numberOfInputs;e+=1)for(let n=0;n<g.channelCount;n+=1)dt(t,W[e],n,n,i);void 0!==m.parameterDescriptors&&m.parameterDescriptors.forEach((({name:e},n)=>{dt(t,U,e,_+n,i)}));for(let t=0;t<g.numberOfInputs;t+=1)for(let e=0;e<y[t];e+=1)0===Z[t][e].byteLength&&(Z[t][e]=new Float32Array(128));try{const t=W.map(((t,e)=>{if(n[e].size>0)return X.set(e,E/128),t;const i=X.get(e);return void 0===i?[]:(t.every((t=>t.every((t=>0===t))))&&(1===i?X.delete(e):X.set(e,i-1)),t)})),s=l(d.currentTime+i/d.sampleRate,d.sampleRate,(()=>B.process(t,Z,U)));Y=s;for(let t=0,n=0;t<g.numberOfOutputs;t+=1){for(let s=0;s<y[t];s+=1)ft(e,Z[t],s,n+s,i);n+=y[t]}}catch(t){Y=!1,j.dispatchEvent(new ErrorEvent("processorerror",{colno:t.colno,filename:t.filename,lineno:t.lineno,message:t.message}))}if(!Y){for(let t=0;t<g.numberOfInputs;t+=1){T[t].disconnect(S[t]);for(let e=0;e<g.channelCount;e+=1)S[i].disconnect(O,e,t*g.channelCount+e)}if(void 0!==m.parameterDescriptors){const t=m.parameterDescriptors.length;for(let e=0;e<t;e+=1){const t=k[e];t.disconnect(O,0,_+e),t.stop()}}O.disconnect(C),C.onaudioprocess=null,Q?G():K();break}}}};let Q=!1;const H=o(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),$=()=>C.connect(H).connect(d.destination),K=()=>{C.disconnect(H),H.disconnect()};return $(),p(j,(()=>{if(Y){K(),g.numberOfOutputs>0&&C.connect(A);for(let t=0,e=0;t<g.numberOfOutputs;t+=1){const n=D[t];for(let i=0;i<y[t];i+=1)A.connect(n,e+i,i);e+=y[t]}}Q=!0}),(()=>{Y&&($(),G()),Q=!1}))})(ei,P,Ot,on,Lt,ln,Wt,Yt,Gt,ii,zn,ri,sn),ai=((t,e,n,i,s)=>(r,o,a,c,u,l)=>{if(null!==a)try{const e=new a(r,c,l),i=new Map;let o=null;if(Object.defineProperties(e,{channelCount:{get:()=>l.channelCount,set:()=>{throw t()}},channelCountMode:{get:()=>"explicit",set:()=>{throw t()}},onprocessorerror:{get:()=>o,set:t=>{"function"==typeof o&&e.removeEventListener("processorerror",o),o="function"==typeof t?t:null,"function"==typeof o&&e.addEventListener("processorerror",o)}}}),e.addEventListener=(p=e.addEventListener,(...t)=>{if("processorerror"===t[0]){const e="function"==typeof t[1]?t[1]:"object"==typeof t[1]&&null!==t[1]&&"function"==typeof t[1].handleEvent?t[1].handleEvent:null;if(null!==e){const n=i.get(t[1]);void 0!==n?t[1]=n:(t[1]=n=>{"error"===n.type?(Object.defineProperties(n,{type:{value:"processorerror"}}),e(n)):e(new ErrorEvent(t[0],{...n}))},i.set(e,t[1]))}}return p.call(e,"error",t[1],t[2]),p.call(e,...t)}),e.removeEventListener=(h=e.removeEventListener,(...t)=>{if("processorerror"===t[0]){const e=i.get(t[1]);void 0!==e&&(i.delete(t[1]),t[1]=e)}return h.call(e,"error",t[1],t[2]),h.call(e,t[0],t[1],t[2])}),0!==l.numberOfOutputs){const t=n(r,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return e.connect(t).connect(r.destination),s(e,(()=>t.disconnect()),(()=>t.connect(r.destination)))}return e}catch(t){if(11===t.code)throw i();throw t}var h,p;if(void 0===u)throw i();return(t=>{const{port1:e}=new MessageChannel;try{e.postMessage(t)}finally{e.close()}})(l),e(r,o,u,l)})(Ot,oi,Wt,Gt,sn),ci=((t,e,n,i,s,r,o,a,c,u,l,h,p,d,f,m)=>(v,g,y)=>{const _=new WeakMap;let b=null;return{render(x,w,T){a(w,x);const S=_.get(w);return void 0!==S?Promise.resolve(S):(async(a,x,w)=>{let T=l(a),S=null;const k=M(T,x),O=Array.isArray(g.outputChannelCount)?g.outputChannelCount:Array.from(g.outputChannelCount);if(null===h){const t=O.reduce(((t,e)=>t+e),0),n=s(x,{channelCount:Math.max(1,t),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,t)}),r=[];for(let t=0;t<a.numberOfOutputs;t+=1)r.push(i(x,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:O[t]}));const u=o(x,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1});u.connect=e.bind(null,r),u.disconnect=c.bind(null,r),S=[n,r,u]}else k||(T=new h(x,v));if(_.set(x,null===S?T:S[2]),null!==S){if(null===b){if(void 0===y)throw new Error("Missing the processor constructor.");if(null===p)throw new Error("Missing the native OfflineAudioContext constructor.");const t=a.channelCount*a.numberOfInputs,e=void 0===y.parameterDescriptors?0:y.parameterDescriptors.length,n=t+e,c=async()=>{const c=new p(n,128*Math.ceil(a.context.length/128),x.sampleRate),u=[],l=[];for(let t=0;t<g.numberOfInputs;t+=1)u.push(o(c,{channelCount:g.channelCount,channelCountMode:g.channelCountMode,channelInterpretation:g.channelInterpretation,gain:1})),l.push(s(c,{channelCount:g.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:g.channelCount}));const h=await Promise.all(Array.from(a.parameters.values()).map((async t=>{const e=r(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:t.value});return await d(c,t,e.offset,w),e}))),v=i(c,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,t+e)});for(let t=0;t<g.numberOfInputs;t+=1){u[t].connect(l[t]);for(let e=0;e<g.channelCount;e+=1)l[t].connect(v,e,t*g.channelCount+e)}for(const[e,n]of h.entries())n.connect(v,0,t+e),n.start(0);return v.connect(c.destination),await Promise.all(u.map((t=>f(a,c,t,w)))),m(c)};b=vt(a,0===n?null:await c(),x,g,O,y,u)}const t=await b,e=n(x,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[c,l,h]=S;null!==t&&(e.buffer=t,e.start(0)),e.connect(c);for(let t=0,e=0;t<a.numberOfOutputs;t+=1){const n=l[t];for(let i=0;i<O[t];i+=1)c.connect(n,e+i,i);e+=O[t]}return h}if(k)for(const[e,n]of a.parameters.entries())await t(x,n,T.parameters.get(e),w);else for(const[t,e]of a.parameters.entries())await d(x,e,T.parameters.get(t),w);return await f(a,x,T,w),T})(x,w,T)}}})(Ye,ei,Ge,on,Lt,ln,Wt,ni,ii,zn,et,Zn,Oe,Xe,we,_n),ui=(t=>e=>t.get(e))(Bn),li=(t=>(e,n)=>{t.set(e,n)})(si),hi=Ln?((t,e,n,i,s,r,o,a,c,u,l,h,p)=>class extends e{constructor(e,l,p){var d;const f=a(e),v=c(f),g=(t=>({...t,outputChannelCount:void 0!==t.outputChannelCount?t.outputChannelCount:1===t.numberOfInputs&&1===t.numberOfOutputs?[t.channelCount]:Array.from({length:t.numberOfOutputs},(()=>1))}))({...pt,...p}),y=m.get(f),_=null==y?void 0:y.get(l),b=v||"closed"!==f.state?f:null!==(d=o(f))&&void 0!==d?d:f,x=s(b,v?null:e.baseLatency,u,l,_,g);super(e,!0,x,v?i(l,g,_):null);const w=[];x.parameters.forEach(((t,e)=>{const i=n(this,v,t);w.push([e,i])})),this._nativeAudioWorkletNode=x,this._onprocessorerror=null,this._parameters=new ht(w),v&&t(f,this);const{activeInputs:T}=r(this);h(x,T)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(t){const e="function"==typeof t?p(this,t):null;this._nativeAudioWorkletNode.onprocessorerror=e;const n=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=null!==n&&n===e?t:n}get parameters(){return null===this._parameters?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}})(ti,Re,He,ci,ai,L,ui,Se,Ee,Zn,0,li,le):void 0,pi=((t,e)=>(n,i,s)=>{if(null===e)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new e(n,i,s)}catch(e){if("SyntaxError"===e.name)throw t();throw e}})(Gt,Oe),di=((t,e,n,i,s,r,o,a)=>{const c=[];return(u,l)=>n(u).render(u,l,c).then((()=>Promise.all(Array.from(i(l)).map((t=>n(t).render(t,l,c)))))).then((()=>s(l))).then((n=>("function"!=typeof n.copyFromChannel?(o(n),R(n)):e(r,(()=>r(n)))||a(n),t.add(n),n)))})(Ne,ve,xe,Jn,_n,I,ze,Be),fi=((t,e,n,i,s)=>class extends t{constructor(t,n,s){let r;if("number"==typeof t&&void 0!==n&&void 0!==s)r={length:n,numberOfChannels:t,sampleRate:s};else{if("object"!=typeof t)throw new Error("The given parameters are not valid.");r=t}const{length:o,numberOfChannels:a,sampleRate:c}={...Xt,...r},u=i(a,o,c);e(Mt,(()=>Mt(u)))||u.addEventListener("statechange",(()=>{let t=0;const e=n=>{"running"===this._state&&(t>0?(u.removeEventListener("statechange",e),n.stopImmediatePropagation(),this._waitForThePromiseToSettle(n)):t+=1)};return e})()),super(u,a),this._length=o,this._nativeOfflineAudioContext=u,this._state=null}get length(){return void 0===this._nativeOfflineAudioContext.length?this._length:this._nativeOfflineAudioContext.length}get state(){return null===this._state?this._nativeOfflineAudioContext.state:this._state}startRendering(){return"running"===this._state?Promise.reject(n()):(this._state="running",s(this.destination,this._nativeOfflineAudioContext).finally((()=>{this._state=null,W(this)})))}_waitForThePromiseToSettle(t){null===this._state?this._nativeOfflineAudioContext.dispatchEvent(t):setTimeout((()=>this._waitForThePromiseToSettle(t)))}})(Gn,ve,Ot,pi,di),mi=((t,e)=>n=>{const i=t.get(n);return e(i)||e(n)})(p,Me),vi=((t,e)=>n=>t.has(n)||e(n))(u,Ie),gi=((t,e)=>n=>t.has(n)||e(n))(h,Pe),yi=((t,e)=>n=>{const i=t.get(n);return e(i)||e(n)})(p,Ee),_i=()=>(async(t,e,n,i,s,r,o,a,c,u,l,h,p,d,f,m)=>!!(t(e,e)&&t(n,n)&&t(s,s)&&t(r,r)&&t(a,a)&&t(c,c)&&t(u,u)&&t(l,l)&&t(h,h)&&t(p,p)&&t(d,d))&&(await Promise.all([t(i,i),t(o,o),t(f,f),t(m,m)])).every((t=>t)))(ve,(t=>()=>{if(null===t)return!1;const e=new t(1,1,44100).createBuffer(1,1,44100);if(void 0===e.copyToChannel)return!0;const n=new Float32Array(2);try{e.copyFromChannel(n,0,0)}catch{return!1}return!0})(Oe),(t=>()=>{if(null===t)return!1;if(void 0!==t.prototype&&void 0!==t.prototype.close)return!0;const e=new t,n=void 0!==e.close;try{e.close()}catch{}return n})(De),(t=>()=>{if(null===t)return Promise.resolve(!1);const e=new t(1,1,44100);return new Promise((t=>{let n=!0;const i=i=>{n&&(n=!1,e.startRendering(),t(i instanceof TypeError))};let s;try{s=e.decodeAudioData(null,(()=>{}),i)}catch(t){i(t)}void 0!==s&&s.catch(i)}))})(Oe),(t=>()=>{if(null===t)return!1;let e;try{e=new t({latencyHint:"balanced"})}catch{return!1}return e.close(),!0})(De),(t=>()=>{if(null===t)return!1;const e=new t(1,1,44100).createGain(),n=e.connect(e)===e;return e.disconnect(e),n})(Oe),((t,e)=>async()=>{if(null===t)return!0;if(null===e)return!1;const n=new Blob(['class A extends AudioWorkletProcessor{process(){this.port.postMessage(0)}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),i=new e(1,128,8e3),s=URL.createObjectURL(n);let r=!1;try{await i.audioWorklet.addModule(s);const e=new t(i,"a",{numberOfOutputs:0}),n=i.createOscillator();e.port.onmessage=()=>r=!0,n.connect(e),n.start(0),await i.startRendering(),r||await new Promise((t=>setTimeout(t,5)))}catch{}finally{URL.revokeObjectURL(s)}return r})(Zn,Oe),(t=>()=>{if(null===t)return!1;const e=new t(1,1,44100).createChannelMerger();if("max"===e.channelCountMode)return!0;try{e.channelCount=2}catch{return!0}return!1})(Oe),(t=>()=>{if(null===t)return!1;const e=new t(1,1,44100);return void 0===e.createConstantSource||e.createConstantSource().offset.maxValue!==Number.POSITIVE_INFINITY})(Oe),(t=>()=>{if(null===t)return!1;const e=new t(1,1,44100),n=e.createConvolver();n.buffer=e.createBuffer(1,1,e.sampleRate);try{n.buffer=e.createBuffer(1,1,e.sampleRate)}catch{return!1}return!0})(Oe),(t=>()=>{if(null===t)return!1;const e=new t(1,1,44100).createConvolver();try{e.channelCount=1}catch{return!1}return!0})(Oe),ae,(t=>()=>null!==t&&t.hasOwnProperty("isSecureContext"))(_e),(t=>()=>{if(null===t)return!1;const e=new t;try{return e.createMediaStreamSource(new MediaStream),!1}catch(t){return!0}})(De),(t=>()=>{if(null===t)return Promise.resolve(!1);const e=new t(1,1,44100);if(void 0===e.createStereoPanner)return Promise.resolve(!0);if(void 0===e.createConstantSource)return Promise.resolve(!0);const n=e.createConstantSource(),i=e.createStereoPanner();return n.channelCount=1,n.offset.value=1,i.channelCount=1,n.start(),n.connect(i).connect(e.destination),e.startRendering().then((t=>1!==t.getChannelData(0)[0]))})(Oe),ce);var bi;function xi(t,e){if(!t)throw new Error(e)}function wi(t,e,n=1/0){if(!(e<=t&&t<=n))throw new RangeError(`Value must be within [${e}, ${n}], got: ${t}`)}function Ti(t){t.isOffline||"running"===t.state||Ei('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}let Si=console;function ki(t){Si=t}function Oi(...t){Si.log(...t)}function Ei(...t){Si.warn(...t)}function Ci(t){return void 0===t}function Ai(t){return!Ci(t)}function Di(t){return"function"==typeof t}function Mi(t){return"number"==typeof t}function Ii(t){return"[object Object]"===Object.prototype.toString.call(t)&&t.constructor===Object}function Pi(t){return"boolean"==typeof t}function Ri(t){return Array.isArray(t)}function ji(t){return"string"==typeof t}function qi(t){return ji(t)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(t)}const Ni="object"==typeof self?self:null,Vi=Ni&&(Ni.hasOwnProperty("AudioContext")||Ni.hasOwnProperty("webkitAudioContext"));function Fi(t,e,n,i){var s,r=arguments.length,o=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(e,n,o):s(e,n))||o);return r>3&&o&&Object.defineProperty(e,n,o),o}function Li(t,e,n,i){return new(n||(n=Promise))((function(s,r){function o(t){try{c(i.next(t))}catch(t){r(t)}}function a(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?s(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(o,a)}c((i=i.apply(t,e||[])).next())}))}Object.create,Object.create;class zi{constructor(t,e,n){this._callback=t,this._type=e,this._updateInterval=n,this._createClock()}_createWorker(){const t=new Blob([`\n\t\t\t// the initial timeout time\n\t\t\tlet timeoutTime =  ${(1e3*this._updateInterval).toFixed(1)};\n\t\t\t// onmessage callback\n\t\t\tself.onmessage = function(msg){\n\t\t\t\ttimeoutTime = parseInt(msg.data);\n\t\t\t};\n\t\t\t// the tick function which posts a message\n\t\t\t// and schedules a new tick\n\t\t\tfunction tick(){\n\t\t\t\tsetTimeout(tick, timeoutTime);\n\t\t\t\tself.postMessage('tick');\n\t\t\t}\n\t\t\t// call tick initially\n\t\t\ttick();\n\t\t\t`],{type:"text/javascript"}),e=URL.createObjectURL(t),n=new Worker(e);n.onmessage=this._callback.bind(this),this._worker=n}_createTimeout(){this._timeout=setTimeout((()=>{this._createTimeout(),this._callback()}),1e3*this._updateInterval)}_createClock(){if("worker"===this._type)try{this._createWorker()}catch(t){this._type="timeout",this._createClock()}else"timeout"===this._type&&this._createTimeout()}_disposeClock(){this._timeout&&(clearTimeout(this._timeout),this._timeout=0),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}get updateInterval(){return this._updateInterval}set updateInterval(t){this._updateInterval=Math.max(t,128/44100),"worker"===this._type&&this._worker.postMessage(Math.max(1e3*t,1))}get type(){return this._type}set type(t){this._disposeClock(),this._type=t,this._createClock()}dispose(){this._disposeClock()}}function Bi(t){return gi(t)}function Wi(t){return vi(t)}function Zi(t){return yi(t)}function Ui(t){return mi(t)}function Yi(t){return t instanceof AudioBuffer}function Gi(t,e){return"value"===t||Bi(e)||Wi(e)||Yi(e)}function Xi(t,...e){if(!e.length)return t;const n=e.shift();if(Ii(t)&&Ii(n))for(const e in n)Gi(e,n[e])?t[e]=n[e]:Ii(n[e])?(t[e]||Object.assign(t,{[e]:{}}),Xi(t[e],n[e])):Object.assign(t,{[e]:n[e]});return Xi(t,...e)}function Qi(t,e,n=[],i){const s={},r=Array.from(e);if(Ii(r[0])&&i&&!Reflect.has(r[0],i)&&(Object.keys(r[0]).some((e=>Reflect.has(t,e)))||(Xi(s,{[i]:r[0]}),n.splice(n.indexOf(i),1),r.shift())),1===r.length&&Ii(r[0]))Xi(s,r[0]);else for(let t=0;t<n.length;t++)Ai(r[t])&&(s[n[t]]=r[t]);return Xi(t,s)}function Hi(t,e){return Ci(t)?e:t}function $i(t,e){return e.forEach((e=>{Reflect.has(t,e)&&delete t[e]})),t}class Ki{constructor(){this.debug=!1,this._wasDisposed=!1}static getDefaults(){return{}}log(...t){(this.debug||Ni&&this.toString()===Ni.TONE_DEBUG_CLASS)&&Oi(this,...t)}dispose(){return this._wasDisposed=!0,this}get disposed(){return this._wasDisposed}toString(){return this.name}}Ki.version=r;const Ji=1e-6;function ts(t,e){return t>e+Ji}function es(t,e){return ts(t,e)||is(t,e)}function ns(t,e){return t+Ji<e}function is(t,e){return Math.abs(t-e)<Ji}function ss(t,e,n){return Math.max(Math.min(t,n),e)}class rs extends Ki{constructor(){super(),this.name="Timeline",this._timeline=[];const t=Qi(rs.getDefaults(),arguments,["memory"]);this.memory=t.memory,this.increasing=t.increasing}static getDefaults(){return{memory:1/0,increasing:!1}}get length(){return this._timeline.length}add(t){if(xi(Reflect.has(t,"time"),"Timeline: events must have a time attribute"),t.time=t.time.valueOf(),this.increasing&&this.length){const e=this._timeline[this.length-1];xi(es(t.time,e.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(t)}else{const e=this._search(t.time);this._timeline.splice(e+1,0,t)}if(this.length>this.memory){const t=this.length-this.memory;this._timeline.splice(0,t)}return this}remove(t){const e=this._timeline.indexOf(t);return-1!==e&&this._timeline.splice(e,1),this}get(t,e="time"){const n=this._search(t,e);return-1!==n?this._timeline[n]:null}peek(){return this._timeline[0]}shift(){return this._timeline.shift()}getAfter(t,e="time"){const n=this._search(t,e);return n+1<this._timeline.length?this._timeline[n+1]:null}getBefore(t){const e=this._timeline.length;if(e>0&&this._timeline[e-1].time<t)return this._timeline[e-1];const n=this._search(t);return n-1>=0?this._timeline[n-1]:null}cancel(t){if(this._timeline.length>1){let e=this._search(t);if(e>=0)if(is(this._timeline[e].time,t)){for(let n=e;n>=0&&is(this._timeline[n].time,t);n--)e=n;this._timeline=this._timeline.slice(0,e)}else this._timeline=this._timeline.slice(0,e+1);else this._timeline=[]}else 1===this._timeline.length&&es(this._timeline[0].time,t)&&(this._timeline=[]);return this}cancelBefore(t){const e=this._search(t);return e>=0&&(this._timeline=this._timeline.slice(e+1)),this}previousEvent(t){const e=this._timeline.indexOf(t);return e>0?this._timeline[e-1]:null}_search(t,e="time"){if(0===this._timeline.length)return-1;let n=0;const i=this._timeline.length;let s=i;if(i>0&&this._timeline[i-1][e]<=t)return i-1;for(;n<s;){let i=Math.floor(n+(s-n)/2);const r=this._timeline[i],o=this._timeline[i+1];if(is(r[e],t)){for(let n=i;n<this._timeline.length&&is(this._timeline[n][e],t);n++)i=n;return i}if(ns(r[e],t)&&ts(o[e],t))return i;ts(r[e],t)?s=i:n=i+1}return-1}_iterate(t,e=0,n=this._timeline.length-1){this._timeline.slice(e,n+1).forEach(t)}forEach(t){return this._iterate(t),this}forEachBefore(t,e){const n=this._search(t);return-1!==n&&this._iterate(e,0,n),this}forEachAfter(t,e){const n=this._search(t);return this._iterate(e,n+1),this}forEachBetween(t,e,n){let i=this._search(t),s=this._search(e);return-1!==i&&-1!==s?(this._timeline[i].time!==t&&(i+=1),this._timeline[s].time===e&&(s-=1),this._iterate(n,i,s)):-1===i&&this._iterate(n,0,s),this}forEachFrom(t,e){let n=this._search(t);for(;n>=0&&this._timeline[n].time>=t;)n--;return this._iterate(e,n+1),this}forEachAtTime(t,e){const n=this._search(t);if(-1!==n&&is(this._timeline[n].time,t)){let i=n;for(let e=n;e>=0&&is(this._timeline[e].time,t);e--)i=e;this._iterate((t=>{e(t)}),i,n)}return this}dispose(){return super.dispose(),this._timeline=[],this}}const os=[];function as(t){os.push(t)}const cs=[];function us(t){cs.push(t)}class ls extends Ki{constructor(){super(...arguments),this.name="Emitter"}on(t,e){return t.split(/\W+/).forEach((t=>{Ci(this._events)&&(this._events={}),this._events.hasOwnProperty(t)||(this._events[t]=[]),this._events[t].push(e)})),this}once(t,e){const n=(...i)=>{e(...i),this.off(t,n)};return this.on(t,n),this}off(t,e){return t.split(/\W+/).forEach((n=>{if(Ci(this._events)&&(this._events={}),this._events.hasOwnProperty(t))if(Ci(e))this._events[t]=[];else{const n=this._events[t];for(let t=n.length-1;t>=0;t--)n[t]===e&&n.splice(t,1)}})),this}emit(t,...e){if(this._events&&this._events.hasOwnProperty(t)){const n=this._events[t].slice(0);for(let t=0,i=n.length;t<i;t++)n[t].apply(this,e)}return this}static mixin(t){["on","once","off","emit"].forEach((e=>{const n=Object.getOwnPropertyDescriptor(ls.prototype,e);Object.defineProperty(t.prototype,e,n)}))}dispose(){return super.dispose(),this._events=void 0,this}}class hs extends ls{constructor(){super(...arguments),this.isOffline=!1}toJSON(){return{}}}class ps extends hs{constructor(){super(),this.name="Context",this._constants=new Map,this._timeouts=new rs,this._timeoutIds=0,this._initialized=!1,this.isOffline=!1,this._workletModules=new Map;const t=Qi(ps.getDefaults(),arguments,["context"]);t.context?this._context=t.context:this._context=function(t){return new Kn(t)}({latencyHint:t.latencyHint}),this._ticker=new zi(this.emit.bind(this,"tick"),t.clockSource,t.updateInterval),this.on("tick",this._timeoutLoop.bind(this)),this._context.onstatechange=()=>{this.emit("statechange",this.state)},this._setLatencyHint(t.latencyHint),this.lookAhead=t.lookAhead}static getDefaults(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}initialize(){var t;return this._initialized||(t=this,os.forEach((e=>e(t))),this._initialized=!0),this}createAnalyser(){return this._context.createAnalyser()}createOscillator(){return this._context.createOscillator()}createBufferSource(){return this._context.createBufferSource()}createBiquadFilter(){return this._context.createBiquadFilter()}createBuffer(t,e,n){return this._context.createBuffer(t,e,n)}createChannelMerger(t){return this._context.createChannelMerger(t)}createChannelSplitter(t){return this._context.createChannelSplitter(t)}createConstantSource(){return this._context.createConstantSource()}createConvolver(){return this._context.createConvolver()}createDelay(t){return this._context.createDelay(t)}createDynamicsCompressor(){return this._context.createDynamicsCompressor()}createGain(){return this._context.createGain()}createIIRFilter(t,e){return this._context.createIIRFilter(t,e)}createPanner(){return this._context.createPanner()}createPeriodicWave(t,e,n){return this._context.createPeriodicWave(t,e,n)}createStereoPanner(){return this._context.createStereoPanner()}createWaveShaper(){return this._context.createWaveShaper()}createMediaStreamSource(t){return xi(Ui(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamSource(t)}createMediaElementSource(t){return xi(Ui(this._context),"Not available if OfflineAudioContext"),this._context.createMediaElementSource(t)}createMediaStreamDestination(){return xi(Ui(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamDestination()}decodeAudioData(t){return this._context.decodeAudioData(t)}get currentTime(){return this._context.currentTime}get state(){return this._context.state}get sampleRate(){return this._context.sampleRate}get listener(){return this.initialize(),this._listener}set listener(t){xi(!this._initialized,"The listener cannot be set after initialization."),this._listener=t}get transport(){return this.initialize(),this._transport}set transport(t){xi(!this._initialized,"The transport cannot be set after initialization."),this._transport=t}get draw(){return this.initialize(),this._draw}set draw(t){xi(!this._initialized,"Draw cannot be set after initialization."),this._draw=t}get destination(){return this.initialize(),this._destination}set destination(t){xi(!this._initialized,"The destination cannot be set after initialization."),this._destination=t}createAudioWorkletNode(t,e){return function(t,e,n){return xi(Ai(hi),"This node only works in a secure context (https or localhost)"),new hi(t,e,n)}(this.rawContext,t,e)}addAudioWorkletModule(t,e){return Li(this,void 0,void 0,(function*(){xi(Ai(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletModules.has(e)||this._workletModules.set(e,this.rawContext.audioWorklet.addModule(t)),yield this._workletModules.get(e)}))}workletsAreReady(){return Li(this,void 0,void 0,(function*(){const t=[];this._workletModules.forEach((e=>t.push(e))),yield Promise.all(t)}))}get updateInterval(){return this._ticker.updateInterval}set updateInterval(t){this._ticker.updateInterval=t}get clockSource(){return this._ticker.type}set clockSource(t){this._ticker.type=t}get latencyHint(){return this._latencyHint}_setLatencyHint(t){let e=0;if(this._latencyHint=t,ji(t))switch(t){case"interactive":e=.1;break;case"playback":e=.5;break;case"balanced":e=.25}this.lookAhead=e,this.updateInterval=e/2}get rawContext(){return this._context}now(){return this._context.currentTime+this.lookAhead}immediate(){return this._context.currentTime}resume(){return Ui(this._context)?this._context.resume():Promise.resolve()}close(){return Li(this,void 0,void 0,(function*(){var t;Ui(this._context)&&(yield this._context.close()),this._initialized&&(t=this,cs.forEach((e=>e(t))))}))}getConstant(t){if(this._constants.has(t))return this._constants.get(t);{const e=this._context.createBuffer(1,128,this._context.sampleRate),n=e.getChannelData(0);for(let e=0;e<n.length;e++)n[e]=t;const i=this._context.createBufferSource();return i.channelCount=1,i.channelCountMode="explicit",i.buffer=e,i.loop=!0,i.start(0),this._constants.set(t,i),i}}dispose(){return super.dispose(),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map((t=>this._constants[t].disconnect())),this}_timeoutLoop(){const t=this.now();let e=this._timeouts.peek();for(;this._timeouts.length&&e&&e.time<=t;)e.callback(),this._timeouts.shift(),e=this._timeouts.peek()}setTimeout(t,e){this._timeoutIds++;const n=this.now();return this._timeouts.add({callback:t,id:this._timeoutIds,time:n+e}),this._timeoutIds}clearTimeout(t){return this._timeouts.forEach((e=>{e.id===t&&this._timeouts.remove(e)})),this}clearInterval(t){return this.clearTimeout(t)}setInterval(t,e){const n=++this._timeoutIds,i=()=>{const s=this.now();this._timeouts.add({callback:()=>{t(),i()},id:n,time:s+e})};return i(),n}}function ds(t,e){Ri(e)?e.forEach((e=>ds(t,e))):Object.defineProperty(t,e,{enumerable:!0,writable:!1})}function fs(t,e){Ri(e)?e.forEach((e=>fs(t,e))):Object.defineProperty(t,e,{writable:!0})}const ms=()=>{};class vs extends Ki{constructor(){super(),this.name="ToneAudioBuffer",this.onload=ms;const t=Qi(vs.getDefaults(),arguments,["url","onload","onerror"]);this.reverse=t.reverse,this.onload=t.onload,t.url&&Yi(t.url)||t.url instanceof vs?this.set(t.url):ji(t.url)&&this.load(t.url).catch(t.onerror)}static getDefaults(){return{onerror:ms,onload:ms,reverse:!1}}get sampleRate(){return this._buffer?this._buffer.sampleRate:bs().sampleRate}set(t){return t instanceof vs?t.loaded?this._buffer=t.get():t.onload=()=>{this.set(t),this.onload(this)}:this._buffer=t,this._reversed&&this._reverse(),this}get(){return this._buffer}load(t){return Li(this,void 0,void 0,(function*(){const e=vs.load(t).then((t=>{this.set(t),this.onload(this)}));vs.downloads.push(e);try{yield e}finally{const t=vs.downloads.indexOf(e);vs.downloads.splice(t,1)}return this}))}dispose(){return super.dispose(),this._buffer=void 0,this}fromArray(t){const e=Ri(t)&&t[0].length>0,n=e?t.length:1,i=e?t[0].length:t.length,s=bs(),r=s.createBuffer(n,i,s.sampleRate),o=e||1!==n?t:[t];for(let t=0;t<n;t++)r.copyToChannel(o[t],t);return this._buffer=r,this}toMono(t){if(Mi(t))this.fromArray(this.toArray(t));else{let t=new Float32Array(this.length);const e=this.numberOfChannels;for(let n=0;n<e;n++){const e=this.toArray(n);for(let n=0;n<e.length;n++)t[n]+=e[n]}t=t.map((t=>t/e)),this.fromArray(t)}return this}toArray(t){if(Mi(t))return this.getChannelData(t);if(1===this.numberOfChannels)return this.toArray(0);{const t=[];for(let e=0;e<this.numberOfChannels;e++)t[e]=this.getChannelData(e);return t}}getChannelData(t){return this._buffer?this._buffer.getChannelData(t):new Float32Array(0)}slice(t,e=this.duration){const n=Math.floor(t*this.sampleRate),i=Math.floor(e*this.sampleRate);xi(n<i,"The start time must be less than the end time");const s=i-n,r=bs().createBuffer(this.numberOfChannels,s,this.sampleRate);for(let t=0;t<this.numberOfChannels;t++)r.copyToChannel(this.getChannelData(t).subarray(n,i),t);return new vs(r)}_reverse(){if(this.loaded)for(let t=0;t<this.numberOfChannels;t++)this.getChannelData(t).reverse();return this}get loaded(){return this.length>0}get duration(){return this._buffer?this._buffer.duration:0}get length(){return this._buffer?this._buffer.length:0}get numberOfChannels(){return this._buffer?this._buffer.numberOfChannels:0}get reverse(){return this._reversed}set reverse(t){this._reversed!==t&&(this._reversed=t,this._reverse())}static fromArray(t){return(new vs).fromArray(t)}static fromUrl(t){return Li(this,void 0,void 0,(function*(){const e=new vs;return yield e.load(t)}))}static load(t){return Li(this,void 0,void 0,(function*(){const e=t.match(/\[([^\]\[]+\|.+)\]$/);if(e){const n=e[1].split("|");let i=n[0];for(const t of n)if(vs.supportsType(t)){i=t;break}t=t.replace(e[0],i)}const n=""===vs.baseUrl||vs.baseUrl.endsWith("/")?vs.baseUrl:vs.baseUrl+"/",i=yield fetch(n+t);if(!i.ok)throw new Error(`could not load url: ${t}`);const s=yield i.arrayBuffer();return yield bs().decodeAudioData(s)}))}static supportsType(t){const e=t.split("."),n=e[e.length-1];return""!==document.createElement("audio").canPlayType("audio/"+n)}static loaded(){return Li(this,void 0,void 0,(function*(){for(yield Promise.resolve();vs.downloads.length;)yield vs.downloads[0]}))}}vs.baseUrl="",vs.downloads=[];class gs extends ps{constructor(){var t,e,n;super({clockSource:"offline",context:Zi(arguments[0])?arguments[0]:(t=arguments[0],e=arguments[1]*arguments[2],n=arguments[2],new fi(t,e,n)),lookAhead:0,updateInterval:Zi(arguments[0])?128/arguments[0].sampleRate:128/arguments[2]}),this.name="OfflineContext",this._currentTime=0,this.isOffline=!0,this._duration=Zi(arguments[0])?arguments[0].length/arguments[0].sampleRate:arguments[1]}now(){return this._currentTime}get currentTime(){return this._currentTime}_renderClock(t){return Li(this,void 0,void 0,(function*(){let e=0;for(;this._duration-this._currentTime>=0;){this.emit("tick"),this._currentTime+=128/this.sampleRate,e++;const n=Math.floor(this.sampleRate/128);t&&e%n==0&&(yield new Promise((t=>setTimeout(t,1))))}}))}render(t=!0){return Li(this,void 0,void 0,(function*(){yield this.workletsAreReady(),yield this._renderClock(t);const e=yield this._context.startRendering();return new vs(e)}))}close(){return Promise.resolve()}}const ys=new class extends hs{constructor(){super(...arguments),this.lookAhead=0,this.latencyHint=0,this.isOffline=!1}createAnalyser(){return{}}createOscillator(){return{}}createBufferSource(){return{}}createBiquadFilter(){return{}}createBuffer(t,e,n){return{}}createChannelMerger(t){return{}}createChannelSplitter(t){return{}}createConstantSource(){return{}}createConvolver(){return{}}createDelay(t){return{}}createDynamicsCompressor(){return{}}createGain(){return{}}createIIRFilter(t,e){return{}}createPanner(){return{}}createPeriodicWave(t,e,n){return{}}createStereoPanner(){return{}}createWaveShaper(){return{}}createMediaStreamSource(t){return{}}createMediaElementSource(t){return{}}createMediaStreamDestination(){return{}}decodeAudioData(t){return Promise.resolve({})}createAudioWorkletNode(t,e){return{}}get rawContext(){return{}}addAudioWorkletModule(t,e){return Li(this,void 0,void 0,(function*(){return Promise.resolve()}))}resume(){return Promise.resolve()}setTimeout(t,e){return 0}clearTimeout(t){return this}setInterval(t,e){return 0}clearInterval(t){return this}getConstant(t){return{}}get currentTime(){return 0}get state(){return{}}get sampleRate(){return 0}get listener(){return{}}get transport(){return{}}get draw(){return{}}set draw(t){}get destination(){return{}}set destination(t){}now(){return 0}immediate(){return 0}};let _s=ys;function bs(){return _s===ys&&Vi&&xs(new ps),_s}function xs(t){_s=Ui(t)?new ps(t):Zi(t)?new gs(t):t}function ws(){return _s.resume()}if(Ni&&!Ni.TONE_SILENCE_LOGGING){let t="v";"dev"===r&&(t="");const e=` * Tone.js ${t}${r} * `;console.log(`%c${e}`,"background: #000; color: #fff")}function Ts(t){return Math.pow(10,t/20)}function Ss(t){return Math.log(t)/Math.LN10*20}function ks(t){return Math.pow(2,t/12)}let Os=440;function Es(t){return Math.round(Cs(t))}function Cs(t){return 69+12*Math.log2(t/Os)}function As(t){return Os*Math.pow(2,(t-69)/12)}class Ds extends Ki{constructor(t,e,n){super(),this.defaultUnits="s",this._val=e,this._units=n,this.context=t,this._expressions=this._getExpressions()}_getExpressions(){return{hz:{method:t=>this._frequencyToUnits(parseFloat(t)),regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:t=>this._ticksToUnits(parseInt(t,10)),regexp:/^(\d+)i$/i},m:{method:t=>this._beatsToUnits(parseInt(t,10)*this._getTimeSignature()),regexp:/^(\d+)m$/i},n:{method:(t,e)=>{const n=parseInt(t,10),i="."===e?1.5:1;return 1===n?this._beatsToUnits(this._getTimeSignature())*i:this._beatsToUnits(4/n)*i},regexp:/^(\d+)n(\.?)$/i},number:{method:t=>this._expressions[this.defaultUnits].method.call(this,t),regexp:/^(\d+(?:\.\d+)?)$/},s:{method:t=>this._secondsToUnits(parseFloat(t)),regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:t=>parseInt(t,10)/this.context.sampleRate,regexp:/^(\d+)samples$/},t:{method:t=>{const e=parseInt(t,10);return this._beatsToUnits(8/(3*Math.floor(e)))},regexp:/^(\d+)t$/i},tr:{method:(t,e,n)=>{let i=0;return t&&"0"!==t&&(i+=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),e&&"0"!==e&&(i+=this._beatsToUnits(parseFloat(e))),n&&"0"!==n&&(i+=this._beatsToUnits(parseFloat(n)/4)),i},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}valueOf(){if(this._val instanceof Ds&&this.fromType(this._val),Ci(this._val))return this._noArg();if(ji(this._val)&&Ci(this._units)){for(const t in this._expressions)if(this._expressions[t].regexp.test(this._val.trim())){this._units=t;break}}else if(Ii(this._val)){let t=0;for(const e in this._val)if(Ai(this._val[e])){const n=this._val[e];t+=new this.constructor(this.context,e).valueOf()*n}return t}if(Ai(this._units)){const t=this._expressions[this._units],e=this._val.toString().trim().match(t.regexp);return e?t.method.apply(this,e.slice(1)):t.method.call(this,this._val)}return ji(this._val)?parseFloat(this._val):this._val}_frequencyToUnits(t){return 1/t}_beatsToUnits(t){return 60/this._getBpm()*t}_secondsToUnits(t){return t}_ticksToUnits(t){return t*this._beatsToUnits(1)/this._getPPQ()}_noArg(){return this._now()}_getBpm(){return this.context.transport.bpm.value}_getTimeSignature(){return this.context.transport.timeSignature}_getPPQ(){return this.context.transport.PPQ}fromType(t){switch(this._units=void 0,this.defaultUnits){case"s":this._val=t.toSeconds();break;case"i":this._val=t.toTicks();break;case"hz":this._val=t.toFrequency();break;case"midi":this._val=t.toMidi()}return this}toFrequency(){return 1/this.toSeconds()}toSamples(){return this.toSeconds()*this.context.sampleRate}toMilliseconds(){return 1e3*this.toSeconds()}}class Ms extends Ds{constructor(){super(...arguments),this.name="TimeClass"}_getExpressions(){return Object.assign(super._getExpressions(),{now:{method:t=>this._now()+new this.constructor(this.context,t).valueOf(),regexp:/^\+(.+)/},quantize:{method:t=>{const e=new Ms(this.context,t).valueOf();return this._secondsToUnits(this.context.transport.nextSubdivision(e))},regexp:/^@(.+)/}})}quantize(t,e=1){const n=new this.constructor(this.context,t).valueOf(),i=this.valueOf();return i+(Math.round(i/n)*n-i)*e}toNotation(){const t=this.toSeconds(),e=["1m"];for(let t=1;t<9;t++){const n=Math.pow(2,t);e.push(n+"n."),e.push(n+"n"),e.push(n+"t")}e.push("0");let n=e[0],i=new Ms(this.context,e[0]).toSeconds();return e.forEach((e=>{const s=new Ms(this.context,e).toSeconds();Math.abs(s-t)<Math.abs(i-t)&&(n=e,i=s)})),n}toBarsBeatsSixteenths(){const t=this._beatsToUnits(1);let e=this.valueOf()/t;e=parseFloat(e.toFixed(4));const n=Math.floor(e/this._getTimeSignature());let i=e%1*4;e=Math.floor(e)%this._getTimeSignature();const s=i.toString();return s.length>3&&(i=parseFloat(parseFloat(s).toFixed(3))),[n,e,i].join(":")}toTicks(){const t=this._beatsToUnits(1),e=this.valueOf()/t;return Math.round(e*this._getPPQ())}toSeconds(){return this.valueOf()}toMidi(){return Es(this.toFrequency())}_now(){return this.context.now()}}function Is(t,e){return new Ms(bs(),t,e)}class Ps extends Ms{constructor(){super(...arguments),this.name="Frequency",this.defaultUnits="hz"}static get A4(){return Os}static set A4(t){!function(t){Os=t}(t)}_getExpressions(){return Object.assign({},super._getExpressions(),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method(t){return"midi"===this.defaultUnits?t:Ps.mtof(t)}},note:{regexp:/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i,method(t,e){const n=Rs[t.toLowerCase()]+12*(parseInt(e,10)+1);return"midi"===this.defaultUnits?n:Ps.mtof(n)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method(t,e,n){let i=1;return t&&"0"!==t&&(i*=this._beatsToUnits(this._getTimeSignature()*parseFloat(t))),e&&"0"!==e&&(i*=this._beatsToUnits(parseFloat(e))),n&&"0"!==n&&(i*=this._beatsToUnits(parseFloat(n)/4)),i}}})}transpose(t){return new Ps(this.context,this.valueOf()*ks(t))}harmonize(t){return t.map((t=>this.transpose(t)))}toMidi(){return Es(this.valueOf())}toNote(){const t=this.toFrequency(),e=Math.log2(t/Ps.A4);let n=Math.round(12*e)+57;const i=Math.floor(n/12);return i<0&&(n+=-12*i),js[n%12]+i.toString()}toSeconds(){return 1/super.toSeconds()}toTicks(){const t=this._beatsToUnits(1),e=this.valueOf()/t;return Math.floor(e*this._getPPQ())}_noArg(){return 0}_frequencyToUnits(t){return t}_ticksToUnits(t){return 1/(60*t/(this._getBpm()*this._getPPQ()))}_beatsToUnits(t){return 1/super._beatsToUnits(t)}_secondsToUnits(t){return 1/t}static mtof(t){return As(t)}static ftom(t){return Es(t)}}const Rs={cbb:-2,cb:-1,c:0,"c#":1,cx:2,dbb:0,db:1,d:2,"d#":3,dx:4,ebb:2,eb:3,e:4,"e#":5,ex:6,fbb:3,fb:4,f:5,"f#":6,fx:7,gbb:5,gb:6,g:7,"g#":8,gx:9,abb:7,ab:8,a:9,"a#":10,ax:11,bbb:9,bb:10,b:11,"b#":12,bx:13},js=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];function qs(t,e){return new Ps(bs(),t,e)}class Ns extends Ms{constructor(){super(...arguments),this.name="TransportTime"}_now(){return this.context.transport.seconds}}function Vs(t,e){return new Ns(bs(),t,e)}class Fs extends Ki{constructor(){super();const t=Qi(Fs.getDefaults(),arguments,["context"]);this.defaultContext?this.context=this.defaultContext:this.context=t.context}static getDefaults(){return{context:bs()}}now(){return this.context.currentTime+this.context.lookAhead}immediate(){return this.context.currentTime}get sampleTime(){return 1/this.context.sampleRate}get blockTime(){return 128/this.context.sampleRate}toSeconds(t){return new Ms(this.context,t).toSeconds()}toFrequency(t){return new Ps(this.context,t).toFrequency()}toTicks(t){return new Ns(this.context,t).toTicks()}_getPartialProperties(t){const e=this.get();return Object.keys(e).forEach((n=>{Ci(t[n])&&delete e[n]})),e}get(){const t=this.constructor.getDefaults();return Object.keys(t).forEach((e=>{if(Reflect.has(this,e)){const n=this[e];Ai(n)&&Ai(n.value)&&Ai(n.setValueAtTime)?t[e]=n.value:n instanceof Fs?t[e]=n._getPartialProperties(t[e]):Ri(n)||Mi(n)||ji(n)||Pi(n)?t[e]=n:delete t[e]}})),t}set(t){return Object.keys(t).forEach((e=>{Reflect.has(this,e)&&Ai(this[e])&&(this[e]&&Ai(this[e].value)&&Ai(this[e].setValueAtTime)?this[e].value!==t[e]&&(this[e].value=t[e]):this[e]instanceof Fs?this[e].set(t[e]):this[e]=t[e])})),this}}class Ls extends rs{constructor(t="stopped"){super(),this.name="StateTimeline",this._initial=t,this.setStateAtTime(this._initial,0)}getValueAtTime(t){const e=this.get(t);return null!==e?e.state:this._initial}setStateAtTime(t,e,n){return wi(e,0),this.add(Object.assign({},n,{state:t,time:e})),this}getLastState(t,e){for(let n=this._search(e);n>=0;n--){const e=this._timeline[n];if(e.state===t)return e}}getNextState(t,e){const n=this._search(e);if(-1!==n)for(let e=n;e<this._timeline.length;e++){const n=this._timeline[e];if(n.state===t)return n}}}class zs extends Fs{constructor(){super(Qi(zs.getDefaults(),arguments,["param","units","convert"])),this.name="Param",this.overridden=!1,this._minOutput=1e-7;const t=Qi(zs.getDefaults(),arguments,["param","units","convert"]);for(xi(Ai(t.param)&&(Bi(t.param)||t.param instanceof zs),"param must be an AudioParam");!Bi(t.param);)t.param=t.param._param;this._swappable=!!Ai(t.swappable)&&t.swappable,this._swappable?(this.input=this.context.createGain(),this._param=t.param,this.input.connect(this._param)):this._param=this.input=t.param,this._events=new rs(1e3),this._initialValue=this._param.defaultValue,this.units=t.units,this.convert=t.convert,this._minValue=t.minValue,this._maxValue=t.maxValue,Ai(t.value)&&t.value!==this._toType(this._initialValue)&&this.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(Fs.getDefaults(),{convert:!0,units:"number"})}get value(){const t=this.now();return this.getValueAtTime(t)}set value(t){this.cancelScheduledValues(this.now()),this.setValueAtTime(t,this.now())}get minValue(){return Ai(this._minValue)?this._minValue:"time"===this.units||"frequency"===this.units||"normalRange"===this.units||"positive"===this.units||"transportTime"===this.units||"ticks"===this.units||"bpm"===this.units||"hertz"===this.units||"samples"===this.units?0:"audioRange"===this.units?-1:"decibels"===this.units?-1/0:this._param.minValue}get maxValue(){return Ai(this._maxValue)?this._maxValue:"normalRange"===this.units||"audioRange"===this.units?1:this._param.maxValue}_is(t,e){return this.units===e}_assertRange(t){return Ai(this.maxValue)&&Ai(this.minValue)&&wi(t,this._fromType(this.minValue),this._fromType(this.maxValue)),t}_fromType(t){return this.convert&&!this.overridden?this._is(t,"time")?this.toSeconds(t):this._is(t,"decibels")?Ts(t):this._is(t,"frequency")?this.toFrequency(t):t:this.overridden?0:t}_toType(t){return this.convert&&"decibels"===this.units?Ss(t):t}setValueAtTime(t,e){const n=this.toSeconds(e),i=this._fromType(t);return xi(isFinite(i)&&isFinite(n),`Invalid argument(s) to setValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._assertRange(i),this.log(this.units,"setValueAtTime",t,n),this._events.add({time:n,type:"setValueAtTime",value:i}),this._param.setValueAtTime(i,n),this}getValueAtTime(t){const e=Math.max(this.toSeconds(t),0),n=this._events.getAfter(e),i=this._events.get(e);let s=this._initialValue;if(null===i)s=this._initialValue;else if("setTargetAtTime"!==i.type||null!==n&&"setValueAtTime"!==n.type)if(null===n)s=i.value;else if("linearRampToValueAtTime"===n.type||"exponentialRampToValueAtTime"===n.type){let t=i.value;if("setTargetAtTime"===i.type){const e=this._events.getBefore(i.time);t=null===e?this._initialValue:e.value}s="linearRampToValueAtTime"===n.type?this._linearInterpolate(i.time,t,n.time,n.value,e):this._exponentialInterpolate(i.time,t,n.time,n.value,e)}else s=i.value;else{const t=this._events.getBefore(i.time);let n;n=null===t?this._initialValue:t.value,"setTargetAtTime"===i.type&&(s=this._exponentialApproach(i.time,n,i.value,i.constant,e))}return this._toType(s)}setRampPoint(t){t=this.toSeconds(t);let e=this.getValueAtTime(t);return this.cancelAndHoldAtTime(t),0===this._fromType(e)&&(e=this._toType(this._minOutput)),this.setValueAtTime(e,t),this}linearRampToValueAtTime(t,e){const n=this._fromType(t),i=this.toSeconds(e);return xi(isFinite(n)&&isFinite(i),`Invalid argument(s) to linearRampToValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._assertRange(n),this._events.add({time:i,type:"linearRampToValueAtTime",value:n}),this.log(this.units,"linearRampToValueAtTime",t,i),this._param.linearRampToValueAtTime(n,i),this}exponentialRampToValueAtTime(t,e){let n=this._fromType(t);n=is(n,0)?this._minOutput:n,this._assertRange(n);const i=this.toSeconds(e);return xi(isFinite(n)&&isFinite(i),`Invalid argument(s) to exponentialRampToValueAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._events.add({time:i,type:"exponentialRampToValueAtTime",value:n}),this.log(this.units,"exponentialRampToValueAtTime",t,i),this._param.exponentialRampToValueAtTime(n,i),this}exponentialRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialRampToValueAtTime(t,n+this.toSeconds(e)),this}linearRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.linearRampToValueAtTime(t,n+this.toSeconds(e)),this}targetRampTo(t,e,n){return n=this.toSeconds(n),this.setRampPoint(n),this.exponentialApproachValueAtTime(t,n,e),this}exponentialApproachValueAtTime(t,e,n){e=this.toSeconds(e),n=this.toSeconds(n);const i=Math.log(n+1)/Math.log(200);return this.setTargetAtTime(t,e,i),this.cancelAndHoldAtTime(e+.9*n),this.linearRampToValueAtTime(t,e+n),this}setTargetAtTime(t,e,n){const i=this._fromType(t);xi(isFinite(n)&&n>0,"timeConstant must be a number greater than 0");const s=this.toSeconds(e);return this._assertRange(i),xi(isFinite(i)&&isFinite(s),`Invalid argument(s) to setTargetAtTime: ${JSON.stringify(t)}, ${JSON.stringify(e)}`),this._events.add({constant:n,time:s,type:"setTargetAtTime",value:i}),this.log(this.units,"setTargetAtTime",t,s,n),this._param.setTargetAtTime(i,s,n),this}setValueCurveAtTime(t,e,n,i=1){n=this.toSeconds(n),e=this.toSeconds(e);const s=this._fromType(t[0])*i;this.setValueAtTime(this._toType(s),e);const r=n/(t.length-1);for(let n=1;n<t.length;n++){const s=this._fromType(t[n])*i;this.linearRampToValueAtTime(this._toType(s),e+n*r)}return this}cancelScheduledValues(t){const e=this.toSeconds(t);return xi(isFinite(e),`Invalid argument to cancelScheduledValues: ${JSON.stringify(t)}`),this._events.cancel(e),this._param.cancelScheduledValues(e),this.log(this.units,"cancelScheduledValues",e),this}cancelAndHoldAtTime(t){const e=this.toSeconds(t),n=this._fromType(this.getValueAtTime(e));xi(isFinite(e),`Invalid argument to cancelAndHoldAtTime: ${JSON.stringify(t)}`),this.log(this.units,"cancelAndHoldAtTime",e,"value="+n);const i=this._events.get(e),s=this._events.getAfter(e);return i&&is(i.time,e)?s?(this._param.cancelScheduledValues(s.time),this._events.cancel(s.time)):(this._param.cancelAndHoldAtTime(e),this._events.cancel(e+this.sampleTime)):s&&(this._param.cancelScheduledValues(s.time),this._events.cancel(s.time),"linearRampToValueAtTime"===s.type?this.linearRampToValueAtTime(this._toType(n),e):"exponentialRampToValueAtTime"===s.type&&this.exponentialRampToValueAtTime(this._toType(n),e)),this._events.add({time:e,type:"setValueAtTime",value:n}),this._param.setValueAtTime(n,e),this}rampTo(t,e=.1,n){return"frequency"===this.units||"bpm"===this.units||"decibels"===this.units?this.exponentialRampTo(t,e,n):this.linearRampTo(t,e,n),this}apply(t){const e=this.context.currentTime;t.setValueAtTime(this.getValueAtTime(e),e);const n=this._events.get(e);if(n&&"setTargetAtTime"===n.type){const i=this._events.getAfter(n.time),s=i?i.time:e+2,r=(s-e)/10;for(let n=e;n<s;n+=r)t.linearRampToValueAtTime(this.getValueAtTime(n),n)}return this._events.forEachAfter(this.context.currentTime,(e=>{"cancelScheduledValues"===e.type?t.cancelScheduledValues(e.time):"setTargetAtTime"===e.type?t.setTargetAtTime(e.value,e.time,e.constant):t[e.type](e.value,e.time)})),this}setParam(t){xi(this._swappable,"The Param must be assigned as 'swappable' in the constructor");const e=this.input;return e.disconnect(this._param),this.apply(t),this._param=t,e.connect(this._param),this}dispose(){return super.dispose(),this._events.dispose(),this}get defaultValue(){return this._toType(this._param.defaultValue)}_exponentialApproach(t,e,n,i,s){return n+(e-n)*Math.exp(-(s-t)/i)}_linearInterpolate(t,e,n,i,s){return e+(s-t)/(n-t)*(i-e)}_exponentialInterpolate(t,e,n,i,s){return e*Math.pow(i/e,(s-t)/(n-t))}}class Bs extends Fs{constructor(){super(...arguments),this.name="ToneAudioNode",this._internalChannels=[]}get numberOfInputs(){return Ai(this.input)?Bi(this.input)||this.input instanceof zs?1:this.input.numberOfInputs:0}get numberOfOutputs(){return Ai(this.output)?this.output.numberOfOutputs:0}_isAudioNode(t){return Ai(t)&&(t instanceof Bs||Wi(t))}_getInternalNodes(){const t=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&t.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&t.push(this.output),t}_setChannelProperties(t){this._getInternalNodes().forEach((e=>{e.channelCount=t.channelCount,e.channelCountMode=t.channelCountMode,e.channelInterpretation=t.channelInterpretation}))}_getChannelProperties(){const t=this._getInternalNodes();xi(t.length>0,"ToneAudioNode does not have any internal nodes");const e=t[0];return{channelCount:e.channelCount,channelCountMode:e.channelCountMode,channelInterpretation:e.channelInterpretation}}get channelCount(){return this._getChannelProperties().channelCount}set channelCount(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCount:t}))}get channelCountMode(){return this._getChannelProperties().channelCountMode}set channelCountMode(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelCountMode:t}))}get channelInterpretation(){return this._getChannelProperties().channelInterpretation}set channelInterpretation(t){const e=this._getChannelProperties();this._setChannelProperties(Object.assign(e,{channelInterpretation:t}))}connect(t,e=0,n=0){return Zs(this,t,e,n),this}toDestination(){return this.connect(this.context.destination),this}toMaster(){return Ei("toMaster() has been renamed toDestination()"),this.toDestination()}disconnect(t,e=0,n=0){return Us(this,t,e,n),this}chain(...t){return Ws(this,...t),this}fan(...t){return t.forEach((t=>this.connect(t))),this}dispose(){return super.dispose(),Ai(this.input)&&(this.input instanceof Bs?this.input.dispose():Wi(this.input)&&this.input.disconnect()),Ai(this.output)&&(this.output instanceof Bs?this.output.dispose():Wi(this.output)&&this.output.disconnect()),this._internalChannels=[],this}}function Ws(...t){const e=t.shift();t.reduce(((t,e)=>(t instanceof Bs?t.connect(e):Wi(t)&&Zs(t,e),e)),e)}function Zs(t,e,n=0,i=0){for(xi(Ai(t),"Cannot connect from undefined node"),xi(Ai(e),"Cannot connect to undefined node"),(e instanceof Bs||Wi(e))&&xi(e.numberOfInputs>0,"Cannot connect to node with no inputs"),xi(t.numberOfOutputs>0,"Cannot connect from node with no outputs");e instanceof Bs||e instanceof zs;)Ai(e.input)&&(e=e.input);for(;t instanceof Bs;)Ai(t.output)&&(t=t.output);Bi(e)?t.connect(e,n):t.connect(e,n,i)}function Us(t,e,n=0,i=0){if(Ai(e))for(;e instanceof Bs;)e=e.input;for(;!Wi(t);)Ai(t.output)&&(t=t.output);Bi(e)?t.disconnect(e,n):Wi(e)?t.disconnect(e,n,i):t.disconnect()}class Ys extends Bs{constructor(){super(Qi(Ys.getDefaults(),arguments,["gain","units"])),this.name="Gain",this._gainNode=this.context.createGain(),this.input=this._gainNode,this.output=this._gainNode;const t=Qi(Ys.getDefaults(),arguments,["gain","units"]);this.gain=new zs({context:this.context,convert:t.convert,param:this._gainNode.gain,units:t.units,value:t.gain,minValue:t.minValue,maxValue:t.maxValue}),ds(this,"gain")}static getDefaults(){return Object.assign(Bs.getDefaults(),{convert:!0,gain:1,units:"gain"})}dispose(){return super.dispose(),this._gainNode.disconnect(),this.gain.dispose(),this}}class Gs extends Bs{constructor(t){super(t),this.onended=ms,this._startTime=-1,this._stopTime=-1,this._timeout=-1,this.output=new Ys({context:this.context,gain:0}),this._gainNode=this.output,this.getStateAtTime=function(t){const e=this.toSeconds(t);return-1!==this._startTime&&e>=this._startTime&&(-1===this._stopTime||e<=this._stopTime)?"started":"stopped"},this._fadeIn=t.fadeIn,this._fadeOut=t.fadeOut,this._curve=t.curve,this.onended=t.onended}static getDefaults(){return Object.assign(Bs.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:ms})}_startGain(t,e=1){xi(-1===this._startTime,"Source cannot be started more than once");const n=this.toSeconds(this._fadeIn);return this._startTime=t+n,this._startTime=Math.max(this._startTime,this.context.currentTime),n>0?(this._gainNode.gain.setValueAtTime(0,t),"linear"===this._curve?this._gainNode.gain.linearRampToValueAtTime(e,t+n):this._gainNode.gain.exponentialApproachValueAtTime(e,t,n)):this._gainNode.gain.setValueAtTime(e,t),this}stop(t){return this.log("stop",t),this._stopGain(this.toSeconds(t)),this}_stopGain(t){xi(-1!==this._startTime,"'start' must be called before 'stop'"),this.cancelStop();const e=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(t)+e,this._stopTime=Math.max(this._stopTime,this.context.currentTime),e>0?"linear"===this._curve?this._gainNode.gain.linearRampTo(0,e,t):this._gainNode.gain.targetRampTo(0,e,t):(this._gainNode.gain.cancelAndHoldAtTime(t),this._gainNode.gain.setValueAtTime(0,t)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout((()=>{const t="exponential"===this._curve?2*e:0;this._stopSource(this.now()+t),this._onended()}),this._stopTime-this.context.currentTime),this}_onended(){if(this.onended!==ms&&(this.onended(this),this.onended=ms,!this.context.isOffline)){const t=()=>this.dispose();void 0!==window.requestIdleCallback?window.requestIdleCallback(t):setTimeout(t,1e3)}}get state(){return this.getStateAtTime(this.now())}cancelStop(){return this.log("cancelStop"),xi(-1!==this._startTime,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}dispose(){return super.dispose(),this._gainNode.disconnect(),this}}class Xs extends Gs{constructor(){super(Qi(Xs.getDefaults(),arguments,["offset"])),this.name="ToneConstantSource",this._source=this.context.createConstantSource();const t=Qi(Xs.getDefaults(),arguments,["offset"]);Zs(this._source,this._gainNode),this.offset=new zs({context:this.context,convert:t.convert,param:this._source.offset,units:t.units,value:t.offset,minValue:t.minValue,maxValue:t.maxValue})}static getDefaults(){return Object.assign(Gs.getDefaults(),{convert:!0,offset:1,units:"number"})}start(t){const e=this.toSeconds(t);return this.log("start",e),this._startGain(e),this._source.start(e),this}_stopSource(t){this._source.stop(t)}dispose(){return super.dispose(),"started"===this.state&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}}class Qs extends Bs{constructor(){super(Qi(Qs.getDefaults(),arguments,["value","units"])),this.name="Signal",this.override=!0;const t=Qi(Qs.getDefaults(),arguments,["value","units"]);this.output=this._constantSource=new Xs({context:this.context,convert:t.convert,offset:t.value,units:t.units,minValue:t.minValue,maxValue:t.maxValue}),this._constantSource.start(0),this.input=this._param=this._constantSource.offset}static getDefaults(){return Object.assign(Bs.getDefaults(),{convert:!0,units:"number",value:0})}connect(t,e=0,n=0){return Hs(this,t,e,n),this}dispose(){return super.dispose(),this._param.dispose(),this._constantSource.dispose(),this}setValueAtTime(t,e){return this._param.setValueAtTime(t,e),this}getValueAtTime(t){return this._param.getValueAtTime(t)}setRampPoint(t){return this._param.setRampPoint(t),this}linearRampToValueAtTime(t,e){return this._param.linearRampToValueAtTime(t,e),this}exponentialRampToValueAtTime(t,e){return this._param.exponentialRampToValueAtTime(t,e),this}exponentialRampTo(t,e,n){return this._param.exponentialRampTo(t,e,n),this}linearRampTo(t,e,n){return this._param.linearRampTo(t,e,n),this}targetRampTo(t,e,n){return this._param.targetRampTo(t,e,n),this}exponentialApproachValueAtTime(t,e,n){return this._param.exponentialApproachValueAtTime(t,e,n),this}setTargetAtTime(t,e,n){return this._param.setTargetAtTime(t,e,n),this}setValueCurveAtTime(t,e,n,i){return this._param.setValueCurveAtTime(t,e,n,i),this}cancelScheduledValues(t){return this._param.cancelScheduledValues(t),this}cancelAndHoldAtTime(t){return this._param.cancelAndHoldAtTime(t),this}rampTo(t,e,n){return this._param.rampTo(t,e,n),this}get value(){return this._param.value}set value(t){this._param.value=t}get convert(){return this._param.convert}set convert(t){this._param.convert=t}get units(){return this._param.units}get overridden(){return this._param.overridden}set overridden(t){this._param.overridden=t}get maxValue(){return this._param.maxValue}get minValue(){return this._param.minValue}apply(t){return this._param.apply(t),this}}function Hs(t,e,n,i){(e instanceof zs||Bi(e)||e instanceof Qs&&e.override)&&(e.cancelScheduledValues(0),e.setValueAtTime(0,0),e instanceof Qs&&(e.overridden=!0)),Zs(t,e,n,i)}class $s extends zs{constructor(){super(Qi($s.getDefaults(),arguments,["value"])),this.name="TickParam",this._events=new rs(1/0),this._multiplier=1;const t=Qi($s.getDefaults(),arguments,["value"]);this._multiplier=t.multiplier,this._events.cancel(0),this._events.add({ticks:0,time:0,type:"setValueAtTime",value:this._fromType(t.value)}),this.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(zs.getDefaults(),{multiplier:1,units:"hertz",value:1})}setTargetAtTime(t,e,n){e=this.toSeconds(e),this.setRampPoint(e);const i=this._fromType(t),s=this._events.get(e),r=Math.round(Math.max(1/n,1));for(let t=0;t<=r;t++){const r=n*t+e,o=this._exponentialApproach(s.time,s.value,i,n,r);this.linearRampToValueAtTime(this._toType(o),r)}return this}setValueAtTime(t,e){const n=this.toSeconds(e);super.setValueAtTime(t,e);const i=this._events.get(n),s=this._events.previousEvent(i),r=this._getTicksUntilEvent(s,n);return i.ticks=Math.max(r,0),this}linearRampToValueAtTime(t,e){const n=this.toSeconds(e);super.linearRampToValueAtTime(t,e);const i=this._events.get(n),s=this._events.previousEvent(i),r=this._getTicksUntilEvent(s,n);return i.ticks=Math.max(r,0),this}exponentialRampToValueAtTime(t,e){e=this.toSeconds(e);const n=this._fromType(t),i=this._events.get(e),s=Math.round(Math.max(10*(e-i.time),1)),r=(e-i.time)/s;for(let t=0;t<=s;t++){const s=r*t+i.time,o=this._exponentialInterpolate(i.time,i.value,e,n,s);this.linearRampToValueAtTime(this._toType(o),s)}return this}_getTicksUntilEvent(t,e){if(null===t)t={ticks:0,time:0,type:"setValueAtTime",value:0};else if(Ci(t.ticks)){const e=this._events.previousEvent(t);t.ticks=this._getTicksUntilEvent(e,t.time)}const n=this._fromType(this.getValueAtTime(t.time));let i=this._fromType(this.getValueAtTime(e));const s=this._events.get(e);return s&&s.time===e&&"setValueAtTime"===s.type&&(i=this._fromType(this.getValueAtTime(e-this.sampleTime))),.5*(e-t.time)*(n+i)+t.ticks}getTicksAtTime(t){const e=this.toSeconds(t),n=this._events.get(e);return Math.max(this._getTicksUntilEvent(n,e),0)}getDurationOfTicks(t,e){const n=this.toSeconds(e),i=this.getTicksAtTime(e);return this.getTimeOfTick(i+t)-n}getTimeOfTick(t){const e=this._events.get(t,"ticks"),n=this._events.getAfter(t,"ticks");if(e&&e.ticks===t)return e.time;if(e&&n&&"linearRampToValueAtTime"===n.type&&e.value!==n.value){const i=this._fromType(this.getValueAtTime(e.time)),s=(this._fromType(this.getValueAtTime(n.time))-i)/(n.time-e.time),r=Math.sqrt(Math.pow(i,2)-2*s*(e.ticks-t)),o=(-i+r)/s,a=(-i-r)/s;return(o>0?o:a)+e.time}return e?0===e.value?1/0:e.time+(t-e.ticks)/e.value:t/this._initialValue}ticksToTime(t,e){return this.getDurationOfTicks(t,e)}timeToTicks(t,e){const n=this.toSeconds(e),i=this.toSeconds(t),s=this.getTicksAtTime(n);return this.getTicksAtTime(n+i)-s}_fromType(t){return"bpm"===this.units&&this.multiplier?1/(60/t/this.multiplier):super._fromType(t)}_toType(t){return"bpm"===this.units&&this.multiplier?t/this.multiplier*60:super._toType(t)}get multiplier(){return this._multiplier}set multiplier(t){const e=this.value;this._multiplier=t,this.cancelScheduledValues(0),this.setValueAtTime(e,0)}}class Ks extends Qs{constructor(){super(Qi(Ks.getDefaults(),arguments,["value"])),this.name="TickSignal";const t=Qi(Ks.getDefaults(),arguments,["value"]);this.input=this._param=new $s({context:this.context,convert:t.convert,multiplier:t.multiplier,param:this._constantSource.offset,units:t.units,value:t.value})}static getDefaults(){return Object.assign(Qs.getDefaults(),{multiplier:1,units:"hertz",value:1})}ticksToTime(t,e){return this._param.ticksToTime(t,e)}timeToTicks(t,e){return this._param.timeToTicks(t,e)}getTimeOfTick(t){return this._param.getTimeOfTick(t)}getDurationOfTicks(t,e){return this._param.getDurationOfTicks(t,e)}getTicksAtTime(t){return this._param.getTicksAtTime(t)}get multiplier(){return this._param.multiplier}set multiplier(t){this._param.multiplier=t}dispose(){return super.dispose(),this._param.dispose(),this}}class Js extends Fs{constructor(){super(Qi(Js.getDefaults(),arguments,["frequency"])),this.name="TickSource",this._state=new Ls,this._tickOffset=new rs;const t=Qi(Js.getDefaults(),arguments,["frequency"]);this.frequency=new Ks({context:this.context,units:t.units,value:t.frequency}),ds(this,"frequency"),this._state.setStateAtTime("stopped",0),this.setTicksAtTime(0,0)}static getDefaults(){return Object.assign({frequency:1,units:"hertz"},Fs.getDefaults())}get state(){return this.getStateAtTime(this.now())}start(t,e){const n=this.toSeconds(t);return"started"!==this._state.getValueAtTime(n)&&(this._state.setStateAtTime("started",n),Ai(e)&&this.setTicksAtTime(e,n)),this}stop(t){const e=this.toSeconds(t);if("stopped"===this._state.getValueAtTime(e)){const t=this._state.get(e);t&&t.time>0&&(this._tickOffset.cancel(t.time),this._state.cancel(t.time))}return this._state.cancel(e),this._state.setStateAtTime("stopped",e),this.setTicksAtTime(0,e),this}pause(t){const e=this.toSeconds(t);return"started"===this._state.getValueAtTime(e)&&this._state.setStateAtTime("paused",e),this}cancel(t){return t=this.toSeconds(t),this._state.cancel(t),this._tickOffset.cancel(t),this}getTicksAtTime(t){const e=this.toSeconds(t),n=this._state.getLastState("stopped",e),i={state:"paused",time:e};this._state.add(i);let s=n,r=0;return this._state.forEachBetween(n.time,e+this.sampleTime,(t=>{let e=s.time;const n=this._tickOffset.get(t.time);n&&n.time>=s.time&&(r=n.ticks,e=n.time),"started"===s.state&&"started"!==t.state&&(r+=this.frequency.getTicksAtTime(t.time)-this.frequency.getTicksAtTime(e)),s=t})),this._state.remove(i),r}get ticks(){return this.getTicksAtTime(this.now())}set ticks(t){this.setTicksAtTime(t,this.now())}get seconds(){return this.getSecondsAtTime(this.now())}set seconds(t){const e=this.now(),n=this.frequency.timeToTicks(t,e);this.setTicksAtTime(n,e)}getSecondsAtTime(t){t=this.toSeconds(t);const e=this._state.getLastState("stopped",t),n={state:"paused",time:t};this._state.add(n);let i=e,s=0;return this._state.forEachBetween(e.time,t+this.sampleTime,(t=>{let e=i.time;const n=this._tickOffset.get(t.time);n&&n.time>=i.time&&(s=n.seconds,e=n.time),"started"===i.state&&"started"!==t.state&&(s+=t.time-e),i=t})),this._state.remove(n),s}setTicksAtTime(t,e){return e=this.toSeconds(e),this._tickOffset.cancel(e),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(t,e),ticks:t,time:e}),this}getStateAtTime(t){return t=this.toSeconds(t),this._state.getValueAtTime(t)}getTimeOfTick(t,e=this.now()){const n=this._tickOffset.get(e),i=this._state.get(e),s=Math.max(n.time,i.time),r=this.frequency.getTicksAtTime(s)+t-n.ticks;return this.frequency.getTimeOfTick(r)}forEachTickBetween(t,e,n){let i=this._state.get(t);this._state.forEachBetween(t,e,(e=>{i&&"started"===i.state&&"started"!==e.state&&this.forEachTickBetween(Math.max(i.time,t),e.time-this.sampleTime,n),i=e}));let s=null;if(i&&"started"===i.state){const r=Math.max(i.time,t),o=this.frequency.getTicksAtTime(r),a=o-this.frequency.getTicksAtTime(i.time);let c=Math.ceil(a)-a;c=is(c,1)?0:c;let u=this.frequency.getTimeOfTick(o+c);for(;u<e;){try{n(u,Math.round(this.getTicksAtTime(u)))}catch(t){s=t;break}u+=this.frequency.getDurationOfTicks(1,u)}}if(s)throw s;return this}dispose(){return super.dispose(),this._state.dispose(),this._tickOffset.dispose(),this.frequency.dispose(),this}}class tr extends Fs{constructor(){super(Qi(tr.getDefaults(),arguments,["callback","frequency"])),this.name="Clock",this.callback=ms,this._lastUpdate=0,this._state=new Ls("stopped"),this._boundLoop=this._loop.bind(this);const t=Qi(tr.getDefaults(),arguments,["callback","frequency"]);this.callback=t.callback,this._tickSource=new Js({context:this.context,frequency:t.frequency,units:t.units}),this._lastUpdate=0,this.frequency=this._tickSource.frequency,ds(this,"frequency"),this._state.setStateAtTime("stopped",0),this.context.on("tick",this._boundLoop)}static getDefaults(){return Object.assign(Fs.getDefaults(),{callback:ms,frequency:1,units:"hertz"})}get state(){return this._state.getValueAtTime(this.now())}start(t,e){Ti(this.context);const n=this.toSeconds(t);return this.log("start",n),"started"!==this._state.getValueAtTime(n)&&(this._state.setStateAtTime("started",n),this._tickSource.start(n,e),n<this._lastUpdate&&this.emit("start",n,e)),this}stop(t){const e=this.toSeconds(t);return this.log("stop",e),this._state.cancel(e),this._state.setStateAtTime("stopped",e),this._tickSource.stop(e),e<this._lastUpdate&&this.emit("stop",e),this}pause(t){const e=this.toSeconds(t);return"started"===this._state.getValueAtTime(e)&&(this._state.setStateAtTime("paused",e),this._tickSource.pause(e),e<this._lastUpdate&&this.emit("pause",e)),this}get ticks(){return Math.ceil(this.getTicksAtTime(this.now()))}set ticks(t){this._tickSource.ticks=t}get seconds(){return this._tickSource.seconds}set seconds(t){this._tickSource.seconds=t}getSecondsAtTime(t){return this._tickSource.getSecondsAtTime(t)}setTicksAtTime(t,e){return this._tickSource.setTicksAtTime(t,e),this}getTimeOfTick(t,e=this.now()){return this._tickSource.getTimeOfTick(t,e)}getTicksAtTime(t){return this._tickSource.getTicksAtTime(t)}nextTickTime(t,e){const n=this.toSeconds(e),i=this.getTicksAtTime(n);return this._tickSource.getTimeOfTick(i+t,n)}_loop(){const t=this._lastUpdate,e=this.now();this._lastUpdate=e,this.log("loop",t,e),t!==e&&(this._state.forEachBetween(t,e,(t=>{switch(t.state){case"started":const e=this._tickSource.getTicksAtTime(t.time);this.emit("start",t.time,e);break;case"stopped":0!==t.time&&this.emit("stop",t.time);break;case"paused":this.emit("pause",t.time)}})),this._tickSource.forEachTickBetween(t,e,((t,e)=>{this.callback(t,e)})))}getStateAtTime(t){const e=this.toSeconds(t);return this._state.getValueAtTime(e)}dispose(){return super.dispose(),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}}ls.mixin(tr);class er extends Bs{constructor(){super(Qi(er.getDefaults(),arguments,["delayTime","maxDelay"])),this.name="Delay";const t=Qi(er.getDefaults(),arguments,["delayTime","maxDelay"]),e=this.toSeconds(t.maxDelay);this._maxDelay=Math.max(e,this.toSeconds(t.delayTime)),this._delayNode=this.input=this.output=this.context.createDelay(e),this.delayTime=new zs({context:this.context,param:this._delayNode.delayTime,units:"time",value:t.delayTime,minValue:0,maxValue:this.maxDelay}),ds(this,"delayTime")}static getDefaults(){return Object.assign(Bs.getDefaults(),{delayTime:0,maxDelay:1})}get maxDelay(){return this._maxDelay}dispose(){return super.dispose(),this._delayNode.disconnect(),this.delayTime.dispose(),this}}function nr(t,e,n=2,i=bs().sampleRate){return Li(this,void 0,void 0,(function*(){const s=bs(),r=new gs(n,e,i);xs(r),yield t(r);const o=r.render();xs(s);const a=yield o;return new vs(a)}))}class ir extends Ki{constructor(){super(),this.name="ToneAudioBuffers",this._buffers=new Map,this._loadingCount=0;const t=Qi(ir.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");this.baseUrl=t.baseUrl,Object.keys(t.urls).forEach((e=>{this._loadingCount++;const n=t.urls[e];this.add(e,n,this._bufferLoaded.bind(this,t.onload),t.onerror)}))}static getDefaults(){return{baseUrl:"",onerror:ms,onload:ms,urls:{}}}has(t){return this._buffers.has(t.toString())}get(t){return xi(this.has(t),`ToneAudioBuffers has no buffer named: ${t}`),this._buffers.get(t.toString())}_bufferLoaded(t){this._loadingCount--,0===this._loadingCount&&t&&t()}get loaded(){return Array.from(this._buffers).every((([t,e])=>e.loaded))}add(t,e,n=ms,i=ms){return ji(e)?this._buffers.set(t.toString(),new vs(this.baseUrl+e,n,i)):this._buffers.set(t.toString(),new vs(e,n,i)),this}dispose(){return super.dispose(),this._buffers.forEach((t=>t.dispose())),this._buffers.clear(),this}}class sr extends Ps{constructor(){super(...arguments),this.name="MidiClass",this.defaultUnits="midi"}_frequencyToUnits(t){return Es(super._frequencyToUnits(t))}_ticksToUnits(t){return Es(super._ticksToUnits(t))}_beatsToUnits(t){return Es(super._beatsToUnits(t))}_secondsToUnits(t){return Es(super._secondsToUnits(t))}toMidi(){return this.valueOf()}toFrequency(){return As(this.toMidi())}transpose(t){return new sr(this.context,this.toMidi()+t)}}function rr(t,e){return new sr(bs(),t,e)}class or extends Ns{constructor(){super(...arguments),this.name="Ticks",this.defaultUnits="i"}_now(){return this.context.transport.ticks}_beatsToUnits(t){return this._getPPQ()*t}_secondsToUnits(t){return Math.floor(t/(60/this._getBpm())*this._getPPQ())}_ticksToUnits(t){return t}toTicks(){return this.valueOf()}toSeconds(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}}function ar(t,e){return new or(bs(),t,e)}class cr extends Fs{constructor(){super(...arguments),this.name="Draw",this.expiration=.25,this.anticipation=.008,this._events=new rs,this._boundDrawLoop=this._drawLoop.bind(this),this._animationFrame=-1}schedule(t,e){return this._events.add({callback:t,time:this.toSeconds(e)}),1===this._events.length&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this}cancel(t){return this._events.cancel(this.toSeconds(t)),this}_drawLoop(){const t=this.context.currentTime;for(;this._events.length&&this._events.peek().time-this.anticipation<=t;){const e=this._events.shift();e&&t-e.time<=this.expiration&&e.callback()}this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))}dispose(){return super.dispose(),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}}as((t=>{t.draw=new cr({context:t})})),us((t=>{t.draw.dispose()}));class ur extends Ki{constructor(){super(...arguments),this.name="IntervalTimeline",this._root=null,this._length=0}add(t){xi(Ai(t.time),"Events must have a time property"),xi(Ai(t.duration),"Events must have a duration parameter"),t.time=t.time.valueOf();let e=new lr(t.time,t.time+t.duration,t);for(null===this._root?this._root=e:this._root.insert(e),this._length++;null!==e;)e.updateHeight(),e.updateMax(),this._rebalance(e),e=e.parent;return this}remove(t){if(null!==this._root){const e=[];this._root.search(t.time,e);for(const n of e)if(n.event===t){this._removeNode(n),this._length--;break}}return this}get length(){return this._length}cancel(t){return this.forEachFrom(t,(t=>this.remove(t))),this}_setRoot(t){this._root=t,null!==this._root&&(this._root.parent=null)}_replaceNodeInParent(t,e){null!==t.parent?(t.isLeftChild()?t.parent.left=e:t.parent.right=e,this._rebalance(t.parent)):this._setRoot(e)}_removeNode(t){if(null===t.left&&null===t.right)this._replaceNodeInParent(t,null);else if(null===t.right)this._replaceNodeInParent(t,t.left);else if(null===t.left)this._replaceNodeInParent(t,t.right);else{let e,n=null;if(t.getBalance()>0)if(null===t.left.right)e=t.left,e.right=t.right,n=e;else{for(e=t.left.right;null!==e.right;)e=e.right;e.parent&&(e.parent.right=e.left,n=e.parent,e.left=t.left,e.right=t.right)}else if(null===t.right.left)e=t.right,e.left=t.left,n=e;else{for(e=t.right.left;null!==e.left;)e=e.left;e.parent&&(e.parent.left=e.right,n=e.parent,e.left=t.left,e.right=t.right)}null!==t.parent?t.isLeftChild()?t.parent.left=e:t.parent.right=e:this._setRoot(e),n&&this._rebalance(n)}t.dispose()}_rotateLeft(t){const e=t.parent,n=t.isLeftChild(),i=t.right;i&&(t.right=i.left,i.left=t),null!==e?n?e.left=i:e.right=i:this._setRoot(i)}_rotateRight(t){const e=t.parent,n=t.isLeftChild(),i=t.left;i&&(t.left=i.right,i.right=t),null!==e?n?e.left=i:e.right=i:this._setRoot(i)}_rebalance(t){const e=t.getBalance();e>1&&t.left?t.left.getBalance()<0?this._rotateLeft(t.left):this._rotateRight(t):e<-1&&t.right&&(t.right.getBalance()>0?this._rotateRight(t.right):this._rotateLeft(t))}get(t){if(null!==this._root){const e=[];if(this._root.search(t,e),e.length>0){let t=e[0];for(let n=1;n<e.length;n++)e[n].low>t.low&&(t=e[n]);return t.event}}return null}forEach(t){if(null!==this._root){const e=[];this._root.traverse((t=>e.push(t))),e.forEach((e=>{e.event&&t(e.event)}))}return this}forEachAtTime(t,e){if(null!==this._root){const n=[];this._root.search(t,n),n.forEach((t=>{t.event&&e(t.event)}))}return this}forEachFrom(t,e){if(null!==this._root){const n=[];this._root.searchAfter(t,n),n.forEach((t=>{t.event&&e(t.event)}))}return this}dispose(){return super.dispose(),null!==this._root&&this._root.traverse((t=>t.dispose())),this._root=null,this}}class lr{constructor(t,e,n){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=n,this.low=t,this.high=e,this.max=this.high}insert(t){t.low<=this.low?null===this.left?this.left=t:this.left.insert(t):null===this.right?this.right=t:this.right.insert(t)}search(t,e){t>this.max||(null!==this.left&&this.left.search(t,e),this.low<=t&&this.high>t&&e.push(this),this.low>t||null!==this.right&&this.right.search(t,e))}searchAfter(t,e){this.low>=t&&(e.push(this),null!==this.left&&this.left.searchAfter(t,e)),null!==this.right&&this.right.searchAfter(t,e)}traverse(t){t(this),null!==this.left&&this.left.traverse(t),null!==this.right&&this.right.traverse(t)}updateHeight(){null!==this.left&&null!==this.right?this.height=Math.max(this.left.height,this.right.height)+1:null!==this.right?this.height=this.right.height+1:null!==this.left?this.height=this.left.height+1:this.height=0}updateMax(){this.max=this.high,null!==this.left&&(this.max=Math.max(this.max,this.left.max)),null!==this.right&&(this.max=Math.max(this.max,this.right.max))}getBalance(){let t=0;return null!==this.left&&null!==this.right?t=this.left.height-this.right.height:null!==this.left?t=this.left.height+1:null!==this.right&&(t=-(this.right.height+1)),t}isLeftChild(){return null!==this.parent&&this.parent.left===this}get left(){return this._left}set left(t){this._left=t,null!==t&&(t.parent=this),this.updateHeight(),this.updateMax()}get right(){return this._right}set right(t){this._right=t,null!==t&&(t.parent=this),this.updateHeight(),this.updateMax()}dispose(){this.parent=null,this._left=null,this._right=null,this.event=null}}class hr extends Bs{constructor(){super(Qi(hr.getDefaults(),arguments,["volume"])),this.name="Volume";const t=Qi(hr.getDefaults(),arguments,["volume"]);this.input=this.output=new Ys({context:this.context,gain:t.volume,units:"decibels"}),this.volume=this.output.gain,ds(this,"volume"),this._unmutedVolume=t.volume,this.mute=t.mute}static getDefaults(){return Object.assign(Bs.getDefaults(),{mute:!1,volume:0})}get mute(){return this.volume.value===-1/0}set mute(t){!this.mute&&t?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!t&&(this.volume.value=this._unmutedVolume)}dispose(){return super.dispose(),this.input.dispose(),this.volume.dispose(),this}}class pr extends Bs{constructor(){super(Qi(pr.getDefaults(),arguments)),this.name="Destination",this.input=new hr({context:this.context}),this.output=new Ys({context:this.context}),this.volume=this.input.volume;const t=Qi(pr.getDefaults(),arguments);Ws(this.input,this.output,this.context.rawContext.destination),this.mute=t.mute,this._internalChannels=[this.input,this.context.rawContext.destination,this.output]}static getDefaults(){return Object.assign(Bs.getDefaults(),{mute:!1,volume:0})}get mute(){return this.input.mute}set mute(t){this.input.mute=t}chain(...t){return this.input.disconnect(),t.unshift(this.input),t.push(this.output),Ws(...t),this}get maxChannelCount(){return this.context.rawContext.destination.maxChannelCount}dispose(){return super.dispose(),this.volume.dispose(),this}}as((t=>{t.destination=new pr({context:t})})),us((t=>{t.destination.dispose()}));class dr extends Ki{constructor(t){super(),this.name="TimelineValue",this._timeline=new rs({memory:10}),this._initialValue=t}set(t,e){return this._timeline.add({value:t,time:e}),this}get(t){const e=this._timeline.get(t);return e?e.value:this._initialValue}}class fr{constructor(t,e){this.id=fr._eventId++;const n=Object.assign(fr.getDefaults(),e);this.transport=t,this.callback=n.callback,this._once=n.once,this.time=n.time}static getDefaults(){return{callback:ms,once:!1,time:0}}invoke(t){this.callback&&(this.callback(t),this._once&&this.transport.clear(this.id))}dispose(){return this.callback=void 0,this}}fr._eventId=0;class mr extends fr{constructor(t,e){super(t,e),this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this);const n=Object.assign(mr.getDefaults(),e);this.duration=new or(t.context,n.duration).valueOf(),this._interval=new or(t.context,n.interval).valueOf(),this._nextTick=n.time,this.transport.on("start",this._boundRestart),this.transport.on("loopStart",this._boundRestart),this.context=this.transport.context,this._restart()}static getDefaults(){return Object.assign({},fr.getDefaults(),{duration:1/0,interval:1,once:!1})}invoke(t){this._createEvents(t),super.invoke(t)}_createEvents(t){const e=this.transport.getTicksAtTime(t);e>=this.time&&e>=this._nextTick&&this._nextTick+this._interval<this.time+this.duration&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new or(this.context,this._nextTick).toSeconds()))}_restart(t){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.time;const e=this.transport.getTicksAtTime(t);e>this.time&&(this._nextTick=this.time+Math.ceil((e-this.time)/this._interval)*this._interval),this._currentId=this.transport.scheduleOnce(this.invoke.bind(this),new or(this.context,this._nextTick).toSeconds()),this._nextTick+=this._interval,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new or(this.context,this._nextTick).toSeconds())}dispose(){return super.dispose(),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this}}class vr extends Fs{constructor(){super(Qi(vr.getDefaults(),arguments)),this.name="Transport",this._loop=new dr(!1),this._loopStart=0,this._loopEnd=0,this._scheduledEvents={},this._timeline=new rs,this._repeatedEvents=new ur,this._syncedSignals=[],this._swingAmount=0;const t=Qi(vr.getDefaults(),arguments);this._ppq=t.ppq,this._clock=new tr({callback:this._processTick.bind(this),context:this.context,frequency:0,units:"bpm"}),this._bindClockEvents(),this.bpm=this._clock.frequency,this._clock.frequency.multiplier=t.ppq,this.bpm.setValueAtTime(t.bpm,0),ds(this,"bpm"),this._timeSignature=t.timeSignature,this._swingTicks=t.ppq/2}static getDefaults(){return Object.assign(Fs.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}_processTick(t,e){if(this._loop.get(t)&&e>=this._loopEnd&&(this.emit("loopEnd",t),this._clock.setTicksAtTime(this._loopStart,t),e=this._loopStart,this.emit("loopStart",t,this._clock.getSecondsAtTime(t)),this.emit("loop",t)),this._swingAmount>0&&e%this._ppq!=0&&e%(2*this._swingTicks)!=0){const n=e%(2*this._swingTicks)/(2*this._swingTicks),i=Math.sin(n*Math.PI)*this._swingAmount;t+=new or(this.context,2*this._swingTicks/3).toSeconds()*i}this._timeline.forEachAtTime(e,(e=>e.invoke(t)))}schedule(t,e){const n=new fr(this,{callback:t,time:new Ns(this.context,e).toTicks()});return this._addEvent(n,this._timeline)}scheduleRepeat(t,e,n,i=1/0){const s=new mr(this,{callback:t,duration:new Ms(this.context,i).toTicks(),interval:new Ms(this.context,e).toTicks(),time:new Ns(this.context,n).toTicks()});return this._addEvent(s,this._repeatedEvents)}scheduleOnce(t,e){const n=new fr(this,{callback:t,once:!0,time:new Ns(this.context,e).toTicks()});return this._addEvent(n,this._timeline)}clear(t){if(this._scheduledEvents.hasOwnProperty(t)){const e=this._scheduledEvents[t.toString()];e.timeline.remove(e.event),e.event.dispose(),delete this._scheduledEvents[t.toString()]}return this}_addEvent(t,e){return this._scheduledEvents[t.id.toString()]={event:t,timeline:e},e.add(t),t.id}cancel(t=0){const e=this.toTicks(t);return this._timeline.forEachFrom(e,(t=>this.clear(t.id))),this._repeatedEvents.forEachFrom(e,(t=>this.clear(t.id))),this}_bindClockEvents(){this._clock.on("start",((t,e)=>{e=new or(this.context,e).toSeconds(),this.emit("start",t,e)})),this._clock.on("stop",(t=>{this.emit("stop",t)})),this._clock.on("pause",(t=>{this.emit("pause",t)}))}get state(){return this._clock.getStateAtTime(this.now())}start(t,e){let n;return Ai(e)&&(n=this.toTicks(e)),this._clock.start(t,n),this}stop(t){return this._clock.stop(t),this}pause(t){return this._clock.pause(t),this}toggle(t){return t=this.toSeconds(t),"started"!==this._clock.getStateAtTime(t)?this.start(t):this.stop(t),this}get timeSignature(){return this._timeSignature}set timeSignature(t){Ri(t)&&(t=t[0]/t[1]*4),this._timeSignature=t}get loopStart(){return new Ms(this.context,this._loopStart,"i").toSeconds()}set loopStart(t){this._loopStart=this.toTicks(t)}get loopEnd(){return new Ms(this.context,this._loopEnd,"i").toSeconds()}set loopEnd(t){this._loopEnd=this.toTicks(t)}get loop(){return this._loop.get(this.now())}set loop(t){this._loop.set(t,this.now())}setLoopPoints(t,e){return this.loopStart=t,this.loopEnd=e,this}get swing(){return this._swingAmount}set swing(t){this._swingAmount=t}get swingSubdivision(){return new or(this.context,this._swingTicks).toNotation()}set swingSubdivision(t){this._swingTicks=this.toTicks(t)}get position(){const t=this.now(),e=this._clock.getTicksAtTime(t);return new or(this.context,e).toBarsBeatsSixteenths()}set position(t){const e=this.toTicks(t);this.ticks=e}get seconds(){return this._clock.seconds}set seconds(t){const e=this.now(),n=this._clock.frequency.timeToTicks(t,e);this.ticks=n}get progress(){if(this.loop){const t=this.now();return(this._clock.getTicksAtTime(t)-this._loopStart)/(this._loopEnd-this._loopStart)}return 0}get ticks(){return this._clock.ticks}set ticks(t){if(this._clock.ticks!==t){const e=this.now();if("started"===this.state){const n=this._clock.getTicksAtTime(e),i=e+this._clock.frequency.getDurationOfTicks(Math.ceil(n)-n,e);this.emit("stop",i),this._clock.setTicksAtTime(t,i),this.emit("start",i,this._clock.getSecondsAtTime(i))}else this._clock.setTicksAtTime(t,e)}}getTicksAtTime(t){return Math.round(this._clock.getTicksAtTime(t))}getSecondsAtTime(t){return this._clock.getSecondsAtTime(t)}get PPQ(){return this._clock.frequency.multiplier}set PPQ(t){this._clock.frequency.multiplier=t}nextSubdivision(t){if(t=this.toTicks(t),"started"!==this.state)return 0;{const e=this.now(),n=t-this.getTicksAtTime(e)%t;return this._clock.nextTickTime(n,e)}}syncSignal(t,e){if(!e){const n=this.now();if(0!==t.getValueAtTime(n)){const i=1/(60/this.bpm.getValueAtTime(n)/this.PPQ);e=t.getValueAtTime(n)/i}else e=0}const n=new Ys(e);return this.bpm.connect(n),n.connect(t._param),this._syncedSignals.push({initial:t.value,ratio:n,signal:t}),t.value=0,this}unsyncSignal(t){for(let e=this._syncedSignals.length-1;e>=0;e--){const n=this._syncedSignals[e];n.signal===t&&(n.ratio.dispose(),n.signal.value=n.initial,this._syncedSignals.splice(e,1))}return this}dispose(){return super.dispose(),this._clock.dispose(),fs(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}}ls.mixin(vr),as((t=>{t.transport=new vr({context:t})})),us((t=>{t.transport.dispose()}));class gr extends Bs{constructor(t){super(t),this.input=void 0,this._state=new Ls("stopped"),this._synced=!1,this._scheduled=[],this._syncedStart=ms,this._syncedStop=ms,this._state.memory=100,this._state.increasing=!0,this._volume=this.output=new hr({context:this.context,mute:t.mute,volume:t.volume}),this.volume=this._volume.volume,ds(this,"volume"),this.onstop=t.onstop}static getDefaults(){return Object.assign(Bs.getDefaults(),{mute:!1,onstop:ms,volume:0})}get state(){return this._synced?"started"===this.context.transport.state?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}_clampToCurrentTime(t){return this._synced?t:Math.max(t,this.context.currentTime)}start(t,e,n){let i=Ci(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(i=this._clampToCurrentTime(i),this._synced||"started"!==this._state.getValueAtTime(i))if(this.log("start",i),this._state.setStateAtTime("started",i),this._synced){const t=this._state.get(i);t&&(t.offset=this.toSeconds(Hi(e,0)),t.duration=n?this.toSeconds(n):void 0);const s=this.context.transport.schedule((t=>{this._start(t,e,n)}),i);this._scheduled.push(s),"started"===this.context.transport.state&&this.context.transport.getSecondsAtTime(this.immediate())>i&&this._syncedStart(this.now(),this.context.transport.seconds)}else Ti(this.context),this._start(i,e,n);else xi(ts(i,this._state.get(i).time),"Start time must be strictly greater than previous start time"),this._state.cancel(i),this._state.setStateAtTime("started",i),this.log("restart",i),this.restart(i,e,n);return this}stop(t){let e=Ci(t)&&this._synced?this.context.transport.seconds:this.toSeconds(t);if(e=this._clampToCurrentTime(e),"started"===this._state.getValueAtTime(e)||Ai(this._state.getNextState("started",e))){if(this.log("stop",e),this._synced){const t=this.context.transport.schedule(this._stop.bind(this),e);this._scheduled.push(t)}else this._stop(e);this._state.cancel(e),this._state.setStateAtTime("stopped",e)}return this}restart(t,e,n){return t=this.toSeconds(t),"started"===this._state.getValueAtTime(t)&&(this._state.cancel(t),this._restart(t,e,n)),this}sync(){return this._synced||(this._synced=!0,this._syncedStart=(t,e)=>{if(e>0){const n=this._state.get(e);if(n&&"started"===n.state&&n.time!==e){const i=e-this.toSeconds(n.time);let s;n.duration&&(s=this.toSeconds(n.duration)-i),this._start(t,this.toSeconds(n.offset)+i,s)}}},this._syncedStop=t=>{const e=this.context.transport.getSecondsAtTime(Math.max(t-this.sampleTime,0));"started"===this._state.getValueAtTime(e)&&this._stop(t)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}unsync(){return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach((t=>this.context.transport.clear(t))),this._scheduled=[],this._state.cancel(0),this._stop(0),this}dispose(){return super.dispose(),this.onstop=ms,this.unsync(),this._volume.dispose(),this._state.dispose(),this}}class yr extends Gs{constructor(){super(Qi(yr.getDefaults(),arguments,["url","onload"])),this.name="ToneBufferSource",this._source=this.context.createBufferSource(),this._internalChannels=[this._source],this._sourceStarted=!1,this._sourceStopped=!1;const t=Qi(yr.getDefaults(),arguments,["url","onload"]);Zs(this._source,this._gainNode),this._source.onended=()=>this._stopSource(),this.playbackRate=new zs({context:this.context,param:this._source.playbackRate,units:"positive",value:t.playbackRate}),this.loop=t.loop,this.loopStart=t.loopStart,this.loopEnd=t.loopEnd,this._buffer=new vs(t.url,t.onload,t.onerror),this._internalChannels.push(this._source)}static getDefaults(){return Object.assign(Gs.getDefaults(),{url:new vs,loop:!1,loopEnd:0,loopStart:0,onload:ms,onerror:ms,playbackRate:1})}get fadeIn(){return this._fadeIn}set fadeIn(t){this._fadeIn=t}get fadeOut(){return this._fadeOut}set fadeOut(t){this._fadeOut=t}get curve(){return this._curve}set curve(t){this._curve=t}start(t,e,n,i=1){xi(this.buffer.loaded,"buffer is either not set or not loaded");const s=this.toSeconds(t);this._startGain(s,i),e=this.loop?Hi(e,this.loopStart):Hi(e,0);let r=Math.max(this.toSeconds(e),0);if(this.loop){const t=this.toSeconds(this.loopEnd)||this.buffer.duration,e=this.toSeconds(this.loopStart),n=t-e;es(r,t)&&(r=(r-e)%n+e),is(r,this.buffer.duration)&&(r=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,ns(r,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(s,r)),Ai(n)){let t=this.toSeconds(n);t=Math.max(t,0),this.stop(s+t)}return this}_stopSource(t){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(t)),this._onended())}get loopStart(){return this._source.loopStart}set loopStart(t){this._source.loopStart=this.toSeconds(t)}get loopEnd(){return this._source.loopEnd}set loopEnd(t){this._source.loopEnd=this.toSeconds(t)}get buffer(){return this._buffer}set buffer(t){this._buffer.set(t)}get loop(){return this._source.loop}set loop(t){this._source.loop=t,this._sourceStarted&&this.cancelStop()}dispose(){return super.dispose(),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}}class _r extends gr{constructor(){super(Qi(_r.getDefaults(),arguments,["type"])),this.name="Noise",this._source=null;const t=Qi(_r.getDefaults(),arguments,["type"]);this._playbackRate=t.playbackRate,this.type=t.type,this._fadeIn=t.fadeIn,this._fadeOut=t.fadeOut}static getDefaults(){return Object.assign(gr.getDefaults(),{fadeIn:0,fadeOut:0,playbackRate:1,type:"white"})}get type(){return this._type}set type(t){if(xi(t in wr,"Noise: invalid type: "+t),this._type!==t&&(this._type=t,"started"===this.state)){const t=this.now();this._stop(t),this._start(t)}}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this._source&&(this._source.playbackRate.value=t)}_start(t){const e=wr[this._type];this._source=new yr({url:e,context:this.context,fadeIn:this._fadeIn,fadeOut:this._fadeOut,loop:!0,onended:()=>this.onstop(this),playbackRate:this._playbackRate}).connect(this.output),this._source.start(this.toSeconds(t),Math.random()*(e.duration-.001))}_stop(t){this._source&&(this._source.stop(this.toSeconds(t)),this._source=null)}get fadeIn(){return this._fadeIn}set fadeIn(t){this._fadeIn=t,this._source&&(this._source.fadeIn=this._fadeIn)}get fadeOut(){return this._fadeOut}set fadeOut(t){this._fadeOut=t,this._source&&(this._source.fadeOut=this._fadeOut)}_restart(t){this._stop(t),this._start(t)}dispose(){return super.dispose(),this._source&&this._source.disconnect(),this}}const br=220500,xr={brown:null,pink:null,white:null},wr={get brown(){if(!xr.brown){const t=[];for(let e=0;e<2;e++){const n=new Float32Array(br);t[e]=n;let i=0;for(let t=0;t<br;t++){const e=2*Math.random()-1;n[t]=(i+.02*e)/1.02,i=n[t],n[t]*=3.5}}xr.brown=(new vs).fromArray(t)}return xr.brown},get pink(){if(!xr.pink){const t=[];for(let e=0;e<2;e++){const n=new Float32Array(br);let i,s,r,o,a,c,u;t[e]=n,i=s=r=o=a=c=u=0;for(let t=0;t<br;t++){const e=2*Math.random()-1;i=.99886*i+.0555179*e,s=.99332*s+.0750759*e,r=.969*r+.153852*e,o=.8665*o+.3104856*e,a=.55*a+.5329522*e,c=-.7616*c-.016898*e,n[t]=i+s+r+o+a+c+u+.5362*e,n[t]*=.11,u=.115926*e}}xr.pink=(new vs).fromArray(t)}return xr.pink},get white(){if(!xr.white){const t=[];for(let e=0;e<2;e++){const n=new Float32Array(br);t[e]=n;for(let t=0;t<br;t++)n[t]=2*Math.random()-1}xr.white=(new vs).fromArray(t)}return xr.white}};class Tr extends Bs{constructor(){super(Qi(Tr.getDefaults(),arguments,["volume"])),this.name="UserMedia";const t=Qi(Tr.getDefaults(),arguments,["volume"]);this._volume=this.output=new hr({context:this.context,volume:t.volume}),this.volume=this._volume.volume,ds(this,"volume"),this.mute=t.mute}static getDefaults(){return Object.assign(Bs.getDefaults(),{mute:!1,volume:0})}open(t){return Li(this,void 0,void 0,(function*(){xi(Tr.supported,"UserMedia is not supported"),"started"===this.state&&this.close();const e=yield Tr.enumerateDevices();Mi(t)?this._device=e[t]:(this._device=e.find((e=>e.label===t||e.deviceId===t)),!this._device&&e.length>0&&(this._device=e[0]),xi(Ai(this._device),`No matching device ${t}`));const n={audio:{echoCancellation:!1,sampleRate:this.context.sampleRate,noiseSuppression:!1,mozNoiseSuppression:!1}};this._device&&(n.audio.deviceId=this._device.deviceId);const i=yield navigator.mediaDevices.getUserMedia(n);if(!this._stream){this._stream=i;const t=this.context.createMediaStreamSource(i);Zs(t,this.output),this._mediaStream=t}return this}))}close(){return this._stream&&this._mediaStream&&(this._stream.getAudioTracks().forEach((t=>{t.stop()})),this._stream=void 0,this._mediaStream.disconnect(),this._mediaStream=void 0),this._device=void 0,this}static enumerateDevices(){return Li(this,void 0,void 0,(function*(){return(yield navigator.mediaDevices.enumerateDevices()).filter((t=>"audioinput"===t.kind))}))}get state(){return this._stream&&this._stream.active?"started":"stopped"}get deviceId(){return this._device?this._device.deviceId:void 0}get groupId(){return this._device?this._device.groupId:void 0}get label(){return this._device?this._device.label:void 0}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}dispose(){return super.dispose(),this.close(),this._volume.dispose(),this.volume.dispose(),this}static get supported(){return Ai(navigator.mediaDevices)&&Ai(navigator.mediaDevices.getUserMedia)}}function Sr(t,e){return Li(this,void 0,void 0,(function*(){const n=e/t.context.sampleRate,i=new gs(1,n,t.context.sampleRate);return new t.constructor(Object.assign(t.get(),{frequency:2/n,detune:0,context:i})).toDestination().start(0),(yield i.render()).getChannelData(0)}))}class kr extends Gs{constructor(){super(Qi(kr.getDefaults(),arguments,["frequency","type"])),this.name="ToneOscillatorNode",this._oscillator=this.context.createOscillator(),this._internalChannels=[this._oscillator];const t=Qi(kr.getDefaults(),arguments,["frequency","type"]);Zs(this._oscillator,this._gainNode),this.type=t.type,this.frequency=new zs({context:this.context,param:this._oscillator.frequency,units:"frequency",value:t.frequency}),this.detune=new zs({context:this.context,param:this._oscillator.detune,units:"cents",value:t.detune}),ds(this,["frequency","detune"])}static getDefaults(){return Object.assign(Gs.getDefaults(),{detune:0,frequency:440,type:"sine"})}start(t){const e=this.toSeconds(t);return this.log("start",e),this._startGain(e),this._oscillator.start(e),this}_stopSource(t){this._oscillator.stop(t)}setPeriodicWave(t){return this._oscillator.setPeriodicWave(t),this}get type(){return this._oscillator.type}set type(t){this._oscillator.type=t}dispose(){return super.dispose(),"started"===this.state&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}}class Or extends gr{constructor(){super(Qi(Or.getDefaults(),arguments,["frequency","type"])),this.name="Oscillator",this._oscillator=null;const t=Qi(Or.getDefaults(),arguments,["frequency","type"]);this.frequency=new Qs({context:this.context,units:"frequency",value:t.frequency}),ds(this,"frequency"),this.detune=new Qs({context:this.context,units:"cents",value:t.detune}),ds(this,"detune"),this._partials=t.partials,this._partialCount=t.partialCount,this._type=t.type,t.partialCount&&"custom"!==t.type&&(this._type=this.baseType+t.partialCount.toString()),this.phase=t.phase}static getDefaults(){return Object.assign(gr.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}_start(t){const e=this.toSeconds(t),n=new kr({context:this.context,onended:()=>this.onstop(this)});this._oscillator=n,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(e)}_stop(t){const e=this.toSeconds(t);this._oscillator&&this._oscillator.stop(e)}_restart(t){const e=this.toSeconds(t);return this.log("restart",e),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(e),this}syncFrequency(){return this.context.transport.syncSignal(this.frequency),this}unsyncFrequency(){return this.context.transport.unsyncSignal(this.frequency),this}_getCachedPeriodicWave(){if("custom"===this._type)return Or._periodicWaveCache.find((t=>{return t.phase===this._phase&&(e=t.partials,n=this._partials,e.length===n.length&&e.every(((t,e)=>n[e]===t)));var e,n}));{const t=Or._periodicWaveCache.find((t=>t.type===this._type&&t.phase===this._phase));return this._partialCount=t?t.partialCount:this._partialCount,t}}get type(){return this._type}set type(t){this._type=t;const e=-1!==["sine","square","sawtooth","triangle"].indexOf(t);if(0===this._phase&&e)this._wave=void 0,this._partialCount=0,null!==this._oscillator&&(this._oscillator.type=t);else{const e=this._getCachedPeriodicWave();if(Ai(e)){const{partials:t,wave:n}=e;this._wave=n,this._partials=t,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave)}else{const[e,n]=this._getRealImaginary(t,this._phase),i=this.context.createPeriodicWave(e,n);this._wave=i,null!==this._oscillator&&this._oscillator.setPeriodicWave(this._wave),Or._periodicWaveCache.push({imag:n,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:e,type:this._type,wave:this._wave}),Or._periodicWaveCache.length>100&&Or._periodicWaveCache.shift()}}}get baseType(){return this._type.replace(this.partialCount.toString(),"")}set baseType(t){this.partialCount&&"custom"!==this._type&&"custom"!==t?this.type=t+this.partialCount:this.type=t}get partialCount(){return this._partialCount}set partialCount(t){wi(t,0);let e=this._type;const n=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(n&&(e=n[1]),"custom"!==this._type)this.type=0===t?e:e+t.toString();else{const e=new Float32Array(t);this._partials.forEach(((t,n)=>e[n]=t)),this._partials=Array.from(e),this.type=this._type}}_getRealImaginary(t,e){let n=2048;const i=new Float32Array(n),s=new Float32Array(n);let r=1;if("custom"===t){if(r=this._partials.length+1,this._partialCount=this._partials.length,n=r,0===this._partials.length)return[i,s]}else{const e=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(t);e?(r=parseInt(e[2],10)+1,this._partialCount=parseInt(e[2],10),t=e[1],r=Math.max(r,2),n=r):this._partialCount=0,this._partials=[]}for(let o=1;o<n;++o){const n=2/(o*Math.PI);let a;switch(t){case"sine":a=o<=r?1:0,this._partials[o-1]=a;break;case"square":a=1&o?2*n:0,this._partials[o-1]=a;break;case"sawtooth":a=n*(1&o?1:-1),this._partials[o-1]=a;break;case"triangle":a=1&o?n*n*2*(o-1>>1&1?-1:1):0,this._partials[o-1]=a;break;case"custom":a=this._partials[o-1];break;default:throw new TypeError("Oscillator: invalid type: "+t)}0!==a?(i[o]=-a*Math.sin(e*o),s[o]=a*Math.cos(e*o)):(i[o]=0,s[o]=0)}return[i,s]}_inverseFFT(t,e,n){let i=0;const s=t.length;for(let r=0;r<s;r++)i+=t[r]*Math.cos(r*n)+e[r]*Math.sin(r*n);return i}getInitialValue(){const[t,e]=this._getRealImaginary(this._type,0);let n=0;const i=2*Math.PI;for(let s=0;s<32;s++)n=Math.max(this._inverseFFT(t,e,s/32*i),n);return ss(-this._inverseFFT(t,e,this._phase)/n,-1,1)}get partials(){return this._partials.slice(0,this.partialCount)}set partials(t){this._partials=t,this._partialCount=this._partials.length,t.length&&(this.type="custom")}get phase(){return this._phase*(180/Math.PI)}set phase(t){this._phase=t*Math.PI/180,this.type=this._type}asArray(t=1024){return Li(this,void 0,void 0,(function*(){return Sr(this,t)}))}dispose(){return super.dispose(),null!==this._oscillator&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}}Or._periodicWaveCache=[];class Er extends Bs{constructor(){super(Object.assign(Qi(Er.getDefaults(),arguments,["context"])))}connect(t,e=0,n=0){return Hs(this,t,e,n),this}}class Cr extends Er{constructor(){super(Object.assign(Qi(Cr.getDefaults(),arguments,["mapping","length"]))),this.name="WaveShaper",this._shaper=this.context.createWaveShaper(),this.input=this._shaper,this.output=this._shaper;const t=Qi(Cr.getDefaults(),arguments,["mapping","length"]);Ri(t.mapping)||t.mapping instanceof Float32Array?this.curve=Float32Array.from(t.mapping):Di(t.mapping)&&this.setMap(t.mapping,t.length)}static getDefaults(){return Object.assign(Qs.getDefaults(),{length:1024})}setMap(t,e=1024){const n=new Float32Array(e);for(let i=0,s=e;i<s;i++){const e=i/(s-1)*2-1;n[i]=t(e,i)}return this.curve=n,this}get curve(){return this._shaper.curve}set curve(t){this._shaper.curve=t}get oversample(){return this._shaper.oversample}set oversample(t){xi(["none","2x","4x"].some((e=>e.includes(t))),"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=t}dispose(){return super.dispose(),this._shaper.disconnect(),this}}class Ar extends Er{constructor(){super(...arguments),this.name="AudioToGain",this._norm=new Cr({context:this.context,mapping:t=>(t+1)/2}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class Dr extends Qs{constructor(){super(Object.assign(Qi(Dr.getDefaults(),arguments,["value"]))),this.name="Multiply",this.override=!1;const t=Qi(Dr.getDefaults(),arguments,["value"]);this._mult=this.input=this.output=new Ys({context:this.context,minValue:t.minValue,maxValue:t.maxValue}),this.factor=this._param=this._mult.gain,this.factor.setValueAtTime(t.value,0)}static getDefaults(){return Object.assign(Qs.getDefaults(),{value:0})}dispose(){return super.dispose(),this._mult.dispose(),this}}class Mr extends gr{constructor(){super(Qi(Mr.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="AMOscillator",this._modulationScale=new Ar({context:this.context}),this._modulationNode=new Ys({context:this.context});const t=Qi(Mr.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new Or({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase,type:t.type}),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this._modulator=new Or({context:this.context,phase:t.phase,type:t.modulationType}),this.harmonicity=new Dr({context:this.context,units:"positive",value:t.harmonicity}),this.frequency.chain(this.harmonicity,this._modulator.frequency),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),ds(this,["frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(Or.getDefaults(),{harmonicity:1,modulationType:"square"})}_start(t){this._modulator.start(t),this._carrier.start(t)}_stop(t){this._modulator.stop(t),this._carrier.stop(t)}_restart(t){this._modulator.restart(t),this._carrier.restart(t)}get type(){return this._carrier.type}set type(t){this._carrier.type=t}get baseType(){return this._carrier.baseType}set baseType(t){this._carrier.baseType=t}get partialCount(){return this._carrier.partialCount}set partialCount(t){this._carrier.partialCount=t}get modulationType(){return this._modulator.type}set modulationType(t){this._modulator.type=t}get phase(){return this._carrier.phase}set phase(t){this._carrier.phase=t,this._modulator.phase=t}get partials(){return this._carrier.partials}set partials(t){this._carrier.partials=t}asArray(t=1024){return Li(this,void 0,void 0,(function*(){return Sr(this,t)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}}class Ir extends gr{constructor(){super(Qi(Ir.getDefaults(),arguments,["frequency","type","modulationType"])),this.name="FMOscillator",this._modulationNode=new Ys({context:this.context,gain:0});const t=Qi(Ir.getDefaults(),arguments,["frequency","type","modulationType"]);this._carrier=new Or({context:this.context,detune:t.detune,frequency:0,onstop:()=>this.onstop(this),phase:t.phase,type:t.type}),this.detune=this._carrier.detune,this.frequency=new Qs({context:this.context,units:"frequency",value:t.frequency}),this._modulator=new Or({context:this.context,phase:t.phase,type:t.modulationType}),this.harmonicity=new Dr({context:this.context,units:"positive",value:t.harmonicity}),this.modulationIndex=new Dr({context:this.context,units:"positive",value:t.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),ds(this,["modulationIndex","frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(Or.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}_start(t){this._modulator.start(t),this._carrier.start(t)}_stop(t){this._modulator.stop(t),this._carrier.stop(t)}_restart(t){return this._modulator.restart(t),this._carrier.restart(t),this}get type(){return this._carrier.type}set type(t){this._carrier.type=t}get baseType(){return this._carrier.baseType}set baseType(t){this._carrier.baseType=t}get partialCount(){return this._carrier.partialCount}set partialCount(t){this._carrier.partialCount=t}get modulationType(){return this._modulator.type}set modulationType(t){this._modulator.type=t}get phase(){return this._carrier.phase}set phase(t){this._carrier.phase=t,this._modulator.phase=t}get partials(){return this._carrier.partials}set partials(t){this._carrier.partials=t}asArray(t=1024){return Li(this,void 0,void 0,(function*(){return Sr(this,t)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}}class Pr extends gr{constructor(){super(Qi(Pr.getDefaults(),arguments,["frequency","width"])),this.name="PulseOscillator",this._widthGate=new Ys({context:this.context,gain:0}),this._thresh=new Cr({context:this.context,mapping:t=>t<=0?-1:1});const t=Qi(Pr.getDefaults(),arguments,["frequency","width"]);this.width=new Qs({context:this.context,units:"audioRange",value:t.width}),this._triangle=new Or({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase,type:"triangle"}),this.frequency=this._triangle.frequency,this.detune=this._triangle.detune,this._triangle.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),ds(this,["width","frequency","detune"])}static getDefaults(){return Object.assign(gr.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}_start(t){t=this.toSeconds(t),this._triangle.start(t),this._widthGate.gain.setValueAtTime(1,t)}_stop(t){t=this.toSeconds(t),this._triangle.stop(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(0,t)}_restart(t){this._triangle.restart(t),this._widthGate.gain.cancelScheduledValues(t),this._widthGate.gain.setValueAtTime(1,t)}get phase(){return this._triangle.phase}set phase(t){this._triangle.phase=t}get type(){return"pulse"}get baseType(){return"pulse"}get partials(){return[]}get partialCount(){return 0}set carrierType(t){this._triangle.type=t}asArray(t=1024){return Li(this,void 0,void 0,(function*(){return Sr(this,t)}))}dispose(){return super.dispose(),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}}class Rr extends gr{constructor(){super(Qi(Rr.getDefaults(),arguments,["frequency","type","spread"])),this.name="FatOscillator",this._oscillators=[];const t=Qi(Rr.getDefaults(),arguments,["frequency","type","spread"]);this.frequency=new Qs({context:this.context,units:"frequency",value:t.frequency}),this.detune=new Qs({context:this.context,units:"cents",value:t.detune}),this._spread=t.spread,this._type=t.type,this._phase=t.phase,this._partials=t.partials,this._partialCount=t.partialCount,this.count=t.count,ds(this,["frequency","detune"])}static getDefaults(){return Object.assign(Or.getDefaults(),{count:3,spread:20,type:"sawtooth"})}_start(t){t=this.toSeconds(t),this._forEach((e=>e.start(t)))}_stop(t){t=this.toSeconds(t),this._forEach((e=>e.stop(t)))}_restart(t){this._forEach((e=>e.restart(t)))}_forEach(t){for(let e=0;e<this._oscillators.length;e++)t(this._oscillators[e],e)}get type(){return this._type}set type(t){this._type=t,this._forEach((e=>e.type=t))}get spread(){return this._spread}set spread(t){if(this._spread=t,this._oscillators.length>1){const e=-t/2,n=t/(this._oscillators.length-1);this._forEach(((t,i)=>t.detune.value=e+n*i))}}get count(){return this._oscillators.length}set count(t){if(wi(t,1),this._oscillators.length!==t){this._forEach((t=>t.dispose())),this._oscillators=[];for(let e=0;e<t;e++){const n=new Or({context:this.context,volume:-6-1.1*t,type:this._type,phase:this._phase+e/t*360,partialCount:this._partialCount,onstop:0===e?()=>this.onstop(this):ms});"custom"===this.type&&(n.partials=this._partials),this.frequency.connect(n.frequency),this.detune.connect(n.detune),n.detune.overridden=!1,n.connect(this.output),this._oscillators[e]=n}this.spread=this._spread,"started"===this.state&&this._forEach((t=>t.start()))}}get phase(){return this._phase}set phase(t){this._phase=t,this._forEach(((t,e)=>t.phase=this._phase+e/this.count*360))}get baseType(){return this._oscillators[0].baseType}set baseType(t){this._forEach((e=>e.baseType=t)),this._type=this._oscillators[0].type}get partials(){return this._oscillators[0].partials}set partials(t){this._partials=t,this._partialCount=this._partials.length,t.length&&(this._type="custom",this._forEach((e=>e.partials=t)))}get partialCount(){return this._oscillators[0].partialCount}set partialCount(t){this._partialCount=t,this._forEach((e=>e.partialCount=t)),this._type=this._oscillators[0].type}asArray(t=1024){return Li(this,void 0,void 0,(function*(){return Sr(this,t)}))}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this._forEach((t=>t.dispose())),this}}class jr extends gr{constructor(){super(Qi(jr.getDefaults(),arguments,["frequency","modulationFrequency"])),this.name="PWMOscillator",this.sourceType="pwm",this._scale=new Dr({context:this.context,value:2});const t=Qi(jr.getDefaults(),arguments,["frequency","modulationFrequency"]);this._pulse=new Pr({context:this.context,frequency:t.modulationFrequency}),this._pulse.carrierType="sine",this.modulationFrequency=this._pulse.frequency,this._modulator=new Or({context:this.context,detune:t.detune,frequency:t.frequency,onstop:()=>this.onstop(this),phase:t.phase}),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),ds(this,["modulationFrequency","frequency","detune"])}static getDefaults(){return Object.assign(gr.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}_start(t){t=this.toSeconds(t),this._modulator.start(t),this._pulse.start(t)}_stop(t){t=this.toSeconds(t),this._modulator.stop(t),this._pulse.stop(t)}_restart(t){this._modulator.restart(t),this._pulse.restart(t)}get type(){return"pwm"}get baseType(){return"pwm"}get partials(){return[]}get partialCount(){return 0}get phase(){return this._modulator.phase}set phase(t){this._modulator.phase=t}asArray(t=1024){return Li(this,void 0,void 0,(function*(){return Sr(this,t)}))}dispose(){return super.dispose(),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}}const qr={am:Mr,fat:Rr,fm:Ir,oscillator:Or,pulse:Pr,pwm:jr};class Nr extends gr{constructor(){super(Qi(Nr.getDefaults(),arguments,["frequency","type"])),this.name="OmniOscillator";const t=Qi(Nr.getDefaults(),arguments,["frequency","type"]);this.frequency=new Qs({context:this.context,units:"frequency",value:t.frequency}),this.detune=new Qs({context:this.context,units:"cents",value:t.detune}),ds(this,["frequency","detune"]),this.set(t)}static getDefaults(){return Object.assign(Or.getDefaults(),Ir.getDefaults(),Mr.getDefaults(),Rr.getDefaults(),Pr.getDefaults(),jr.getDefaults())}_start(t){this._oscillator.start(t)}_stop(t){this._oscillator.stop(t)}_restart(t){return this._oscillator.restart(t),this}get type(){let t="";return["am","fm","fat"].some((t=>this._sourceType===t))&&(t=this._sourceType),t+this._oscillator.type}set type(t){"fm"===t.substr(0,2)?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):"am"===t.substr(0,2)?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(2)):"fat"===t.substr(0,3)?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=t.substr(3)):"pwm"===t?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):"pulse"===t?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=t)}get partials(){return this._oscillator.partials}set partials(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partials=t)}get partialCount(){return this._oscillator.partialCount}set partialCount(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||(this._oscillator.partialCount=t)}set(t){return Reflect.has(t,"type")&&t.type&&(this.type=t.type),super.set(t),this}_createNewOscillator(t){if(t!==this._sourceType){this._sourceType=t;const e=qr[t],n=this.now();if(this._oscillator){const t=this._oscillator;t.stop(n),this.context.setTimeout((()=>t.dispose()),this.blockTime)}this._oscillator=new e({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=()=>this.onstop(this),"started"===this.state&&this._oscillator.start(n)}}get phase(){return this._oscillator.phase}set phase(t){this._oscillator.phase=t}get sourceType(){return this._sourceType}set sourceType(t){let e="sine";"pwm"!==this._oscillator.type&&"pulse"!==this._oscillator.type&&(e=this._oscillator.type),"fm"===t?this.type="fm"+e:"am"===t?this.type="am"+e:"fat"===t?this.type="fat"+e:"oscillator"===t?this.type=e:"pulse"===t?this.type="pulse":"pwm"===t&&(this.type="pwm")}_getOscType(t,e){return t instanceof qr[e]}get baseType(){return this._oscillator.baseType}set baseType(t){this._getOscType(this._oscillator,"pulse")||this._getOscType(this._oscillator,"pwm")||"pulse"===t||"pwm"===t||(this._oscillator.baseType=t)}get width(){return this._getOscType(this._oscillator,"pulse")?this._oscillator.width:void 0}get count(){return this._getOscType(this._oscillator,"fat")?this._oscillator.count:void 0}set count(t){this._getOscType(this._oscillator,"fat")&&Mi(t)&&(this._oscillator.count=t)}get spread(){return this._getOscType(this._oscillator,"fat")?this._oscillator.spread:void 0}set spread(t){this._getOscType(this._oscillator,"fat")&&Mi(t)&&(this._oscillator.spread=t)}get modulationType(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.modulationType:void 0}set modulationType(t){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&ji(t)&&(this._oscillator.modulationType=t)}get modulationIndex(){return this._getOscType(this._oscillator,"fm")?this._oscillator.modulationIndex:void 0}get harmonicity(){return this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am")?this._oscillator.harmonicity:void 0}get modulationFrequency(){return this._getOscType(this._oscillator,"pwm")?this._oscillator.modulationFrequency:void 0}asArray(t=1024){return Li(this,void 0,void 0,(function*(){return Sr(this,t)}))}dispose(){return super.dispose(),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}}class Vr extends Qs{constructor(){super(Object.assign(Qi(Vr.getDefaults(),arguments,["value"]))),this.override=!1,this.name="Add",this._sum=new Ys({context:this.context}),this.input=this._sum,this.output=this._sum,this.addend=this._param,Ws(this._constantSource,this._sum)}static getDefaults(){return Object.assign(Qs.getDefaults(),{value:0})}dispose(){return super.dispose(),this._sum.dispose(),this}}class Fr extends Er{constructor(){super(Object.assign(Qi(Fr.getDefaults(),arguments,["min","max"]))),this.name="Scale";const t=Qi(Fr.getDefaults(),arguments,["min","max"]);this._mult=this.input=new Dr({context:this.context,value:t.max-t.min}),this._add=this.output=new Vr({context:this.context,value:t.min}),this._min=t.min,this._max=t.max,this.input.connect(this.output)}static getDefaults(){return Object.assign(Er.getDefaults(),{max:1,min:0})}get min(){return this._min}set min(t){this._min=t,this._setRange()}get max(){return this._max}set max(t){this._max=t,this._setRange()}_setRange(){this._add.value=this._min,this._mult.value=this._max-this._min}dispose(){return super.dispose(),this._add.dispose(),this._mult.dispose(),this}}class Lr extends Er{constructor(){super(Object.assign(Qi(Lr.getDefaults(),arguments))),this.name="Zero",this._gain=new Ys({context:this.context}),this.output=this._gain,this.input=void 0,Zs(this.context.getConstant(0),this._gain)}dispose(){return super.dispose(),Us(this.context.getConstant(0),this._gain),this}}class zr extends Bs{constructor(){super(Qi(zr.getDefaults(),arguments,["frequency","min","max"])),this.name="LFO",this._stoppedValue=0,this._units="number",this.convert=!0,this._fromType=zs.prototype._fromType,this._toType=zs.prototype._toType,this._is=zs.prototype._is,this._clampValue=zs.prototype._clampValue;const t=Qi(zr.getDefaults(),arguments,["frequency","min","max"]);this._oscillator=new Or(t),this.frequency=this._oscillator.frequency,this._amplitudeGain=new Ys({context:this.context,gain:t.amplitude,units:"normalRange"}),this.amplitude=this._amplitudeGain.gain,this._stoppedSignal=new Qs({context:this.context,units:"audioRange",value:0}),this._zeros=new Lr({context:this.context}),this._a2g=new Ar({context:this.context}),this._scaler=this.output=new Fr({context:this.context,max:t.max,min:t.min}),this.units=t.units,this.min=t.min,this.max=t.max,this._oscillator.chain(this._amplitudeGain,this._a2g,this._scaler),this._zeros.connect(this._a2g),this._stoppedSignal.connect(this._a2g),ds(this,["amplitude","frequency"]),this.phase=t.phase}static getDefaults(){return Object.assign(Or.getDefaults(),{amplitude:1,frequency:"4n",max:1,min:0,type:"sine",units:"number"})}start(t){return t=this.toSeconds(t),this._stoppedSignal.setValueAtTime(0,t),this._oscillator.start(t),this}stop(t){return t=this.toSeconds(t),this._stoppedSignal.setValueAtTime(this._stoppedValue,t),this._oscillator.stop(t),this}sync(){return this._oscillator.sync(),this._oscillator.syncFrequency(),this}unsync(){return this._oscillator.unsync(),this._oscillator.unsyncFrequency(),this}_setStoppedValue(){this._stoppedValue=this._oscillator.getInitialValue(),this._stoppedSignal.value=this._stoppedValue}get min(){return this._toType(this._scaler.min)}set min(t){t=this._fromType(t),this._scaler.min=t}get max(){return this._toType(this._scaler.max)}set max(t){t=this._fromType(t),this._scaler.max=t}get type(){return this._oscillator.type}set type(t){this._oscillator.type=t,this._setStoppedValue()}get partials(){return this._oscillator.partials}set partials(t){this._oscillator.partials=t,this._setStoppedValue()}get phase(){return this._oscillator.phase}set phase(t){this._oscillator.phase=t,this._setStoppedValue()}get units(){return this._units}set units(t){const e=this.min,n=this.max;this._units=t,this.min=e,this.max=n}get state(){return this._oscillator.state}connect(t,e,n){return(t instanceof zs||t instanceof Qs)&&(this.convert=t.convert,this.units=t.units),Hs(this,t,e,n),this}dispose(){return super.dispose(),this._oscillator.dispose(),this._stoppedSignal.dispose(),this._zeros.dispose(),this._scaler.dispose(),this._a2g.dispose(),this._amplitudeGain.dispose(),this.amplitude.dispose(),this}}function Br(t,e=1/0){const n=new WeakMap;return function(i,s){Reflect.defineProperty(i,s,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(i){wi(i,t,e),n.set(this,i)}})}}function Wr(t,e=1/0){const n=new WeakMap;return function(i,s){Reflect.defineProperty(i,s,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(i){wi(this.toSeconds(i),t,e),n.set(this,i)}})}}class Zr extends gr{constructor(){super(Qi(Zr.getDefaults(),arguments,["url","onload"])),this.name="Player",this._activeSources=new Set;const t=Qi(Zr.getDefaults(),arguments,["url","onload"]);this._buffer=new vs({onload:this._onload.bind(this,t.onload),onerror:t.onerror,reverse:t.reverse,url:t.url}),this.autostart=t.autostart,this._loop=t.loop,this._loopStart=t.loopStart,this._loopEnd=t.loopEnd,this._playbackRate=t.playbackRate,this.fadeIn=t.fadeIn,this.fadeOut=t.fadeOut}static getDefaults(){return Object.assign(gr.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:ms,onerror:ms,playbackRate:1,reverse:!1})}load(t){return Li(this,void 0,void 0,(function*(){return yield this._buffer.load(t),this._onload(),this}))}_onload(t=ms){t(),this.autostart&&this.start()}_onSourceEnd(t){this.onstop(this),this._activeSources.delete(t),0!==this._activeSources.size||this._synced||"started"!==this._state.getValueAtTime(this.now())||(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}start(t,e,n){return super.start(t,e,n),this}_start(t,e,n){e=this._loop?Hi(e,this._loopStart):Hi(e,0);const i=this.toSeconds(e),s=n;n=Hi(n,Math.max(this._buffer.duration-i,0));let r=this.toSeconds(n);r/=this._playbackRate,t=this.toSeconds(t);const o=new yr({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);this._loop||this._synced||(this._state.cancel(t+r),this._state.setStateAtTime("stopped",t+r,{implicitEnd:!0})),this._activeSources.add(o),this._loop&&Ci(s)?o.start(t,i):o.start(t,i,r-this.toSeconds(this.fadeOut))}_stop(t){const e=this.toSeconds(t);this._activeSources.forEach((t=>t.stop(e)))}restart(t,e,n){return super.restart(t,e,n),this}_restart(t,e,n){this._stop(t),this._start(t,e,n)}seek(t,e){const n=this.toSeconds(e);if("started"===this._state.getValueAtTime(n)){const e=this.toSeconds(t);this._stop(n),this._start(n,e)}return this}setLoopPoints(t,e){return this.loopStart=t,this.loopEnd=e,this}get loopStart(){return this._loopStart}set loopStart(t){this._loopStart=t,this.buffer.loaded&&wi(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach((e=>{e.loopStart=t}))}get loopEnd(){return this._loopEnd}set loopEnd(t){this._loopEnd=t,this.buffer.loaded&&wi(this.toSeconds(t),0,this.buffer.duration),this._activeSources.forEach((e=>{e.loopEnd=t}))}get buffer(){return this._buffer}set buffer(t){this._buffer.set(t)}get loop(){return this._loop}set loop(t){if(this._loop!==t&&(this._loop=t,this._activeSources.forEach((e=>{e.loop=t})),t)){const t=this._state.getNextState("stopped",this.now());t&&this._state.cancel(t.time)}}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t;const e=this.now(),n=this._state.getNextState("stopped",e);n&&n.implicitEnd&&(this._state.cancel(n.time),this._activeSources.forEach((t=>t.cancelStop()))),this._activeSources.forEach((n=>{n.playbackRate.setValueAtTime(t,e)}))}get reverse(){return this._buffer.reverse}set reverse(t){this._buffer.reverse=t}get loaded(){return this._buffer.loaded}dispose(){return super.dispose(),this._activeSources.forEach((t=>t.dispose())),this._activeSources.clear(),this._buffer.dispose(),this}}Fi([Wr(0)],Zr.prototype,"fadeIn",void 0),Fi([Wr(0)],Zr.prototype,"fadeOut",void 0);class Ur extends Bs{constructor(){super(Qi(Ur.getDefaults(),arguments,["urls","onload"],"urls")),this.name="Players",this.input=void 0,this._players=new Map;const t=Qi(Ur.getDefaults(),arguments,["urls","onload"],"urls");this._volume=this.output=new hr({context:this.context,volume:t.volume}),this.volume=this._volume.volume,ds(this,"volume"),this._buffers=new ir({urls:t.urls,onload:t.onload,baseUrl:t.baseUrl,onerror:t.onerror}),this.mute=t.mute,this._fadeIn=t.fadeIn,this._fadeOut=t.fadeOut}static getDefaults(){return Object.assign(gr.getDefaults(),{baseUrl:"",fadeIn:0,fadeOut:0,mute:!1,onload:ms,onerror:ms,urls:{},volume:0})}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}get fadeIn(){return this._fadeIn}set fadeIn(t){this._fadeIn=t,this._players.forEach((e=>{e.fadeIn=t}))}get fadeOut(){return this._fadeOut}set fadeOut(t){this._fadeOut=t,this._players.forEach((e=>{e.fadeOut=t}))}get state(){return Array.from(this._players).some((([t,e])=>"started"===e.state))?"started":"stopped"}has(t){return this._buffers.has(t)}player(t){if(xi(this.has(t),`No Player with the name ${t} exists on this object`),!this._players.has(t)){const e=new Zr({context:this.context,fadeIn:this._fadeIn,fadeOut:this._fadeOut,url:this._buffers.get(t)}).connect(this.output);this._players.set(t,e)}return this._players.get(t)}get loaded(){return this._buffers.loaded}add(t,e,n){return xi(!this._buffers.has(t),"A buffer with that name already exists on this object"),this._buffers.add(t,e,n),this}stopAll(t){return this._players.forEach((e=>e.stop(t))),this}dispose(){return super.dispose(),this._volume.dispose(),this.volume.dispose(),this._players.forEach((t=>t.dispose())),this._buffers.dispose(),this}}class Yr extends gr{constructor(){super(Qi(Yr.getDefaults(),arguments,["url","onload"])),this.name="GrainPlayer",this._loopStart=0,this._loopEnd=0,this._activeSources=[];const t=Qi(Yr.getDefaults(),arguments,["url","onload"]);this.buffer=new vs({onload:t.onload,onerror:t.onerror,reverse:t.reverse,url:t.url}),this._clock=new tr({context:this.context,callback:this._tick.bind(this),frequency:1/t.grainSize}),this._playbackRate=t.playbackRate,this._grainSize=t.grainSize,this._overlap=t.overlap,this.detune=t.detune,this.overlap=t.overlap,this.loop=t.loop,this.playbackRate=t.playbackRate,this.grainSize=t.grainSize,this.loopStart=t.loopStart,this.loopEnd=t.loopEnd,this.reverse=t.reverse,this._clock.on("stop",this._onstop.bind(this))}static getDefaults(){return Object.assign(gr.getDefaults(),{onload:ms,onerror:ms,overlap:.1,grainSize:.2,playbackRate:1,detune:0,loop:!1,loopStart:0,loopEnd:0,reverse:!1})}_start(t,e,n){e=Hi(e,0),e=this.toSeconds(e),t=this.toSeconds(t);const i=1/this._clock.frequency.getValueAtTime(t);this._clock.start(t,e/i),n&&this.stop(t+this.toSeconds(n))}restart(t,e,n){return super.restart(t,e,n),this}_restart(t,e,n){this._stop(t),this._start(t,e,n)}_stop(t){this._clock.stop(t)}_onstop(t){this._activeSources.forEach((e=>{e.fadeOut=0,e.stop(t)})),this.onstop(this)}_tick(t){const e=this._clock.getTicksAtTime(t),n=e*this._grainSize;if(this.log("offset",n),!this.loop&&n>this.buffer.duration)return void this.stop(t);const i=n<this._overlap?0:this._overlap,s=new yr({context:this.context,url:this.buffer,fadeIn:i,fadeOut:this._overlap,loop:this.loop,loopStart:this._loopStart,loopEnd:this._loopEnd,playbackRate:ks(this.detune/100)}).connect(this.output);s.start(t,this._grainSize*e),s.stop(t+this._grainSize/this.playbackRate),this._activeSources.push(s),s.onended=()=>{const t=this._activeSources.indexOf(s);-1!==t&&this._activeSources.splice(t,1)}}get playbackRate(){return this._playbackRate}set playbackRate(t){wi(t,.001),this._playbackRate=t,this.grainSize=this._grainSize}get loopStart(){return this._loopStart}set loopStart(t){this.buffer.loaded&&wi(this.toSeconds(t),0,this.buffer.duration),this._loopStart=this.toSeconds(t)}get loopEnd(){return this._loopEnd}set loopEnd(t){this.buffer.loaded&&wi(this.toSeconds(t),0,this.buffer.duration),this._loopEnd=this.toSeconds(t)}get reverse(){return this.buffer.reverse}set reverse(t){this.buffer.reverse=t}get grainSize(){return this._grainSize}set grainSize(t){this._grainSize=this.toSeconds(t),this._clock.frequency.setValueAtTime(this._playbackRate/this._grainSize,this.now())}get overlap(){return this._overlap}set overlap(t){const e=this.toSeconds(t);wi(e,0),this._overlap=e}get loaded(){return this.buffer.loaded}dispose(){return super.dispose(),this.buffer.dispose(),this._clock.dispose(),this._activeSources.forEach((t=>t.dispose())),this}}class Gr extends Er{constructor(){super(...arguments),this.name="Abs",this._abs=new Cr({context:this.context,mapping:t=>Math.abs(t)<.001?0:Math.abs(t)}),this.input=this._abs,this.output=this._abs}dispose(){return super.dispose(),this._abs.dispose(),this}}class Xr extends Er{constructor(){super(...arguments),this.name="GainToAudio",this._norm=new Cr({context:this.context,mapping:t=>2*Math.abs(t)-1}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class Qr extends Er{constructor(){super(...arguments),this.name="Negate",this._multiply=new Dr({context:this.context,value:-1}),this.input=this._multiply,this.output=this._multiply}dispose(){return super.dispose(),this._multiply.dispose(),this}}class Hr extends Qs{constructor(){super(Object.assign(Qi(Hr.getDefaults(),arguments,["value"]))),this.override=!1,this.name="Subtract",this._sum=new Ys({context:this.context}),this.input=this._sum,this.output=this._sum,this._neg=new Qr({context:this.context}),this.subtrahend=this._param,Ws(this._constantSource,this._neg,this._sum)}static getDefaults(){return Object.assign(Qs.getDefaults(),{value:0})}dispose(){return super.dispose(),this._neg.dispose(),this._sum.dispose(),this}}class $r extends Er{constructor(){super(Object.assign(Qi($r.getDefaults(),arguments))),this.name="GreaterThanZero",this._thresh=this.output=new Cr({context:this.context,length:127,mapping:t=>t<=0?0:1}),this._scale=this.input=new Dr({context:this.context,value:1e4}),this._scale.connect(this._thresh)}dispose(){return super.dispose(),this._scale.dispose(),this._thresh.dispose(),this}}class Kr extends Qs{constructor(){super(Object.assign(Qi(Kr.getDefaults(),arguments,["value"]))),this.name="GreaterThan",this.override=!1;const t=Qi(Kr.getDefaults(),arguments,["value"]);this._subtract=this.input=new Hr({context:this.context,value:t.value}),this._gtz=this.output=new $r({context:this.context}),this.comparator=this._param=this._subtract.subtrahend,ds(this,"comparator"),this._subtract.connect(this._gtz)}static getDefaults(){return Object.assign(Qs.getDefaults(),{value:0})}dispose(){return super.dispose(),this._gtz.dispose(),this._subtract.dispose(),this.comparator.dispose(),this}}class Jr extends Er{constructor(){super(Object.assign(Qi(Jr.getDefaults(),arguments,["value"]))),this.name="Pow";const t=Qi(Jr.getDefaults(),arguments,["value"]);this._exponentScaler=this.input=this.output=new Cr({context:this.context,mapping:this._expFunc(t.value),length:8192}),this._exponent=t.value}static getDefaults(){return Object.assign(Er.getDefaults(),{value:1})}_expFunc(t){return e=>Math.pow(Math.abs(e),t)}get value(){return this._exponent}set value(t){this._exponent=t,this._exponentScaler.setMap(this._expFunc(this._exponent))}dispose(){return super.dispose(),this._exponentScaler.dispose(),this}}class to extends Fr{constructor(){super(Object.assign(Qi(to.getDefaults(),arguments,["min","max","exponent"]))),this.name="ScaleExp";const t=Qi(to.getDefaults(),arguments,["min","max","exponent"]);this.input=this._exp=new Jr({context:this.context,value:t.exponent}),this._exp.connect(this._mult)}static getDefaults(){return Object.assign(Fr.getDefaults(),{exponent:1})}get exponent(){return this._exp.value}set exponent(t){this._exp.value=t}dispose(){return super.dispose(),this._exp.dispose(),this}}class eo extends Qs{constructor(){super(Qi(Qs.getDefaults(),arguments,["value","units"])),this.name="SyncedSignal",this.override=!1;const t=Qi(Qs.getDefaults(),arguments,["value","units"]);this._lastVal=t.value,this._synced=this.context.transport.scheduleRepeat(this._onTick.bind(this),"1i"),this._syncedCallback=this._anchorValue.bind(this),this.context.transport.on("start",this._syncedCallback),this.context.transport.on("pause",this._syncedCallback),this.context.transport.on("stop",this._syncedCallback),this._constantSource.disconnect(),this._constantSource.stop(0),this._constantSource=this.output=new Xs({context:this.context,offset:t.value,units:t.units}).start(0),this.setValueAtTime(t.value,0)}_onTick(t){const e=super.getValueAtTime(this.context.transport.seconds);this._lastVal!==e&&(this._lastVal=e,this._constantSource.offset.setValueAtTime(e,t))}_anchorValue(t){const e=super.getValueAtTime(this.context.transport.seconds);this._lastVal=e,this._constantSource.offset.cancelAndHoldAtTime(t),this._constantSource.offset.setValueAtTime(e,t)}getValueAtTime(t){const e=new Ns(this.context,t).toSeconds();return super.getValueAtTime(e)}setValueAtTime(t,e){const n=new Ns(this.context,e).toSeconds();return super.setValueAtTime(t,n),this}linearRampToValueAtTime(t,e){const n=new Ns(this.context,e).toSeconds();return super.linearRampToValueAtTime(t,n),this}exponentialRampToValueAtTime(t,e){const n=new Ns(this.context,e).toSeconds();return super.exponentialRampToValueAtTime(t,n),this}setTargetAtTime(t,e,n){const i=new Ns(this.context,e).toSeconds();return super.setTargetAtTime(t,i,n),this}cancelScheduledValues(t){const e=new Ns(this.context,t).toSeconds();return super.cancelScheduledValues(e),this}setValueCurveAtTime(t,e,n,i){const s=new Ns(this.context,e).toSeconds();return n=this.toSeconds(n),super.setValueCurveAtTime(t,s,n,i),this}cancelAndHoldAtTime(t){const e=new Ns(this.context,t).toSeconds();return super.cancelAndHoldAtTime(e),this}setRampPoint(t){const e=new Ns(this.context,t).toSeconds();return super.setRampPoint(e),this}exponentialRampTo(t,e,n){const i=new Ns(this.context,n).toSeconds();return super.exponentialRampTo(t,e,i),this}linearRampTo(t,e,n){const i=new Ns(this.context,n).toSeconds();return super.linearRampTo(t,e,i),this}targetRampTo(t,e,n){const i=new Ns(this.context,n).toSeconds();return super.targetRampTo(t,e,i),this}dispose(){return super.dispose(),this.context.transport.clear(this._synced),this.context.transport.off("start",this._syncedCallback),this.context.transport.off("pause",this._syncedCallback),this.context.transport.off("stop",this._syncedCallback),this._constantSource.dispose(),this}}class no extends Bs{constructor(){super(Qi(no.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="Envelope",this._sig=new Qs({context:this.context,value:0}),this.output=this._sig,this.input=void 0;const t=Qi(no.getDefaults(),arguments,["attack","decay","sustain","release"]);this.attack=t.attack,this.decay=t.decay,this.sustain=t.sustain,this.release=t.release,this.attackCurve=t.attackCurve,this.releaseCurve=t.releaseCurve,this.decayCurve=t.decayCurve}static getDefaults(){return Object.assign(Bs.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}get value(){return this.getValueAtTime(this.now())}_getCurve(t,e){if(ji(t))return t;{let n;for(n in io)if(io[n][e]===t)return n;return t}}_setCurve(t,e,n){if(ji(n)&&Reflect.has(io,n)){const i=io[n];Ii(i)?"_decayCurve"!==t&&(this[t]=i[e]):this[t]=i}else{if(!Ri(n)||"_decayCurve"===t)throw new Error("Envelope: invalid curve: "+n);this[t]=n}}get attackCurve(){return this._getCurve(this._attackCurve,"In")}set attackCurve(t){this._setCurve("_attackCurve","In",t)}get releaseCurve(){return this._getCurve(this._releaseCurve,"Out")}set releaseCurve(t){this._setCurve("_releaseCurve","Out",t)}get decayCurve(){return this._decayCurve}set decayCurve(t){xi(["linear","exponential"].some((e=>e===t)),`Invalid envelope curve: ${t}`),this._decayCurve=t}triggerAttack(t,e=1){this.log("triggerAttack",t,e),t=this.toSeconds(t);let n=this.toSeconds(this.attack);const i=this.toSeconds(this.decay),s=this.getValueAtTime(t);if(s>0&&(n=(1-s)/(1/n)),n<this.sampleTime)this._sig.cancelScheduledValues(t),this._sig.setValueAtTime(e,t);else if("linear"===this._attackCurve)this._sig.linearRampTo(e,n,t);else if("exponential"===this._attackCurve)this._sig.targetRampTo(e,n,t);else{this._sig.cancelAndHoldAtTime(t);let i=this._attackCurve;for(let t=1;t<i.length;t++)if(i[t-1]<=s&&s<=i[t]){i=this._attackCurve.slice(t),i[0]=s;break}this._sig.setValueCurveAtTime(i,t,n,e)}if(i&&this.sustain<1){const s=e*this.sustain,r=t+n;this.log("decay",r),"linear"===this._decayCurve?this._sig.linearRampToValueAtTime(s,i+r):this._sig.exponentialApproachValueAtTime(s,r,i)}return this}triggerRelease(t){this.log("triggerRelease",t),t=this.toSeconds(t);const e=this.getValueAtTime(t);if(e>0){const n=this.toSeconds(this.release);n<this.sampleTime?this._sig.setValueAtTime(0,t):"linear"===this._releaseCurve?this._sig.linearRampTo(0,n,t):"exponential"===this._releaseCurve?this._sig.targetRampTo(0,n,t):(xi(Ri(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(t),this._sig.setValueCurveAtTime(this._releaseCurve,t,n,e))}return this}getValueAtTime(t){return this._sig.getValueAtTime(t)}triggerAttackRelease(t,e,n=1){return e=this.toSeconds(e),this.triggerAttack(e,n),this.triggerRelease(e+this.toSeconds(t)),this}cancel(t){return this._sig.cancelScheduledValues(this.toSeconds(t)),this}connect(t,e=0,n=0){return Hs(this,t,e,n),this}asArray(t=1024){return Li(this,void 0,void 0,(function*(){const e=t/this.context.sampleRate,n=new gs(1,e,this.context.sampleRate),i=this.toSeconds(this.attack)+this.toSeconds(this.decay),s=i+this.toSeconds(this.release),r=.1*s,o=s+r,a=new this.constructor(Object.assign(this.get(),{attack:e*this.toSeconds(this.attack)/o,decay:e*this.toSeconds(this.decay)/o,release:e*this.toSeconds(this.release)/o,context:n}));return a._sig.toDestination(),a.triggerAttackRelease(e*(i+r)/o,0),(yield n.render()).getChannelData(0)}))}dispose(){return super.dispose(),this._sig.dispose(),this}}Fi([Wr(0)],no.prototype,"attack",void 0),Fi([Wr(0)],no.prototype,"decay",void 0),Fi([Br(0,1)],no.prototype,"sustain",void 0),Fi([Wr(0)],no.prototype,"release",void 0);const io=(()=>{const t=128;let e,n;const i=[];for(e=0;e<t;e++)i[e]=Math.sin(e/127*(Math.PI/2));const s=[];for(e=0;e<127;e++){n=e/127;const t=Math.sin(n*(2*Math.PI)*6.4-Math.PI/2)+1;s[e]=t/10+.83*n}s[127]=1;const r=[];for(e=0;e<t;e++)r[e]=Math.ceil(e/127*5)/5;const o=[];for(e=0;e<t;e++)n=e/127,o[e]=.5*(1-Math.cos(Math.PI*n));const a=[];for(e=0;e<t;e++){n=e/127;const t=4*Math.pow(n,3)+.2,i=Math.cos(t*Math.PI*2*n);a[e]=Math.abs(i*(1-n))}function c(t){const e=new Array(t.length);for(let n=0;n<t.length;n++)e[n]=1-t[n];return e}return{bounce:{In:c(a),Out:a},cosine:{In:i,Out:(u=i,u.slice(0).reverse())},exponential:"exponential",linear:"linear",ripple:{In:s,Out:c(s)},sine:{In:o,Out:c(o)},step:{In:r,Out:c(r)}};var u})();class so extends Bs{constructor(){super(Qi(so.getDefaults(),arguments)),this._scheduledEvents=[],this._synced=!1,this._original_triggerAttack=this.triggerAttack,this._original_triggerRelease=this.triggerRelease;const t=Qi(so.getDefaults(),arguments);this._volume=this.output=new hr({context:this.context,volume:t.volume}),this.volume=this._volume.volume,ds(this,"volume")}static getDefaults(){return Object.assign(Bs.getDefaults(),{volume:0})}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0)),this}_syncState(){let t=!1;return this._synced||(this._synced=!0,t=!0),t}_syncMethod(t,e){const n=this["_original_"+t]=this[t];this[t]=(...t)=>{const i=t[e],s=this.context.transport.schedule((i=>{t[e]=i,n.apply(this,t)}),i);this._scheduledEvents.push(s)}}unsync(){return this._scheduledEvents.forEach((t=>this.context.transport.clear(t))),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease),this}triggerAttackRelease(t,e,n,i){const s=this.toSeconds(n),r=this.toSeconds(e);return this.triggerAttack(t,s,i),this.triggerRelease(s+r),this}dispose(){return super.dispose(),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}}class ro extends so{constructor(){super(Qi(ro.getDefaults(),arguments));const t=Qi(ro.getDefaults(),arguments);this.portamento=t.portamento,this.onsilence=t.onsilence}static getDefaults(){return Object.assign(so.getDefaults(),{detune:0,onsilence:ms,portamento:0})}triggerAttack(t,e,n=1){this.log("triggerAttack",t,e,n);const i=this.toSeconds(e);return this._triggerEnvelopeAttack(i,n),this.setNote(t,i),this}triggerRelease(t){this.log("triggerRelease",t);const e=this.toSeconds(t);return this._triggerEnvelopeRelease(e),this}setNote(t,e){const n=this.toSeconds(e),i=t instanceof Ps?t.toFrequency():t;if(this.portamento>0&&this.getLevelAtTime(n)>.05){const t=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(i,t,n)}else this.frequency.setValueAtTime(i,n);return this}}Fi([Wr(0)],ro.prototype,"portamento",void 0);class oo extends no{constructor(){super(Qi(oo.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="AmplitudeEnvelope",this._gainNode=new Ys({context:this.context,gain:0}),this.output=this._gainNode,this.input=this._gainNode,this._sig.connect(this._gainNode.gain),this.output=this._gainNode,this.input=this._gainNode}dispose(){return super.dispose(),this._gainNode.dispose(),this}}class ao extends ro{constructor(){super(Qi(ao.getDefaults(),arguments)),this.name="Synth";const t=Qi(ao.getDefaults(),arguments);this.oscillator=new Nr(Object.assign({context:this.context,detune:t.detune,onstop:()=>this.onsilence(this)},t.oscillator)),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new oo(Object.assign({context:this.context},t.envelope)),this.oscillator.chain(this.envelope,this.output),ds(this,["oscillator","frequency","detune","envelope"])}static getDefaults(){return Object.assign(ro.getDefaults(),{envelope:Object.assign($i(no.getDefaults(),Object.keys(Bs.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign($i(Nr.getDefaults(),[...Object.keys(gr.getDefaults()),"frequency","detune"]),{type:"triangle"})})}_triggerEnvelopeAttack(t,e){if(this.envelope.triggerAttack(t,e),this.oscillator.start(t),0===this.envelope.sustain){const e=this.toSeconds(this.envelope.attack),n=this.toSeconds(this.envelope.decay);this.oscillator.stop(t+e+n)}}_triggerEnvelopeRelease(t){this.envelope.triggerRelease(t),this.oscillator.stop(t+this.toSeconds(this.envelope.release))}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this}}class co extends ro{constructor(){super(Qi(co.getDefaults(),arguments)),this.name="ModulationSynth";const t=Qi(co.getDefaults(),arguments);this._carrier=new ao({context:this.context,oscillator:t.oscillator,envelope:t.envelope,onsilence:()=>this.onsilence(this),volume:-10}),this._modulator=new ao({context:this.context,oscillator:t.modulation,envelope:t.modulationEnvelope,volume:-10}),this.oscillator=this._carrier.oscillator,this.envelope=this._carrier.envelope,this.modulation=this._modulator.oscillator,this.modulationEnvelope=this._modulator.envelope,this.frequency=new Qs({context:this.context,units:"frequency"}),this.detune=new Qs({context:this.context,value:t.detune,units:"cents"}),this.harmonicity=new Dr({context:this.context,value:t.harmonicity,minValue:0}),this._modulationNode=new Ys({context:this.context,gain:0}),ds(this,["frequency","harmonicity","oscillator","envelope","modulation","modulationEnvelope","detune"])}static getDefaults(){return Object.assign(ro.getDefaults(),{harmonicity:3,oscillator:Object.assign($i(Nr.getDefaults(),[...Object.keys(gr.getDefaults()),"frequency","detune"]),{type:"sine"}),envelope:Object.assign($i(no.getDefaults(),Object.keys(Bs.getDefaults())),{attack:.01,decay:.01,sustain:1,release:.5}),modulation:Object.assign($i(Nr.getDefaults(),[...Object.keys(gr.getDefaults()),"frequency","detune"]),{type:"square"}),modulationEnvelope:Object.assign($i(no.getDefaults(),Object.keys(Bs.getDefaults())),{attack:.5,decay:0,sustain:1,release:.5})})}_triggerEnvelopeAttack(t,e){this._carrier._triggerEnvelopeAttack(t,e),this._modulator._triggerEnvelopeAttack(t,e)}_triggerEnvelopeRelease(t){return this._carrier._triggerEnvelopeRelease(t),this._modulator._triggerEnvelopeRelease(t),this}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}dispose(){return super.dispose(),this._carrier.dispose(),this._modulator.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._modulationNode.dispose(),this}}class uo extends co{constructor(){super(Qi(uo.getDefaults(),arguments)),this.name="AMSynth",this._modulationScale=new Ar({context:this.context}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.detune.fan(this._carrier.detune,this._modulator.detune),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output)}dispose(){return super.dispose(),this._modulationScale.dispose(),this}}class lo extends Bs{constructor(){super(Qi(lo.getDefaults(),arguments,["frequency","type"])),this.name="BiquadFilter";const t=Qi(lo.getDefaults(),arguments,["frequency","type"]);this._filter=this.context.createBiquadFilter(),this.input=this.output=this._filter,this.Q=new zs({context:this.context,units:"number",value:t.Q,param:this._filter.Q}),this.frequency=new zs({context:this.context,units:"frequency",value:t.frequency,param:this._filter.frequency}),this.detune=new zs({context:this.context,units:"cents",value:t.detune,param:this._filter.detune}),this.gain=new zs({context:this.context,units:"decibels",convert:!1,value:t.gain,param:this._filter.gain}),this.type=t.type}static getDefaults(){return Object.assign(Bs.getDefaults(),{Q:1,type:"lowpass",frequency:350,detune:0,gain:0})}get type(){return this._filter.type}set type(t){xi(-1!==["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(t),`Invalid filter type: ${t}`),this._filter.type=t}getFrequencyResponse(t=128){const e=new Float32Array(t);for(let n=0;n<t;n++){const i=19980*Math.pow(n/t,2)+20;e[n]=i}const n=new Float32Array(t),i=new Float32Array(t),s=this.context.createBiquadFilter();return s.type=this.type,s.Q.value=this.Q.value,s.frequency.value=this.frequency.value,s.gain.value=this.gain.value,s.getFrequencyResponse(e,n,i),n}dispose(){return super.dispose(),this._filter.disconnect(),this.Q.dispose(),this.frequency.dispose(),this.gain.dispose(),this.detune.dispose(),this}}class ho extends Bs{constructor(){super(Qi(ho.getDefaults(),arguments,["frequency","type","rolloff"])),this.name="Filter",this.input=new Ys({context:this.context}),this.output=new Ys({context:this.context}),this._filters=[];const t=Qi(ho.getDefaults(),arguments,["frequency","type","rolloff"]);this._filters=[],this.Q=new Qs({context:this.context,units:"positive",value:t.Q}),this.frequency=new Qs({context:this.context,units:"frequency",value:t.frequency}),this.detune=new Qs({context:this.context,units:"cents",value:t.detune}),this.gain=new Qs({context:this.context,units:"decibels",convert:!1,value:t.gain}),this._type=t.type,this.rolloff=t.rolloff,ds(this,["detune","frequency","gain","Q"])}static getDefaults(){return Object.assign(Bs.getDefaults(),{Q:1,detune:0,frequency:350,gain:0,rolloff:-12,type:"lowpass"})}get type(){return this._type}set type(t){xi(-1!==["lowpass","highpass","bandpass","lowshelf","highshelf","notch","allpass","peaking"].indexOf(t),`Invalid filter type: ${t}`),this._type=t,this._filters.forEach((e=>e.type=t))}get rolloff(){return this._rolloff}set rolloff(t){const e=Mi(t)?t:parseInt(t,10),n=[-12,-24,-48,-96];let i=n.indexOf(e);xi(-1!==i,`rolloff can only be ${n.join(", ")}`),i+=1,this._rolloff=e,this.input.disconnect(),this._filters.forEach((t=>t.disconnect())),this._filters=new Array(i);for(let t=0;t<i;t++){const e=new lo({context:this.context});e.type=this._type,this.frequency.connect(e.frequency),this.detune.connect(e.detune),this.Q.connect(e.Q),this.gain.connect(e.gain),this._filters[t]=e}this._internalChannels=this._filters,Ws(this.input,...this._internalChannels,this.output)}getFrequencyResponse(t=128){const e=new lo({frequency:this.frequency.value,gain:this.gain.value,Q:this.Q.value,type:this._type,detune:this.detune.value}),n=new Float32Array(t).map((()=>1));return this._filters.forEach((()=>{e.getFrequencyResponse(t).forEach(((t,e)=>n[e]*=t))})),e.dispose(),n}dispose(){return super.dispose(),this._filters.forEach((t=>{t.dispose()})),fs(this,["detune","frequency","gain","Q"]),this.frequency.dispose(),this.Q.dispose(),this.detune.dispose(),this.gain.dispose(),this}}class po extends no{constructor(){super(Qi(po.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="FrequencyEnvelope";const t=Qi(po.getDefaults(),arguments,["attack","decay","sustain","release"]);this._octaves=t.octaves,this._baseFrequency=this.toFrequency(t.baseFrequency),this._exponent=this.input=new Jr({context:this.context,value:t.exponent}),this._scale=this.output=new Fr({context:this.context,min:this._baseFrequency,max:this._baseFrequency*Math.pow(2,this._octaves)}),this._sig.chain(this._exponent,this._scale)}static getDefaults(){return Object.assign(no.getDefaults(),{baseFrequency:200,exponent:1,octaves:4})}get baseFrequency(){return this._baseFrequency}set baseFrequency(t){const e=this.toFrequency(t);wi(e,0),this._baseFrequency=e,this._scale.min=this._baseFrequency,this.octaves=this._octaves}get octaves(){return this._octaves}set octaves(t){this._octaves=t,this._scale.max=this._baseFrequency*Math.pow(2,t)}get exponent(){return this._exponent.value}set exponent(t){this._exponent.value=t}dispose(){return super.dispose(),this._exponent.dispose(),this._scale.dispose(),this}}class fo extends ro{constructor(){super(Qi(fo.getDefaults(),arguments)),this.name="MonoSynth";const t=Qi(fo.getDefaults(),arguments);this.oscillator=new Nr(Object.assign(t.oscillator,{context:this.context,detune:t.detune,onstop:()=>this.onsilence(this)})),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.filter=new ho(Object.assign(t.filter,{context:this.context})),this.filterEnvelope=new po(Object.assign(t.filterEnvelope,{context:this.context})),this.envelope=new oo(Object.assign(t.envelope,{context:this.context})),this.oscillator.chain(this.filter,this.envelope,this.output),this.filterEnvelope.connect(this.filter.frequency),ds(this,["oscillator","frequency","detune","filter","filterEnvelope","envelope"])}static getDefaults(){return Object.assign(ro.getDefaults(),{envelope:Object.assign($i(no.getDefaults(),Object.keys(Bs.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.9}),filter:Object.assign($i(ho.getDefaults(),Object.keys(Bs.getDefaults())),{Q:1,rolloff:-12,type:"lowpass"}),filterEnvelope:Object.assign($i(po.getDefaults(),Object.keys(Bs.getDefaults())),{attack:.6,baseFrequency:200,decay:.2,exponent:2,octaves:3,release:2,sustain:.5}),oscillator:Object.assign($i(Nr.getDefaults(),Object.keys(gr.getDefaults())),{type:"sawtooth"})})}_triggerEnvelopeAttack(t,e=1){if(this.envelope.triggerAttack(t,e),this.filterEnvelope.triggerAttack(t),this.oscillator.start(t),0===this.envelope.sustain){const e=this.toSeconds(this.envelope.attack),n=this.toSeconds(this.envelope.decay);this.oscillator.stop(t+e+n)}}_triggerEnvelopeRelease(t){this.envelope.triggerRelease(t),this.filterEnvelope.triggerRelease(t),this.oscillator.stop(t+this.toSeconds(this.envelope.release))}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this.filterEnvelope.dispose(),this.filter.dispose(),this}}class mo extends ro{constructor(){super(Qi(mo.getDefaults(),arguments)),this.name="DuoSynth";const t=Qi(mo.getDefaults(),arguments);this.voice0=new fo(Object.assign(t.voice0,{context:this.context,onsilence:()=>this.onsilence(this)})),this.voice1=new fo(Object.assign(t.voice1,{context:this.context})),this.harmonicity=new Dr({context:this.context,units:"positive",value:t.harmonicity}),this._vibrato=new zr({frequency:t.vibratoRate,context:this.context,min:-50,max:50}),this._vibrato.start(),this.vibratoRate=this._vibrato.frequency,this._vibratoGain=new Ys({context:this.context,units:"normalRange",gain:t.vibratoAmount}),this.vibratoAmount=this._vibratoGain.gain,this.frequency=new Qs({context:this.context,units:"frequency",value:440}),this.detune=new Qs({context:this.context,units:"cents",value:t.detune}),this.frequency.connect(this.voice0.frequency),this.frequency.chain(this.harmonicity,this.voice1.frequency),this._vibrato.connect(this._vibratoGain),this._vibratoGain.fan(this.voice0.detune,this.voice1.detune),this.detune.fan(this.voice0.detune,this.voice1.detune),this.voice0.connect(this.output),this.voice1.connect(this.output),ds(this,["voice0","voice1","frequency","vibratoAmount","vibratoRate"])}getLevelAtTime(t){return t=this.toSeconds(t),this.voice0.envelope.getValueAtTime(t)+this.voice1.envelope.getValueAtTime(t)}static getDefaults(){return Xi(ro.getDefaults(),{vibratoAmount:.5,vibratoRate:5,harmonicity:1.5,voice0:Xi($i(fo.getDefaults(),Object.keys(ro.getDefaults())),{filterEnvelope:{attack:.01,decay:0,sustain:1,release:.5},envelope:{attack:.01,decay:0,sustain:1,release:.5}}),voice1:Xi($i(fo.getDefaults(),Object.keys(ro.getDefaults())),{filterEnvelope:{attack:.01,decay:0,sustain:1,release:.5},envelope:{attack:.01,decay:0,sustain:1,release:.5}})})}_triggerEnvelopeAttack(t,e){this.voice0._triggerEnvelopeAttack(t,e),this.voice1._triggerEnvelopeAttack(t,e)}_triggerEnvelopeRelease(t){return this.voice0._triggerEnvelopeRelease(t),this.voice1._triggerEnvelopeRelease(t),this}dispose(){return super.dispose(),this.voice0.dispose(),this.voice1.dispose(),this.frequency.dispose(),this.detune.dispose(),this._vibrato.dispose(),this.vibratoRate.dispose(),this._vibratoGain.dispose(),this.harmonicity.dispose(),this}}class vo extends co{constructor(){super(Qi(vo.getDefaults(),arguments)),this.name="FMSynth";const t=Qi(vo.getDefaults(),arguments);this.modulationIndex=new Dr({context:this.context,value:t.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this.detune.fan(this._carrier.detune,this._modulator.detune),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output)}static getDefaults(){return Object.assign(co.getDefaults(),{modulationIndex:10})}dispose(){return super.dispose(),this.modulationIndex.dispose(),this}}const go=[1,1.483,1.932,2.546,2.63,3.897];class yo extends ro{constructor(){super(Qi(yo.getDefaults(),arguments)),this.name="MetalSynth",this._oscillators=[],this._freqMultipliers=[];const t=Qi(yo.getDefaults(),arguments);this.detune=new Qs({context:this.context,units:"cents",value:t.detune}),this.frequency=new Qs({context:this.context,units:"frequency"}),this._amplitude=new Ys({context:this.context,gain:0}).connect(this.output),this._highpass=new ho({Q:0,context:this.context,type:"highpass"}).connect(this._amplitude);for(let e=0;e<go.length;e++){const n=new Ir({context:this.context,harmonicity:t.harmonicity,modulationIndex:t.modulationIndex,modulationType:"square",onstop:0===e?()=>this.onsilence(this):ms,type:"square"});n.connect(this._highpass),this._oscillators[e]=n;const i=new Dr({context:this.context,value:go[e]});this._freqMultipliers[e]=i,this.frequency.chain(i,n.frequency),this.detune.connect(n.detune)}this._filterFreqScaler=new Fr({context:this.context,max:7e3,min:this.toFrequency(t.resonance)}),this.envelope=new no({attack:t.envelope.attack,attackCurve:"linear",context:this.context,decay:t.envelope.decay,release:t.envelope.release,sustain:0}),this.envelope.chain(this._filterFreqScaler,this._highpass.frequency),this.envelope.connect(this._amplitude.gain),this._octaves=t.octaves,this.octaves=t.octaves}static getDefaults(){return Xi(ro.getDefaults(),{envelope:Object.assign($i(no.getDefaults(),Object.keys(Bs.getDefaults())),{attack:.001,decay:1.4,release:.2}),harmonicity:5.1,modulationIndex:32,octaves:1.5,resonance:4e3})}_triggerEnvelopeAttack(t,e=1){return this.envelope.triggerAttack(t,e),this._oscillators.forEach((e=>e.start(t))),0===this.envelope.sustain&&this._oscillators.forEach((e=>{e.stop(t+this.toSeconds(this.envelope.attack)+this.toSeconds(this.envelope.decay))})),this}_triggerEnvelopeRelease(t){return this.envelope.triggerRelease(t),this._oscillators.forEach((e=>e.stop(t+this.toSeconds(this.envelope.release)))),this}getLevelAtTime(t){return t=this.toSeconds(t),this.envelope.getValueAtTime(t)}get modulationIndex(){return this._oscillators[0].modulationIndex.value}set modulationIndex(t){this._oscillators.forEach((e=>e.modulationIndex.value=t))}get harmonicity(){return this._oscillators[0].harmonicity.value}set harmonicity(t){this._oscillators.forEach((e=>e.harmonicity.value=t))}get resonance(){return this._filterFreqScaler.min}set resonance(t){this._filterFreqScaler.min=this.toFrequency(t),this.octaves=this._octaves}get octaves(){return this._octaves}set octaves(t){this._octaves=t,this._filterFreqScaler.max=this._filterFreqScaler.min*Math.pow(2,t)}dispose(){return super.dispose(),this._oscillators.forEach((t=>t.dispose())),this._freqMultipliers.forEach((t=>t.dispose())),this.frequency.dispose(),this.detune.dispose(),this._filterFreqScaler.dispose(),this._amplitude.dispose(),this.envelope.dispose(),this._highpass.dispose(),this}}class _o extends ao{constructor(){super(Qi(_o.getDefaults(),arguments)),this.name="MembraneSynth",this.portamento=0;const t=Qi(_o.getDefaults(),arguments);this.pitchDecay=t.pitchDecay,this.octaves=t.octaves,ds(this,["oscillator","envelope"])}static getDefaults(){return Xi(ro.getDefaults(),ao.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05})}setNote(t,e){const n=this.toSeconds(e),i=this.toFrequency(t instanceof Ps?t.toFrequency():t),s=i*this.octaves;return this.oscillator.frequency.setValueAtTime(s,n),this.oscillator.frequency.exponentialRampToValueAtTime(i,n+this.toSeconds(this.pitchDecay)),this}dispose(){return super.dispose(),this}}Fi([Br(0)],_o.prototype,"octaves",void 0),Fi([Wr(0)],_o.prototype,"pitchDecay",void 0);class bo extends so{constructor(){super(Qi(bo.getDefaults(),arguments)),this.name="NoiseSynth";const t=Qi(bo.getDefaults(),arguments);this.noise=new _r(Object.assign({context:this.context},t.noise)),this.envelope=new oo(Object.assign({context:this.context},t.envelope)),this.noise.chain(this.envelope,this.output)}static getDefaults(){return Object.assign(so.getDefaults(),{envelope:Object.assign($i(no.getDefaults(),Object.keys(Bs.getDefaults())),{decay:.1,sustain:0}),noise:Object.assign($i(_r.getDefaults(),Object.keys(gr.getDefaults())),{type:"white"})})}triggerAttack(t,e=1){return t=this.toSeconds(t),this.envelope.triggerAttack(t,e),this.noise.start(t),0===this.envelope.sustain&&this.noise.stop(t+this.toSeconds(this.envelope.attack)+this.toSeconds(this.envelope.decay)),this}triggerRelease(t){return t=this.toSeconds(t),this.envelope.triggerRelease(t),this.noise.stop(t+this.toSeconds(this.envelope.release)),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",0),this._syncMethod("triggerRelease",0)),this}triggerAttackRelease(t,e,n=1){return e=this.toSeconds(e),t=this.toSeconds(t),this.triggerAttack(e,n),this.triggerRelease(e+t),this}dispose(){return super.dispose(),this.noise.dispose(),this.envelope.dispose(),this}}const xo=new Set;function wo(t){xo.add(t)}function To(t,e){const n=`registerProcessor("${t}", ${e})`;xo.add(n)}class So extends Bs{constructor(t){super(t),this.name="ToneAudioWorklet",this.workletOptions={},this.onprocessorerror=ms;const e=URL.createObjectURL(new Blob([Array.from(xo).join("\n")],{type:"text/javascript"})),n=this._audioWorkletName();this._dummyGain=this.context.createGain(),this._dummyParam=this._dummyGain.gain,this.context.addAudioWorkletModule(e,n).then((()=>{this.disposed||(this._worklet=this.context.createAudioWorkletNode(n,this.workletOptions),this._worklet.onprocessorerror=this.onprocessorerror.bind(this),this.onReady(this._worklet))}))}dispose(){return super.dispose(),this._dummyGain.disconnect(),this._worklet&&(this._worklet.port.postMessage("dispose"),this._worklet.disconnect()),this}}wo('\n\t/**\n\t * The base AudioWorkletProcessor for use in Tone.js. Works with the [[ToneAudioWorklet]]. \n\t */\n\tclass ToneAudioWorkletProcessor extends AudioWorkletProcessor {\n\n\t\tconstructor(options) {\n\t\t\t\n\t\t\tsuper(options);\n\t\t\t/**\n\t\t\t * If the processor was disposed or not. Keep alive until it\'s disposed.\n\t\t\t */\n\t\t\tthis.disposed = false;\n\t\t   \t/** \n\t\t\t * The number of samples in the processing block\n\t\t\t */\n\t\t\tthis.blockSize = 128;\n\t\t\t/**\n\t\t\t * the sample rate\n\t\t\t */\n\t\t\tthis.sampleRate = sampleRate;\n\n\t\t\tthis.port.onmessage = (event) => {\n\t\t\t\t// when it receives a dispose \n\t\t\t\tif (event.data === "dispose") {\n\t\t\t\t\tthis.disposed = true;\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t}\n'),wo("\n\t/**\n\t * Abstract class for a single input/output processor. \n\t * has a 'generate' function which processes one sample at a time\n\t */\n\tclass SingleIOProcessor extends ToneAudioWorkletProcessor {\n\n\t\tconstructor(options) {\n\t\t\tsuper(Object.assign(options, {\n\t\t\t\tnumberOfInputs: 1,\n\t\t\t\tnumberOfOutputs: 1\n\t\t\t}));\n\t\t\t/**\n\t\t\t * Holds the name of the parameter and a single value of that\n\t\t\t * parameter at the current sample\n\t\t\t * @type { [name: string]: number }\n\t\t\t */\n\t\t\tthis.params = {}\n\t\t}\n\n\t\t/**\n\t\t * Generate an output sample from the input sample and parameters\n\t\t * @abstract\n\t\t * @param input number\n\t\t * @param channel number\n\t\t * @param parameters { [name: string]: number }\n\t\t * @returns number\n\t\t */\n\t\tgenerate(){}\n\n\t\t/**\n\t\t * Update the private params object with the \n\t\t * values of the parameters at the given index\n\t\t * @param parameters { [name: string]: Float32Array },\n\t\t * @param index number\n\t\t */\n\t\tupdateParams(parameters, index) {\n\t\t\tfor (const paramName in parameters) {\n\t\t\t\tconst param = parameters[paramName];\n\t\t\t\tif (param.length > 1) {\n\t\t\t\t\tthis.params[paramName] = parameters[paramName][index];\n\t\t\t\t} else {\n\t\t\t\t\tthis.params[paramName] = parameters[paramName][0];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Process a single frame of the audio\n\t\t * @param inputs Float32Array[][]\n\t\t * @param outputs Float32Array[][]\n\t\t */\n\t\tprocess(inputs, outputs, parameters) {\n\t\t\tconst input = inputs[0];\n\t\t\tconst output = outputs[0];\n\t\t\t// get the parameter values\n\t\t\tconst channelCount = Math.max(input && input.length || 0, output.length);\n\t\t\tfor (let sample = 0; sample < this.blockSize; sample++) {\n\t\t\t\tthis.updateParams(parameters, sample);\n\t\t\t\tfor (let channel = 0; channel < channelCount; channel++) {\n\t\t\t\t\tconst inputSample = input && input.length ? input[channel][sample] : 0;\n\t\t\t\t\toutput[channel][sample] = this.generate(inputSample, channel, this.params);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn !this.disposed;\n\t\t}\n\t};\n"),wo("\n\t/**\n\t * A multichannel buffer for use within an AudioWorkletProcessor as a delay line\n\t */\n\tclass DelayLine {\n\t\t\n\t\tconstructor(size, channels) {\n\t\t\tthis.buffer = [];\n\t\t\tthis.writeHead = []\n\t\t\tthis.size = size;\n\n\t\t\t// create the empty channels\n\t\t\tfor (let i = 0; i < channels; i++) {\n\t\t\t\tthis.buffer[i] = new Float32Array(this.size);\n\t\t\t\tthis.writeHead[i] = 0;\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Push a value onto the end\n\t\t * @param channel number\n\t\t * @param value number\n\t\t */\n\t\tpush(channel, value) {\n\t\t\tthis.writeHead[channel] += 1;\n\t\t\tif (this.writeHead[channel] > this.size) {\n\t\t\t\tthis.writeHead[channel] = 0;\n\t\t\t}\n\t\t\tthis.buffer[channel][this.writeHead[channel]] = value;\n\t\t}\n\n\t\t/**\n\t\t * Get the recorded value of the channel given the delay\n\t\t * @param channel number\n\t\t * @param delay number delay samples\n\t\t */\n\t\tget(channel, delay) {\n\t\t\tlet readHead = this.writeHead[channel] - Math.floor(delay);\n\t\t\tif (readHead < 0) {\n\t\t\t\treadHead += this.size;\n\t\t\t}\n\t\t\treturn this.buffer[channel][readHead];\n\t\t}\n\t}\n");const ko="feedback-comb-filter";To(ko,'\n\tclass FeedbackCombFilterWorklet extends SingleIOProcessor {\n\n\t\tconstructor(options) {\n\t\t\tsuper(options);\n\t\t\tthis.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);\n\t\t}\n\n\t\tstatic get parameterDescriptors() {\n\t\t\treturn [{\n\t\t\t\tname: "delayTime",\n\t\t\t\tdefaultValue: 0.1,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 1,\n\t\t\t\tautomationRate: "k-rate"\n\t\t\t}, {\n\t\t\t\tname: "feedback",\n\t\t\t\tdefaultValue: 0.5,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 0.9999,\n\t\t\t\tautomationRate: "k-rate"\n\t\t\t}];\n\t\t}\n\n\t\tgenerate(input, channel, parameters) {\n\t\t\tconst delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);\n\t\t\tthis.delayLine.push(channel, input + delayedSample * parameters.feedback);\n\t\t\treturn delayedSample;\n\t\t}\n\t}\n');class Oo extends So{constructor(){super(Qi(Oo.getDefaults(),arguments,["delayTime","resonance"])),this.name="FeedbackCombFilter";const t=Qi(Oo.getDefaults(),arguments,["delayTime","resonance"]);this.input=new Ys({context:this.context}),this.output=new Ys({context:this.context}),this.delayTime=new zs({context:this.context,value:t.delayTime,units:"time",minValue:0,maxValue:1,param:this._dummyParam,swappable:!0}),this.resonance=new zs({context:this.context,value:t.resonance,units:"normalRange",param:this._dummyParam,swappable:!0}),ds(this,["resonance","delayTime"])}_audioWorkletName(){return ko}static getDefaults(){return Object.assign(Bs.getDefaults(),{delayTime:.1,resonance:.5})}onReady(t){Ws(this.input,t,this.output);const e=t.parameters.get("delayTime");this.delayTime.setParam(e);const n=t.parameters.get("feedback");this.resonance.setParam(n)}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this.delayTime.dispose(),this.resonance.dispose(),this}}class Eo extends Bs{constructor(){super(Qi(Eo.getDefaults(),arguments,["frequency","type"])),this.name="OnePoleFilter";const t=Qi(Eo.getDefaults(),arguments,["frequency","type"]);this._frequency=t.frequency,this._type=t.type,this.input=new Ys({context:this.context}),this.output=new Ys({context:this.context}),this._createFilter()}static getDefaults(){return Object.assign(Bs.getDefaults(),{frequency:880,type:"lowpass"})}_createFilter(){const t=this._filter,e=this.toFrequency(this._frequency),n=1/(2*Math.PI*e);if("lowpass"===this._type){const t=1/(n*this.context.sampleRate),e=t-1;this._filter=this.context.createIIRFilter([t,0],[1,e])}else{const t=1/(n*this.context.sampleRate)-1;this._filter=this.context.createIIRFilter([1,-1],[1,t])}this.input.chain(this._filter,this.output),t&&this.context.setTimeout((()=>{this.disposed||(this.input.disconnect(t),t.disconnect())}),this.blockTime)}get frequency(){return this._frequency}set frequency(t){this._frequency=t,this._createFilter()}get type(){return this._type}set type(t){this._type=t,this._createFilter()}getFrequencyResponse(t=128){const e=new Float32Array(t);for(let n=0;n<t;n++){const i=19980*Math.pow(n/t,2)+20;e[n]=i}const n=new Float32Array(t),i=new Float32Array(t);return this._filter.getFrequencyResponse(e,n,i),n}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this._filter.disconnect(),this}}class Co extends Bs{constructor(){super(Qi(Co.getDefaults(),arguments,["delayTime","resonance","dampening"])),this.name="LowpassCombFilter";const t=Qi(Co.getDefaults(),arguments,["delayTime","resonance","dampening"]);this._combFilter=this.output=new Oo({context:this.context,delayTime:t.delayTime,resonance:t.resonance}),this.delayTime=this._combFilter.delayTime,this.resonance=this._combFilter.resonance,this._lowpass=this.input=new Eo({context:this.context,frequency:t.dampening,type:"lowpass"}),this._lowpass.connect(this._combFilter)}static getDefaults(){return Object.assign(Bs.getDefaults(),{dampening:3e3,delayTime:.1,resonance:.5})}get dampening(){return this._lowpass.frequency}set dampening(t){this._lowpass.frequency=t}dispose(){return super.dispose(),this._combFilter.dispose(),this._lowpass.dispose(),this}}class Ao extends so{constructor(){super(Qi(Ao.getDefaults(),arguments)),this.name="PluckSynth";const t=Qi(Ao.getDefaults(),arguments);this._noise=new _r({context:this.context,type:"pink"}),this.attackNoise=t.attackNoise,this._lfcf=new Co({context:this.context,dampening:t.dampening,resonance:t.resonance}),this.resonance=t.resonance,this.release=t.release,this._noise.connect(this._lfcf),this._lfcf.connect(this.output)}static getDefaults(){return Xi(so.getDefaults(),{attackNoise:1,dampening:4e3,resonance:.7,release:1})}get dampening(){return this._lfcf.dampening}set dampening(t){this._lfcf.dampening=t}triggerAttack(t,e){const n=this.toFrequency(t);e=this.toSeconds(e);const i=1/n;return this._lfcf.delayTime.setValueAtTime(i,e),this._noise.start(e),this._noise.stop(e+i*this.attackNoise),this._lfcf.resonance.cancelScheduledValues(e),this._lfcf.resonance.setValueAtTime(this.resonance,e),this}triggerRelease(t){return this._lfcf.resonance.linearRampTo(0,this.release,t),this}dispose(){return super.dispose(),this._noise.dispose(),this._lfcf.dispose(),this}}class Do extends so{constructor(){super(Qi(Do.getDefaults(),arguments,["voice","options"])),this.name="PolySynth",this._availableVoices=[],this._activeVoices=[],this._voices=[],this._gcTimeout=-1,this._averageActiveVoices=0;const t=Qi(Do.getDefaults(),arguments,["voice","options"]);xi(!Mi(t.voice),"DEPRECATED: The polyphony count is no longer the first argument.");const e=t.voice.getDefaults();this.options=Object.assign(e,t.options),this.voice=t.voice,this.maxPolyphony=t.maxPolyphony,this._dummyVoice=this._getNextAvailableVoice();const n=this._voices.indexOf(this._dummyVoice);this._voices.splice(n,1),this._gcTimeout=this.context.setInterval(this._collectGarbage.bind(this),1)}static getDefaults(){return Object.assign(so.getDefaults(),{maxPolyphony:32,options:{},voice:ao})}get activeVoices(){return this._activeVoices.length}_makeVoiceAvailable(t){this._availableVoices.push(t);const e=this._activeVoices.findIndex((e=>e.voice===t));this._activeVoices.splice(e,1)}_getNextAvailableVoice(){if(this._availableVoices.length)return this._availableVoices.shift();if(this._voices.length<this.maxPolyphony){const t=new this.voice(Object.assign(this.options,{context:this.context,onsilence:this._makeVoiceAvailable.bind(this)}));return t.connect(this.output),this._voices.push(t),t}Ei("Max polyphony exceeded. Note dropped.")}_collectGarbage(){if(this._averageActiveVoices=Math.max(.95*this._averageActiveVoices,this.activeVoices),this._availableVoices.length&&this._voices.length>Math.ceil(this._averageActiveVoices+1)){const t=this._availableVoices.shift(),e=this._voices.indexOf(t);this._voices.splice(e,1),this.context.isOffline||t.dispose()}}_triggerAttack(t,e,n){t.forEach((t=>{const i=new sr(this.context,t).toMidi(),s=this._getNextAvailableVoice();s&&(s.triggerAttack(t,e,n),this._activeVoices.push({midi:i,voice:s,released:!1}),this.log("triggerAttack",t,e))}))}_triggerRelease(t,e){t.forEach((t=>{const n=new sr(this.context,t).toMidi(),i=this._activeVoices.find((({midi:t,released:e})=>t===n&&!e));i&&(i.voice.triggerRelease(e),i.released=!0,this.log("triggerRelease",t,e))}))}_scheduleEvent(t,e,n,i){xi(!this.disposed,"Synth was already disposed"),n<=this.now()?"attack"===t?this._triggerAttack(e,n,i):this._triggerRelease(e,n):this.context.setTimeout((()=>{this._scheduleEvent(t,e,n,i)}),n-this.now())}triggerAttack(t,e,n){Array.isArray(t)||(t=[t]);const i=this.toSeconds(e);return this._scheduleEvent("attack",t,i,n),this}triggerRelease(t,e){Array.isArray(t)||(t=[t]);const n=this.toSeconds(e);return this._scheduleEvent("release",t,n),this}triggerAttackRelease(t,e,n,i){const s=this.toSeconds(n);if(this.triggerAttack(t,s,i),Ri(e)){xi(Ri(t),"If the duration is an array, the notes must also be an array"),t=t;for(let n=0;n<t.length;n++){const i=e[Math.min(n,e.length-1)],r=this.toSeconds(i);xi(r>0,"The duration must be greater than 0"),this.triggerRelease(t[n],s+r)}}else{const n=this.toSeconds(e);xi(n>0,"The duration must be greater than 0"),this.triggerRelease(t,s+n)}return this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}set(t){const e=$i(t,["onsilence","context"]);return this.options=Xi(this.options,e),this._voices.forEach((t=>t.set(e))),this._dummyVoice.set(e),this}get(){return this._dummyVoice.get()}releaseAll(t){const e=this.toSeconds(t);return this._activeVoices.forEach((({voice:t})=>{t.triggerRelease(e)})),this}dispose(){return super.dispose(),this._dummyVoice.dispose(),this._voices.forEach((t=>t.dispose())),this._activeVoices=[],this._availableVoices=[],this.context.clearInterval(this._gcTimeout),this}}class Mo extends so{constructor(){super(Qi(Mo.getDefaults(),arguments,["urls","onload","baseUrl"],"urls")),this.name="Sampler",this._activeSources=new Map;const t=Qi(Mo.getDefaults(),arguments,["urls","onload","baseUrl"],"urls"),e={};Object.keys(t.urls).forEach((n=>{const i=parseInt(n,10);if(xi(qi(n)||Mi(i)&&isFinite(i),`url key is neither a note or midi pitch: ${n}`),qi(n)){const i=new Ps(this.context,n).toMidi();e[i]=t.urls[n]}else Mi(i)&&isFinite(i)&&(e[i]=t.urls[i])})),this._buffers=new ir({urls:e,onload:t.onload,baseUrl:t.baseUrl,onerror:t.onerror}),this.attack=t.attack,this.release=t.release,this.curve=t.curve,this._buffers.loaded&&Promise.resolve().then(t.onload)}static getDefaults(){return Object.assign(so.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:ms,onerror:ms,release:.1,urls:{}})}_findClosest(t){let e=0;for(;e<96;){if(this._buffers.has(t+e))return-e;if(this._buffers.has(t-e))return e;e++}throw new Error(`No available buffers for note: ${t}`)}triggerAttack(t,e,n=1){return this.log("triggerAttack",t,e,n),Array.isArray(t)||(t=[t]),t.forEach((t=>{const i=Cs(new Ps(this.context,t).toFrequency()),s=Math.round(i),r=i-s,o=this._findClosest(s),a=s-o,c=this._buffers.get(a),u=ks(o+r),l=new yr({url:c,context:this.context,curve:this.curve,fadeIn:this.attack,fadeOut:this.release,playbackRate:u}).connect(this.output);l.start(e,0,c.duration/u,n),Ri(this._activeSources.get(s))||this._activeSources.set(s,[]),this._activeSources.get(s).push(l),l.onended=()=>{if(this._activeSources&&this._activeSources.has(s)){const t=this._activeSources.get(s),e=t.indexOf(l);-1!==e&&t.splice(e,1)}}})),this}triggerRelease(t,e){return this.log("triggerRelease",t,e),Array.isArray(t)||(t=[t]),t.forEach((t=>{const n=new Ps(this.context,t).toMidi();if(this._activeSources.has(n)&&this._activeSources.get(n).length){const t=this._activeSources.get(n);e=this.toSeconds(e),t.forEach((t=>{t.stop(e)})),this._activeSources.set(n,[])}})),this}releaseAll(t){const e=this.toSeconds(t);return this._activeSources.forEach((t=>{for(;t.length;)t.shift().stop(e)})),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}triggerAttackRelease(t,e,n,i=1){const s=this.toSeconds(n);return this.triggerAttack(t,s,i),Ri(e)?(xi(Ri(t),"notes must be an array when duration is array"),t.forEach(((t,n)=>{const i=e[Math.min(n,e.length-1)];this.triggerRelease(t,s+this.toSeconds(i))}))):this.triggerRelease(t,s+this.toSeconds(e)),this}add(t,e,n){if(xi(qi(t)||isFinite(t),`note must be a pitch or midi: ${t}`),qi(t)){const i=new Ps(this.context,t).toMidi();this._buffers.add(i,e,n)}else this._buffers.add(t,e,n);return this}get loaded(){return this._buffers.loaded}dispose(){return super.dispose(),this._buffers.dispose(),this._activeSources.forEach((t=>{t.forEach((t=>t.dispose()))})),this._activeSources.clear(),this}}Fi([Wr(0)],Mo.prototype,"attack",void 0),Fi([Wr(0)],Mo.prototype,"release",void 0);class Io extends Fs{constructor(){super(Qi(Io.getDefaults(),arguments,["callback","value"])),this.name="ToneEvent",this._state=new Ls("stopped"),this._startOffset=0;const t=Qi(Io.getDefaults(),arguments,["callback","value"]);this._loop=t.loop,this.callback=t.callback,this.value=t.value,this._loopStart=this.toTicks(t.loopStart),this._loopEnd=this.toTicks(t.loopEnd),this._playbackRate=t.playbackRate,this._probability=t.probability,this._humanize=t.humanize,this.mute=t.mute,this._playbackRate=t.playbackRate,this._state.increasing=!0,this._rescheduleEvents()}static getDefaults(){return Object.assign(Fs.getDefaults(),{callback:ms,humanize:!1,loop:!1,loopEnd:"1m",loopStart:0,mute:!1,playbackRate:1,probability:1,value:null})}_rescheduleEvents(t=-1){this._state.forEachFrom(t,(t=>{let e;if("started"===t.state){-1!==t.id&&this.context.transport.clear(t.id);const n=t.time+Math.round(this.startOffset/this._playbackRate);if(!0===this._loop||Mi(this._loop)&&this._loop>1){e=1/0,Mi(this._loop)&&(e=this._loop*this._getLoopDuration());const i=this._state.getAfter(n);null!==i&&(e=Math.min(e,i.time-n)),e!==1/0&&(this._state.setStateAtTime("stopped",n+e+1,{id:-1}),e=new or(this.context,e));const s=new or(this.context,this._getLoopDuration());t.id=this.context.transport.scheduleRepeat(this._tick.bind(this),s,new or(this.context,n),e)}else t.id=this.context.transport.schedule(this._tick.bind(this),new or(this.context,n))}}))}get state(){return this._state.getValueAtTime(this.context.transport.ticks)}get startOffset(){return this._startOffset}set startOffset(t){this._startOffset=t}get probability(){return this._probability}set probability(t){this._probability=t}get humanize(){return this._humanize}set humanize(t){this._humanize=t}start(t){const e=this.toTicks(t);return"stopped"===this._state.getValueAtTime(e)&&(this._state.add({id:-1,state:"started",time:e}),this._rescheduleEvents(e)),this}stop(t){this.cancel(t);const e=this.toTicks(t);if("started"===this._state.getValueAtTime(e)){this._state.setStateAtTime("stopped",e,{id:-1});const t=this._state.getBefore(e);let n=e;null!==t&&(n=t.time),this._rescheduleEvents(n)}return this}cancel(t){t=Hi(t,-1/0);const e=this.toTicks(t);return this._state.forEachFrom(e,(t=>{this.context.transport.clear(t.id)})),this._state.cancel(e),this}_tick(t){const e=this.context.transport.getTicksAtTime(t);if(!this.mute&&"started"===this._state.getValueAtTime(e)){if(this.probability<1&&Math.random()>this.probability)return;if(this.humanize){let e=.02;Pi(this.humanize)||(e=this.toSeconds(this.humanize)),t+=(2*Math.random()-1)*e}this.callback(t,this.value)}}_getLoopDuration(){return Math.round((this._loopEnd-this._loopStart)/this._playbackRate)}get loop(){return this._loop}set loop(t){this._loop=t,this._rescheduleEvents()}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this._rescheduleEvents()}get loopEnd(){return new or(this.context,this._loopEnd).toSeconds()}set loopEnd(t){this._loopEnd=this.toTicks(t),this._loop&&this._rescheduleEvents()}get loopStart(){return new or(this.context,this._loopStart).toSeconds()}set loopStart(t){this._loopStart=this.toTicks(t),this._loop&&this._rescheduleEvents()}get progress(){if(this._loop){const t=this.context.transport.ticks,e=this._state.get(t);if(null!==e&&"started"===e.state){const n=this._getLoopDuration();return(t-e.time)%n/n}return 0}return 0}dispose(){return super.dispose(),this.cancel(),this._state.dispose(),this}}class Po extends Fs{constructor(){super(Qi(Po.getDefaults(),arguments,["callback","interval"])),this.name="Loop";const t=Qi(Po.getDefaults(),arguments,["callback","interval"]);this._event=new Io({context:this.context,callback:this._tick.bind(this),loop:!0,loopEnd:t.interval,playbackRate:t.playbackRate,probability:t.probability}),this.callback=t.callback,this.iterations=t.iterations}static getDefaults(){return Object.assign(Fs.getDefaults(),{interval:"4n",callback:ms,playbackRate:1,iterations:1/0,probability:1,mute:!1,humanize:!1})}start(t){return this._event.start(t),this}stop(t){return this._event.stop(t),this}cancel(t){return this._event.cancel(t),this}_tick(t){this.callback(t)}get state(){return this._event.state}get progress(){return this._event.progress}get interval(){return this._event.loopEnd}set interval(t){this._event.loopEnd=t}get playbackRate(){return this._event.playbackRate}set playbackRate(t){this._event.playbackRate=t}get humanize(){return this._event.humanize}set humanize(t){this._event.humanize=t}get probability(){return this._event.probability}set probability(t){this._event.probability=t}get mute(){return this._event.mute}set mute(t){this._event.mute=t}get iterations(){return!0===this._event.loop?1/0:this._event.loop}set iterations(t){this._event.loop=t===1/0||t}dispose(){return super.dispose(),this._event.dispose(),this}}class Ro extends Io{constructor(){super(Qi(Ro.getDefaults(),arguments,["callback","events"])),this.name="Part",this._state=new Ls("stopped"),this._events=new Set;const t=Qi(Ro.getDefaults(),arguments,["callback","events"]);this._state.increasing=!0,t.events.forEach((t=>{Ri(t)?this.add(t[0],t[1]):this.add(t)}))}static getDefaults(){return Object.assign(Io.getDefaults(),{events:[]})}start(t,e){const n=this.toTicks(t);if("started"!==this._state.getValueAtTime(n)){e=Hi(e,this._loop?this._loopStart:0),e=this._loop?Hi(e,this._loopStart):Hi(e,0);const t=this.toTicks(e);this._state.add({id:-1,offset:t,state:"started",time:n}),this._forEach((e=>{this._startNote(e,n,t)}))}return this}_startNote(t,e,n){e-=n,this._loop?t.startOffset>=this._loopStart&&t.startOffset<this._loopEnd?(t.startOffset<n&&(e+=this._getLoopDuration()),t.start(new or(this.context,e))):t.startOffset<this._loopStart&&t.startOffset>=n&&(t.loop=!1,t.start(new or(this.context,e))):t.startOffset>=n&&t.start(new or(this.context,e))}get startOffset(){return this._startOffset}set startOffset(t){this._startOffset=t,this._forEach((t=>{t.startOffset+=this._startOffset}))}stop(t){const e=this.toTicks(t);return this._state.cancel(e),this._state.setStateAtTime("stopped",e),this._forEach((e=>{e.stop(t)})),this}at(t,e){const n=new Ns(this.context,t).toTicks(),i=new or(this.context,1).toSeconds(),s=this._events.values();let r=s.next();for(;!r.done;){const t=r.value;if(Math.abs(n-t.startOffset)<i)return Ai(e)&&(t.value=e),t;r=s.next()}return Ai(e)?(this.add(t,e),this.at(t)):null}add(t,e){t instanceof Object&&Reflect.has(t,"time")&&(t=(e=t).time);const n=this.toTicks(t);let i;return e instanceof Io?(i=e,i.callback=this._tick.bind(this)):i=new Io({callback:this._tick.bind(this),context:this.context,value:e}),i.startOffset=n,i.set({humanize:this.humanize,loop:this.loop,loopEnd:this.loopEnd,loopStart:this.loopStart,playbackRate:this.playbackRate,probability:this.probability}),this._events.add(i),this._restartEvent(i),this}_restartEvent(t){this._state.forEach((e=>{"started"===e.state?this._startNote(t,e.time,e.offset):t.stop(new or(this.context,e.time))}))}remove(t,e){return Ii(t)&&t.hasOwnProperty("time")&&(t=(e=t).time),t=this.toTicks(t),this._events.forEach((n=>{n.startOffset===t&&(Ci(e)||Ai(e)&&n.value===e)&&(this._events.delete(n),n.dispose())})),this}clear(){return this._forEach((t=>t.dispose())),this._events.clear(),this}cancel(t){return this._forEach((e=>e.cancel(t))),this._state.cancel(this.toTicks(t)),this}_forEach(t){return this._events&&this._events.forEach((e=>{e instanceof Ro?e._forEach(t):t(e)})),this}_setAll(t,e){this._forEach((n=>{n[t]=e}))}_tick(t,e){this.mute||this.callback(t,e)}_testLoopBoundries(t){this._loop&&(t.startOffset<this._loopStart||t.startOffset>=this._loopEnd)?t.cancel(0):"stopped"===t.state&&this._restartEvent(t)}get probability(){return this._probability}set probability(t){this._probability=t,this._setAll("probability",t)}get humanize(){return this._humanize}set humanize(t){this._humanize=t,this._setAll("humanize",t)}get loop(){return this._loop}set loop(t){this._loop=t,this._forEach((e=>{e.loopStart=this.loopStart,e.loopEnd=this.loopEnd,e.loop=t,this._testLoopBoundries(e)}))}get loopEnd(){return new or(this.context,this._loopEnd).toSeconds()}set loopEnd(t){this._loopEnd=this.toTicks(t),this._loop&&this._forEach((e=>{e.loopEnd=t,this._testLoopBoundries(e)}))}get loopStart(){return new or(this.context,this._loopStart).toSeconds()}set loopStart(t){this._loopStart=this.toTicks(t),this._loop&&this._forEach((t=>{t.loopStart=this.loopStart,this._testLoopBoundries(t)}))}get playbackRate(){return this._playbackRate}set playbackRate(t){this._playbackRate=t,this._setAll("playbackRate",t)}get length(){return this._events.size}dispose(){return super.dispose(),this.clear(),this}}function*jo(t){let e=0;for(;e<t.length;)e=Vo(e,t),yield t[e],e++}function*qo(t){let e=t.length-1;for(;e>=0;)e=Vo(e,t),yield t[e],e--}function*No(t,e){for(;;)yield*e(t)}function Vo(t,e){return ss(t,0,e.length-1)}function*Fo(t,e){let n=e?0:t.length-1;for(;;)n=Vo(n,t),yield t[n],e?(n++,n>=t.length-1&&(e=!1)):(n--,n<=0&&(e=!0))}function*Lo(t){let e=0,n=0;for(;e<t.length;)e=Vo(e,t),yield t[e],n++,e+=n%2?2:-1}function*zo(t){let e=t.length-1,n=0;for(;e>=0;)e=Vo(e,t),yield t[e],n++,e+=n%2?-2:1}function*Bo(t){const e=[];for(let n=0;n<t.length;n++)e.push(n);for(;e.length>0;){const n=Vo(e.splice(Math.floor(e.length*Math.random()),1)[0],t);yield t[n]}}function*Wo(t,e="up",n=0){switch(xi(t.length>0,"The array must have more than one value in it"),e){case"up":yield*No(t,jo);case"down":yield*No(t,qo);case"upDown":yield*Fo(t,!0);case"downUp":yield*Fo(t,!1);case"alternateUp":yield*No(t,Lo);case"alternateDown":yield*No(t,zo);case"random":yield*function*(t){for(;;){const e=Math.floor(Math.random()*t.length);yield t[e]}}(t);case"randomOnce":yield*No(t,Bo);case"randomWalk":yield*function*(t){let e=Math.floor(Math.random()*t.length);for(;;)0===e?e++:e===t.length-1||Math.random()<.5?e--:e++,yield t[e]}(t)}}class Zo extends Po{constructor(){super(Qi(Zo.getDefaults(),arguments,["callback","values","pattern"])),this.name="Pattern";const t=Qi(Zo.getDefaults(),arguments,["callback","values","pattern"]);this.callback=t.callback,this._values=t.values,this._pattern=Wo(t.values,t.pattern),this._type=t.pattern}static getDefaults(){return Object.assign(Po.getDefaults(),{pattern:"up",values:[],callback:ms})}_tick(t){const e=this._pattern.next();this._value=e.value,this.callback(t,this._value)}get values(){return this._values}set values(t){this._values=t,this.pattern=this._type}get value(){return this._value}get pattern(){return this._type}set pattern(t){this._type=t,this._pattern=Wo(this._values,this._type)}}class Uo extends Io{constructor(){super(Qi(Uo.getDefaults(),arguments,["callback","events","subdivision"])),this.name="Sequence",this._part=new Ro({callback:this._seqCallback.bind(this),context:this.context}),this._events=[],this._eventsArray=[];const t=Qi(Uo.getDefaults(),arguments,["callback","events","subdivision"]);this._subdivision=this.toTicks(t.subdivision),this.events=t.events,this.loop=t.loop,this.loopStart=t.loopStart,this.loopEnd=t.loopEnd,this.playbackRate=t.playbackRate,this.probability=t.probability,this.humanize=t.humanize,this.mute=t.mute,this.playbackRate=t.playbackRate}static getDefaults(){return Object.assign($i(Io.getDefaults(),["value"]),{events:[],loop:!0,loopEnd:0,loopStart:0,subdivision:"8n"})}_seqCallback(t,e){null!==e&&this.callback(t,e)}get events(){return this._events}set events(t){this.clear(),this._eventsArray=t,this._events=this._createSequence(this._eventsArray),this._eventsUpdated()}start(t,e){return this._part.start(t,e?this._indexTime(e):e),this}stop(t){return this._part.stop(t),this}get subdivision(){return new or(this.context,this._subdivision).toSeconds()}_createSequence(t){return new Proxy(t,{get:(t,e)=>t[e],set:(t,e,n)=>(ji(e)&&isFinite(parseInt(e,10))&&Ri(n)?t[e]=this._createSequence(n):t[e]=n,this._eventsUpdated(),!0)})}_eventsUpdated(){this._part.clear(),this._rescheduleSequence(this._eventsArray,this._subdivision,this.startOffset),this.loopEnd=this.loopEnd}_rescheduleSequence(t,e,n){t.forEach(((t,i)=>{const s=i*e+n;if(Ri(t))this._rescheduleSequence(t,e/t.length,s);else{const e=new or(this.context,s,"i").toSeconds();this._part.add(e,t)}}))}_indexTime(t){return new or(this.context,t*this._subdivision+this.startOffset).toSeconds()}clear(){return this._part.clear(),this}dispose(){return super.dispose(),this._part.dispose(),this}get loop(){return this._part.loop}set loop(t){this._part.loop=t}get loopStart(){return this._loopStart}set loopStart(t){this._loopStart=t,this._part.loopStart=this._indexTime(t)}get loopEnd(){return this._loopEnd}set loopEnd(t){this._loopEnd=t,this._part.loopEnd=0===t?this._indexTime(this._eventsArray.length):this._indexTime(t)}get startOffset(){return this._part.startOffset}set startOffset(t){this._part.startOffset=t}get playbackRate(){return this._part.playbackRate}set playbackRate(t){this._part.playbackRate=t}get probability(){return this._part.probability}set probability(t){this._part.probability=t}get progress(){return this._part.progress}get humanize(){return this._part.humanize}set humanize(t){this._part.humanize=t}get length(){return this._part.length}}class Yo extends Bs{constructor(){super(Object.assign(Qi(Yo.getDefaults(),arguments,["fade"]))),this.name="CrossFade",this._panner=this.context.createStereoPanner(),this._split=this.context.createChannelSplitter(2),this._g2a=new Xr({context:this.context}),this.a=new Ys({context:this.context,gain:0}),this.b=new Ys({context:this.context,gain:0}),this.output=new Ys({context:this.context}),this._internalChannels=[this.a,this.b];const t=Qi(Yo.getDefaults(),arguments,["fade"]);this.fade=new Qs({context:this.context,units:"normalRange",value:t.fade}),ds(this,"fade"),this.context.getConstant(1).connect(this._panner),this._panner.connect(this._split),this._panner.channelCount=1,this._panner.channelCountMode="explicit",Zs(this._split,this.a.gain,0),Zs(this._split,this.b.gain,1),this.fade.chain(this._g2a,this._panner.pan),this.a.connect(this.output),this.b.connect(this.output)}static getDefaults(){return Object.assign(Bs.getDefaults(),{fade:.5})}dispose(){return super.dispose(),this.a.dispose(),this.b.dispose(),this.output.dispose(),this.fade.dispose(),this._g2a.dispose(),this._panner.disconnect(),this._split.disconnect(),this}}class Go extends Bs{constructor(t){super(t),this.name="Effect",this._dryWet=new Yo({context:this.context}),this.wet=this._dryWet.fade,this.effectSend=new Ys({context:this.context}),this.effectReturn=new Ys({context:this.context}),this.input=new Ys({context:this.context}),this.output=this._dryWet,this.input.fan(this._dryWet.a,this.effectSend),this.effectReturn.connect(this._dryWet.b),this.wet.setValueAtTime(t.wet,0),this._internalChannels=[this.effectReturn,this.effectSend],ds(this,"wet")}static getDefaults(){return Object.assign(Bs.getDefaults(),{wet:1})}connectEffect(t){return this._internalChannels.push(t),this.effectSend.chain(t,this.effectReturn),this}dispose(){return super.dispose(),this._dryWet.dispose(),this.effectSend.dispose(),this.effectReturn.dispose(),this.wet.dispose(),this}}class Xo extends Go{constructor(t){super(t),this.name="LFOEffect",this._lfo=new zr({context:this.context,frequency:t.frequency,amplitude:t.depth}),this.depth=this._lfo.amplitude,this.frequency=this._lfo.frequency,this.type=t.type,ds(this,["frequency","depth"])}static getDefaults(){return Object.assign(Go.getDefaults(),{frequency:1,type:"sine",depth:1})}start(t){return this._lfo.start(t),this}stop(t){return this._lfo.stop(t),this}sync(){return this._lfo.sync(),this}unsync(){return this._lfo.unsync(),this}get type(){return this._lfo.type}set type(t){this._lfo.type=t}dispose(){return super.dispose(),this._lfo.dispose(),this.frequency.dispose(),this.depth.dispose(),this}}class Qo extends Xo{constructor(){super(Qi(Qo.getDefaults(),arguments,["frequency","baseFrequency","octaves"])),this.name="AutoFilter";const t=Qi(Qo.getDefaults(),arguments,["frequency","baseFrequency","octaves"]);this.filter=new ho(Object.assign(t.filter,{context:this.context})),this.connectEffect(this.filter),this._lfo.connect(this.filter.frequency),this.octaves=t.octaves,this.baseFrequency=t.baseFrequency}static getDefaults(){return Object.assign(Xo.getDefaults(),{baseFrequency:200,octaves:2.6,filter:{type:"lowpass",rolloff:-12,Q:1}})}get baseFrequency(){return this._lfo.min}set baseFrequency(t){this._lfo.min=this.toFrequency(t),this.octaves=this._octaves}get octaves(){return this._octaves}set octaves(t){this._octaves=t,this._lfo.max=this._lfo.min*Math.pow(2,t)}dispose(){return super.dispose(),this.filter.dispose(),this}}class Ho extends Bs{constructor(){super(Object.assign(Qi(Ho.getDefaults(),arguments,["pan"]))),this.name="Panner",this._panner=this.context.createStereoPanner(),this.input=this._panner,this.output=this._panner;const t=Qi(Ho.getDefaults(),arguments,["pan"]);this.pan=new zs({context:this.context,param:this._panner.pan,value:t.pan,minValue:-1,maxValue:1}),this._panner.channelCount=t.channelCount,this._panner.channelCountMode="explicit",ds(this,"pan")}static getDefaults(){return Object.assign(Bs.getDefaults(),{pan:0,channelCount:1})}dispose(){return super.dispose(),this._panner.disconnect(),this.pan.dispose(),this}}class $o extends Xo{constructor(){super(Qi($o.getDefaults(),arguments,["frequency"])),this.name="AutoPanner";const t=Qi($o.getDefaults(),arguments,["frequency"]);this._panner=new Ho({context:this.context,channelCount:t.channelCount}),this.connectEffect(this._panner),this._lfo.connect(this._panner.pan),this._lfo.min=-1,this._lfo.max=1}static getDefaults(){return Object.assign(Xo.getDefaults(),{channelCount:1})}dispose(){return super.dispose(),this._panner.dispose(),this}}class Ko extends Bs{constructor(){super(Qi(Ko.getDefaults(),arguments,["smoothing"])),this.name="Follower";const t=Qi(Ko.getDefaults(),arguments,["smoothing"]);this._abs=this.input=new Gr({context:this.context}),this._lowpass=this.output=new Eo({context:this.context,frequency:1/this.toSeconds(t.smoothing),type:"lowpass"}),this._abs.connect(this._lowpass),this._smoothing=t.smoothing}static getDefaults(){return Object.assign(Bs.getDefaults(),{smoothing:.05})}get smoothing(){return this._smoothing}set smoothing(t){this._smoothing=t,this._lowpass.frequency=1/this.toSeconds(this.smoothing)}dispose(){return super.dispose(),this._abs.dispose(),this._lowpass.dispose(),this}}class Jo extends Go{constructor(){super(Qi(Jo.getDefaults(),arguments,["baseFrequency","octaves","sensitivity"])),this.name="AutoWah";const t=Qi(Jo.getDefaults(),arguments,["baseFrequency","octaves","sensitivity"]);this._follower=new Ko({context:this.context,smoothing:t.follower}),this._sweepRange=new to({context:this.context,min:0,max:1,exponent:.5}),this._baseFrequency=this.toFrequency(t.baseFrequency),this._octaves=t.octaves,this._inputBoost=new Ys({context:this.context}),this._bandpass=new ho({context:this.context,rolloff:-48,frequency:0,Q:t.Q}),this._peaking=new ho({context:this.context,type:"peaking"}),this._peaking.gain.value=t.gain,this.gain=this._peaking.gain,this.Q=this._bandpass.Q,this.effectSend.chain(this._inputBoost,this._follower,this._sweepRange),this._sweepRange.connect(this._bandpass.frequency),this._sweepRange.connect(this._peaking.frequency),this.effectSend.chain(this._bandpass,this._peaking,this.effectReturn),this._setSweepRange(),this.sensitivity=t.sensitivity,ds(this,["gain","Q"])}static getDefaults(){return Object.assign(Go.getDefaults(),{baseFrequency:100,octaves:6,sensitivity:0,Q:2,gain:2,follower:.2})}get octaves(){return this._octaves}set octaves(t){this._octaves=t,this._setSweepRange()}get follower(){return this._follower.smoothing}set follower(t){this._follower.smoothing=t}get baseFrequency(){return this._baseFrequency}set baseFrequency(t){this._baseFrequency=this.toFrequency(t),this._setSweepRange()}get sensitivity(){return Ss(1/this._inputBoost.gain.value)}set sensitivity(t){this._inputBoost.gain.value=1/Ts(t)}_setSweepRange(){this._sweepRange.min=this._baseFrequency,this._sweepRange.max=Math.min(this._baseFrequency*Math.pow(2,this._octaves),this.context.sampleRate/2)}dispose(){return super.dispose(),this._follower.dispose(),this._sweepRange.dispose(),this._bandpass.dispose(),this._peaking.dispose(),this._inputBoost.dispose(),this}}const ta="bit-crusher";To(ta,"\n\tclass BitCrusherWorklet extends SingleIOProcessor {\n\n\t\tstatic get parameterDescriptors() {\n\t\t\treturn [{\n\t\t\t\tname: \"bits\",\n\t\t\t\tdefaultValue: 12,\n\t\t\t\tminValue: 1,\n\t\t\t\tmaxValue: 16,\n\t\t\t\tautomationRate: 'k-rate'\n\t\t\t}];\n\t\t}\n\n\t\tgenerate(input, _channel, parameters) {\n\t\t\tconst step = Math.pow(0.5, parameters.bits - 1);\n\t\t\tconst val = step * Math.floor(input / step + 0.5);\n\t\t\treturn val;\n\t\t}\n\t}\n");class ea extends Go{constructor(){super(Qi(ea.getDefaults(),arguments,["bits"])),this.name="BitCrusher";const t=Qi(ea.getDefaults(),arguments,["bits"]);this._bitCrusherWorklet=new na({context:this.context,bits:t.bits}),this.connectEffect(this._bitCrusherWorklet),this.bits=this._bitCrusherWorklet.bits}static getDefaults(){return Object.assign(Go.getDefaults(),{bits:4})}dispose(){return super.dispose(),this._bitCrusherWorklet.dispose(),this}}class na extends So{constructor(){super(Qi(na.getDefaults(),arguments)),this.name="BitCrusherWorklet";const t=Qi(na.getDefaults(),arguments);this.input=new Ys({context:this.context}),this.output=new Ys({context:this.context}),this.bits=new zs({context:this.context,value:t.bits,units:"positive",minValue:1,maxValue:16,param:this._dummyParam,swappable:!0})}static getDefaults(){return Object.assign(So.getDefaults(),{bits:12})}_audioWorkletName(){return ta}onReady(t){Ws(this.input,t,this.output);const e=t.parameters.get("bits");this.bits.setParam(e)}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this.bits.dispose(),this}}class ia extends Go{constructor(){super(Qi(ia.getDefaults(),arguments,["order"])),this.name="Chebyshev";const t=Qi(ia.getDefaults(),arguments,["order"]);this._shaper=new Cr({context:this.context,length:4096}),this._order=t.order,this.connectEffect(this._shaper),this.order=t.order,this.oversample=t.oversample}static getDefaults(){return Object.assign(Go.getDefaults(),{order:1,oversample:"none"})}_getCoefficient(t,e,n){return n.has(e)||(0===e?n.set(e,0):1===e?n.set(e,t):n.set(e,2*t*this._getCoefficient(t,e-1,n)-this._getCoefficient(t,e-2,n))),n.get(e)}get order(){return this._order}set order(t){this._order=t,this._shaper.setMap((e=>this._getCoefficient(e,t,new Map)))}get oversample(){return this._shaper.oversample}set oversample(t){this._shaper.oversample=t}dispose(){return super.dispose(),this._shaper.dispose(),this}}class sa extends Bs{constructor(){super(Qi(sa.getDefaults(),arguments,["channels"])),this.name="Split";const t=Qi(sa.getDefaults(),arguments,["channels"]);this._splitter=this.input=this.output=this.context.createChannelSplitter(t.channels),this._internalChannels=[this._splitter]}static getDefaults(){return Object.assign(Bs.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._splitter.disconnect(),this}}class ra extends Bs{constructor(){super(Qi(ra.getDefaults(),arguments,["channels"])),this.name="Merge";const t=Qi(ra.getDefaults(),arguments,["channels"]);this._merger=this.output=this.input=this.context.createChannelMerger(t.channels)}static getDefaults(){return Object.assign(Bs.getDefaults(),{channels:2})}dispose(){return super.dispose(),this._merger.disconnect(),this}}class oa extends Bs{constructor(t){super(t),this.name="StereoEffect",this.input=new Ys({context:this.context}),this.input.channelCount=2,this.input.channelCountMode="explicit",this._dryWet=this.output=new Yo({context:this.context,fade:t.wet}),this.wet=this._dryWet.fade,this._split=new sa({context:this.context,channels:2}),this._merge=new ra({context:this.context,channels:2}),this.input.connect(this._split),this.input.connect(this._dryWet.a),this._merge.connect(this._dryWet.b),ds(this,["wet"])}connectEffectLeft(...t){this._split.connect(t[0],0,0),Ws(...t),Zs(t[t.length-1],this._merge,0,0)}connectEffectRight(...t){this._split.connect(t[0],1,0),Ws(...t),Zs(t[t.length-1],this._merge,0,1)}static getDefaults(){return Object.assign(Bs.getDefaults(),{wet:1})}dispose(){return super.dispose(),this._dryWet.dispose(),this._split.dispose(),this._merge.dispose(),this}}class aa extends oa{constructor(t){super(t),this.feedback=new Qs({context:this.context,value:t.feedback,units:"normalRange"}),this._feedbackL=new Ys({context:this.context}),this._feedbackR=new Ys({context:this.context}),this._feedbackSplit=new sa({context:this.context,channels:2}),this._feedbackMerge=new ra({context:this.context,channels:2}),this._merge.connect(this._feedbackSplit),this._feedbackMerge.connect(this._split),this._feedbackSplit.connect(this._feedbackL,0,0),this._feedbackL.connect(this._feedbackMerge,0,0),this._feedbackSplit.connect(this._feedbackR,1,0),this._feedbackR.connect(this._feedbackMerge,0,1),this.feedback.fan(this._feedbackL.gain,this._feedbackR.gain),ds(this,["feedback"])}static getDefaults(){return Object.assign(oa.getDefaults(),{feedback:.5})}dispose(){return super.dispose(),this.feedback.dispose(),this._feedbackL.dispose(),this._feedbackR.dispose(),this._feedbackSplit.dispose(),this._feedbackMerge.dispose(),this}}class ca extends aa{constructor(){super(Qi(ca.getDefaults(),arguments,["frequency","delayTime","depth"])),this.name="Chorus";const t=Qi(ca.getDefaults(),arguments,["frequency","delayTime","depth"]);this._depth=t.depth,this._delayTime=t.delayTime/1e3,this._lfoL=new zr({context:this.context,frequency:t.frequency,min:0,max:1}),this._lfoR=new zr({context:this.context,frequency:t.frequency,min:0,max:1,phase:180}),this._delayNodeL=new er({context:this.context}),this._delayNodeR=new er({context:this.context}),this.frequency=this._lfoL.frequency,ds(this,["frequency"]),this._lfoL.frequency.connect(this._lfoR.frequency),this.connectEffectLeft(this._delayNodeL),this.connectEffectRight(this._delayNodeR),this._lfoL.connect(this._delayNodeL.delayTime),this._lfoR.connect(this._delayNodeR.delayTime),this.depth=this._depth,this.type=t.type,this.spread=t.spread}static getDefaults(){return Object.assign(aa.getDefaults(),{frequency:1.5,delayTime:3.5,depth:.7,type:"sine",spread:180,feedback:0,wet:.5})}get depth(){return this._depth}set depth(t){this._depth=t;const e=this._delayTime*t;this._lfoL.min=Math.max(this._delayTime-e,0),this._lfoL.max=this._delayTime+e,this._lfoR.min=Math.max(this._delayTime-e,0),this._lfoR.max=this._delayTime+e}get delayTime(){return 1e3*this._delayTime}set delayTime(t){this._delayTime=t/1e3,this.depth=this._depth}get type(){return this._lfoL.type}set type(t){this._lfoL.type=t,this._lfoR.type=t}get spread(){return this._lfoR.phase-this._lfoL.phase}set spread(t){this._lfoL.phase=90-t/2,this._lfoR.phase=t/2+90}start(t){return this._lfoL.start(t),this._lfoR.start(t),this}stop(t){return this._lfoL.stop(t),this._lfoR.stop(t),this}sync(){return this._lfoL.sync(),this._lfoR.sync(),this}unsync(){return this._lfoL.unsync(),this._lfoR.unsync(),this}dispose(){return super.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._delayNodeL.dispose(),this._delayNodeR.dispose(),this.frequency.dispose(),this}}class ua extends Go{constructor(){super(Qi(ua.getDefaults(),arguments,["distortion"])),this.name="Distortion";const t=Qi(ua.getDefaults(),arguments,["distortion"]);this._shaper=new Cr({context:this.context,length:4096}),this._distortion=t.distortion,this.connectEffect(this._shaper),this.distortion=t.distortion,this.oversample=t.oversample}static getDefaults(){return Object.assign(Go.getDefaults(),{distortion:.4,oversample:"none"})}get distortion(){return this._distortion}set distortion(t){this._distortion=t;const e=100*t,n=Math.PI/180;this._shaper.setMap((t=>Math.abs(t)<.001?0:(3+e)*t*20*n/(Math.PI+e*Math.abs(t))))}get oversample(){return this._shaper.oversample}set oversample(t){this._shaper.oversample=t}dispose(){return super.dispose(),this._shaper.dispose(),this}}class la extends Go{constructor(t){super(t),this.name="FeedbackEffect",this._feedbackGain=new Ys({context:this.context,gain:t.feedback,units:"normalRange"}),this.feedback=this._feedbackGain.gain,ds(this,"feedback"),this.effectReturn.chain(this._feedbackGain,this.effectSend)}static getDefaults(){return Object.assign(Go.getDefaults(),{feedback:.125})}dispose(){return super.dispose(),this._feedbackGain.dispose(),this.feedback.dispose(),this}}class ha extends la{constructor(){super(Qi(ha.getDefaults(),arguments,["delayTime","feedback"])),this.name="FeedbackDelay";const t=Qi(ha.getDefaults(),arguments,["delayTime","feedback"]);this._delayNode=new er({context:this.context,delayTime:t.delayTime,maxDelay:t.maxDelay}),this.delayTime=this._delayNode.delayTime,this.connectEffect(this._delayNode),ds(this,"delayTime")}static getDefaults(){return Object.assign(la.getDefaults(),{delayTime:.25,maxDelay:1})}dispose(){return super.dispose(),this._delayNode.dispose(),this.delayTime.dispose(),this}}class pa extends Bs{constructor(t){super(t),this.name="PhaseShiftAllpass",this.input=new Ys({context:this.context}),this.output=new Ys({context:this.context}),this.offset90=new Ys({context:this.context}),this._bank0=this._createAllPassFilterBank([.6923878,.9360654322959,.988229522686,.9987488452737]),this._bank1=this._createAllPassFilterBank([.4021921162426,.856171088242,.9722909545651,.9952884791278]),this._oneSampleDelay=this.context.createIIRFilter([0,1],[1,0]),Ws(this.input,...this._bank0,this._oneSampleDelay,this.output),Ws(this.input,...this._bank1,this.offset90)}_createAllPassFilterBank(t){return t.map((t=>{const e=[[t*t,0,-1],[1,0,-t*t]];return this.context.createIIRFilter(e[0],e[1])}))}dispose(){return super.dispose(),this.input.dispose(),this.output.dispose(),this.offset90.dispose(),this._bank0.forEach((t=>t.disconnect())),this._bank1.forEach((t=>t.disconnect())),this._oneSampleDelay.disconnect(),this}}class da extends Go{constructor(){super(Qi(da.getDefaults(),arguments,["frequency"])),this.name="FrequencyShifter";const t=Qi(da.getDefaults(),arguments,["frequency"]);this.frequency=new Qs({context:this.context,units:"frequency",value:t.frequency,minValue:-this.context.sampleRate/2,maxValue:this.context.sampleRate/2}),this._sine=new kr({context:this.context,type:"sine"}),this._cosine=new Or({context:this.context,phase:-90,type:"sine"}),this._sineMultiply=new Dr({context:this.context}),this._cosineMultiply=new Dr({context:this.context}),this._negate=new Qr({context:this.context}),this._add=new Vr({context:this.context}),this._phaseShifter=new pa({context:this.context}),this.effectSend.connect(this._phaseShifter),this.frequency.fan(this._sine.frequency,this._cosine.frequency),this._phaseShifter.offset90.connect(this._cosineMultiply),this._cosine.connect(this._cosineMultiply.factor),this._phaseShifter.connect(this._sineMultiply),this._sine.connect(this._sineMultiply.factor),this._sineMultiply.connect(this._negate),this._cosineMultiply.connect(this._add),this._negate.connect(this._add.addend),this._add.connect(this.effectReturn);const e=this.immediate();this._sine.start(e),this._cosine.start(e)}static getDefaults(){return Object.assign(Go.getDefaults(),{frequency:0})}dispose(){return super.dispose(),this.frequency.dispose(),this._add.dispose(),this._cosine.dispose(),this._cosineMultiply.dispose(),this._negate.dispose(),this._phaseShifter.dispose(),this._sine.dispose(),this._sineMultiply.dispose(),this}}const fa=[1557/44100,1617/44100,1491/44100,1422/44100,1277/44100,1356/44100,1188/44100,1116/44100],ma=[225,556,441,341];class va extends oa{constructor(){super(Qi(va.getDefaults(),arguments,["roomSize","dampening"])),this.name="Freeverb",this._combFilters=[],this._allpassFiltersL=[],this._allpassFiltersR=[];const t=Qi(va.getDefaults(),arguments,["roomSize","dampening"]);this.roomSize=new Qs({context:this.context,value:t.roomSize,units:"normalRange"}),this._allpassFiltersL=ma.map((t=>{const e=this.context.createBiquadFilter();return e.type="allpass",e.frequency.value=t,e})),this._allpassFiltersR=ma.map((t=>{const e=this.context.createBiquadFilter();return e.type="allpass",e.frequency.value=t,e})),this._combFilters=fa.map(((e,n)=>{const i=new Co({context:this.context,dampening:t.dampening,delayTime:e});return n<fa.length/2?this.connectEffectLeft(i,...this._allpassFiltersL):this.connectEffectRight(i,...this._allpassFiltersR),this.roomSize.connect(i.resonance),i})),ds(this,["roomSize"])}static getDefaults(){return Object.assign(oa.getDefaults(),{roomSize:.7,dampening:3e3})}get dampening(){return this._combFilters[0].dampening}set dampening(t){this._combFilters.forEach((e=>e.dampening=t))}dispose(){return super.dispose(),this._allpassFiltersL.forEach((t=>t.disconnect())),this._allpassFiltersR.forEach((t=>t.disconnect())),this._combFilters.forEach((t=>t.dispose())),this.roomSize.dispose(),this}}const ga=[.06748,.06404,.08212,.09004],ya=[.773,.802,.753,.733],_a=[347,113,37];class ba extends oa{constructor(){super(Qi(ba.getDefaults(),arguments,["roomSize"])),this.name="JCReverb",this._allpassFilters=[],this._feedbackCombFilters=[];const t=Qi(ba.getDefaults(),arguments,["roomSize"]);this.roomSize=new Qs({context:this.context,value:t.roomSize,units:"normalRange"}),this._scaleRoomSize=new Fr({context:this.context,min:-.733,max:.197}),this._allpassFilters=_a.map((t=>{const e=this.context.createBiquadFilter();return e.type="allpass",e.frequency.value=t,e})),this._feedbackCombFilters=ga.map(((t,e)=>{const n=new Oo({context:this.context,delayTime:t});return this._scaleRoomSize.connect(n.resonance),n.resonance.value=ya[e],e<ga.length/2?this.connectEffectLeft(...this._allpassFilters,n):this.connectEffectRight(...this._allpassFilters,n),n})),this.roomSize.connect(this._scaleRoomSize),ds(this,["roomSize"])}static getDefaults(){return Object.assign(oa.getDefaults(),{roomSize:.5})}dispose(){return super.dispose(),this._allpassFilters.forEach((t=>t.disconnect())),this._feedbackCombFilters.forEach((t=>t.dispose())),this.roomSize.dispose(),this._scaleRoomSize.dispose(),this}}class xa extends aa{constructor(t){super(t),this._feedbackL.disconnect(),this._feedbackL.connect(this._feedbackMerge,0,1),this._feedbackR.disconnect(),this._feedbackR.connect(this._feedbackMerge,0,0),ds(this,["feedback"])}}class wa extends xa{constructor(){super(Qi(wa.getDefaults(),arguments,["delayTime","feedback"])),this.name="PingPongDelay";const t=Qi(wa.getDefaults(),arguments,["delayTime","feedback"]);this._leftDelay=new er({context:this.context,maxDelay:t.maxDelay}),this._rightDelay=new er({context:this.context,maxDelay:t.maxDelay}),this._rightPreDelay=new er({context:this.context,maxDelay:t.maxDelay}),this.delayTime=new Qs({context:this.context,units:"time",value:t.delayTime}),this.connectEffectLeft(this._leftDelay),this.connectEffectRight(this._rightPreDelay,this._rightDelay),this.delayTime.fan(this._leftDelay.delayTime,this._rightDelay.delayTime,this._rightPreDelay.delayTime),this._feedbackL.disconnect(),this._feedbackL.connect(this._rightDelay),ds(this,["delayTime"])}static getDefaults(){return Object.assign(xa.getDefaults(),{delayTime:.25,maxDelay:1})}dispose(){return super.dispose(),this._leftDelay.dispose(),this._rightDelay.dispose(),this._rightPreDelay.dispose(),this.delayTime.dispose(),this}}class Ta extends la{constructor(){super(Qi(Ta.getDefaults(),arguments,["pitch"])),this.name="PitchShift";const t=Qi(Ta.getDefaults(),arguments,["pitch"]);this._frequency=new Qs({context:this.context}),this._delayA=new er({maxDelay:1,context:this.context}),this._lfoA=new zr({context:this.context,min:0,max:.1,type:"sawtooth"}).connect(this._delayA.delayTime),this._delayB=new er({maxDelay:1,context:this.context}),this._lfoB=new zr({context:this.context,min:0,max:.1,type:"sawtooth",phase:180}).connect(this._delayB.delayTime),this._crossFade=new Yo({context:this.context}),this._crossFadeLFO=new zr({context:this.context,min:0,max:1,type:"triangle",phase:90}).connect(this._crossFade.fade),this._feedbackDelay=new er({delayTime:t.delayTime,context:this.context}),this.delayTime=this._feedbackDelay.delayTime,ds(this,"delayTime"),this._pitch=t.pitch,this._windowSize=t.windowSize,this._delayA.connect(this._crossFade.a),this._delayB.connect(this._crossFade.b),this._frequency.fan(this._lfoA.frequency,this._lfoB.frequency,this._crossFadeLFO.frequency),this.effectSend.fan(this._delayA,this._delayB),this._crossFade.chain(this._feedbackDelay,this.effectReturn);const e=this.now();this._lfoA.start(e),this._lfoB.start(e),this._crossFadeLFO.start(e),this.windowSize=this._windowSize}static getDefaults(){return Object.assign(la.getDefaults(),{pitch:0,windowSize:.1,delayTime:0,feedback:0})}get pitch(){return this._pitch}set pitch(t){this._pitch=t;let e=0;t<0?(this._lfoA.min=0,this._lfoA.max=this._windowSize,this._lfoB.min=0,this._lfoB.max=this._windowSize,e=ks(t-1)+1):(this._lfoA.min=this._windowSize,this._lfoA.max=0,this._lfoB.min=this._windowSize,this._lfoB.max=0,e=ks(t)-1),this._frequency.value=e*(1.2/this._windowSize)}get windowSize(){return this._windowSize}set windowSize(t){this._windowSize=this.toSeconds(t),this.pitch=this._pitch}dispose(){return super.dispose(),this._frequency.dispose(),this._delayA.dispose(),this._delayB.dispose(),this._lfoA.dispose(),this._lfoB.dispose(),this._crossFade.dispose(),this._crossFadeLFO.dispose(),this._feedbackDelay.dispose(),this}}class Sa extends oa{constructor(){super(Qi(Sa.getDefaults(),arguments,["frequency","octaves","baseFrequency"])),this.name="Phaser";const t=Qi(Sa.getDefaults(),arguments,["frequency","octaves","baseFrequency"]);this._lfoL=new zr({context:this.context,frequency:t.frequency,min:0,max:1}),this._lfoR=new zr({context:this.context,frequency:t.frequency,min:0,max:1,phase:180}),this._baseFrequency=this.toFrequency(t.baseFrequency),this._octaves=t.octaves,this.Q=new Qs({context:this.context,value:t.Q,units:"positive"}),this._filtersL=this._makeFilters(t.stages,this._lfoL),this._filtersR=this._makeFilters(t.stages,this._lfoR),this.frequency=this._lfoL.frequency,this.frequency.value=t.frequency,this.connectEffectLeft(...this._filtersL),this.connectEffectRight(...this._filtersR),this._lfoL.frequency.connect(this._lfoR.frequency),this.baseFrequency=t.baseFrequency,this.octaves=t.octaves,this._lfoL.start(),this._lfoR.start(),ds(this,["frequency","Q"])}static getDefaults(){return Object.assign(oa.getDefaults(),{frequency:.5,octaves:3,stages:10,Q:10,baseFrequency:350})}_makeFilters(t,e){const n=[];for(let i=0;i<t;i++){const t=this.context.createBiquadFilter();t.type="allpass",this.Q.connect(t.Q),e.connect(t.frequency),n.push(t)}return n}get octaves(){return this._octaves}set octaves(t){this._octaves=t;const e=this._baseFrequency*Math.pow(2,t);this._lfoL.max=e,this._lfoR.max=e}get baseFrequency(){return this._baseFrequency}set baseFrequency(t){this._baseFrequency=this.toFrequency(t),this._lfoL.min=this._baseFrequency,this._lfoR.min=this._baseFrequency,this.octaves=this._octaves}dispose(){return super.dispose(),this.Q.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._filtersL.forEach((t=>t.disconnect())),this._filtersR.forEach((t=>t.disconnect())),this.frequency.dispose(),this}}class ka extends Go{constructor(){super(Qi(ka.getDefaults(),arguments,["decay"])),this.name="Reverb",this._convolver=this.context.createConvolver(),this.ready=Promise.resolve();const t=Qi(ka.getDefaults(),arguments,["decay"]);this._decay=t.decay,this._preDelay=t.preDelay,this.generate(),this.connectEffect(this._convolver)}static getDefaults(){return Object.assign(Go.getDefaults(),{decay:1.5,preDelay:.01})}get decay(){return this._decay}set decay(t){wi(t=this.toSeconds(t),.001),this._decay=t,this.generate()}get preDelay(){return this._preDelay}set preDelay(t){wi(t=this.toSeconds(t),0),this._preDelay=t,this.generate()}generate(){return Li(this,void 0,void 0,(function*(){const t=this.ready,e=new gs(2,this._decay+this._preDelay,this.context.sampleRate),n=new _r({context:e}),i=new _r({context:e}),s=new ra({context:e});n.connect(s,0,0),i.connect(s,0,1);const r=new Ys({context:e}).toDestination();s.connect(r),n.start(0),i.start(0),r.gain.setValueAtTime(0,0),r.gain.setValueAtTime(1,this._preDelay),r.gain.exponentialApproachValueAtTime(0,this._preDelay,this.decay);const o=e.render();return this.ready=o.then(ms),yield t,this._convolver.buffer=(yield o).get(),this}))}dispose(){return super.dispose(),this._convolver.disconnect(),this}}class Oa extends Bs{constructor(){super(Qi(Oa.getDefaults(),arguments)),this.name="MidSideSplit",this._split=this.input=new sa({channels:2,context:this.context}),this._midAdd=new Vr({context:this.context}),this.mid=new Dr({context:this.context,value:Math.SQRT1_2}),this._sideSubtract=new Hr({context:this.context}),this.side=new Dr({context:this.context,value:Math.SQRT1_2}),this._split.connect(this._midAdd,0),this._split.connect(this._midAdd.addend,1),this._split.connect(this._sideSubtract,0),this._split.connect(this._sideSubtract.subtrahend,1),this._midAdd.connect(this.mid),this._sideSubtract.connect(this.side)}dispose(){return super.dispose(),this.mid.dispose(),this.side.dispose(),this._midAdd.dispose(),this._sideSubtract.dispose(),this._split.dispose(),this}}class Ea extends Bs{constructor(){super(Qi(Ea.getDefaults(),arguments)),this.name="MidSideMerge",this.mid=new Ys({context:this.context}),this.side=new Ys({context:this.context}),this._left=new Vr({context:this.context}),this._leftMult=new Dr({context:this.context,value:Math.SQRT1_2}),this._right=new Hr({context:this.context}),this._rightMult=new Dr({context:this.context,value:Math.SQRT1_2}),this._merge=this.output=new ra({context:this.context}),this.mid.fan(this._left),this.side.connect(this._left.addend),this.mid.connect(this._right),this.side.connect(this._right.subtrahend),this._left.connect(this._leftMult),this._right.connect(this._rightMult),this._leftMult.connect(this._merge,0,0),this._rightMult.connect(this._merge,0,1)}dispose(){return super.dispose(),this.mid.dispose(),this.side.dispose(),this._leftMult.dispose(),this._rightMult.dispose(),this._left.dispose(),this._right.dispose(),this}}class Ca extends Go{constructor(t){super(t),this.name="MidSideEffect",this._midSideMerge=new Ea({context:this.context}),this._midSideSplit=new Oa({context:this.context}),this._midSend=this._midSideSplit.mid,this._sideSend=this._midSideSplit.side,this._midReturn=this._midSideMerge.mid,this._sideReturn=this._midSideMerge.side,this.effectSend.connect(this._midSideSplit),this._midSideMerge.connect(this.effectReturn)}connectEffectMid(...t){this._midSend.chain(...t,this._midReturn)}connectEffectSide(...t){this._sideSend.chain(...t,this._sideReturn)}dispose(){return super.dispose(),this._midSideSplit.dispose(),this._midSideMerge.dispose(),this._midSend.dispose(),this._sideSend.dispose(),this._midReturn.dispose(),this._sideReturn.dispose(),this}}class Aa extends Ca{constructor(){super(Qi(Aa.getDefaults(),arguments,["width"])),this.name="StereoWidener";const t=Qi(Aa.getDefaults(),arguments,["width"]);this.width=new Qs({context:this.context,value:t.width,units:"normalRange"}),ds(this,["width"]),this._twoTimesWidthMid=new Dr({context:this.context,value:2}),this._twoTimesWidthSide=new Dr({context:this.context,value:2}),this._midMult=new Dr({context:this.context}),this._twoTimesWidthMid.connect(this._midMult.factor),this.connectEffectMid(this._midMult),this._oneMinusWidth=new Hr({context:this.context}),this._oneMinusWidth.connect(this._twoTimesWidthMid),Zs(this.context.getConstant(1),this._oneMinusWidth),this.width.connect(this._oneMinusWidth.subtrahend),this._sideMult=new Dr({context:this.context}),this.width.connect(this._twoTimesWidthSide),this._twoTimesWidthSide.connect(this._sideMult.factor),this.connectEffectSide(this._sideMult)}static getDefaults(){return Object.assign(Ca.getDefaults(),{width:.5})}dispose(){return super.dispose(),this.width.dispose(),this._midMult.dispose(),this._sideMult.dispose(),this._twoTimesWidthMid.dispose(),this._twoTimesWidthSide.dispose(),this._oneMinusWidth.dispose(),this}}class Da extends oa{constructor(){super(Qi(Da.getDefaults(),arguments,["frequency","depth"])),this.name="Tremolo";const t=Qi(Da.getDefaults(),arguments,["frequency","depth"]);this._lfoL=new zr({context:this.context,type:t.type,min:1,max:0}),this._lfoR=new zr({context:this.context,type:t.type,min:1,max:0}),this._amplitudeL=new Ys({context:this.context}),this._amplitudeR=new Ys({context:this.context}),this.frequency=new Qs({context:this.context,value:t.frequency,units:"frequency"}),this.depth=new Qs({context:this.context,value:t.depth,units:"normalRange"}),ds(this,["frequency","depth"]),this.connectEffectLeft(this._amplitudeL),this.connectEffectRight(this._amplitudeR),this._lfoL.connect(this._amplitudeL.gain),this._lfoR.connect(this._amplitudeR.gain),this.frequency.fan(this._lfoL.frequency,this._lfoR.frequency),this.depth.fan(this._lfoR.amplitude,this._lfoL.amplitude),this.spread=t.spread}static getDefaults(){return Object.assign(oa.getDefaults(),{frequency:10,type:"sine",depth:.5,spread:180})}start(t){return this._lfoL.start(t),this._lfoR.start(t),this}stop(t){return this._lfoL.stop(t),this._lfoR.stop(t),this}sync(){return this._lfoL.sync(),this._lfoR.sync(),this.context.transport.syncSignal(this.frequency),this}unsync(){return this._lfoL.unsync(),this._lfoR.unsync(),this.context.transport.unsyncSignal(this.frequency),this}get type(){return this._lfoL.type}set type(t){this._lfoL.type=t,this._lfoR.type=t}get spread(){return this._lfoR.phase-this._lfoL.phase}set spread(t){this._lfoL.phase=90-t/2,this._lfoR.phase=t/2+90}dispose(){return super.dispose(),this._lfoL.dispose(),this._lfoR.dispose(),this._amplitudeL.dispose(),this._amplitudeR.dispose(),this.frequency.dispose(),this.depth.dispose(),this}}class Ma extends Go{constructor(){super(Qi(Ma.getDefaults(),arguments,["frequency","depth"])),this.name="Vibrato";const t=Qi(Ma.getDefaults(),arguments,["frequency","depth"]);this._delayNode=new er({context:this.context,delayTime:0,maxDelay:t.maxDelay}),this._lfo=new zr({context:this.context,type:t.type,min:0,max:t.maxDelay,frequency:t.frequency,phase:-90}).start().connect(this._delayNode.delayTime),this.frequency=this._lfo.frequency,this.depth=this._lfo.amplitude,this.depth.value=t.depth,ds(this,["frequency","depth"]),this.effectSend.chain(this._delayNode,this.effectReturn)}static getDefaults(){return Object.assign(Go.getDefaults(),{maxDelay:.005,frequency:5,depth:.1,type:"sine"})}get type(){return this._lfo.type}set type(t){this._lfo.type=t}dispose(){return super.dispose(),this._delayNode.dispose(),this._lfo.dispose(),this.frequency.dispose(),this.depth.dispose(),this}}class Ia extends Bs{constructor(){super(Qi(Ia.getDefaults(),arguments,["type","size"])),this.name="Analyser",this._analysers=[],this._buffers=[];const t=Qi(Ia.getDefaults(),arguments,["type","size"]);this.input=this.output=this._gain=new Ys({context:this.context}),this._split=new sa({context:this.context,channels:t.channels}),this.input.connect(this._split),wi(t.channels,1);for(let e=0;e<t.channels;e++)this._analysers[e]=this.context.createAnalyser(),this._split.connect(this._analysers[e],e,0);this.size=t.size,this.type=t.type}static getDefaults(){return Object.assign(Bs.getDefaults(),{size:1024,smoothing:.8,type:"fft",channels:1})}getValue(){return this._analysers.forEach(((t,e)=>{const n=this._buffers[e];"fft"===this._type?t.getFloatFrequencyData(n):"waveform"===this._type&&t.getFloatTimeDomainData(n)})),1===this.channels?this._buffers[0]:this._buffers}get size(){return this._analysers[0].frequencyBinCount}set size(t){this._analysers.forEach(((e,n)=>{e.fftSize=2*t,this._buffers[n]=new Float32Array(t)}))}get channels(){return this._analysers.length}get type(){return this._type}set type(t){xi("waveform"===t||"fft"===t,`Analyser: invalid type: ${t}`),this._type=t}get smoothing(){return this._analysers[0].smoothingTimeConstant}set smoothing(t){this._analysers.forEach((e=>e.smoothingTimeConstant=t))}dispose(){return super.dispose(),this._analysers.forEach((t=>t.disconnect())),this._split.dispose(),this._gain.dispose(),this}}class Pa extends Bs{constructor(){super(Qi(Pa.getDefaults(),arguments)),this.name="MeterBase",this.input=this.output=this._analyser=new Ia({context:this.context,size:256,type:"waveform"})}dispose(){return super.dispose(),this._analyser.dispose(),this}}class Ra extends Pa{constructor(){super(Qi(Ra.getDefaults(),arguments,["smoothing"])),this.name="Meter",this._rms=0;const t=Qi(Ra.getDefaults(),arguments,["smoothing"]);this.input=this.output=this._analyser=new Ia({context:this.context,size:256,type:"waveform",channels:t.channels}),this.smoothing=t.smoothing,this.normalRange=t.normalRange}static getDefaults(){return Object.assign(Pa.getDefaults(),{smoothing:.8,normalRange:!1,channels:1})}getLevel(){return Ei("'getLevel' has been changed to 'getValue'"),this.getValue()}getValue(){const t=this._analyser.getValue(),e=(1===this.channels?[t]:t).map((t=>{const e=t.reduce(((t,e)=>t+e*e),0),n=Math.sqrt(e/t.length);return this._rms=Math.max(n,this._rms*this.smoothing),this.normalRange?this._rms:Ss(this._rms)}));return 1===this.channels?e[0]:e}get channels(){return this._analyser.channels}dispose(){return super.dispose(),this._analyser.dispose(),this}}class ja extends Pa{constructor(){super(Qi(ja.getDefaults(),arguments,["size"])),this.name="FFT";const t=Qi(ja.getDefaults(),arguments,["size"]);this.normalRange=t.normalRange,this._analyser.type="fft",this.size=t.size}static getDefaults(){return Object.assign(Bs.getDefaults(),{normalRange:!1,size:1024,smoothing:.8})}getValue(){return this._analyser.getValue().map((t=>this.normalRange?Ts(t):t))}get size(){return this._analyser.size}set size(t){this._analyser.size=t}get smoothing(){return this._analyser.smoothing}set smoothing(t){this._analyser.smoothing=t}getFrequencyOfIndex(t){return xi(0<=t&&t<this.size,`index must be greater than or equal to 0 and less than ${this.size}`),t*this.context.sampleRate/(2*this.size)}}class qa extends Pa{constructor(){super(Qi(qa.getDefaults(),arguments)),this.name="DCMeter",this._analyser.type="waveform",this._analyser.size=256}getValue(){return this._analyser.getValue()[0]}}class Na extends Pa{constructor(){super(Qi(Na.getDefaults(),arguments,["size"])),this.name="Waveform";const t=Qi(Na.getDefaults(),arguments,["size"]);this._analyser.type="waveform",this.size=t.size}static getDefaults(){return Object.assign(Pa.getDefaults(),{size:1024})}getValue(){return this._analyser.getValue()}get size(){return this._analyser.size}set size(t){this._analyser.size=t}}class Va extends Bs{constructor(){super(Qi(Va.getDefaults(),arguments,["solo"])),this.name="Solo";const t=Qi(Va.getDefaults(),arguments,["solo"]);this.input=this.output=new Ys({context:this.context}),Va._allSolos.has(this.context)||Va._allSolos.set(this.context,new Set),Va._allSolos.get(this.context).add(this),this.solo=t.solo}static getDefaults(){return Object.assign(Bs.getDefaults(),{solo:!1})}get solo(){return this._isSoloed()}set solo(t){t?this._addSolo():this._removeSolo(),Va._allSolos.get(this.context).forEach((t=>t._updateSolo()))}get muted(){return 0===this.input.gain.value}_addSolo(){Va._soloed.has(this.context)||Va._soloed.set(this.context,new Set),Va._soloed.get(this.context).add(this)}_removeSolo(){Va._soloed.has(this.context)&&Va._soloed.get(this.context).delete(this)}_isSoloed(){return Va._soloed.has(this.context)&&Va._soloed.get(this.context).has(this)}_noSolos(){return!Va._soloed.has(this.context)||Va._soloed.has(this.context)&&0===Va._soloed.get(this.context).size}_updateSolo(){this._isSoloed()||this._noSolos()?this.input.gain.value=1:this.input.gain.value=0}dispose(){return super.dispose(),Va._allSolos.get(this.context).delete(this),this._removeSolo(),this}}Va._allSolos=new Map,Va._soloed=new Map;class Fa extends Bs{constructor(){super(Qi(Fa.getDefaults(),arguments,["pan","volume"])),this.name="PanVol";const t=Qi(Fa.getDefaults(),arguments,["pan","volume"]);this._panner=this.input=new Ho({context:this.context,pan:t.pan,channelCount:t.channelCount}),this.pan=this._panner.pan,this._volume=this.output=new hr({context:this.context,volume:t.volume}),this.volume=this._volume.volume,this._panner.connect(this._volume),this.mute=t.mute,ds(this,["pan","volume"])}static getDefaults(){return Object.assign(Bs.getDefaults(),{mute:!1,pan:0,volume:0,channelCount:1})}get mute(){return this._volume.mute}set mute(t){this._volume.mute=t}dispose(){return super.dispose(),this._panner.dispose(),this.pan.dispose(),this._volume.dispose(),this.volume.dispose(),this}}class La extends Bs{constructor(){super(Qi(La.getDefaults(),arguments,["volume","pan"])),this.name="Channel";const t=Qi(La.getDefaults(),arguments,["volume","pan"]);this._solo=this.input=new Va({solo:t.solo,context:this.context}),this._panVol=this.output=new Fa({context:this.context,pan:t.pan,volume:t.volume,mute:t.mute,channelCount:t.channelCount}),this.pan=this._panVol.pan,this.volume=this._panVol.volume,this._solo.connect(this._panVol),ds(this,["pan","volume"])}static getDefaults(){return Object.assign(Bs.getDefaults(),{pan:0,volume:0,mute:!1,solo:!1,channelCount:1})}get solo(){return this._solo.solo}set solo(t){this._solo.solo=t}get muted(){return this._solo.muted||this.mute}get mute(){return this._panVol.mute}set mute(t){this._panVol.mute=t}_getBus(t){return La.buses.has(t)||La.buses.set(t,new Ys({context:this.context})),La.buses.get(t)}send(t,e=0){const n=this._getBus(t),i=new Ys({context:this.context,units:"decibels",gain:e});return this.connect(i),i.connect(n),i}receive(t){return this._getBus(t).connect(this),this}dispose(){return super.dispose(),this._panVol.dispose(),this.pan.dispose(),this.volume.dispose(),this._solo.dispose(),this}}La.buses=new Map;class za extends Bs{constructor(){super(Qi(za.getDefaults(),arguments)),this.name="Mono",this.input=new Ys({context:this.context}),this._merge=this.output=new ra({channels:2,context:this.context}),this.input.connect(this._merge,0,0),this.input.connect(this._merge,0,1)}dispose(){return super.dispose(),this._merge.dispose(),this.input.dispose(),this}}class Ba extends Bs{constructor(){super(Qi(Ba.getDefaults(),arguments,["lowFrequency","highFrequency"])),this.name="MultibandSplit",this.input=new Ys({context:this.context}),this.output=void 0,this.low=new ho({context:this.context,frequency:0,type:"lowpass"}),this._lowMidFilter=new ho({context:this.context,frequency:0,type:"highpass"}),this.mid=new ho({context:this.context,frequency:0,type:"lowpass"}),this.high=new ho({context:this.context,frequency:0,type:"highpass"}),this._internalChannels=[this.low,this.mid,this.high];const t=Qi(Ba.getDefaults(),arguments,["lowFrequency","highFrequency"]);this.lowFrequency=new Qs({context:this.context,units:"frequency",value:t.lowFrequency}),this.highFrequency=new Qs({context:this.context,units:"frequency",value:t.highFrequency}),this.Q=new Qs({context:this.context,units:"positive",value:t.Q}),this.input.fan(this.low,this.high),this.input.chain(this._lowMidFilter,this.mid),this.lowFrequency.fan(this.low.frequency,this._lowMidFilter.frequency),this.highFrequency.fan(this.mid.frequency,this.high.frequency),this.Q.connect(this.low.Q),this.Q.connect(this._lowMidFilter.Q),this.Q.connect(this.mid.Q),this.Q.connect(this.high.Q),ds(this,["high","mid","low","highFrequency","lowFrequency"])}static getDefaults(){return Object.assign(Bs.getDefaults(),{Q:1,highFrequency:2500,lowFrequency:400})}dispose(){return super.dispose(),fs(this,["high","mid","low","highFrequency","lowFrequency"]),this.low.dispose(),this._lowMidFilter.dispose(),this.mid.dispose(),this.high.dispose(),this.lowFrequency.dispose(),this.highFrequency.dispose(),this.Q.dispose(),this}}class Wa extends Bs{constructor(){super(...arguments),this.name="Listener",this.positionX=new zs({context:this.context,param:this.context.rawContext.listener.positionX}),this.positionY=new zs({context:this.context,param:this.context.rawContext.listener.positionY}),this.positionZ=new zs({context:this.context,param:this.context.rawContext.listener.positionZ}),this.forwardX=new zs({context:this.context,param:this.context.rawContext.listener.forwardX}),this.forwardY=new zs({context:this.context,param:this.context.rawContext.listener.forwardY}),this.forwardZ=new zs({context:this.context,param:this.context.rawContext.listener.forwardZ}),this.upX=new zs({context:this.context,param:this.context.rawContext.listener.upX}),this.upY=new zs({context:this.context,param:this.context.rawContext.listener.upY}),this.upZ=new zs({context:this.context,param:this.context.rawContext.listener.upZ})}static getDefaults(){return Object.assign(Bs.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}dispose(){return super.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}}as((t=>{t.listener=new Wa({context:t})})),us((t=>{t.listener.dispose()}));class Za extends Bs{constructor(){super(Qi(Za.getDefaults(),arguments,["positionX","positionY","positionZ"])),this.name="Panner3D";const t=Qi(Za.getDefaults(),arguments,["positionX","positionY","positionZ"]);this._panner=this.input=this.output=this.context.createPanner(),this.panningModel=t.panningModel,this.maxDistance=t.maxDistance,this.distanceModel=t.distanceModel,this.coneOuterGain=t.coneOuterGain,this.coneOuterAngle=t.coneOuterAngle,this.coneInnerAngle=t.coneInnerAngle,this.refDistance=t.refDistance,this.rolloffFactor=t.rolloffFactor,this.positionX=new zs({context:this.context,param:this._panner.positionX,value:t.positionX}),this.positionY=new zs({context:this.context,param:this._panner.positionY,value:t.positionY}),this.positionZ=new zs({context:this.context,param:this._panner.positionZ,value:t.positionZ}),this.orientationX=new zs({context:this.context,param:this._panner.orientationX,value:t.orientationX}),this.orientationY=new zs({context:this.context,param:this._panner.orientationY,value:t.orientationY}),this.orientationZ=new zs({context:this.context,param:this._panner.orientationZ,value:t.orientationZ})}static getDefaults(){return Object.assign(Bs.getDefaults(),{coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:0,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1})}setPosition(t,e,n){return this.positionX.value=t,this.positionY.value=e,this.positionZ.value=n,this}setOrientation(t,e,n){return this.orientationX.value=t,this.orientationY.value=e,this.orientationZ.value=n,this}get panningModel(){return this._panner.panningModel}set panningModel(t){this._panner.panningModel=t}get refDistance(){return this._panner.refDistance}set refDistance(t){this._panner.refDistance=t}get rolloffFactor(){return this._panner.rolloffFactor}set rolloffFactor(t){this._panner.rolloffFactor=t}get distanceModel(){return this._panner.distanceModel}set distanceModel(t){this._panner.distanceModel=t}get coneInnerAngle(){return this._panner.coneInnerAngle}set coneInnerAngle(t){this._panner.coneInnerAngle=t}get coneOuterAngle(){return this._panner.coneOuterAngle}set coneOuterAngle(t){this._panner.coneOuterAngle=t}get coneOuterGain(){return this._panner.coneOuterGain}set coneOuterGain(t){this._panner.coneOuterGain=t}get maxDistance(){return this._panner.maxDistance}set maxDistance(t){this._panner.maxDistance=t}dispose(){return super.dispose(),this._panner.disconnect(),this.orientationX.dispose(),this.orientationY.dispose(),this.orientationZ.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this}}class Ua extends Bs{constructor(){super(Qi(Ua.getDefaults(),arguments)),this.name="Recorder";const t=Qi(Ua.getDefaults(),arguments);this.input=new Ys({context:this.context}),xi(Ua.supported,"Media Recorder API is not available"),this._stream=this.context.createMediaStreamDestination(),this.input.connect(this._stream),this._recorder=new MediaRecorder(this._stream.stream,{mimeType:t.mimeType})}static getDefaults(){return Bs.getDefaults()}get mimeType(){return this._recorder.mimeType}static get supported(){return null!==Ni&&Reflect.has(Ni,"MediaRecorder")}get state(){return"inactive"===this._recorder.state?"stopped":"paused"===this._recorder.state?"paused":"started"}start(){return Li(this,void 0,void 0,(function*(){xi("started"!==this.state,"Recorder is already started");const t=new Promise((t=>{const e=()=>{this._recorder.removeEventListener("start",e,!1),t()};this._recorder.addEventListener("start",e,!1)}));return this._recorder.start(),yield t}))}stop(){return Li(this,void 0,void 0,(function*(){xi("stopped"!==this.state,"Recorder is not started");const t=new Promise((t=>{const e=n=>{this._recorder.removeEventListener("dataavailable",e,!1),t(n.data)};this._recorder.addEventListener("dataavailable",e,!1)}));return this._recorder.stop(),yield t}))}pause(){return xi("started"===this.state,"Recorder must be started"),this._recorder.pause(),this}dispose(){return super.dispose(),this.input.dispose(),this._stream.disconnect(),this}}class Ya extends Bs{constructor(){super(Qi(Ya.getDefaults(),arguments,["threshold","ratio"])),this.name="Compressor",this._compressor=this.context.createDynamicsCompressor(),this.input=this._compressor,this.output=this._compressor;const t=Qi(Ya.getDefaults(),arguments,["threshold","ratio"]);this.threshold=new zs({minValue:this._compressor.threshold.minValue,maxValue:this._compressor.threshold.maxValue,context:this.context,convert:!1,param:this._compressor.threshold,units:"decibels",value:t.threshold}),this.attack=new zs({minValue:this._compressor.attack.minValue,maxValue:this._compressor.attack.maxValue,context:this.context,param:this._compressor.attack,units:"time",value:t.attack}),this.release=new zs({minValue:this._compressor.release.minValue,maxValue:this._compressor.release.maxValue,context:this.context,param:this._compressor.release,units:"time",value:t.release}),this.knee=new zs({minValue:this._compressor.knee.minValue,maxValue:this._compressor.knee.maxValue,context:this.context,convert:!1,param:this._compressor.knee,units:"decibels",value:t.knee}),this.ratio=new zs({minValue:this._compressor.ratio.minValue,maxValue:this._compressor.ratio.maxValue,context:this.context,convert:!1,param:this._compressor.ratio,units:"positive",value:t.ratio}),ds(this,["knee","release","attack","ratio","threshold"])}static getDefaults(){return Object.assign(Bs.getDefaults(),{attack:.003,knee:30,ratio:12,release:.25,threshold:-24})}get reduction(){return this._compressor.reduction}dispose(){return super.dispose(),this._compressor.disconnect(),this.attack.dispose(),this.release.dispose(),this.threshold.dispose(),this.ratio.dispose(),this.knee.dispose(),this}}class Ga extends Bs{constructor(){super(Object.assign(Qi(Ga.getDefaults(),arguments,["threshold","smoothing"]))),this.name="Gate";const t=Qi(Ga.getDefaults(),arguments,["threshold","smoothing"]);this._follower=new Ko({context:this.context,smoothing:t.smoothing}),this._gt=new Kr({context:this.context,value:Ts(t.threshold)}),this.input=new Ys({context:this.context}),this._gate=this.output=new Ys({context:this.context}),this.input.connect(this._gate),this.input.chain(this._follower,this._gt,this._gate.gain)}static getDefaults(){return Object.assign(Bs.getDefaults(),{smoothing:.1,threshold:-40})}get threshold(){return Ss(this._gt.value)}set threshold(t){this._gt.value=Ts(t)}get smoothing(){return this._follower.smoothing}set smoothing(t){this._follower.smoothing=t}dispose(){return super.dispose(),this.input.dispose(),this._follower.dispose(),this._gt.dispose(),this._gate.dispose(),this}}class Xa extends Bs{constructor(){super(Object.assign(Qi(Xa.getDefaults(),arguments,["threshold"]))),this.name="Limiter";const t=Qi(Xa.getDefaults(),arguments,["threshold"]);this._compressor=this.input=this.output=new Ya({context:this.context,ratio:20,attack:.003,release:.01,threshold:t.threshold}),this.threshold=this._compressor.threshold,ds(this,"threshold")}static getDefaults(){return Object.assign(Bs.getDefaults(),{threshold:-12})}get reduction(){return this._compressor.reduction}dispose(){return super.dispose(),this._compressor.dispose(),this.threshold.dispose(),this}}class Qa extends Bs{constructor(){super(Object.assign(Qi(Qa.getDefaults(),arguments))),this.name="MidSideCompressor";const t=Qi(Qa.getDefaults(),arguments);this._midSideSplit=this.input=new Oa({context:this.context}),this._midSideMerge=this.output=new Ea({context:this.context}),this.mid=new Ya(Object.assign(t.mid,{context:this.context})),this.side=new Ya(Object.assign(t.side,{context:this.context})),this._midSideSplit.mid.chain(this.mid,this._midSideMerge.mid),this._midSideSplit.side.chain(this.side,this._midSideMerge.side),ds(this,["mid","side"])}static getDefaults(){return Object.assign(Bs.getDefaults(),{mid:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16},side:{ratio:6,threshold:-30,release:.25,attack:.03,knee:10}})}dispose(){return super.dispose(),this.mid.dispose(),this.side.dispose(),this._midSideSplit.dispose(),this._midSideMerge.dispose(),this}}class Ha extends Bs{constructor(){super(Object.assign(Qi(Ha.getDefaults(),arguments))),this.name="MultibandCompressor";const t=Qi(Ha.getDefaults(),arguments);this._splitter=this.input=new Ba({context:this.context,lowFrequency:t.lowFrequency,highFrequency:t.highFrequency}),this.lowFrequency=this._splitter.lowFrequency,this.highFrequency=this._splitter.highFrequency,this.output=new Ys({context:this.context}),this.low=new Ya(Object.assign(t.low,{context:this.context})),this.mid=new Ya(Object.assign(t.mid,{context:this.context})),this.high=new Ya(Object.assign(t.high,{context:this.context})),this._splitter.low.chain(this.low,this.output),this._splitter.mid.chain(this.mid,this.output),this._splitter.high.chain(this.high,this.output),ds(this,["high","mid","low","highFrequency","lowFrequency"])}static getDefaults(){return Object.assign(Bs.getDefaults(),{lowFrequency:250,highFrequency:2e3,low:{ratio:6,threshold:-30,release:.25,attack:.03,knee:10},mid:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16},high:{ratio:3,threshold:-24,release:.03,attack:.02,knee:16}})}dispose(){return super.dispose(),this._splitter.dispose(),this.low.dispose(),this.mid.dispose(),this.high.dispose(),this.output.dispose(),this}}class $a extends Bs{constructor(){super(Qi($a.getDefaults(),arguments,["low","mid","high"])),this.name="EQ3",this.output=new Ys({context:this.context}),this._internalChannels=[];const t=Qi($a.getDefaults(),arguments,["low","mid","high"]);this.input=this._multibandSplit=new Ba({context:this.context,highFrequency:t.highFrequency,lowFrequency:t.lowFrequency}),this._lowGain=new Ys({context:this.context,gain:t.low,units:"decibels"}),this._midGain=new Ys({context:this.context,gain:t.mid,units:"decibels"}),this._highGain=new Ys({context:this.context,gain:t.high,units:"decibels"}),this.low=this._lowGain.gain,this.mid=this._midGain.gain,this.high=this._highGain.gain,this.Q=this._multibandSplit.Q,this.lowFrequency=this._multibandSplit.lowFrequency,this.highFrequency=this._multibandSplit.highFrequency,this._multibandSplit.low.chain(this._lowGain,this.output),this._multibandSplit.mid.chain(this._midGain,this.output),this._multibandSplit.high.chain(this._highGain,this.output),ds(this,["low","mid","high","lowFrequency","highFrequency"]),this._internalChannels=[this._multibandSplit]}static getDefaults(){return Object.assign(Bs.getDefaults(),{high:0,highFrequency:2500,low:0,lowFrequency:400,mid:0})}dispose(){return super.dispose(),fs(this,["low","mid","high","lowFrequency","highFrequency"]),this._multibandSplit.dispose(),this.lowFrequency.dispose(),this.highFrequency.dispose(),this._lowGain.dispose(),this._midGain.dispose(),this._highGain.dispose(),this.low.dispose(),this.mid.dispose(),this.high.dispose(),this.Q.dispose(),this}}class Ka extends Bs{constructor(){super(Qi(Ka.getDefaults(),arguments,["url","onload"])),this.name="Convolver",this._convolver=this.context.createConvolver();const t=Qi(Ka.getDefaults(),arguments,["url","onload"]);this._buffer=new vs(t.url,(e=>{this.buffer=e,t.onload()})),this.input=new Ys({context:this.context}),this.output=new Ys({context:this.context}),this._buffer.loaded&&(this.buffer=this._buffer),this.normalize=t.normalize,this.input.chain(this._convolver,this.output)}static getDefaults(){return Object.assign(Bs.getDefaults(),{normalize:!0,onload:ms})}load(t){return Li(this,void 0,void 0,(function*(){this.buffer=yield this._buffer.load(t)}))}get buffer(){return this._buffer.length?this._buffer:null}set buffer(t){t&&this._buffer.set(t),this._convolver.buffer&&(this.input.disconnect(),this._convolver.disconnect(),this._convolver=this.context.createConvolver(),this.input.chain(this._convolver,this.output));const e=this._buffer.get();this._convolver.buffer=e||null}get normalize(){return this._convolver.normalize}set normalize(t){this._convolver.normalize=t}dispose(){return super.dispose(),this._buffer.dispose(),this._convolver.disconnect(),this}}function Ja(){return bs().now()}function tc(){return bs().immediate()}const ec=bs().transport;function nc(){return bs().transport}const ic=bs().destination,sc=bs().destination;function rc(){return bs().destination}const oc=bs().listener;function ac(){return bs().listener}const cc=bs().draw;function uc(){return bs().draw}const lc=bs();function hc(){return vs.loaded()}const pc=vs,dc=ir,fc=yr},655:(t,e,n)=>{"use strict";n.d(e,{ZT:()=>s});var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function s(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}},e={};function n(i){var s=e[i];if(void 0!==s)return s.exports;var r=e[i]={exports:{}};return t[i].call(r.exports,r,r.exports,n),r.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{"use strict";function t(t,e,n,i,s,r,o){try{var a=t[r](o),c=a.value}catch(t){return void n(t)}a.done?e(c):Promise.resolve(c).then(i,s)}var e,i,s=n(7757),r=n.n(s),o=[{ButtonId:1,Note:"C3",IsDragging:!1,Element:void 0,Label:{Element:void 0}},{ButtonId:2,Note:"D3",IsDragging:!1,Element:void 0,Label:{Element:void 0}},{ButtonId:3,Note:"E3",IsDragging:!1,Element:void 0,Label:{Element:void 0}},{ButtonId:4,Note:"F3",IsDragging:!1,Element:void 0,Label:{Element:void 0}},{ButtonId:5,Note:"G3",IsDragging:!1,Element:void 0,Label:{Element:void 0}},{ButtonId:6,Note:"A3",IsDragging:!1,Element:void 0,Label:{Element:void 0}},{ButtonId:7,Note:"B3",IsDragging:!1,Element:void 0,Label:{Element:void 0}},{ButtonId:8,Note:"C4",IsDragging:!1,Element:void 0,Label:{Element:void 0}},{ButtonId:9,Note:"D4",IsDragging:!1,Element:void 0,Label:{Element:void 0}},{ButtonId:10,Note:"E4",IsDragging:!1,Element:void 0,Label:{Element:void 0}}],a=[{ButtonId:1,KeyCode:"z",Note:"C3",IsPressed:!1,Element:void 0},{ButtonId:2,KeyCode:"x",Note:"D3",IsPressed:!1,Element:void 0},{ButtonId:3,KeyCode:"c",Note:"E3",IsPressed:!1,Element:void 0},{ButtonId:4,KeyCode:"v",Note:"F3",IsPressed:!1,Element:void 0},{ButtonId:5,KeyCode:"b",Note:"G3",IsPressed:!1,Element:void 0},{ButtonId:6,KeyCode:"n",Note:"A3",IsPressed:!1,Element:void 0},{ButtonId:7,KeyCode:"m",Note:"B3",IsPressed:!1,Element:void 0},{ButtonId:8,KeyCode:",",Note:"C4",IsPressed:!1,Element:void 0},{ButtonId:9,KeyCode:".",Note:"D4",IsPressed:!1,Element:void 0},{ButtonId:10,KeyCode:"/",Note:"E4",IsPressed:!1,Element:void 0}],c=n(4143),u=c.interval,l=c.defer,h=n(1717),p=h.take,d=h.repeat,f=n(8496),m=n(879),v=new m.Recorder,g=new m.PolySynth(m.Synth).connect(v).toDestination(),y=4,_="high",b=!1,x=!1,w=0,T=1e3,S=[1,2,3,4,5,6,7,8,9,10],k=1;document.addEventListener("DOMContentLoaded",(function(){I("vol-container","vol-slider","vol-button-container",(function(t){var e=1e4*M(t,4)-3500;g.set({detune:e})})),I("speed-container","speed-slider","speed-button-container",(function(t){T=-1*Math.round(1e4*M(t,4)-8197)})),function(){f(".dropzone").dropzone({accept:".drag-drop",overlap:.5,ondragenter:function(t){var e=t.target;D(parseInt(t.relatedTarget.id,10))||e.classList.contains("occupied")&&e.classList.remove("occupied")},ondragleave:function(t){for(var e=t.relatedTarget,n=e.children,i=0;i<n.length;i++)n[i].classList.contains("cross")&&(n[i].classList.contains("d-none")||n[i].classList.add("d-none"));e.classList.add("dragging");var s=parseInt(e.id,10);if(!D(s)){A(s),t.target.classList.remove("occupied");var r=t.target.id;S[r-1]=0}},ondrop:function(t){var e=t.relatedTarget,n=e.children;if(t.target.classList.contains("occupied"))for(var i=0;i<n.length;i++)n[i].classList.contains("cross")&&n[i].classList.remove("d-none");else{for(var s=0;s<n.length;s++)n[s].classList.contains("cross")&&(n[s].classList.contains("d-none")||n[s].classList.add("d-none"));var r=parseInt(e.id,10);D(r)&&A(r),t.target.classList.add("occupied");var o,a,c=parseInt(t.target.id,10);e.style.zIndex=12-c,e.classList.remove("dragging"),S[c-1]=r,c>r?o="right":c<r?o="left":c===r&&(o="same");"same"===o?a=0:"right"===o?a=45*(c-r):"left"===o&&(a=-45*(r-c)),e.style.webkitTransform=e.style.transform="translate("+a+"px, 0px)",e.setAttribute("data-x",a),e.setAttribute("data-y",0)}}});f(".drag-drop").draggable({inertia:!1,modifiers:[f.modifiers.restrictRect({endOnly:!0})],autoScroll:!0,listeners:{move:function(t){var e=t.target,n=(parseFloat(e.getAttribute("data-x"))||0)+t.dx,i=(parseFloat(e.getAttribute("data-y"))||0)+t.dy;e.style.webkitTransform=e.style.transform="translate("+n+"px, "+i+"px)",e.setAttribute("data-x",n),e.setAttribute("data-y",i)}}})}(),function(){for(var t=document.getElementsByClassName("key"),e=document.getElementsByClassName("button"),n=document.getElementsByClassName("plug-label"),i=function(e){a.find((function(t){return t.ButtonId===e+1})).Element=t[e]},s=0;s<t.length;s++)i(s);for(var r=function(t){var i=o.find((function(e){return e.ButtonId===t+1}));i.Element=e[t],i.Label.Element=n[t]},c=0;c<e.length;c++)r(c)}(),function(){window.addEventListener("keydown",(function(t){var e;R(t.key)&&(e=t.key,a.find((function(t){return t.KeyCode===e})).IsPressed||function(t){var e=a.find((function(e){return e.KeyCode===t}));e.Element.classList.add("key-pressed"),e.IsPressed=!0,b&&g.triggerAttack(E(t))}(t.key))}),{passive:!0}),window.addEventListener("keyup",(function(t){var e,n;R(t.key)&&(e=t.key,(n=a.find((function(t){return t.KeyCode===e}))).Element.classList.remove("key-pressed"),n.IsPressed=!1,g.triggerRelease(E(e),m.now()+w))}),{passive:!0});var t=document.getElementById("sustain-input"),n=document.getElementById("range-btn"),s=document.getElementById("volume-btn"),r=document.getElementById("mode-btn"),c=document.getElementById("reset-plugs-btn"),h=document.getElementById("start-recording-btn"),f=document.getElementById("stop-recording-btn"),M=document.getElementById("change-osc-btn");t.addEventListener("input",(function(){var e=parseFloat(t.value,10);w=isNaN(e)?0:e})),n.addEventListener("click",(function(){var t;(t=document.getElementById("range-knob"))&&(4===y?(t.style.transform="rotate(-31.6deg)",y=6):6===y?(t.style.transform="rotate(-63.2deg)",y=8):8===y?(t.style.transform="rotate(-95deg)",y=10):10===y&&(t.style.transform="rotate(0deg)",y=4))})),s.addEventListener("click",(function(){var t;t=document.getElementsByClassName("switch-button")[0],"low"===_?(_="med",t.style.left="10px",g.volume.value=-5):"med"===_?(_="high",t.style.left="19.55px",g.volume.value=0):"high"===_&&(_="low",t.style.left="0.45px",g.volume.value=-10)})),r.addEventListener("click",(function(){var t;(t=document.getElementById("mode-knob"))&&(b?b&&x?(t.style.transform="rotate(0deg)",x=!1,b=!1,e.unsubscribe(),O()):(t.style.transform="rotate(95deg)",x=!0,i=-1,e=l((function(){return u(T/y)})).pipe(p(1),d()).subscribe((function(t){O(),(++i===y||i>y)&&(i=0);var e=S[i];!function(t){t>0&&t<11&&o.find((function(e){return e.ButtonId===t})).Label.Element.classList.add("label-highlighted")}(e),function(t,e){var n,i;"NONE"!==t&&g.triggerAttackRelease(t,((i=w||.01)>(n=T/1e3/e)&&(i=n),i))}(function(t){return 0===t?"NONE":o.find((function(e){return e.ButtonId===t})).Note}(e),y)}))):(t.style.transform="rotate(47.5deg)",b=!0))})),c.addEventListener("click",(function(){(S=[1,2,3,4,5,6,7,8,9,10]).forEach((function(t){D(t)&&A(t)})),o.forEach((function(t){t.Element.classList.contains("dragging")&&t.Element.classList.remove("dragging");for(var e=t.Element.children,n=0;n<e.length;n++)e[n].classList.contains("cross")&&(e[n].classList.contains("d-none")||e[n].classList.add("d-none"));var i=t.Element.parentElement;i.classList.contains("occupied")||i.classList.add("occupied"),t.Element.style.webkitTransform=t.Element.style.transform="translate(0px, 0px)",t.Element.style.zIndex=(12-parseInt(t.Element.id,10)).toString(),t.Element.setAttribute("data-x","0"),t.Element.setAttribute("data-y","0")}))})),h.addEventListener("click",(function(){v.start()})),f.addEventListener("click",(function(){C()})),M.addEventListener("click",(function(){1===k?(k=2,g.set({oscillator:{type:"sine"}})):2===k?(k=3,g.set({oscillator:{type:"square"}})):3===k?(k=4,g.set({oscillator:{type:"sawtooth"}})):4===k&&(k=1,g.set({oscillator:{type:"triangle"}}))}))}()}));var O=function(){o.forEach((function(t){var e=t.Label.Element;e.classList.contains("label-highlighted")&&e.classList.remove("label-highlighted")}))},E=function(t){return a.find((function(e){return e.KeyCode===t})).Note},C=function(){var e,n=(e=r().mark((function t(){var e,n,i;return r().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,v.stop();case 2:e=t.sent,n=URL.createObjectURL(e),(i=document.createElement("a")).download="recording-".concat(Date.now(),".webm"),i.href=n,i.click();case 8:case"end":return t.stop()}}),t)})),function(){var n=this,i=arguments;return new Promise((function(s,r){var o=e.apply(n,i);function a(e){t(o,s,r,a,c,"next",e)}function c(e){t(o,s,r,a,c,"throw",e)}a(void 0)}))});return function(){return n.apply(this,arguments)}}(),A=function(t){var e=o.find((function(e){return e.ButtonId===t}));e&&(e.IsDragging=!e.IsDragging)},D=function(t){var e=o.find((function(e){return e.ButtonId===t}));if(e)return e.IsDragging},M=function(t,e){var n=parseInt("1"+"0".repeat(e),10);return t*=n,Math.round(t)/n};function I(t,e,n,i){var s,r=document.getElementsByClassName(t)[0],o=document.getElementsByClassName(n)[0],a=document.getElementsByClassName(e)[0];r.addEventListener("mousedown",(function(t){P(t,s=t,o,a,i)})),r.addEventListener("mousemove",(function(t){P(t,s,o,a,i)})),r.addEventListener("mouseup",(function(t){s=null})),r.addEventListener("dragstart",(function(t){t.preventDefault()}))}function P(t,e,n,i,s){if(e){var r=i.getBoundingClientRect();r.y-=15;var o=r.height+5,a=Math.min(o,Math.max(20,t.y-r.y));n.style.top=a+"px",s((o-a)/o)}}function R(t){return!!a.find((function(e){return e.KeyCode===t}))}})()})();
//# sourceMappingURL=script.bundle.js.map